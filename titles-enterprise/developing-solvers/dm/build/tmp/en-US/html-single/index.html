<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Developing solvers with Red Hat build of OptaPlanner in Red Hat Decision Manager</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.2"/><meta name="description" content="This document describes how to develop solvers with Red Hat build of OptaPlanner in Red Hat Decision Manager to find the optimal solution to planning problems."/><link rel="next" href="#idm45892285712896" title="Preface"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><div xml:lang="en-US" class="book" id="idm45892320463424"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Decision Manager</span> <span class="productnumber">7.13</span></div><div><h1 class="title">Developing solvers with Red Hat build of OptaPlanner in Red Hat Decision Manager</h1></div><div><h2 class="subtitle"/></div><div><a href="#idm45892287759744">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This document describes how to develop solvers with Red Hat build of OptaPlanner in Red Hat Decision Manager to find the optimal solution to planning problems.
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="preface"><a href="#idm45892285712896">Preface</a></span></li><li><span class="preface"><a href="#snip-conscious-language_developing-solvers">Making open source more inclusive</a></span></li><li><span class="part"><a href="#assembly-optimizer-migration-8_developing-solvers">I. Upgrading your Red Hat build of OptaPlanner projects to OptaPlanner 8</a></span><ul><li><span class="chapter"><a href="#optaplanner-7-ref_developing-solvers">1. Changes that are not compatible with OptaPlanner 7.x or earlier</a></span></li><li><span class="chapter"><a href="#optaplanner-8-ref_developing-solvers">2. Changes between OptaPlanner 8.2.0 and OptaPlanner 8.3.0</a></span></li></ul></li><li><span class="part"><a href="#assembly-getting-started-business-optimizer">II. Getting started with Red Hat build of OptaPlanner</a></span><ul><li><span class="chapter"><a href="#optimizer-about-optimizer-con_getting-started-optaplanner">3. Introduction to Red Hat build of OptaPlanner</a></span><ul><li><span class="section"><a href="#optimizer-planning-problem-con">3.1. Planning problems</a></span></li><li><span class="section"><a href="#optimizer-NP-complete-vs-NP-hard-con">3.2. NP-completeness in planning problems</a></span></li><li><span class="section"><a href="#optimizer-planning-problem-search-space-con">3.3. Solutions to planning problems</a></span></li><li><span class="section"><a href="#optimizer-hard-vs-soft-constraints-con">3.4. Constraints on planning problems</a></span></li><li><span class="section"><a href="#examples-con">3.5. Examples provided with Red Hat build of OptaPlanner</a></span></li><li><span class="section"><a href="#ex-nQueens-ref">3.6. N queens</a></span><ul><li><span class="section"><a href="#nQueensDomainModel">3.6.1. Domain model for N queens</a></span></li></ul></li><li><span class="section"><a href="#ex-cloudBalancing-ref">3.7. Cloud balancing</a></span></li><li><span class="section"><a href="#ex-tsp-ref">3.8. Traveling salesman (TSP - Traveling Salesman Problem)</a></span></li><li><span class="section"><a href="#ex-tennis-ref">3.9. Tennis club scheduling</a></span></li><li><span class="section"><a href="#ex-meetingScheduling-ref">3.10. Meeting scheduling</a></span></li><li><span class="section"><a href="#ex-curriculumCourse-ref">3.11. Course timetabling (ITC 2007 Track 3 - Curriculum Course Scheduling)</a></span></li><li><span class="section"><a href="#ex-machineReassignment-ref">3.12. Machine reassignment (Google ROADEF 2012)</a></span></li><li><span class="section"><a href="#ex-vehicleRouting-ref">3.13. Vehicle routing</a></span><ul><li><span class="section"><a href="#vehicleRoutingDomainModel">3.13.1. Domain model for Vehicle routing</a></span></li></ul></li><li><span class="section"><a href="#ex-projectJobScheduling-ref">3.14. Project job scheduling</a></span></li><li><span class="section"><a href="#ex-taskAssigning-ref">3.15. Task assigning</a></span></li><li><span class="section"><a href="#ex-examination-ref">3.16. Exam timetabling (ITC 2007 track 1 - Examination)</a></span><ul><li><span class="section"><a href="#domain_model_for_exam_timetabling">3.16.1. Domain model for exam timetabling</a></span></li></ul></li><li><span class="section"><a href="#ex-nurseRostering-ref">3.17. Nurse rostering (INRC 2010)</a></span></li><li><span class="section"><a href="#ex-travelingTournament-ref">3.18. Traveling tournament problem (TTP)</a></span></li><li><span class="section"><a href="#ex-cheapTimeScheduling-ref">3.19. Cheap time scheduling</a></span></li><li><span class="section"><a href="#ex-investment-ref">3.20. Investment asset class allocation (Portfolio Optimization)</a></span></li><li><span class="section"><a href="#ex-conferenceScheduling-ref">3.21. Conference scheduling</a></span></li><li><span class="section"><a href="#ex-rockTour-ref">3.22. Rock tour</a></span></li><li><span class="section"><a href="#ex-flightCrewScheduling-ref">3.23. Flight crew scheduling</a></span></li></ul></li><li><span class="chapter"><a href="#examples-download-proc">4. Downloading Red Hat build of OptaPlanner examples</a></span><ul><li><span class="section"><a href="#optimizer-running-the-examples-proc">4.1. Running OptaPlanner examples</a></span></li><li><span class="section"><a href="#optimizer-running-the-examples-in-an-IDE-proc">4.2. Running the Red Hat build of OptaPlanner examples in an IDE (IntelliJ, Eclipse, or Netbeans)</a></span></li></ul></li><li><span class="chapter"><a href="#workbench-er-tutorial-con">5. Getting started with OptaPlanner in Business Central: An employee rostering example</a></span><ul><li><span class="section"><a href="#wb-employee-rostering-example-deploying-in-central-proc">5.1. Deploying the employee rostering sample project in Business Central</a></span></li><li><span class="section"><a href="#wb-employee-rostering-example-recreate-con">5.2. Re-creating the employee rostering sample project</a></span><ul><li><span class="section"><a href="#wb-employee-rostering-example-setup-proc">5.2.1. Setting up the employee rostering project</a></span></li><li><span class="section"><a href="#wb-employee-rostering-facts-vs-entities-con">5.2.2. Problem facts and planning entities</a></span></li><li><span class="section"><a href="#wb-employee-rostering-data-model-proc">5.2.3. Creating the data model for the employee rostering project</a></span></li><li><span class="section"><a href="#wb-employee-rostering-constraints-con">5.2.4. Employee rostering constraints</a></span></li><li><span class="section"><a href="#wb-employee-rostering-guided-rule-editor-proc">5.2.5. Creating rules for employee rostering using guided rules</a></span></li><li><span class="section"><a href="#wb-employee-rostering-solver-configuration-proc">5.2.6. Creating a solver configuration for employee rostering</a></span></li><li><span class="section"><a href="#wb-employee-rostering-solver-termination-configuration-proc">5.2.7. Configuring Solver termination for the employee rostering project</a></span></li></ul></li><li><span class="section"><a href="#wb-employee-rostering-using-rest-proc">5.3. Accessing the solver using the REST API</a></span><ul><li><span class="section"><a href="#wb-employee-rostering-register-solver-proc">5.3.1. Registering the Solver using the REST API</a></span></li><li><span class="section"><a href="#wb-employee-rostering-call-solver-proc">5.3.2. Calling the Solver using the REST API</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#optaplanner-quarkus-con_getting-started-optaplanner">6. Getting Started with OptaPlanner and Quarkus</a></span><ul><li><span class="section"><a href="#con-apache-maven-plug-ins-and-quarkus_getting-started-optaplanner">6.1. Apache Maven and Red Hat build of Quarkus</a></span><ul><li><span class="section"><a href="#con-online-maven_getting-started-optaplanner">6.1.1. Configuring the Maven <code class="literal">settings.xml</code> file for the online repository</a></span></li><li><span class="section"><a href="#con-download-maven_getting-started-optaplanner">6.1.2. Downloading and configuring the Quarkus Maven repository</a></span></li></ul></li><li><span class="section"><a href="#proc-quarkus-creating-proj_getting-started-optaplanner">6.2. Creating an OptaPlanner Red Hat build of Quarkus Maven project using the Maven plug-in</a></span></li><li><span class="section"><a href="#code-quarkus-redhat-com-proc_getting-started-optaplanner">6.3. Creating a Red Hat build of Quarkus Maven project using code.quarkus.redhat.com</a></span></li><li><span class="section"><a href="#proc-quarkus-creating-proj-cli_getting-started-optaplanner">6.4. Creating a Red Hat build of Quarkus Maven project using the Quarkus CLI</a></span></li></ul></li></ul></li><li><span class="part"><a href="#assembly-planner-configuration">III. The Red Hat build of OptaPlanner solver</a></span><ul><li><span class="chapter"><a href="#configuring-planner-proc_developing-solvers">7. Configuring the Red Hat build of OptaPlanner solver</a></span><ul><li><span class="section"><a href="#xml-configuration-proc_developing-solvers">7.1. Using an XML file to configure the OptaPlanner solver</a></span></li><li><span class="section"><a href="#using-java-api-proc_developing-solvers">7.2. Using the Java API to configure the OptaPlanner solver</a></span></li><li><span class="section"><a href="#planner-annotations-con_developing-solvers">7.3. OptaPlanner annotation</a></span></li><li><span class="section"><a href="#specifying-domain-access-proc_developing-solvers">7.4. Specifying OptaPlanner domain access</a></span></li><li><span class="section"><a href="#configuring-custom-properties-proc_developing-solvers">7.5. Configuring custom properties</a></span></li></ul></li><li><span class="chapter"><a href="#solver-con_developing-solvers">8. The OptaPlanner Solver</a></span><ul><li><span class="section"><a href="#solving-a-problem-proc_developing-solvers">8.1. Solving a problem</a></span></li><li><span class="section"><a href="#solver-environment-con_developing-solvers">8.2. Solver environment mode</a></span></li><li><span class="section"><a href="#logging-level-proc_developing-solvers">8.3. Changing the OptaPlanner solver logging level</a></span></li><li><span class="section"><a href="#logback-proc_developing-solvers">8.4. Using Logback to log OptaPlanner solver activity</a></span></li><li><span class="section"><a href="#Log4J-proc_developing-solvers">8.5. Using Log4J to log OptaPlanner solver activity</a></span></li><li><span class="section"><a href="#monitoring-the-solver-proc_developing-solvers">8.6. Monitoring the solver</a></span><ul><li><span class="section"><a href="#configuring_a_quarkus_optaplanner_application_for_micrometer">8.6.1. Configuring a Quarkus OptaPlanner application for Micrometer</a></span></li><li><span class="section"><a href="#configuring_a_spring_boot_optaplanner_application_for_micrometer">8.6.2. Configuring a Spring Boot OptaPlanner application for Micrometer</a></span></li><li><span class="section"><a href="#configuring_a_plain_java_optaplanner_application_for_micrometer">8.6.3. Configuring a plain Java OptaPlanner application for Micrometer</a></span></li><li><span class="section"><a href="#additional_metrics">8.6.4. Additional Metrics</a></span></li></ul></li><li><span class="section"><a href="#cofiguring-random-number-proc_developing-solvers">8.7. Configuring the random number generator</a></span></li></ul></li><li><span class="chapter"><a href="#sovlermanager-con_developing-solvers">9. The OptaPlanner SolverManager</a></span><ul><li><span class="section"><a href="#batch-solving-con_developing-solvers">9.1. Batch solving problems</a></span></li><li><span class="section"><a href="#show-progress-proc_developing-solvers">9.2. Solve and listen to show progress</a></span></li></ul></li></ul></li><li><span class="part"><a href="#assembly-optaplanner-quickstarts_developing-solvers">IV. Red Hat build of OptaPlanner quick start guides</a></span><ul><li><span class="chapter"><a href="#assembly-optaplanner-school-timetable-quarkus_optaplanner-quickstarts">10. Red Hat build of OptaPlanner on Red Hat build of Quarkus: a school timetable quick start guide</a></span><ul><li><span class="section"><a href="#proc-quarkus-creating-proj_optaplanner-quarkus">10.1. Creating an OptaPlanner Red Hat build of Quarkus Maven project using the Maven plug-in</a></span></li><li><span class="section"><a href="#business-optimizr-domain-objects-proc_optaplanner-quarkus">10.2. Model the domain objects</a></span></li><li><span class="section"><a href="#business-optimizr-define-contraints-proc_optaplanner-quarkus">10.3. Define the constraints and calculate the score</a></span></li><li><span class="section"><a href="#business-optimizr-gather-objects-proc_optaplanner-quarkus">10.4. Gather the domain objects in a planning solution</a></span></li><li><span class="section"><a href="#solver-service-proc_optaplanner-quarkus">10.5. Create the solver service</a></span></li><li><span class="section"><a href="#business-optimizr-set-solver-time-proc_optaplanner-quarkus">10.6. Set the solver termination time</a></span></li><li><span class="section"><a href="#proc-quarkus-compiling-project_optaplanner-quarkus">10.7. Running the school timetable application</a></span></li><li><span class="section"><a href="#testing_the_application">10.8. Testing the application</a></span><ul><li><span class="section"><a href="#business-optimizer-test-constraints-proc_optaplanner-quarkus">10.8.1. Test the school timetable constraints</a></span></li><li><span class="section"><a href="#business-optimizer-test-solver-proc_optaplanner-quarkus">10.8.2. Test the school timetable solver</a></span></li></ul></li><li><span class="section"><a href="#business-optimizer-logging-quarkus-proc_optaplanner-quarkus">10.9. Logging</a></span></li><li><span class="section"><a href="#planner-quarkus-database-proc_optaplanner-quarkus">10.10. Integrating a database with your Quarkus OptaPlanner school timetable application</a></span></li><li><span class="section"><a href="#micrometer-and-quarkus-proc_optaplanner-quarkus">10.11. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Quarkus application</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-optaplanner-vaccination_optaplanner-quickstarts">11. Red Hat build of OptaPlanner on Red Hat build of Quarkus: a vaccination appointment scheduler quick start guide</a></span><ul><li><span class="section"><a href="#vaccination-scheduler-con_optaplanner-quickstarts">11.1. How the OptaPlanner vaccination appointment scheduler works</a></span><ul><li><span class="section"><a href="#vaccination-contraints-con_optaplanner-quickstarts">11.1.1. OptaPlanner vaccination appointment scheduler constraints</a></span></li><li><span class="section"><a href="#optaplanner-solver-con_optaplanner-quickstarts">11.1.2. The OptaPlanner solver</a></span></li><li><span class="section"><a href="#continuous-planning-con_optaplanner-quickstarts">11.1.3. Continuous planning</a></span></li><li><span class="section"><a href="#pinned-planning-entities-con_optaplanner-quickstarts">11.1.4. Pinned planning entities</a></span></li></ul></li><li><span class="section"><a href="#vaccination-scheduler-download-proc_optaplanner-quickstarts">11.2. Downloading and running the OptaPlanner vaccination appointment scheduler</a></span></li><li><span class="section"><a href="#vaccination-scheduler-package-proc_optaplanner-quickstarts">11.3. Package and run the OptaPlanner vaccination appointment scheduler</a></span></li><li><span class="section"><a href="#vaccination-native-proc_optaplanner-quickstarts">11.4. Run the OptaPlanner vaccination appointment scheduler as a native executable</a></span></li><li><span class="section"><a href="#additional_resources">11.5. Additional resources</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-business-optimizer-springboot_optaplanner-quickstarts">12. Red Hat build of OptaPlanner on Spring Boot: a school timetable quick start guide</a></span><ul><li><span class="section"><a href="#spring-boot-ref-download-proc_business-optimizer-spring-boot">12.1. Downloading and building the Spring Boot school timetable quick start</a></span></li><li><span class="section"><a href="#business-optimizr-domain-objects-proc_business-optimizer-spring-boot">12.2. Model the domain objects</a></span></li><li><span class="section"><a href="#business-optimizr-define-contraints-proc_business-optimizer-spring-boot">12.3. Define the constraints and calculate the score</a></span></li><li><span class="section"><a href="#business-optimizr-gather-objects-proc_business-optimizer-spring-boot">12.4. Gather the domain objects in a planning solution</a></span></li><li><span class="section"><a href="#business-optimizr-create-timetable-service-proc_business-optimizer-spring-boot">12.5. Create the Timetable service</a></span></li><li><span class="section"><a href="#business-optimizr-set-solver-time-proc_business-optimizer-spring-boot">12.6. Set the solver termination time</a></span></li><li><span class="section"><a href="#business-optimizer-make-executable-proc_business-optimizer-spring-boot">12.7. Make the application executable</a></span><ul><li><span class="section"><a href="#business-optimizer-try-application-proc_business-optimizer-spring-boot">12.7.1. Try the timetable application</a></span></li><li><span class="section"><a href="#business-optimizer-test-application-proc_business-optimizer-spring-boot">12.7.2. Test the application</a></span></li><li><span class="section"><a href="#business-optimizer-logging-proc_business-optimizer-spring-boot">12.7.3. Logging</a></span></li></ul></li><li><span class="section"><a href="#business-optimizer-database-UI-integration-proc_business-optimizer-spring-boot">12.8. Add Database and UI integration</a></span></li><li><span class="section"><a href="#using_micrometer_and_prometheus_to_monitor_your_school_timetable_optaplanner_spring_boot_application">12.9. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Spring Boot application</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-planner-java">13. Red Hat build of OptaPlanner and Java: a school timetable quickstart guide</a></span><ul><li><span class="section"><a href="#create_the_maven_or_gradle_build_file_and_add_dependencies">13.1. Create the Maven or Gradle build file and add dependencies</a></span></li><li><span class="section"><a href="#business-optimizr-domain-objects-proc_optaplanner-java">13.2. Model the domain objects</a></span></li><li><span class="section"><a href="#business-optimizr-define-contraints-proc_optaplanner-java">13.3. Define the constraints and calculate the score</a></span></li><li><span class="section"><a href="#business-optimizr-gather-objects-proc_optaplanner-java">13.4. Gather the domain objects in a planning solution</a></span></li><li><span class="section"><a href="#the_timetableapp_java_class">13.5. The TimeTableApp.java class</a></span></li><li><span class="section"><a href="#create_and_run_the_school_timetable_application">13.6. Create and run the school timetable application</a></span></li><li><span class="section"><a href="#test_the_application">13.7. Test the application</a></span><ul><li><span class="section"><a href="#business-optimizer-test-constraints-proc_optaplanner-java">13.7.1. Test the school timetable constraints</a></span></li><li><span class="section"><a href="#business-optimizer-test-solver-proc_optaplanner-java">13.7.2. Test the school timetable solver</a></span></li></ul></li><li><span class="section"><a href="#business-optimizer-logging-quarkus-proc_optaplanner-java">13.8. Logging</a></span></li><li><span class="section"><a href="#using_micrometer_and_prometheus_to_monitor_your_school_timetable_optaplanner_java_application">13.9. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Java application</a></span></li></ul></li></ul></li><li><span class="part"><a href="#assembly-optaplanner-starter-applications_optaplanner-quickstarts">V. Red Hat build of OptaPlanner starter applications</a></span><ul><li><span class="chapter"><a href="#assembly-optimizer-modifying-ER-template-IDE">14. Using Red Hat build of OptaPlanner in an IDE: an employee rostering example</a></span><ul><li><span class="section"><a href="#optashift-ER-overview-con_employee-rostering-ide">14.1. Overview of the employee rostering starter application</a></span></li><li><span class="section"><a href="#optashift-ER-building-con">14.2. Building and running the employee rostering starter application</a></span><ul><li><span class="section"><a href="#er-deploy-prepare-proc">14.2.1. Preparing deployment files</a></span></li><li><span class="section"><a href="#optashift-ER-running-jar-proc">14.2.2. Running the Employee Rostering starter application JAR file</a></span></li><li><span class="section"><a href="#optashift-ER-building-commandline-proc">14.2.3. Building and running the Employee Rostering starter application using Maven</a></span></li><li><span class="section"><a href="#optashift-ER-building-commandline-db-proc">14.2.4. Building and running the employee rostering starter application with persistent data storage from the command line</a></span></li><li><span class="section"><a href="#optashift-ER-building-IntelliJ-IDEA-proc">14.2.5. Building and running the employee rostering starter application using IntelliJ IDEA</a></span></li></ul></li><li><span class="section"><a href="#er-overview-source-con">14.3. Overview of the source code of the employee rostering starter application</a></span></li><li><span class="section"><a href="#optashift-ER-modifying-proc">14.4. Modifying the employee rostering starter application</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-optimizer-running-employee-rostering-openshift">15. Deploying and using Red Hat build of OptaPlanner in Red Hat OpenShift Container Platform: an employee rostering starter example</a></span><ul><li><span class="section"><a href="#optashift-ER-overview-con_employee-rostering-openshift">15.1. Overview of the employee rostering starter application</a></span></li><li><span class="section"><a href="#optashift-ER-openshift-deploy-con">15.2. Installing and starting the employee rostering starter application on OpenShift</a></span><ul><li><span class="section"><a href="#er-deploy-script-proc">15.2.1. Deploying the application using the provided script</a></span></li></ul></li><li><span class="section"><a href="#er-using-con">15.3. Using the employee rostering starter application</a></span><ul><li><span class="section"><a href="#er-periods-con">15.3.1. The draft and published periods</a></span></li><li><span class="section"><a href="#er-rotation-con">15.3.2. The rotation pattern</a></span></li><li><span class="section"><a href="#er-tenants-con">15.3.3. Employee Rostering tenants</a></span></li><li><span class="section"><a href="#er-skills-proc">15.3.4. Entering skills</a></span></li><li><span class="section"><a href="#er-spots-proc">15.3.5. Entering spots</a></span></li><li><span class="section"><a href="#er-contracts-proc">15.3.6. Entering the list of contracts</a></span></li><li><span class="section"><a href="#er-employees-proc">15.3.7. Entering the list of employees</a></span></li><li><span class="section"><a href="#er-availability-proc">15.3.8. Setting employee availability</a></span></li><li><span class="section"><a href="#er-shiftroster-proc">15.3.9. Viewing and editing shifts in the shift roster</a></span></li><li><span class="section"><a href="#er-solve-proc">15.3.10. Creating and viewing the employee shift roster</a></span></li><li><span class="section"><a href="#er-individualroster-proc">15.3.11. Viewing employee shifts</a></span></li><li><span class="section"><a href="#er-publish-proc">15.3.12. Publishing the shift roster</a></span></li><li><span class="section"><a href="#er-rotation-edit-proc">15.3.13. Viewing and editing the rotation pattern</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#assembly-business-optimizer-vrp">16. Deploying and using the Red Hat build of OptaPlanner vehicle route planning starter application</a></span><ul><li><span class="section"><a href="#vrp-con_business-optimizer-vrp">16.1. What is OptaWeb Vehicle Routing?</a></span></li><li><span class="section"><a href="#download-ref-imp-proc_business-optimizer-vrp">16.2. Download and build the OptaWeb Vehicle Routing deployment files</a></span></li><li><span class="section"><a href="#runlocally-con_business-optimizer-vrp">16.3. Run OptaWeb Vehicle Routing locally using the runLocally.sh script</a></span><ul><li><span class="section"><a href="#run-locally-qs-proc_business-optimizer-vrp">16.3.1. Run the OptaWeb Vehicle Routing runLocally.sh script in quick start mode</a></span></li><li><span class="section"><a href="#run-locally-interactive-proc_business-optimizer-vrp">16.3.2. Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode</a></span></li><li><span class="section"><a href="#run-locally-noninteractive-proc_business-optimizer-vrp">16.3.3. Run the OptaWeb Vehicle Routing runLocally.sh script in non-interactive mode</a></span></li><li><span class="section"><a href="#adjust-data-dir-proc_business-optimizer-vrp">16.3.4. Update the data directory</a></span></li></ul></li><li><span class="section"><a href="#run-vrp-manually-proc_business-optimizer-vrp">16.4. Configure and run OptaWeb Vehicle Routing manually</a></span></li><li><span class="section"><a href="#vrp-run-openshift-proc_business-optimizer-vrp">16.5. Run OptaWeb Vehicle Routing on Red Hat OpenShift Container Platform</a></span><ul><li><span class="section"><a href="#vrp-update-deployed-changes-proc_business-optimizer-vrp">16.5.1. Updating the deployed OptaWeb Vehicle Routing application with local changes</a></span></li></ul></li><li><span class="section"><a href="#use-vrp-con_business-optimizer-vrp">16.6. Using OptaWeb Vehicle Routing</a></span><ul><li><span class="section"><a href="#vrp-create-route-proc_business-optimizer-vrp">16.6.1. Creating a route</a></span></li><li><span class="section"><a href="#vrp-other-actions-proc_business-optimizer-vrp">16.6.2. Viewing and setting other details</a></span></li><li><span class="section"><a href="#vrp-custom-data-sets-proc_business-optimizer-vrp">16.6.3. Creating custom data sets with OptaWeb Vehicle Routing</a></span></li><li><span class="section"><a href="#vrp-troubleshooting-proc_business-optimizer-vrp">16.6.4. Troubleshooting OptaWeb Vehicle Routing</a></span></li></ul></li><li><span class="section"><a href="#optaweb_vehicle_routing_development_guide">16.7. OptaWeb Vehicle Routing development guide</a></span><ul><li><span class="section"><a href="#vrp-structure-con_business-optimizer-vrp">16.7.1. OptaWeb Vehicle Routing project structure</a></span></li><li><span class="section"><a href="#vrp-backend-con_business-optimizer-vrp">16.7.2. The OptaWeb Vehicle Routing back-end module</a></span></li><li><span class="section"><a href="#vrp-frontend-proc_business-optimizer-vrp">16.7.3. Working with the OptaWeb Vehicle Routing front-end module</a></span></li></ul></li><li><span class="section"><a href="#backend-architecture-con_business-optimizer-vrp">16.8. OptaWeb Vehicle Routing back-end architecture</a></span><ul><li><span class="section"><a href="#code_organization">16.8.1. Code organization</a></span></li><li><span class="section"><a href="#dependency_rules">16.8.2. Dependency rules</a></span></li><li><span class="section"><a href="#the_domain_package">16.8.3. The domain package</a></span></li><li><span class="section"><a href="#the_service_package">16.8.4. The service package</a></span></li><li><span class="section"><a href="#the_plugin_package">16.8.5. The plugin package</a></span></li></ul></li><li><span class="section"><a href="#backend-properties-ref_business-optimizer-vrp">16.9. OptaWeb Vehicle Routing back-end configuration properties</a></span></li></ul></li></ul></li><li><span class="appendix"><a href="#versioning-information">A. Versioning information</a></span></li><li><span class="appendix"><a href="#author-group">B. Contact information</a></span></li></ul></div><section class="preface" id="idm45892285712896"><div class="titlepage"><div><div><h1 class="title">Preface</h1></div></div></div><p>
			As a developer of business decisions , you can use Red Hat build of OptaPlanner to develop solvers that determine the optimal solution to planning problems. OptaPlanner is a built-in component of Red Hat Decision Manager. You can use solvers as part of your services in Red Hat Decision Manager to optimize limited resources with specific constraints.
		</p></section><section class="preface" id="snip-conscious-language_developing-solvers"><div class="titlepage"><div><div><h1 class="title">Making open source more inclusive</h1></div></div></div><p>
			Red Hat is committed to replacing problematic language in our code, documentation, and web properties. We are beginning with these four terms: master, slave, blacklist, and whitelist. Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases. For more details, see <a class="link" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language"><span class="emphasis"><em>our CTO Chris Wright’s message</em></span></a>.
		</p></section><div class="part" id="assembly-optimizer-migration-8_developing-solvers"><div class="titlepage"><div><div><h1 class="title">Part I. Upgrading your Red Hat build of OptaPlanner projects to OptaPlanner 8</h1></div></div></div><div class="partintro" id="idm45892301360336"><div/><p>
				If you have OptaPlanner projects that you created with the OptaPlanner 7 or earlier pubic API and you want to upgrade your project code to OptaPlanner 8, review the information in this guide. This guide also includes changes to implementation classes which are outside of the pubic API.
			</p><p>
				The OptaPlanner public API is a subset of the OptaPlanner source code that enables you to interact with OptaPlanner through Java code. So that you can upgrade to higher OptaPlanner versions within the same major release, OptaPlanner follows <a class="link" href="https://semver.org/">semantic versioning</a>. This means that you can upgrade from OptaPlanner 7.44 to OptaPlanner 7.48 for example without breaking your code that uses the OptaPlanner public API. The OptaPlanner public API classes are compatible within the versions of a major OptaPlanner release. However, when Red Hat releases a new major release, disrupting changes are sometimes introduced to the public API.
			</p><p>
				OptaPlanner 8 is a new major release and some of the changes to the public API are not are not compatible with earlier versions of OptaPlanner. OptaPlanner 8 will be the foundation for the 8.x series for the next few years. The changes to the public API that are not compatible with earlier versions that were required for this release were made for the long term benefit of this project.
			</p><div class="table" id="idm45892301357824"><p class="title"><strong>Table 1. Red Hat Decision Manager and Red Hat build of OptaPlanner versions</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 67%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892295724960" scope="col">Decision Manager</th><th align="left" valign="top" id="idm45892295723872" scope="col">OptaPlanner</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892295724960">
							<p>
								7.7
							</p>
							</td><td align="left" valign="top" headers="idm45892295723872">
							<p>
								7.33
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45892295724960">
							<p>
								7.8
							</p>
							</td><td align="left" valign="top" headers="idm45892295723872">
							<p>
								7.39
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45892295724960">
							<p>
								7.9
							</p>
							</td><td align="left" valign="top" headers="idm45892295723872">
							<p>
								7.44
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45892295724960">
							<p>
								7.10
							</p>
							</td><td align="left" valign="top" headers="idm45892295723872">
							<p>
								7.48
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45892295724960">
							<p>
								7.11
							</p>
							</td><td align="left" valign="top" headers="idm45892295723872">
							<p>
								8.5
							</p>
							</td></tr></tbody></table></div></div><p>
				Every upgrade note has a label that indicates how likely it is that your code will be affected by that change. The following table describes each label:
			</p><div class="table" id="idm45892296323712"><p class="title"><strong>Table 2. Upgrade impact labels</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 67%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892296318880" scope="col">Label</th><th align="left" valign="top" id="idm45892296317792" scope="col">Impact</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892296318880">
							<p>
								Major
							</p>
							</td><td align="left" valign="top" headers="idm45892296317792">
							<p>
								Likely to affect your code.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45892296318880">
							<p>
								Minor
							</p>
							</td><td align="left" valign="top" headers="idm45892296317792">
							<p>
								Unlikely to affect your code, especially if you followed the examples, unless you have customized the code extensively.
							</p>
							</td></tr></tbody></table></div></div><p>
				Any changes that are not compatible with earlier versions of OptaPlanner are annotated with the <span class="strong strong"><strong>Public API</strong></span> tag.
			</p><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#optaplanner-7-ref_developing-solvers">1. Changes that are not compatible with OptaPlanner 7.x or earlier</a></span></li><li><span class="chapter"><a href="#optaplanner-8-ref_developing-solvers">2. Changes between OptaPlanner 8.2.0 and OptaPlanner 8.3.0</a></span></li></ul></div></div><section class="chapter" id="optaplanner-7-ref_developing-solvers"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Changes that are not compatible with OptaPlanner 7.x or earlier</h2></div></div></div><p>
				The changes listed in this section are not compatible with OptaPlanner 7.x or earlier versions of OptaPlanner.
			</p><h3 id="java_11_or_higher_required">Java 11 or higher required</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				If you are using JRE or JDK 8, upgrade to JDK 11 or higher.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On Linux, get OpenJDK from your Linux software repository. On Fedora and Red Hat Enterprise Linux, enter the following command:
					</p><pre class="programlisting language-bash">sudo dnf install java-11-openjdk-devel</pre></li><li class="listitem">
						On Windows and macOS, download OpenJDK from the <a class="link" href="https://adoptopenjdk.net">AdoptOpenJDK</a> website.
					</li></ul></div><h3 id="literal_solverfactory_literal_and_literal_plannerbenchmarkfactory_literal_no_longer_support_kie_containers"><code class="literal">SolverFactory</code> and <code class="literal">PlannerBenchmarkFactory</code> no longer support KIE containers</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				Because OptaPlanner now aligns with Kogito, the KIE container concept no longer applies. Therefore, <code class="literal">SolverFactory</code> no longer allows you to create <code class="literal">Solver</code> instances from KIE containers. This also applies to <code class="literal">PlannerBenchmarkFactory</code> and benchmarks.
			</p><h3 id="osgi_metadata_removed">OSGi metadata removed</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				Because of the limited usage of OSGi and the maintenance burden it brings, the OptaPlanner JAR files in the OptaPlanner 8.x series no longer include OSGi metadata in the <code class="literal">META-INF/MANIFEST.MF</code> file.
			</p><h3 id="refrain_from_using_java_serialization">Refrain from using Java serialization</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				In OptaPlanner 8, most uses of the <code class="literal">Serializable</code> marker interface were removed from the public API. Consider serializing with JSON or another format.
			</p><h3 id="literal_solverfactory_getscoredirectorfactory_literal_replaced_with_literal_scoremanager_literal"><code class="literal">SolverFactory.getScoreDirectorFactory()</code> replaced with <code class="literal">ScoreManager</code></h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				In version 7 of OptaPlanner, using <code class="literal">ScoreDirectorFactory</code> was necessary in order to explain the score. In version 8 of OptaPlanner, new functionality was added to the <code class="literal">ScoreManager</code> and as a result there is no longer any reason to create new instances of <code class="literal">ScoreDirector</code>.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">ScoreDirectorFactory&lt;CloudBalance&gt; scoreDirectorFactory = solverFactory.getScoreDirectorFactory();
try (ScoreDirector&lt;CloudBalance&gt; scoreDirector = scoreDirectorFactory.buildScoreDirector()) {
    scoreDirector.setWorkingSolution(solution);
    Score score = scoreDirector.calculateScore();
}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">ScoreManager&lt;CloudBalance&gt; scoreManager = ScoreManager.create(solverFactory);
Score score = scoreManager.updateScore(solution);</pre><p>
				Methods that allowed you to retrieve an instance of <code class="literal">ScoreDirector</code> and <code class="literal">ScoreDirectorFactory</code> have been removed from the public API without replacement. A reduced version of the <code class="literal">ScoreDirector</code> interface was promoted to the public API to promote the <code class="literal">ProblemFactChange</code> interface to the public API.
			</p><h3 id="literal_solverfactory_literal_literal_getsolverconfig_literal_removed"><code class="literal">SolverFactory</code>: <code class="literal">getSolverConfig()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">SolverFactory.getSolverConfig()</code> method has been deprecated and replaced with the <code class="literal">SolverFactory.create(SolverConfig)</code> method. A <code class="literal">SolverConfig</code> instance is now instantiated before a <code class="literal">SolverFactory</code> instance is instantiated, which is more natural. The previous order has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">SolverFactory&lt;MySolution&gt; solverFactory = SolverFactory.createFromXmlResource(".../mySolverConfig.xml");
SolverConfig solverConfig = solverFactory.getSolverConfig();
...
Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">SolverConfig solverConfig = SolverConfig.createFromXmlResource(".../mySolverConfig.xml");
...
SolverFactory&lt;MySolution&gt; solverFactory = SolverFactory.create(solverConfig);
Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();</pre><p>
				If you were also passing a <code class="literal">ClassLoader</code>, pass it to both <code class="literal">SolverConfig.createFromXmlResource()</code> and <code class="literal">SolverFactory.create()</code>.
			</p><h3 id="literal_solverconfig_literal_literal_buildsolver_literal_removed"><code class="literal">SolverConfig</code>: <code class="literal">buildSolver()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">SolverConfig.buildSolver()</code> method is an inner method that does not belong in the public API. Use the <code class="literal">SolverFactory.buildSolver()</code> method instead.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">SolverConfig solverConfig = SolverConfig.createFromXmlResource(".../mySolverConfig.xml");
...
Solver&lt;MySolution&gt; solver = solverConfig.buildSolver();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">SolverConfig solverConfig = SolverConfig.createFromXmlResource(".../mySolverConfig.xml");
...
SolverFactory&lt;MySolution&gt; solverFactory = SolverFactory.create(solverConfig);
Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();</pre><h3 id="literal_plannerbenchmarkconfig_literal_literal_buildplannerbenchmark_literal_removed"><code class="literal">PlannerBenchmarkConfig</code>: <code class="literal">buildPlannerBenchmark()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">PlannerBenchmarkConfig.buildPlannerBenchmark()</code> method is an inner method that does not belong in the public API. Use the <code class="literal">PlannerBenchmarkFactory.buildPlannerBenchmark()</code> method instead.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">PlannerBenchmarkConfig benchmarkConfig = PlannerBenchmarkConfig.createFromXmlResource(
        ".../cloudBalancingBenchmarkConfig.xml");
...
PlannerBenchmark benchmark = benchmarkFactory.buildPlannerBenchmark();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">PlannerBenchmarkConfig benchmarkConfig = PlannerBenchmarkConfig.createFromXmlResource(
        ".../cloudBalancingBenchmarkConfig.xml");
...
PlannerBenchmarkFactory benchmarkFactory = PlannerBenchmarkFactory.create(benchmarkConfig);
PlannerBenchmark benchmark = benchmarkFactory.buildPlannerBenchmark();</pre><h3 id="literal_solverfactory_literal_literal_clonesolverfactory_literal_removed"><code class="literal">SolverFactory</code>: <code class="literal">cloneSolverFactory()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">SolverFactory.cloneSolverFactory()</code> method has been deprecated and replaced with the new <code class="literal">SolverConfig(SolverConfig)</code> copy constructors and the <code class="literal">SolverFactory.cloneSolverFactory()</code> method has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">private SolverFactory&lt;MySolution&gt; base;

public void userRequest(..., long userInput) {
    SolverFactory&lt;MySolution&gt; solverFactory = base.cloneSolverFactory();
    solverFactory.getSolverConfig()
            .getTerminationConfig()
            .setMinutesSpentLimit(userInput);
    Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();
    ...
}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">private SolverConfig base;

public void userRequest(..., long userInput) {
    SolverConfig solverConfig = new SolverConfig(base); // Copy it
    solverConfig.getTerminationConfig()
            .setMinutesSpentLimit(userInput);
    SolverFactory&lt;MySolution&gt; solverFactory = SolverFactory.create(solverConfig);
    Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();
    ...
}</pre><h3 id="literal_solverfactory_literal_literal_createempty_literal_removed"><code class="literal">SolverFactory</code>: <code class="literal">createEmpty()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">SolverFactory.createEmpty()</code> method has been deprecated and replaced with the <code class="literal">new SolverConfig()</code> method. The <code class="literal">SolverFactory.createEmpty()</code> method has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">SolverFactory&lt;MySolution&gt; solverFactory = SolverFactory.createEmpty();
SolverConfig solverConfig = solverFactory.getSolverConfig()
...
Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">SolverConfig solverConfig = new SolverConfig();
...
SolverFactory&lt;MySolution&gt; solverFactory = SolverFactory.create(solverConfig);
Solver&lt;MySolution&gt; solver = solverFactory.buildSolver();</pre><h3 id="xml_solver_root_element_now_belongs_to_the_http_www_optaplanner_org_xsd_solver_namespace">XML &lt;solver/&gt; root element now belongs to the http://www.optaplanner.org/xsd/solver namespace</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				OptaPlanner now provides an XML schema definition for the solver configuration. Although OptaPlanner retains compatibility with previous versions of the existing XML configuration, migrating to the XSD is strongly recommended because OptaPlanner might support only valid configuration XML in the future.
			</p><p>
				An example from the <code class="literal">*SolverConfig.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;solver&gt;
  ...
&lt;/solver&gt;</pre><p>
				An example from the <code class="literal">*SolverConfig.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd"&gt;
  ...
&lt;/solver&gt;</pre><p>
				Using the XSD might require reordering some of the XML elements of the configuration. Use code completion in the IDE to migrate to a valid XML.
			</p><h3 id="property_literal_subpillarenabled_literal_in_move_selector_configuration_has_been_removed">Property <code class="literal">subPillarEnabled</code> in move selector configuration has been removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">subPillarEnabled</code> property in <code class="literal">PillarSwapMoveSelector</code> and <code class="literal">PillarChangeMoveSelector</code> has been deprecated and replaced with a new property, <code class="literal">subPillarType</code>. The <code class="literal">subPillarEnabled</code> property has been removed.
			</p><p>
				An example from the <code class="literal">*SolverConfig.xml</code> and <code class="literal">*BenchmarkConfig.xml</code> files in OptaPlanner 7:
			</p><pre class="programlisting language-xml">      &lt;pillar...MoveSelector&gt;
        ...
        &lt;pillarSelector&gt;
          &lt;subPillarEnabled&gt;false&lt;/subPillarEnabled&gt;
          ...
        &lt;/pillarSelector&gt;
        ...
      &lt;/pillar...MoveSelector&gt;</pre><p>
				An example from the <code class="literal">*SolverConfig.xml</code> and <code class="literal">*BenchmarkConfig.xml</code> files in OptaPlanner 8:
			</p><pre class="programlisting language-xml">      &lt;pillar...MoveSelector&gt;
        &lt;subPillarType&gt;NONE&lt;/subPillarType&gt;
        &lt;pillarSelector&gt;
          ...
        &lt;/pillarSelector&gt;
        ...
      &lt;/pillar...MoveSelector&gt;</pre><h3 id="literal_solver_literal_literal_getscoredirectorfactory_literal_removed"><code class="literal">Solver</code>: <code class="literal">getScoreDirectorFactory()</code> removed</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">getScoreDirectorFactory()</code> method has been deprecated and has now been removed from both <code class="literal">Solver</code> and <code class="literal">SolverFactory</code> classes.
			</p><p>
				You no longer need to create a <code class="literal">Solver</code> instance just to calculate or explain a score in the UI. Use the <code class="literal">ScoreManager</code> API instead.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">SolverFactory&lt;VehicleRoutingSolution&gt; solverFactory = SolverFactory.createFromXmlResource(...);
Solver&lt;VehicleRoutingSolution&gt; solver = solverFactory.buildSolver();
uiScoreDirectorFactory = solver.getScoreDirectorFactory();
...</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">SolverFactory&lt;VehicleRoutingSolution&gt; solverFactory = SolverFactory.createFromXmlResource(...);
ScoreManager&lt;VehicleRoutingSolution&gt; scoreManager = ScoreManager.create(solverFactory);
...</pre><p>
				<code class="literal">ScoreDirectorFactory</code> should not be used anymore because it has always been outside the public API and all of its functionality is exposed in various parts of the public API.
			</p><h3 id="literal_solver_explainbestscore_literal_has_been_removed"><code class="literal">Solver.explainBestScore()</code> has been removed</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">explainBestScore()</code> method on the <code class="literal">Solver</code> interface was deprecated in 7.x and has now been removed. You can obtain the same information through the new <code class="literal">ScoreManager</code> API.
			</p><p>
				Red Hat recommends that you do not parse the results of this method call in any way.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">solver = ...;
scoreExplanation = solver.explainBestScore();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">MySolution solution = ...;
ScoreManager&lt;MySolution&gt; scoreManager = ...;
scoreExplanation = scoreManager.explainScore(solution);</pre><h3 id="the_solver_interface_methods_literal_getbestsolution_literal_literal_getbestscore_literal_and_literal_gettimemillisspent_literal_have_been_removed">The Solver interface methods <code class="literal">getBestSolution()</code>, <code class="literal">getBestScore()</code>, and <code class="literal">getTimeMillisSpent()</code> have been removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				Several methods on the <code class="literal">Solver</code> interface were deprecated in 7.x and have been removed. You can obtain the same information by registering an <code class="literal">EventListener</code> through the <code class="literal">Solver.addEventListener(…​)</code>.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">solver = ...;
solution = solver.getBestSolution();
score = solver.getBestScore();
timeMillisSpent = solver.getTimeMillisSpent();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">solver = ...;
solver.addEventListener(event -&gt; {
    solution = event.getNewBestSolution();
    score = event.getNewBestScore();
    timeMillisSpent = event.getTimeMillisSpent();
});</pre><h3 id="annotation_scanning_has_been_removed">Annotation scanning has been removed</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">&lt;scanAnnotatedClasses/&gt;</code> directive in the solver configuration was deprecated in 7.x and is now removed.
			</p><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">&lt;solver&gt;
    ...
    &lt;scanAnnotatedClasses/&gt;
    ...
&lt;/solver&gt;</pre><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;solver&gt;
    ...
    &lt;solutionClass&gt;...&lt;/solutionClass&gt;
    &lt;entityClass&gt;...&lt;/entityClass&gt;
    ...
&lt;/solver&gt;</pre><h3 id="new_package_for_literal_planningfactproperty_literal_and_literal_planningfactcollectionproperty_literal">New package for <code class="literal">@PlanningFactProperty</code> and <code class="literal">@PlanningFactCollectionProperty</code></h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">@PlanningFactProperty</code> and <code class="literal">@PlanningFactCollectionProperty</code> annotations now share the same package with other similar annotations, such as <code class="literal">@PlanningSolution</code>. The old annotations were deprecated in 7.x and removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">import org.optaplanner.core.api.domain.solution.drools.ProblemFactCollectionProperty;
import org.optaplanner.core.api.domain.solution.drools.ProblemFactProperty;</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">import org.optaplanner.core.api.domain.solution.ProblemFactCollectionProperty;
import org.optaplanner.core.api.domain.solution.ProblemFactProperty;</pre><h3 id="literal_filterclasslist_literal_replaced_with_a_single_filter_class"><code class="literal">filterClassList</code> replaced with a single filter class</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The configuration of <code class="literal">EntitySelector</code>, <code class="literal">ValueSelector</code>, and <code class="literal">MoveSelector</code> now has a single filter class in both the configuration API and the solver configuration XML.
			</p><p>
				In practice, you do not need multiple selection filter classes often, and you can replace them with a single selection filter class that implements the logic of all of them. Passing a single selection class now requires less boilerplate code.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">ValueSelectorConfig valueSelectorConfig = new ValueSelectorConfig();
valueSelectorConfig.setFilterClassList(Collections.singletonList(MySelectionFilterClass.class));</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">ValueSelectorConfig valueSelectorConfig = new ValueSelectorConfig();
valueSelectorConfig.setFilterClass(MySelectionFilterClass.class);</pre><div class="formalpara"><p class="title"><strong>Replacing multiple selection filter classes with a single selection filter class</strong></p><p>
					An example from the <code class="literal">*.xml</code> file in OptaPlanner 7:
				</p></div><pre class="programlisting language-xml">&lt;swapMoveSelector&gt;
  &lt;entitySelector&gt;
    &lt;filterClass&gt;com.example.FilterA&lt;/filterClass&gt;
    &lt;filterClass&gt;com.example.FilterB&lt;/filterClass&gt;
  &lt;/entitySelector&gt;
&lt;/swapMoveSelector&gt;</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">package com.example;
...
public class FilterA implements SelectionFilter&lt;MySolution, MyPlanningEntity&gt; {

    @Override
    public boolean accept(ScoreDirector&lt;MySolution&gt; scoreDirector, MyPlanningEntity selection) {
        return selection.getValue() &lt; 500;
    }
}</pre><pre class="programlisting language-java">package com.example;
...
public class FilterB implements SelectionFilter&lt;MySolution, MyPlanningEntity&gt; {

    @Override
    public boolean accept(ScoreDirector&lt;MySolution&gt; scoreDirector, MyPlanningEntity selection) {
        return selection.getOrder() == Order.ASC;
    }
}</pre><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;swapMoveSelector&gt;
  &lt;entitySelector&gt;
    &lt;filterClass&gt;com.example.SingleEntityFilter&lt;/filterClass&gt;
  &lt;/entitySelector&gt;
&lt;/swapMoveSelector&gt;</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">package com.example;
...
public class SingleEntityFilter implements SelectionFilter&lt;MySolution, MyPlanningEntity&gt; {

    @Override
    public boolean accept(ScoreDirector&lt;MySolution&gt; scoreDirector, MyPlanningEntity selection) {
        return selection.getValue() &lt; 500 &amp;&amp; selection.getOrder() == Order.ASC;
    }
}</pre><h3 id="literal_acceptorconfig_literal_renamed_to_literal_localsearchacceptorconfig_literal"><code class="literal">AcceptorConfig</code> renamed to <code class="literal">LocalSearchAcceptorConfig</code></h3><p>
				<span class="strong strong"><strong>Minor</strong></span>
			</p><p>
				This only impacts the configuration API. The solver configuration XML file remains intact.
			</p><p>
				Naming consistency with other local-search-specific configuration classes has been implemented.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">LocalSearchPhaseConfig localSearchPhaseConfig = new LocalSearchPhaseConfig()
        .withAcceptorConfig(new AcceptorConfig().withEntityTabuSize(5));</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">LocalSearchPhaseConfig localSearchPhaseConfig = new LocalSearchPhaseConfig()
        .withAcceptorConfig(new LocalSearchAcceptorConfig().withEntityTabuSize(5));</pre><h3 id="custom_properties_xml_configuration_format_changes">Custom properties XML configuration format changes</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				This issue only impacts the solver configuration XML, specifically <code class="literal">&lt;scoreDirectorFactory/&gt;</code>, <code class="literal">&lt;moveIteratorFactory/&gt;</code>, <code class="literal">&lt;moveListFactory/&gt;</code>, <code class="literal">&lt;partitionedSearch/&gt;</code> and <code class="literal">&lt;customPhase/&gt;</code>.
			</p><p>
				This change was made to enforce the structure of the configuration XML in build time.
			</p><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">&lt;partitionedSearch&gt;
  &lt;solutionPartitionerClass&gt;com.example.MySolutionPartitioner&lt;/solutionPartitionerClass&gt;
  &lt;solutionPartitionerCustomProperties&gt;
    &lt;partCount&gt;4&lt;/partCount&gt; &lt;!-- a custom property --&gt;
    &lt;minimumProcessListSize&gt;300&lt;/minimumProcessListSize&gt; &lt;!-- a custom property --&gt;
  &lt;/solutionPartitionerCustomProperties&gt;
&lt;/partitionedSearch&gt;</pre><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;partitionedSearch&gt;
  &lt;solutionPartitionerClass&gt;com.example.MySolutionPartitioner&lt;/solutionPartitionerClass&gt;
  &lt;solutionPartitionerCustomProperties&gt;
    &lt;property name="partCount" value="4"/&gt; &lt;!-- a custom property --&gt;
    &lt;property name="minimumProcessListSize" value="300"/&gt; &lt;!-- a custom property --&gt;
  &lt;/solutionPartitionerCustomProperties&gt;
&lt;/partitionedSearch&gt;</pre><h3 id="literal_variablenameinclude_literal_elements_are_now_wrapped_by_the_literal_variablenameincludes_literal_element"><code class="literal">&lt;variableNameInclude/&gt;</code> elements are now wrapped by the <code class="literal">&lt;variableNameIncludes/&gt;</code> element</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				This update only impacts the solver configuration XML, specifically the <code class="literal">&lt;swapMoveSelector/&gt;</code> and <code class="literal">&lt;pillarSwapMoveSelector/&gt;</code> elements.
			</p><p>
				This change was made to enforce the structure of the configuration XML in build time.
			</p><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">&lt;swapMoveSelector&gt;
  &lt;variableNameInclude&gt;variableA&lt;/variableNameInclude&gt;
  &lt;variableNameInclude&gt;variableB&lt;/variableNameInclude&gt;
&lt;/swapMoveSelector&gt;</pre><p>
				An example from the <code class="literal">*.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;swapMoveSelector&gt;
  &lt;variableNameIncludes&gt;
    &lt;variableNameInclude&gt;variableA&lt;/variableNameInclude&gt;
    &lt;variableNameInclude&gt;variableB&lt;/variableNameInclude&gt;
  &lt;/variableNameIncludes&gt;
&lt;/swapMoveSelector&gt;</pre><h3 id="literal_solution_literal_interface_removed"><code class="literal">Solution</code> interface removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">Solution</code> interface was deprecated and removed. The <code class="literal">AbstractSolution</code> interface, which is only used by Business Central, has also been removed.
			</p><p>
				Remove the <code class="literal">Solution</code> interface, annotate the <code class="literal">getScore()</code> method with <code class="literal">@PlanningScore</code>, and replace the <code class="literal">getProblemFacts()</code> method with a <code class="literal">@ProblemFactCollectionProperty</code> annotation directly on every problem fact getter (or field).
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">@PlanningSolution
public class CloudBalance implements Solution&lt;HardSoftScore&gt; {

    private List&lt;CloudComputer&gt; computerList;
    ...

    private HardSoftScore score;

    @ValueRangeProvider(id = "computerRange")
    public List&lt;CloudComputer&gt; getComputerList() {...}

    public HardSoftScore getScore() {...}
    public void setScore(HardSoftScore score) {...}

    public Collection&lt;? extends Object&gt; getProblemFacts() {
        List&lt;Object&gt; facts = new ArrayList&lt;Object&gt;();
        facts.addAll(computerList);
        ...
        return facts;
    }

}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">@PlanningSolution
public class CloudBalance {

    private List&lt;CloudComputer&gt; computerList;
    ...

    private HardSoftScore score;

    @ValueRangeProvider(id = "computerRange")
    @ProblemFactCollectionProperty
    public List&lt;CloudComputer&gt; getComputerList() {...}

    @PlanningScore
    public HardSoftScore getScore() {...}
    public void setScore(HardSoftScore score) {...}

}</pre><p>
				For a single problem fact that is not wrapped in a <code class="literal">Collection</code>, use the <code class="literal">@ProblemFactProperty</code> annotation, as shown in the following example, with field annotations this time:
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">@PlanningSolution
public class CloudBalance implements Solution&lt;HardSoftScore&gt; {

    private CloudParametrization parametrization;
    private List&lt;CloudBuilding&gt; buildingList;
    @ValueRangeProvider(id = "computerRange")
    private List&lt;CloudComputer&gt; computerList;
    ...

    public Collection&lt;? extends Object&gt; getProblemFacts() {
        List&lt;Object&gt; facts = new ArrayList&lt;Object&gt;();
        facts.add(parametrization); // not a Collection
        facts.addAll(buildingList);
        facts.addAll(computerList);
        ...
        return facts;
    }

}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">@PlanningSolution
public class CloudBalance {

    @ProblemFactProperty
    private CloudParametrization parametrization;
    @ProblemFactCollectionProperty
    private List&lt;CloudBuilding&gt; buildingList;
    @ValueRangeProvider(id = "computerRange")
    @ProblemFactCollectionProperty
    private List&lt;CloudComputer&gt; computerList;
    ...

}</pre><p>
				Do not add the <code class="literal">@ProblemFactCollectionProperty</code> annotation on getters (or fields) that have a <code class="literal">@PlanningEntityCollectionProperty</code> annotation.
			</p><h3 id="literal_bestsolutionchangedevent_literal_literal_isnewbestsolutioninitialized_literal_removed"><code class="literal">BestSolutionChangedEvent</code>: <code class="literal">isNewBestSolutionInitialized()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">BestSolutionChangedEvent.isNewBestSolutionInitialized()</code> method has been deprecated and replaced with the <code class="literal">BestSolutionChangedEvent.getNewBestSolution().getScore().isSolutionInitialized()</code> method. The <code class="literal">BestSolutionChangedEvent.isNewBestSolutionInitialized()</code> method has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">    public void bestSolutionChanged(BestSolutionChangedEvent&lt;CloudBalance&gt; event) {
        if (event.isEveryProblemFactChangeProcessed()
                &amp;&amp; event.isNewBestSolutionInitialized()) {
            ...
        }
    }</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">    public void bestSolutionChanged(BestSolutionChangedEvent&lt;CloudBalance&gt; event) {
        if (event.isEveryProblemFactChangeProcessed()
                &amp;&amp; event.getNewBestSolution().getScore().isSolutionInitialized()) {
            ...
        }
    }</pre><p>
				If you check <code class="literal">isFeasible()</code>, it checks if the solution is initialized.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">    public void bestSolutionChanged(BestSolutionChangedEvent&lt;CloudBalance&gt; event) {
        if (event.isEveryProblemFactChangeProcessed()
                // isFeasible() checks isSolutionInitialized() too
                &amp;&amp; event.getNewBestSolution().getScore().isFeasible()) {
            ...
        }
    }</pre><h3 id="literal_valueselector_literal_literal_variablename_literal_is_now_an_attribute"><code class="literal">&lt;valueSelector&gt;</code>: <code class="literal">variableName</code> is now an attribute</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				When power-tweaking move selectors, such as <code class="literal">&lt;changeMoveSelector&gt;</code>, in a use case with multiple planning variables, the <code class="literal">&lt;variableName&gt;</code> XML element has been replaced with a <code class="literal">variableName="…​"</code> XML attribute. This change reduces the solver configuration verbosity. After being deprecated for the entire 7.x series, the old way has now been removed.
			</p><p>
				An example from the <code class="literal">*SolverConfig.xml</code> and <code class="literal">*BenchmarkConfig.xml</code> files in OptaPlanner 7:
			</p><pre class="programlisting language-xml">  &lt;valueSelector&gt;
    &lt;variableName&gt;room&lt;/variableName&gt;
  &lt;/valueSelector&gt;</pre><p>
				An example from the <code class="literal">*SolverConfig.xml</code> and <code class="literal">*BenchmarkConfig.xml</code> files in OptaPlanner 8:
			</p><pre class="programlisting language-xml">  &lt;valueSelector variableName="room"/&gt;</pre><h3 id="partitioned_search_literal_threadfactoryclass_literal_removed">Partitioned Search: <code class="literal">threadFactoryClass</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				Because <code class="literal">&lt;solver&gt;</code> has supported a <code class="literal">&lt;threadFactoryClass&gt;</code> element for some time, the <code class="literal">&lt;threadFactoryClass&gt;</code> element under <code class="literal">&lt;partitionedSearch&gt;</code> has been removed.
			</p><p>
				An example from the <code class="literal">*SolverConfig.xml</code> and <code class="literal">*BenchmarkConfig.xml</code> files in OptaPlanner 7:
			</p><pre class="programlisting language-xml">  &lt;solver&gt;
    ...
    &lt;partitionedSearch&gt;
      &lt;threadFactoryClass&gt;...MyAppServerThreadFactory&lt;/threadFactoryClass&gt;
      ...
    &lt;/partitionedSearch&gt;
  &lt;/solver&gt;</pre><p>
				An example from the <code class="literal">*SolverConfig.xml</code> and <code class="literal">*BenchmarkConfig.xml</code> files in OptaPlanner 8:
			</p><pre class="programlisting language-xml">  &lt;solver&gt;
    &lt;threadFactoryClass&gt;...MyAppServerThreadFactory&lt;/threadFactoryClass&gt;
    ...
    &lt;partitionedSearch&gt;
      ...
    &lt;/partitionedSearch&gt;
  &lt;/solver&gt;</pre><h3 id="literal_simpledoublescore_literal_and_literal_hardsoftdoublescore_literal_removed"><code class="literal">SimpleDoubleScore</code> and <code class="literal">HardSoftDoubleScore</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The use of double-based score types is not recommended because they can cause score corruption. They have been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">@PlanningSolution
public class MyPlanningSolution {

    private SimpleDoubleScore score;

    ...

}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">@PlanningSolution
public class MyPlanningSolution {

    private SimpleLongScore score;

    ...

}</pre><h3 id="literal_score_toinitializedscore_literal_removed"><code class="literal">Score.toInitializedScore()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">Score.toInitializedScore()</code> method was deprecated and replaced with the <code class="literal">Score.withInitScore(int)</code> method in 7.x and is now removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">score = score.toInitializedScore();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">score = score.withInitScore(0);</pre><h3 id="various_justification_literal_comparators_literal_removed">Various justification <code class="literal">Comparators</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The following <code class="literal">Comparator</code> implementations were deprecated in 7.x and removed:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">org.optaplanner.core.api.score.comparator.NaturalScoreComparator</code>
					</li><li class="listitem">
						<code class="literal">org.optaplanner.core.api.score.constraint.ConstraintMatchScoreComparator</code>
					</li><li class="listitem">
						<code class="literal">org.optaplanner.core.api.score.constraint.ConstraintMatchTotalScoreComparator</code>
					</li><li class="listitem">
						<code class="literal">org.optaplanner.core.api.score.constraint.IndictmentScoreComparator</code>
					</li></ul></div><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">NaturalScoreComparator comparator = new NaturalScoreComparator();
ConstraintMatchScoreComparator comparator2 = new ConstraintMatchScoreComparator();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">Comparator&lt;Score&gt; comparator = Comparable::compareTo;
Comparator&lt;ConstraintMatch&gt; comparator2 = Comparator.comparing(ConstraintMatch::getScore);</pre><h3 id="literal_feasibilityscore_literal_removed"><code class="literal">FeasibilityScore</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">FeasibilityScore</code> interface was deprecated in 7.x and its only method <code class="literal">isFeasible()</code> moved to the <code class="literal">Score</code> supertype. The interface has now been removed.
			</p><p>
				You should refer to <code class="literal">Score</code>s by their ultimate type, for example <code class="literal">HardSoftScore</code> instead of to <code class="literal">Score</code>.
			</p><h3 id="literal_planningentity_movableentityselectionfilter_literal_removed"><code class="literal">@PlanningEntity.movableEntitySelectionFilter</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">movableEntitySelectionFilter</code> field on the <code class="literal">@PlanningEntity</code> annotation was deprecated in 7.x and a new field <code class="literal">pinningFilter</code> has been introduced with a name that shows the relation to the <code class="literal">@PlanningPin</code> annotation. This filter implements a new <code class="literal">PinningFilter</code> interface, returning true if the entity is pinned, and false if movable. The logic of this new filter is therefore inverted as compared to the old filter.
			</p><p>
				You should update your <code class="literal">@PlanningEntity</code> annotations by supplying the new filter instead of the old filter. The old filter has now been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">@PlanningEntity(movableEntitySelectionFilter = MyMovableEntitySelectionFilter.class)</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">@PlanningEntity(pinningFilter = MyPinningFilter.class)</pre><h3 id="literal_planningvariable_reinitializevariableentityfilter_literal_removed"><code class="literal">@PlanningVariable.reinitializeVariableEntityFilter</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">reinitializeVariableEntityFilter</code> field on the <code class="literal">@PlanningVariable</code> annotation was deprecated in 7.x and now removed.
			</p><h3 id="literal_scoreholder_literal_classes_turned_into_interfaces"><code class="literal">*ScoreHolder</code> classes turned into interfaces</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				In OptaPlanner 7, <code class="literal">ScoreHolder</code> classes, used exclusively for Drools score calculation, exposed a number of public methods which, if used, allowed the user to unintentionally corrupt or otherwise negatively affect their scores.
			</p><p>
				In OptaPlanner 8, these methods have been removed and the classes have been turned into interfaces. Most users do not use the removed and potentially harmful methods.
			</p><p>
				However, if you do use these methods, you will find suitable replacements in the public API in areas of score explanation and constraint configuration.
			</p><h3 id="literal_valuerangefactory_literal_class_now_final"><code class="literal">ValueRangeFactory</code> class now final</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>
			</p><p>
				<code class="literal">ValueRangeFactory</code> class is a factory class that has only static methods. There is no need for you to extend this class, and it has therefore been made <code class="literal">final</code>.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">class MyValueRangeFactory extends ValueRangeFactory {
    ...
}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">class MyValueRangeFactory {
    ...
}</pre><h3 id="literal_constraintmatchtotal_literal_and_literal_indictment_literal_are_now_interfaces"><code class="literal">ConstraintMatchTotal</code> and <code class="literal">Indictment</code> are now interfaces</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				<code class="literal">ConstraintMatchTotal</code> and <code class="literal">Indictment</code> classes have been converted into interfaces. As a result, their implementations were moved out of the public API, together with methods that allowed them to mutate their state. These methods were never intended for the public API, and therefore there is no replacement for them.
			</p><p>
				You might still need the instances themselves if you choose to implement <code class="literal">ConstraintMatchAwareIncrementalScoreCalculator</code>:
			</p><pre class="programlisting language-java">ConstraintMatchTotal maximumCapacityMatchTotal = new ConstraintMatchTotal(...);</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">ConstraintMatchTotal maximumCapacityMatchTotal = new DefaultConstraintMatchTotal(...);</pre><h3 id="literal_scoremanager_literal_generic_type_literal_score_literal_added"><code class="literal">ScoreManager</code>: generic type <code class="literal">Score</code> added</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">ScoreManager</code> and <code class="literal">ScoreExplanation</code> APIs now have the generic type <code class="literal">Score</code> to avoid downcasts in your code, for example from <code class="literal">Score</code> to <code class="literal">HardSoftScore</code>.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">    @Inject // or @Autowired
    ScoreManager&lt;TimeTable&gt; scoreManager;</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">    @Inject // or @Autowired
    ScoreManager&lt;TimeTable, HardSoftScore&gt; scoreManager;</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">    ScoreExplanation&lt;TimeTable&gt; explanation = scoreManager.explainScore(timeTable);
    HardSoftScore score = (HardSoftScore) explanation.getScore();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">    ScoreExplanation&lt;TimeTable, HardSoftScore&gt; explanation = scoreManager.explainScore(timeTable);
    HardSoftScore score = explanation.getScore();</pre><h3 id="literal_constraintmatchtotal_literal_literal_constraintmatch_literal_and_literal_indictment_literal_generic_type_literal_score_literal_added"><code class="literal">ConstraintMatchTotal</code>, <code class="literal">ConstraintMatch</code>, and <code class="literal">Indictment</code>: generic type <code class="literal">Score</code> added</h3><p>
				<span class="strong strong"><strong>Major</strong></span>
			</p><p>
				Similar to <code class="literal">ScoreManager</code> and <code class="literal">ScoreExplanation</code>, the <code class="literal">ConstraintMatchTotal</code>, <code class="literal">ConstraintMatch</code>, and <code class="literal">Indictment</code> APIs now have a generic type <code class="literal">Score</code> to avoid downcasts in your code, for example from <code class="literal">Score</code> to <code class="literal">HardSoftScore</code>.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">    ScoreExplanation&lt;TimeTable&gt; explanation = scoreManager.explainScore(timeTable);
    Map&lt;String, ConstraintMatchTotal&gt; constraintMatchTotalMap = scoreExplanation.getConstraintMatchTotalMap();
    ConstraintMatchTotal constraintMatchTotal = constraintMatchTotalMap.get(contraintId);
    HardSoftScore totalScore = (HardSoftScore) constraintMatchTotal.getScore();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">    ScoreExplanation&lt;TimeTable, HardSoftScore&gt; explanation = scoreManager.explainScore(timeTable);
    Map&lt;String, ConstraintMatchTotal&lt;HardSoftScore&gt;&gt; constraintMatchTotalMap = scoreExplanation.getConstraintMatchTotalMap();
    ConstraintMatchTotal&lt;HardSoftScore&gt; constraintMatchTotal = constraintMatchTotalMap.get(contraintId);
    HardSoftScore totalScore = constraintMatchTotal.getScore();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">    ScoreExplanation&lt;TimeTable&gt; explanation = scoreManager.explainScore(timeTable);
    Map&lt;Object, Indictment&gt; indictmentMap = scoreExplanation.getIndictmentMap();
    Indictment indictment = indictmentMap.get(lesson);
    HardSoftScore totalScore = (HardSoftScore) indictment.getScore();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">    ScoreExplanation&lt;TimeTable, HardSoftScore&gt; explanation = scoreManager.explainScore(timeTable);
    Map&lt;Object, Indictment&lt;HardSoftScore&gt;&gt; indictmentMap = scoreExplanation.getIndictmentMap();
    Indictment&lt;HardSoftScore&gt; indictment = indictmentMap.get(lesson);
    HardSoftScore totalScore = indictment.getScore();</pre><h3 id="literal_constraintmatchawareincrementalscorecalculator_literal_generic_type_literal_score_literal_added"><code class="literal">ConstraintMatchAwareIncrementalScoreCalculator</code>: generic type <code class="literal">Score</code> added</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>
			</p><p>
				The interface <code class="literal">ConstraintMatchAwareIncrementalScoreCalculator</code> now also has a generic type parameter for <code class="literal">Score</code> to avoid raw type usages of <code class="literal">ConstraintMatchTotal</code> and <code class="literal">Indictment</code>.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">public class MachineReassignmentIncrementalScoreCalculator
        implements ConstraintMatchAwareIncrementalScoreCalculator&lt;MachineReassignment&gt; {

    @Override
    public Collection&lt;ConstraintMatchTotal&gt; getConstraintMatchTotals() {
        ...
    }


    @Override
    public Map&lt;Object, Indictment&gt; getIndictmentMap() {
        ...
    }

}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">public class MachineReassignmentIncrementalScoreCalculator
        implements ConstraintMatchAwareIncrementalScoreCalculator&lt;MachineReassignment, HardSoftLongScore&gt; {

    @Override
    public Collection&lt;ConstraintMatchTotal&lt;HardSoftLongScore&gt;&gt; getConstraintMatchTotals() {
        ...
    }


    @Override
    public Map&lt;Object, Indictment&lt;HardSoftLongScore&gt;&gt; getIndictmentMap() {
        ...
    }

}</pre><h3 id="literal_abstractcustomphasecommand_literal_was_removed"><code class="literal">AbstractCustomPhaseCommand</code> was removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The abstract class <code class="literal">AbstractCustomPhaseCommand</code> was removed. Any class that extends it should directly implement the <code class="literal">CustomPhaseCommand</code> interface.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">public class DinnerPartySolutionInitializer extends AbstractCustomPhaseCommand&lt;DinnerParty&gt; {

    @Override
    public void changeWorkingSolution(ScoreDirector&lt;DinnerParty&gt; scoreDirector) {
        ...
    }

}</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">public class DinnerPartySolutionInitializer implements CustomPhaseCommand&lt;DinnerParty&gt; {

    @Override
    public void changeWorkingSolution(ScoreDirector&lt;DinnerParty&gt; scoreDirector) {
        ...
    }

}</pre><h3 id="score_calculators_moved_to_the_public_api">Score calculators moved to the public API</h3><p>
				<span class="strong strong"><strong>Major</strong></span>
			</p><p>
				The interfaces <code class="literal">EasyScoreCalculator</code>, <code class="literal">IncrementalScoreCalculator</code>, and <code class="literal">ConstraintMatchAwareIncrementalScoreCalculator</code> have moved to a new package in the public API. Their deprecated counterparts have been removed. The deprecated class <code class="literal">org.optaplanner.core.impl.score.director.incremental.AbstractIncrementalScoreCalculator</code> has also been removed. Replace the use of the removed interfaces and classes with their counterparts in the public API.
			</p><p>
				An example from the <code class="literal"><span class="strong strong"><strong>EasyScoreCalculator.java</strong></span></code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">  ...
  import org.optaplanner.core.impl.score.director.easy.EasyScoreCalculator;
  ...

  public class CloudBalancingEasyScoreCalculator implements EasyScoreCalculator&lt;CloudBalance&gt; {
    ...
  }</pre><p>
				An example from the <code class="literal"><span class="strong strong"><strong>EasyScoreCalculator.java</strong></span></code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">  ...
  import org.optaplanner.core.api.score.calculator.EasyScoreCalculator;
  ...

  public class CloudBalancingEasyScoreCalculator implements EasyScoreCalculator&lt;CloudBalance, HardSoftScore&gt; {
    ...
  }</pre><p>
				An example from the <code class="literal"><span class="strong strong"><strong>IncrementalScoreCalculator.java</strong></span></code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">  ...
  import org.optaplanner.core.impl.score.director.incremental.AbstractIncrementalScoreCalculator;
  ...

  public class CloudBalancingIncrementalScoreCalculator extends AbstractIncrementalScoreCalculator&lt;CloudBalance&gt; {
    ...
  }</pre><p>
				An example from the <code class="literal"><span class="strong strong"><strong>IncrementalScoreCalculator.java</strong></span></code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">  ...
  import org.optaplanner.core.api.score.calculator.IncrementalScoreCalculator;
  ...

  public class CloudBalancingIncrementalScoreCalculator implements IncrementalScoreCalculator&lt;CloudBalance, HardSoftScore&gt; {
    ...
  }</pre><p>
				An example from the <code class="literal"><span class="strong strong"><strong>ConstraintMatchAwareIncrementalScoreCalculator.java</strong></span></code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">  ...
  import org.optaplanner.core.impl.score.director.incremental.AbstractIncrementalScoreCalculator;
  import org.optaplanner.core.impl.score.director.incremental.ConstraintMatchAwareIncrementalScoreCalculator;
  ...

  public class CheapTimeConstraintMatchAwareIncrementalScoreCalculator
        extends AbstractIncrementalScoreCalculator&lt;CheapTimeSolution&gt;
        implements ConstraintMatchAwareIncrementalScoreCalculator&lt;CheapTimeSolution&gt; {
    ...
  }</pre><p>
				An example from the <code class="literal"><span class="strong strong"><strong>ConstraintMatchAwareIncrementalScoreCalculator.java</strong></span></code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">  ...
  import org.optaplanner.core.api.score.calculator.ConstraintMatchAwareIncrementalScoreCalculator;
  ...

  public class CheapTimeConstraintMatchAwareIncrementalScoreCalculator
        implements ConstraintMatchAwareIncrementalScoreCalculator&lt;CheapTimeSolution, HardMediumSoftLongScore&gt; {
    ...
  }</pre><h3 id="literal_plannerbenchmarkfactory_literal_literal_createfromsolverfactory_literal_removed"><code class="literal">PlannerBenchmarkFactory</code>: <code class="literal">createFromSolverFactory()</code> removed</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">PlannerBenchmarkFactory.createFromSolverFactory()</code> method has been deprecated and replaced with the <code class="literal">PlannerBenchmarkFactory.createFromSolverConfigXmlResource(String)</code> method. The <code class="literal">PlannerBenchmarkFactory.createFromSolverFactory()</code> method has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">SolverFactory&lt;CloudBalance&gt; solverFactory = SolverFactory.createFromXmlResource(
        ".../cloudBalancingSolverConfig.xml");
PlannerBenchmarkFactory benchmarkFactory = PlannerBenchmarkFactory.createFromSolverFactory(solverFactory);</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">PlannerBenchmarkFactory benchmarkFactory = PlannerBenchmarkFactory.createFromSolverConfigXmlResource(
        ".../cloudBalancingSolverConfig.xml");</pre><p>
				If you programmatically adjust the solver configuration, you can use <code class="literal">PlannerBenchmarkConfig.createFromSolverConfig(SolverConfig)</code> and then <code class="literal">PlannerBenchmarkFactory.create(PlannerBenchmarkConfig)</code> instead.
			</p><h3 id="literal_plannerbenchmarkfactory_literal_literal_getplannerbenchmarkconfig_literal_removed"><code class="literal">PlannerBenchmarkFactory</code>: <code class="literal">getPlannerBenchmarkConfig()</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">PlannerBenchmarkFactory.getPlannerBenchmarkConfig()</code> method has been deprecated and replaced with the <code class="literal">PlannerBenchmarkFactory.create(PlannerBenchmarkConfig)</code> method. A <code class="literal">PlannerBenchmarkConfig</code> instance is now instantiated before a <code class="literal">PlannerBenchmarkFactory</code> instance is instantiated. This order is more logical. <code class="literal">PlannerBenchmarkFactory.getPlannerBenchmarkConfig()</code> has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">PlannerBenchmarkFactory benchmarkFactory = PlannerBenchmarkFactory.createFromXmlResource(
        ".../cloudBalancingBenchmarkConfig.xml");
PlannerBenchmarkConfig benchmarkConfig = benchmarkFactory.getPlannerBenchmarkConfig();
...
PlannerBenchmark benchmark = benchmarkFactory.buildPlannerBenchmark();</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">PlannerBenchmarkConfig benchmarkConfig = PlannerBenchmarkConfig.createFromXmlResource(
        ".../cloudBalancingBenchmarkConfig.xml");
...
PlannerBenchmarkFactory benchmarkFactory = PlannerBenchmarkFactory.create(benchmarkConfig);
PlannerBenchmark benchmark = benchmarkFactory.buildPlannerBenchmark();</pre><h3 id="xml_plannerbenchmark_root_element_now_belongs_to_the_http_www_optaplanner_org_xsd_benchmark_namespace">XML &lt;plannerBenchmark/&gt; root element now belongs to the http://www.optaplanner.org/xsd/benchmark namespace</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				OptaPlanner now provides an XML Schema Definition (XSD) for the benchmark configuration. Although OptaPlanner keeps compatibility with earlier versions of the existing XML configuration, migrating to the XSD is strongly recommended because OptaPlanner might support only valid configuration XML in the future.
			</p><p>
				An example from the <code class="literal">*BenchmarkConfig.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;plannerBenchmark&gt;
  ...
&lt;/plannerBenchmark&gt;</pre><p>
				An example from the <code class="literal">*BenchmarkConfig.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;plannerBenchmark xmlns="https://www.optaplanner.org/xsd/benchmark" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="https://www.optaplanner.org/xsd/benchmark https://www.optaplanner.org/xsd/benchmark/benchmark.xsd"&gt;
  ...
&lt;/plannerBenchmark&gt;</pre><p>
				Using the XSD might require reordering some of the XML elements of the configuration. Use code completion in the IDE to migrate to a valid XML.
			</p><h3 id="literal_problembenchmarksconfig_literal_literal_xstreamannotatedclass_literal_removed"><code class="literal">ProblemBenchmarksConfig</code>: <code class="literal">xStreamAnnotatedClass</code> removed</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The <code class="literal">&lt;xStreamAnnotatedClass/&gt;</code> has been removed from the <code class="literal">&lt;problemBenchmarks/&gt;</code> configuration together with the corresponding <code class="literal">getXStreamAnnotatedClassList()</code> and <code class="literal">setXStreamAnnotatedClassList()</code> methods in the <code class="literal">ProblemBenchmarksConfig</code> class.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">ProblemBenchmarksConfig problemBenchmarksConfig = new ProblemBenchmarksConfig();
problemBenchmarksConfig.setXStreamAnnotatedClassList(MySolution.class);</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">package com.example;
...
public class MySolutionFileIO extends XStreamSolutionFileIO&lt;MySolution&gt; {
    public MySolutionFileIO() {
        super(MySolution.class);
    }
}

...

ProblemBenchmarksConfig problemBenchmarksConfig = new ProblemBenchmarksConfig();
problemBenchmarksConfig.setSolutionFileIOClass(MySolutionFileIO.class);</pre><p>
				An example from the <code class="literal">*BenchmarkConfig.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">&lt;plannerBenchmark&gt;
...
  &lt;solverBenchmark&gt;
    &lt;problemBenchmarks&gt;
      &lt;xStreamAnnotatedClass&gt;com.example.MySolution&lt;/xStreamAnnotatedClass&gt;
      ...
    &lt;/problemBenchmarks&gt;
    ...
  &lt;/solverBenchmark&gt;
...
&lt;/plannerBenchmark&gt;</pre><p>
				An example from the <code class="literal">*BenchmarkConfig.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">&lt;plannerBenchmark&gt;
...
  &lt;solverBenchmark&gt;
    &lt;problemBenchmarks&gt;
      &lt;!-- See the "After in *.java" section to create the MySolutionFileIO. --&gt;
      &lt;solutionFileIOClass&gt;com.example.MySolutionFileIO&lt;/solutionFileIOClass&gt;
      ...
    &lt;/problemBenchmarks&gt;
    ...
  &lt;/solverBenchmark&gt;
...
&lt;/plannerBenchmark&gt;</pre><h3 id="literal_benchmarkaggregatorframe_createanddisplay_plannerbenchmarkfactory_literal_removed"><code class="literal">BenchmarkAggregatorFrame.createAndDisplay(PlannerBenchmarkFactory)</code> removed</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>
			</p><p>
				The <code class="literal">BenchmarkAggregatorFrame.createAndDisplay(PlannerBenchmarkFactory)</code> method has been deprecated and replaced with the <code class="literal">BenchmarkAggregatorFrame.createAndDisplayFromXmlResource(String)</code> method. The <code class="literal">BenchmarkAggregatorFrame.createAndDisplay(PlannerBenchmarkFactory)</code> method has been removed.
			</p><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">PlannerBenchmarkFactory benchmarkFactory = PlannerBenchmarkFactory.createFromXmlResource(
        ".../cloudBalancingBenchmarkConfig.xml");
BenchmarkAggregatorFrame.createAndDisplay(benchmarkFactory);</pre><p>
				An example from a <code class="literal">*.java</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">BenchmarkAggregatorFrame.createAndDisplayFromXmlResource(
        ".../cloudBalancingBenchmarkConfig.xml");</pre><p>
				If you programmatically adjust the benchmark configuration, you can use <code class="literal">BenchmarkAggregatorFrame.createAndDisplay(PlannerBenchmarkConfig)</code> instead.
			</p><h3 id="removed_javascript_expression_support_in_configuration">Removed JavaScript expression support in configuration</h3><p>
				<span class="strong strong"><strong>Minor</strong></span>
			</p><p>
				Various elements of both the solver configuration and benchmark configuration no longer support nested JavaScript expressions. You must replace these with either auto-configuration or with integer constants.
			</p><p>
				An example from the <code class="literal">solverConfig.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">    &lt;solver&gt;
        ...
        &lt;moveThreadCount&gt;availableProcessorCount - 1&lt;/moveThreadCount&gt;
        ...
    &lt;/solver&gt;</pre><p>
				An example from the `solverConfig.xml`file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">    &lt;solver&gt;
        ...
        &lt;moveThreadCount&gt;1&lt;/moveThreadCount&gt; &lt;!-- Alternatively, use "AUTO" or omit entirely. --&gt;
        ...
    &lt;/solver&gt;</pre><p>
				An example from the <code class="literal">benchmarkConfig.xml</code> file in OptaPlanner 7:
			</p><pre class="programlisting language-xml">    &lt;plannerBenchmark&gt;
      ...
      &lt;parallelBenchmarkCount&gt;availableProcessorCount - 1&lt;/parallelBenchmarkCount&gt;
      ...
    &lt;/plannerBenchmark&gt;</pre><p>
				An example from the <code class="literal">benchmarkConfig.xml</code> file in OptaPlanner 8:
			</p><pre class="programlisting language-xml">    &lt;plannerBenchmark&gt;
      ...
      &lt;parallelBenchmarkCount&gt;1&lt;/parallelBenchmarkCount&gt; &lt;!-- Alternatively, use "AUTO" or omit entirely. --&gt;
      ...
    &lt;/plannerBenchmark&gt;</pre><h3 id="removed_the_deprecated_variable_listeners">Removed the deprecated variable listeners</h3><p>
				<span class="strong strong"><strong>Major</strong></span>, <span class="strong strong"><strong>Public API</strong></span>
			</p><p>
				The deprecated interface <code class="literal">VariableListener</code> from the package <code class="literal">org.optaplanner.core.impl.domain.variable.listener</code> has been removed, along with the deprecated interface <code class="literal">StatefulVariableListener</code> and the deprecated class <code class="literal">VariableListenerAdapter</code> in that same package. Use a <code class="literal">VariableListener</code> interface from the <code class="literal">org.optaplanner.core.api.domain.variable</code> package instead.
			</p><p>
				An example of a <code class="literal"><span class="strong strong"><strong>VariableListener.java</strong></span></code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">  ...
  import org.optaplanner.core.impl.domain.variable.listener.VariableListenerAdapter;
  ...

  public class MyVariableListener extends VariableListenerAdapter&lt;Object&gt; {

    ...

    @Override
    void afterEntityRemoved(ScoreDirector scoreDirector, Object entity);
      ...
    }

    ...
  }</pre><p>
				An example from a <code class="literal"><span class="strong strong"><strong>VariableListener.java</strong></span></code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">  ...
  import org.optaplanner.core.api.domain.variable.VariableListener;
  ...

  public class MyVariableListener extends VariableListener&lt;MySolution, Object&gt; {

    ...

    @Override
    void afterEntityRemoved(ScoreDirector&lt;MySolution&gt; scoreDirector, Object entity);
      ...
    }

    ...
  }</pre><p>
				An example of a <code class="literal"><span class="strong strong"><strong>StatefulVariableListener.java</strong></span></code> file in OptaPlanner 7:
			</p><pre class="programlisting language-java">  ...
  import org.optaplanner.core.impl.domain.variable.listener.StatefulVariableListener;
  ...

  public class MyStatefulVariableListener implements StatefulVariableListener&lt;Object&gt; {

    ...

    @Override
    public void clearWorkingSolution(ScoreDirector scoreDirector) {
      ...
    }

    ...
  }</pre><p>
				An example from the <code class="literal"><span class="strong strong"><strong>StatefulVariableListener.java</strong></span></code> file in OptaPlanner 8:
			</p><pre class="programlisting language-java">  ...
  import org.optaplanner.core.api.domain.variable.VariableListener;
  ...

  public class MyStatefulVariableListener implements VariableListener&lt;MySolution, Object&gt; {

    ...

    @Override
    public void close() {
      ...
    }

    ...
  }</pre></section><section class="chapter" id="optaplanner-8-ref_developing-solvers"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Changes between OptaPlanner 8.2.0 and OptaPlanner 8.3.0</h2></div></div></div><p>
				The changes listed in this section were made between OptaPlanner 8.2.0 and OptaPlanner 8.3.0.
			</p><h4 id="literal_constraintmatch_compareto_literal_inconsistent_with_literal_equals_literal"><code class="literal">ConstraintMatch.compareTo()</code> inconsistent with <code class="literal">equals()</code></h4><p>
				<span class="strong strong"><strong>Minor</strong></span>
			</p><p>
				The <code class="literal">equals()</code> override in <code class="literal">ConstraintMatch</code> has been removed. As a result, two different <code class="literal">ConstraintMatch</code> instances are never considered equal. This contrasts with the <code class="literal">compareTo()</code> method, which continues to consider two instances equal if all their field values are equal.
			</p></section></div><div class="part" id="assembly-getting-started-business-optimizer"><div class="titlepage"><div><div><h1 class="title">Part II. Getting started with Red Hat build of OptaPlanner</h1></div></div></div><div class="partintro" id="idm45892297471488"><div/><p>
				As a business rules developer, you can use Red Hat build of OptaPlanner to find the optimal solution to planning problems based on a set of limited resources and under specific constraints.
			</p><p>
				Use this document to start developing solvers with OptaPlanner.
			</p><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#optimizer-about-optimizer-con_getting-started-optaplanner">3. Introduction to Red Hat build of OptaPlanner</a></span><ul><li><span class="section"><a href="#optimizer-planning-problem-con">3.1. Planning problems</a></span></li><li><span class="section"><a href="#optimizer-NP-complete-vs-NP-hard-con">3.2. NP-completeness in planning problems</a></span></li><li><span class="section"><a href="#optimizer-planning-problem-search-space-con">3.3. Solutions to planning problems</a></span></li><li><span class="section"><a href="#optimizer-hard-vs-soft-constraints-con">3.4. Constraints on planning problems</a></span></li><li><span class="section"><a href="#examples-con">3.5. Examples provided with Red Hat build of OptaPlanner</a></span></li><li><span class="section"><a href="#ex-nQueens-ref">3.6. N queens</a></span><ul><li><span class="section"><a href="#nQueensDomainModel">3.6.1. Domain model for N queens</a></span></li></ul></li><li><span class="section"><a href="#ex-cloudBalancing-ref">3.7. Cloud balancing</a></span></li><li><span class="section"><a href="#ex-tsp-ref">3.8. Traveling salesman (TSP - Traveling Salesman Problem)</a></span></li><li><span class="section"><a href="#ex-tennis-ref">3.9. Tennis club scheduling</a></span></li><li><span class="section"><a href="#ex-meetingScheduling-ref">3.10. Meeting scheduling</a></span></li><li><span class="section"><a href="#ex-curriculumCourse-ref">3.11. Course timetabling (ITC 2007 Track 3 - Curriculum Course Scheduling)</a></span></li><li><span class="section"><a href="#ex-machineReassignment-ref">3.12. Machine reassignment (Google ROADEF 2012)</a></span></li><li><span class="section"><a href="#ex-vehicleRouting-ref">3.13. Vehicle routing</a></span><ul><li><span class="section"><a href="#vehicleRoutingDomainModel">3.13.1. Domain model for Vehicle routing</a></span></li></ul></li><li><span class="section"><a href="#ex-projectJobScheduling-ref">3.14. Project job scheduling</a></span></li><li><span class="section"><a href="#ex-taskAssigning-ref">3.15. Task assigning</a></span></li><li><span class="section"><a href="#ex-examination-ref">3.16. Exam timetabling (ITC 2007 track 1 - Examination)</a></span><ul><li><span class="section"><a href="#domain_model_for_exam_timetabling">3.16.1. Domain model for exam timetabling</a></span></li></ul></li><li><span class="section"><a href="#ex-nurseRostering-ref">3.17. Nurse rostering (INRC 2010)</a></span></li><li><span class="section"><a href="#ex-travelingTournament-ref">3.18. Traveling tournament problem (TTP)</a></span></li><li><span class="section"><a href="#ex-cheapTimeScheduling-ref">3.19. Cheap time scheduling</a></span></li><li><span class="section"><a href="#ex-investment-ref">3.20. Investment asset class allocation (Portfolio Optimization)</a></span></li><li><span class="section"><a href="#ex-conferenceScheduling-ref">3.21. Conference scheduling</a></span></li><li><span class="section"><a href="#ex-rockTour-ref">3.22. Rock tour</a></span></li><li><span class="section"><a href="#ex-flightCrewScheduling-ref">3.23. Flight crew scheduling</a></span></li></ul></li><li><span class="chapter"><a href="#examples-download-proc">4. Downloading Red Hat build of OptaPlanner examples</a></span><ul><li><span class="section"><a href="#optimizer-running-the-examples-proc">4.1. Running OptaPlanner examples</a></span></li><li><span class="section"><a href="#optimizer-running-the-examples-in-an-IDE-proc">4.2. Running the Red Hat build of OptaPlanner examples in an IDE (IntelliJ, Eclipse, or Netbeans)</a></span></li></ul></li><li><span class="chapter"><a href="#workbench-er-tutorial-con">5. Getting started with OptaPlanner in Business Central: An employee rostering example</a></span><ul><li><span class="section"><a href="#wb-employee-rostering-example-deploying-in-central-proc">5.1. Deploying the employee rostering sample project in Business Central</a></span></li><li><span class="section"><a href="#wb-employee-rostering-example-recreate-con">5.2. Re-creating the employee rostering sample project</a></span><ul><li><span class="section"><a href="#wb-employee-rostering-example-setup-proc">5.2.1. Setting up the employee rostering project</a></span></li><li><span class="section"><a href="#wb-employee-rostering-facts-vs-entities-con">5.2.2. Problem facts and planning entities</a></span></li><li><span class="section"><a href="#wb-employee-rostering-data-model-proc">5.2.3. Creating the data model for the employee rostering project</a></span></li><li><span class="section"><a href="#wb-employee-rostering-constraints-con">5.2.4. Employee rostering constraints</a></span></li><li><span class="section"><a href="#wb-employee-rostering-guided-rule-editor-proc">5.2.5. Creating rules for employee rostering using guided rules</a></span></li><li><span class="section"><a href="#wb-employee-rostering-solver-configuration-proc">5.2.6. Creating a solver configuration for employee rostering</a></span></li><li><span class="section"><a href="#wb-employee-rostering-solver-termination-configuration-proc">5.2.7. Configuring Solver termination for the employee rostering project</a></span></li></ul></li><li><span class="section"><a href="#wb-employee-rostering-using-rest-proc">5.3. Accessing the solver using the REST API</a></span><ul><li><span class="section"><a href="#wb-employee-rostering-register-solver-proc">5.3.1. Registering the Solver using the REST API</a></span></li><li><span class="section"><a href="#wb-employee-rostering-call-solver-proc">5.3.2. Calling the Solver using the REST API</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#optaplanner-quarkus-con_getting-started-optaplanner">6. Getting Started with OptaPlanner and Quarkus</a></span><ul><li><span class="section"><a href="#con-apache-maven-plug-ins-and-quarkus_getting-started-optaplanner">6.1. Apache Maven and Red Hat build of Quarkus</a></span><ul><li><span class="section"><a href="#con-online-maven_getting-started-optaplanner">6.1.1. Configuring the Maven <code class="literal">settings.xml</code> file for the online repository</a></span></li><li><span class="section"><a href="#con-download-maven_getting-started-optaplanner">6.1.2. Downloading and configuring the Quarkus Maven repository</a></span></li></ul></li><li><span class="section"><a href="#proc-quarkus-creating-proj_getting-started-optaplanner">6.2. Creating an OptaPlanner Red Hat build of Quarkus Maven project using the Maven plug-in</a></span></li><li><span class="section"><a href="#code-quarkus-redhat-com-proc_getting-started-optaplanner">6.3. Creating a Red Hat build of Quarkus Maven project using code.quarkus.redhat.com</a></span></li><li><span class="section"><a href="#proc-quarkus-creating-proj-cli_getting-started-optaplanner">6.4. Creating a Red Hat build of Quarkus Maven project using the Quarkus CLI</a></span></li></ul></li></ul></div></div><section class="chapter" id="optimizer-about-optimizer-con_getting-started-optaplanner"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Introduction to Red Hat build of OptaPlanner</h2></div></div></div><p>
				OptaPlanner is a lightweight, embeddable planning engine that optimizes planning problems. It helps normal Java programmers solve planning problems efficiently, and it combines optimization heuristics and metaheuristics with very efficient score calculations.
			</p><p>
				For example, OptaPlanner helps solve various use cases:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="emphasis"><em>Employee/Patient Rosters</em></span>: It helps create timetables for nurses and keeps track of patient bed management.
					</li><li class="listitem">
						<span class="emphasis"><em>Educational Timetables</em></span>: It helps schedule lessons, courses, exams, and conference presentations.
					</li><li class="listitem">
						<span class="emphasis"><em>Shop Schedules</em></span>: It tracks car assembly lines, machine queue planning, and workforce task planning.
					</li><li class="listitem">
						<span class="emphasis"><em>Cutting Stock</em></span>: It minimizes waste by reducing the consumption of resources such as paper and steel.
					</li></ul></div><p>
				Every organization faces planning problems; that is, they provide products and services with a limited set of constrained resources (employees, assets, time, and money).
			</p><p>
				OptaPlanner is open source software under the Apache Software License 2.0. It is 100% pure Java and runs on most Java virtual machines (JVMs).
			</p><section class="section" id="optimizer-planning-problem-con"><div class="titlepage"><div><div><h2 class="title">3.1. Planning problems</h2></div></div></div><p>
					A <span class="emphasis"><em>planning problem</em></span> has an optimal goal, based on limited resources and under specific constraints. Optimal goals can be any number of things, such as:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Maximized profits - the optimal goal results in the highest possible profit.
						</li><li class="listitem">
							Minimized ecological footprint - the optimal goal has the least amount of environmental impact.
						</li><li class="listitem">
							Maximized satisfaction for employees or customers - the optimal goal prioritizes the needs of employees or customers.
						</li></ul></div><p>
					The ability to achieve these goals relies on the number of resources available. For example, the following resources might be limited:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Number of people
						</li><li class="listitem">
							Amount of time
						</li><li class="listitem">
							Budget
						</li><li class="listitem">
							Physical assets, for example, machinery, vehicles, computers, buildings
						</li></ul></div><p>
					You must also take into account the specific constraints related to these resources, such as the number of hours a person works, their ability to use certain machines, or compatibility between pieces of equipment.
				</p><p>
					Red Hat build of OptaPlanner helps Java programmers solve constraint satisfaction problems efficiently. It combines optimization heuristics and metaheuristics with efficient score calculation.
				</p></section><section class="section" id="optimizer-NP-complete-vs-NP-hard-con"><div class="titlepage"><div><div><h2 class="title">3.2. NP-completeness in planning problems</h2></div></div></div><p>
					The provided use cases are <span class="emphasis"><em>probably</em></span> <a class="link" href="http://en.wikipedia.org/wiki/NP-complete">NP-complete or NP-hard</a>, which means the following statements apply:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							It is easy to verify a specific solution to a problem in reasonable time.
						</li><li class="listitem">
							There is no simple way to find the optimal solution of a problem in reasonable time.
						</li></ul></div><p>
					The implication is that solving your problem is probably harder than you anticipated, because the two common techniques do not suffice:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A brute force algorithm (even a more advanced variant) takes too long.
						</li><li class="listitem">
							A quick algorithm, for example in the <a class="link" href="https://en.wikipedia.org/wiki/Bin_packing_problem">bin packing problem</a>, <span class="emphasis"><em>putting in the largest items first</em></span> returns a solution that is far from optimal.
						</li></ul></div><p>
					By using advanced optimization algorithms, OptaPlanner finds a good solution in reasonable time for such planning problems.
				</p></section><section class="section" id="optimizer-planning-problem-search-space-con"><div class="titlepage"><div><div><h2 class="title">3.3. Solutions to planning problems</h2></div></div></div><p>
					A planning problem has a number of solutions.
				</p><p>
					Several categories of solutions are:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Possible solution</span></dt><dd>
								A possible solution is any solution, whether or not it breaks any number of constraints. Planning problems often have an incredibly large number of possible solutions. Many of those solutions are not useful.
							</dd><dt><span class="term">Feasible solution</span></dt><dd>
								A feasible solution is a solution that does not break any (negative) hard constraints. The number of feasible solutions are relative to the number of possible solutions. Sometimes there are no feasible solutions. Every feasible solution is a possible solution.
							</dd><dt><span class="term">Optimal solution</span></dt><dd>
								Optimal solutions are the solutions with the highest scores. Planning problems usually have a few optimal solutions. They always have at least one optimal solution, even in the case that there are no feasible solutions and the optimal solution is not feasible.
							</dd><dt><span class="term">Best solution found</span></dt><dd>
								The best solution is the solution with the highest score found by an implementation in a specified amount of time. The best solution found is likely to be feasible and, given enough time, it’s an optimal solution.
							</dd></dl></div><p>
					Counterintuitively, the number of possible solutions is huge (if calculated correctly), even with a small data set.
				</p><p>
					In the examples provided in the <code class="literal">planner-engine</code> distribution folder, most instances have a large number of possible solutions. As there is no guaranteed way to find the optimal solution, any implementation is forced to evaluate at least a subset of all those possible solutions.
				</p><p>
					OptaPlanner supports several optimization algorithms to efficiently wade through that incredibly large number of possible solutions.
				</p><p>
					Depending on the use case, some optimization algorithms perform better than others, but it is impossible to know in advance. Using OptaPlanner, you can switch the optimization algorithm by changing the solver configuration in a few lines of XML or code.
				</p></section><section class="section" id="optimizer-hard-vs-soft-constraints-con"><div class="titlepage"><div><div><h2 class="title">3.4. Constraints on planning problems</h2></div></div></div><p>
					Usually, a planning problem has minimum two levels of constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							A <span class="emphasis"><em>(negative) hard constraint</em></span> must not be broken.
						</p><p class="simpara">
							For example, one teacher can not teach two different lessons at the same time.
						</p></li><li class="listitem"><p class="simpara">
							A <span class="emphasis"><em>(negative) soft constraint</em></span> should not be broken if it can be avoided.
						</p><p class="simpara">
							For example, Teacher A does not like to teach on Friday afternoons.
						</p></li></ul></div><p>
					Some problems also have positive constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							A <span class="emphasis"><em>positive soft constraint (or reward)</em></span> should be fulfilled if possible.
						</p><p class="simpara">
							For example, Teacher B likes to teach on Monday mornings.
						</p></li></ul></div><p>
					Some basic problems only have hard constraints. Some problems have three or more levels of constraints, for example, hard, medium, and soft constraints.
				</p><p>
					These constraints define the <span class="emphasis"><em>score calculation</em></span> (otherwise known as the <span class="emphasis"><em>fitness function</em></span>) of a planning problem. Each solution of a planning problem is graded with a score. With OptaPlanner, score constraints are written in an object oriented language such as Java, or in Drools rules.
				</p><p>
					This type of code is flexible and scalable.
				</p></section><section class="section" id="examples-con"><div class="titlepage"><div><div><h2 class="title">3.5. Examples provided with Red Hat build of OptaPlanner</h2></div></div></div><p>
					Several Red Hat build of OptaPlanner examples are shipped with Red Hat Decision Manager. You can review the code for examples and modify it as necessary to suit your needs.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat does not provide support for the example code included in the Red Hat Decision Manager distribution.
					</p></div></div><p>
					Some of the OptaPlanner examples solve problems that are presented in academic contests. The <code class="literal">Contest</code> column in the following table lists the contests. It also identifies an example as being either <span class="emphasis"><em>realistic</em></span> or <span class="emphasis"><em>unrealistic</em></span> for the purpose of a contest. A <span class="emphasis"><em>realistic contest</em></span> is an official, independent contest that meets the following standards:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Clearly defined real-world use cases
						</li><li class="listitem">
							Real-world constraints
						</li><li class="listitem">
							Multiple real-world datasets
						</li><li class="listitem">
							Reproducible results within a specific time limit on specific hardware
						</li><li class="listitem">
							Serious participation from the academic and/or enterprise Operations Research community.
						</li></ul></div><p>
					Realistic contests provide an objective comparison of OptaPlanner with competitive software and academic research.
				</p><div class="table" id="idm45892295893104"><p class="title"><strong>Table 3.1. Examples overview</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 13%; " class="col_1"/><col style="width: 25%; " class="col_2"/><col style="width: 25%; " class="col_3"/><col style="width: 13%; " class="col_4"/><col style="width: 25%; " class="col_5"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892295417776" scope="col">Example</th><th align="left" valign="top" id="idm45892295416688" scope="col">Domain</th><th align="left" valign="top" id="idm45892295415600" scope="col">Size</th><th align="left" valign="top" id="idm45892293014768" scope="col">Contest</th><th align="left" valign="top" id="idm45892293013680" scope="col">Directory name</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-nQueens-ref" title="3.6. N queens">N queens</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">256</code>
								</p>
								<p>
									Value ⇐ <code class="literal">256</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^616</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Pointless (cheatable)
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">nqueens</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-cloudBalancing-ref" title="3.7. Cloud balancing">Cloud balancing</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">2400</code>
								</p>
								<p>
									Value ⇐ <code class="literal">800</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^6967</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No (Defined by us)
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">cloudbalancing</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-tsp-ref" title="3.8. Traveling salesman (TSP - Traveling Salesman Problem)">Traveling salesman</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 chained variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">980</code>
								</p>
								<p>
									Value ⇐ <code class="literal">980</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^2504</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Unrealistic <a class="link" href="http://www.math.uwaterloo.ca/tsp/">TSP web</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">tsp</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-tennis-ref" title="3.9. Tennis club scheduling">Tennis club scheduling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">72</code>
								</p>
								<p>
									Value ⇐ <code class="literal">7</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^60</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No (Defined by us)
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">tennis</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-meetingScheduling-ref" title="3.10. Meeting scheduling">Meeting scheduling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(2 variables)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">10</code>
								</p>
								<p>
									Value ⇐ <code class="literal">320</code> and ⇐ <code class="literal">5</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^320</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No (Defined by us)
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">meetingscheduling</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-curriculumCourse-ref" title="3.11. Course timetabling (ITC 2007 Track 3 - Curriculum Course Scheduling)">Course timetabling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(2 variables)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">434</code>
								</p>
								<p>
									Value ⇐ <code class="literal">25</code> and ⇐ <code class="literal">20</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^1171</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Realistic <a class="link" href="http://www.cs.qub.ac.uk/itc2007/curriculmcourse/course_curriculm_index.htm">ITC 2007 track 3</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">curriculumCourse</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-machineReassignment-ref" title="3.12. Machine reassignment (Google ROADEF 2012)">Machine reassignment</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">50000</code>
								</p>
								<p>
									Value ⇐ <code class="literal">5000</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^184948</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Nearly realistic <a class="link" href="http://challenge.roadef.org/2012/en/">ROADEF 2012</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">machineReassignment</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-vehicleRouting-ref" title="3.13. Vehicle routing">Vehicle routing</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 chained variable)
								</p>
								<p>
									1 shadow entity class
								</p>
								<p>
									(1 automatic shadow variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">2740</code>
								</p>
								<p>
									Value ⇐ <code class="literal">2795</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^8380</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Unrealistic VRP web
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">vehiclerouting</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-vehicleRouting-ref" title="3.13. Vehicle routing">Vehicle routing</a> with time windows
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									All of Vehicle routing
								</p>
								<p>
									(1 shadow variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">2740</code>
								</p>
								<p>
									Value ⇐ <code class="literal">2795</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^8380</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Unrealistic VRP web
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">vehiclerouting</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-projectJobScheduling-ref" title="3.14. Project job scheduling">Project job scheduling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(2 variables)
								</p>
								<p>
									(1 shadow variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">640</code>
								</p>
								<p>
									Value ⇐ <code class="literal">?</code> and ⇐ <code class="literal">?</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">?</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Nearly realistic <a class="link" href="http://gent.cs.kuleuven.be/mista2013challenge/">MISTA 2013</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">projectjobscheduling</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-taskAssigning-ref" title="3.15. Task assigning">Task assigning</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 chained variable)
								</p>
								<p>
									(1 shadow variable)
								</p>
								<p>
									1 shadow entity class
								</p>
								<p>
									(1 automatic shadow variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">500</code>
								</p>
								<p>
									Value ⇐ <code class="literal">520</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^1168</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No Defined by us
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">taskassigning</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-examination-ref" title="3.16. Exam timetabling (ITC 2007 track 1 - Examination)">Exam timetabling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									2 entity classes (same hierarchy)
								</p>
								<p>
									(2 variables)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">1096</code>
								</p>
								<p>
									Value ⇐ <code class="literal">80</code> and ⇐ <code class="literal">49</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^3374</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Realistic <a class="link" href="http://www.cs.qub.ac.uk/itc2007/examtrack/exam_track_index.htm">ITC 2007 track 1</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">examination</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-nurseRostering-ref" title="3.17. Nurse rostering (INRC 2010)">Nurse rostering</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">752</code>
								</p>
								<p>
									Value ⇐ <code class="literal">50</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^1277</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Realistic <a class="link" href="http://www.kuleuven-kortrijk.be/nrpcompetition">INRC 2010</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">nurserostering</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-travelingTournament-ref" title="3.18. Traveling tournament problem (TTP)">Traveling tournament</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">1560</code>
								</p>
								<p>
									Value ⇐ <code class="literal">78</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^2301</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Unrealistic <a class="link" href="http://mat.tepper.cmu.edu/TOURN/">TTP</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">travelingtournament</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-cheapTimeScheduling-ref" title="3.19. Cheap time scheduling">Cheap time scheduling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(2 variables)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">500</code>
								</p>
								<p>
									Value ⇐ <code class="literal">100</code> and ⇐ <code class="literal">288</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^20078</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									Nearly realistic <a class="link" href="https://web.archive.org/web/20170223060433/http://iconchallenge.insight-centre.org/challenge-energy">ICON Energy</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">cheaptimescheduling</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-investment-ref" title="3.20. Investment asset class allocation (Portfolio Optimization)">Investment</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">11</code>
								</p>
								<p>
									Value = <code class="literal">1000</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^4</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No Defined by us
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">investment</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-conferenceScheduling-ref" title="3.21. Conference scheduling">Conference scheduling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(2 variables)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">216</code>
								</p>
								<p>
									Value ⇐ <code class="literal">18</code> and ⇐ <code class="literal">20</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^552</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No Defined by us
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">conferencescheduling</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-rockTour-ref" title="3.22. Rock tour">Rock tour</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 chained variable)
								</p>
								<p>
									(4 shadow variables)
								</p>
								<p>
									1 shadow entity class
								</p>
								<p>
									(1 automatic shadow variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">47</code>
								</p>
								<p>
									Value ⇐ <code class="literal">48</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^59</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No Defined by us
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">rocktour</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892295417776">
								<p>
									<a class="link" href="#ex-flightCrewScheduling-ref" title="3.23. Flight crew scheduling">Flight crew scheduling</a>
								</p>
								</td><td align="left" valign="top" headers="idm45892295416688">
								<p>
									1 entity class
								</p>
								<p>
									(1 variable)
								</p>
								<p>
									1 shadow entity class
								</p>
								<p>
									(1 automatic shadow variable)
								</p>
								</td><td align="left" valign="top" headers="idm45892295415600">
								<p>
									Entity ⇐ <code class="literal">4375</code>
								</p>
								<p>
									Value ⇐ <code class="literal">750</code>
								</p>
								<p>
									Search space ⇐ <code class="literal">10^12578</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892293014768">
								<p>
									No Defined by us
								</p>
								</td><td align="left" valign="top" headers="idm45892293013680">
								<p>
									<code class="literal">flightcrewscheduling</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="ex-nQueens-ref"><div class="titlepage"><div><div><h2 class="title">3.6. N queens</h2></div></div></div><p>
					Place <span class="emphasis"><em>n</em></span> number of queens on an <span class="emphasis"><em>n</em></span> sized chessboard so that no two queens can attack each other. The most common <span class="emphasis"><em>n</em></span> queens puzzle is the eight queens puzzle, with <span class="emphasis"><em>n = 8</em></span>:
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NQueens/nQueensScreenshot.png" alt="nQueensScreenshot"/></div></div><p>
					Constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Use a chessboard of <span class="emphasis"><em>n</em></span> columns and <span class="emphasis"><em>n</em></span> rows.
						</li><li class="listitem">
							Place <span class="emphasis"><em>n</em></span> queens on the chessboard.
						</li><li class="listitem">
							No two queens can attack each other. A queen can attack any other queen on the same horizontal, vertical, or diagonal line.
						</li></ul></div><p>
					This documentation heavily uses the four queens puzzle as the primary example.
				</p><p>
					A proposed solution could be:
				</p><div class="figure" id="idm45892299850128"><p class="title"><strong>Figure 3.1. A wrong solution for the four queens puzzle</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NQueens/partiallySolvedNQueens04Explained.png" alt="partiallySolvedNQueens04Explained"/></div></div></div><p>
					The above solution is wrong because queens <code class="literal">A1</code> and <code class="literal">B0</code> can attack each other (so can queens <code class="literal">B0</code> and <code class="literal">D0</code>). Removing queen <code class="literal">B0</code> would respect the "no two queens can attack each other" constraint, but would break the "place <span class="emphasis"><em>n</em></span> queens" constraint.
				</p><p>
					Below is a correct solution:
				</p><div class="figure" id="idm45892293579456"><p class="title"><strong>Figure 3.2. A correct solution for the Four queens puzzle</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NQueens/solvedNQueens04.png" alt="solvedNQueens04"/></div></div></div><p>
					All the constraints have been met, so the solution is correct.
				</p><p>
					Note that most <span class="emphasis"><em>n</em></span> queens puzzles have multiple correct solutions. We will focus on finding a single correct solution for a specific <span class="emphasis"><em>n</em></span>, not on finding the number of possible correct solutions for a specific <span class="emphasis"><em>n</em></span>.
				</p><div id="nQueensProblemSize" class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">4queens   has   4 queens with a search space of    256.
8queens   has   8 queens with a search space of   10^7.
16queens  has  16 queens with a search space of  10^19.
32queens  has  32 queens with a search space of  10^48.
64queens  has  64 queens with a search space of 10^115.
256queens has 256 queens with a search space of 10^616.</pre>
					</p></div><p>
					The implementation of the <span class="emphasis"><em>n</em></span> queens example has not been optimized because it functions as a beginner example. Nevertheless, it can easily handle 64 queens. With a few changes it has been shown to easily handle 5000 queens and more.
				</p><section class="section" id="nQueensDomainModel"><div class="titlepage"><div><div><h3 class="title">3.6.1. Domain model for N queens</h3></div></div></div><p>
						This example uses the domain model to solve the four queens problem.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Creating a Domain Model</strong></span>
							</p><p class="simpara">
								A good domain model will make it easier to understand and solve your planning problem.
							</p><p class="simpara">
								This is the domain model for the <span class="emphasis"><em>n</em></span> queens example:
							</p><pre class="programlisting language-java">public class Column {

    private int index;

    // ... getters and setters
}</pre><pre class="programlisting language-java">public class Row {

    private int index;

    // ... getters and setters
}</pre><pre class="programlisting language-java">public class Queen {

    private Column column;
    private Row row;

    public int getAscendingDiagonalIndex() {...}
    public int getDescendingDiagonalIndex() {...}

    // ... getters and setters
}</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Calculating the Search Space.</strong></span>
							</p><p class="simpara">
								A <code class="literal">Queen</code> instance has a <code class="literal">Column</code> (for example: 0 is column A, 1 is column B, …​) and a <code class="literal">Row</code> (its row, for example: 0 is row 0, 1 is row 1, …​).
							</p><p class="simpara">
								The ascending diagonal line and the descending diagonal line can be calculated based on the column and the row.
							</p><p class="simpara">
								The column and row indexes start from the upper left corner of the chessboard.
							</p><pre class="programlisting language-java">public class NQueens {

    private int n;
    private List&lt;Column&gt; columnList;
    private List&lt;Row&gt; rowList;

    private List&lt;Queen&gt; queenList;

    private SimpleScore score;

    // ... getters and setters
}</pre></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Finding the Solution</strong></span>
							</p><p class="simpara">
								A single <code class="literal">NQueens</code> instance contains a list of all <code class="literal">Queen</code> instances. It is the <code class="literal">Solution</code> implementation which will be supplied to, solved by, and retrieved from the Solver.
							</p></li></ul></div><p>
						Notice that in the four queens example, the NQueens <code class="literal">getN()</code> method will always return four.
					</p><div class="figure" id="idm45892296291040"><p class="title"><strong>Figure 3.3. A solution for Four Queens</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NQueens/partiallySolvedNQueens04Explained.png" alt="partiallySolvedNQueens04Explained"/></div></div></div><div class="table" id="idm45892296286832"><p class="title"><strong>Table 3.2. Details of the solution in the domain model</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 9%; " class="col_1"/><col style="width: 18%; " class="col_2"/><col style="width: 18%; " class="col_3"/><col style="width: 27%; " class="col_4"/><col style="width: 27%; " class="col_5"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892299322928" scope="col"> </th><th align="left" valign="top" id="idm45892299322000" scope="col">columnIndex</th><th align="left" valign="top" id="idm45892296093360" scope="col">rowIndex</th><th align="left" valign="top" id="idm45892296092272" scope="col">ascendingDiagonalIndex (columnIndex + rowIndex)</th><th align="left" valign="top" id="idm45892296091216" scope="col">descendingDiagonalIndex (columnIndex - rowIndex)</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892299322928">
									<p>
										A1
									</p>
									</td><td align="left" valign="top" headers="idm45892299322000">
									<p>
										0
									</p>
									</td><td align="left" valign="top" headers="idm45892296093360">
									<p>
										1
									</p>
									</td><td align="left" valign="top" headers="idm45892296092272">
									<p>
										<span class="strong strong"><strong>1 (**)</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45892296091216">
									<p>
										-1
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45892299322928">
									<p>
										B0
									</p>
									</td><td align="left" valign="top" headers="idm45892299322000">
									<p>
										1
									</p>
									</td><td align="left" valign="top" headers="idm45892296093360">
									<p>
										<span class="strong strong"><strong>0 (*)</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45892296092272">
									<p>
										<span class="strong strong"><strong>1 (**)</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45892296091216">
									<p>
										1
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45892299322928">
									<p>
										C2
									</p>
									</td><td align="left" valign="top" headers="idm45892299322000">
									<p>
										2
									</p>
									</td><td align="left" valign="top" headers="idm45892296093360">
									<p>
										2
									</p>
									</td><td align="left" valign="top" headers="idm45892296092272">
									<p>
										4
									</p>
									</td><td align="left" valign="top" headers="idm45892296091216">
									<p>
										0
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45892299322928">
									<p>
										D0
									</p>
									</td><td align="left" valign="top" headers="idm45892299322000">
									<p>
										3
									</p>
									</td><td align="left" valign="top" headers="idm45892296093360">
									<p>
										<span class="strong strong"><strong>0 (*)</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45892296092272">
									<p>
										3
									</p>
									</td><td align="left" valign="top" headers="idm45892296091216">
									<p>
										3
									</p>
									</td></tr></tbody></table></div></div><p>
						When two queens share the same column, row or diagonal line, such as (*) and (**), they can attack each other.
					</p></section></section><section class="section" id="ex-cloudBalancing-ref"><div class="titlepage"><div><div><h2 class="title">3.7. Cloud balancing</h2></div></div></div><p>
					For information about this example, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/developing_solvers_with_red_hat_build_of_optaplanner_in_red_hat_decision_manager#assembly-optaplanner-quickstarts_developing-solvers"><span class="emphasis"><em>Red Hat build of OptaPlanner quick start guides</em></span></a>.
				</p></section><section class="section" id="ex-tsp-ref"><div class="titlepage"><div><div><h2 class="title">3.8. Traveling salesman (TSP - Traveling Salesman Problem)</h2></div></div></div><p>
					Given a list of cities, find the shortest tour for a salesman that visits each city exactly once.
				</p><p>
					The problem is defined by <a class="link" href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">Wikipedia</a>. It is <a class="link" href="http://www.math.uwaterloo.ca/tsp/">one of the most intensively studied problems</a> in computational mathematics. Yet, in the real world, it is often only part of a planning problem, along with other constraints, such as employee shift rostering constraints.
				</p><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">dj38     has  38 cities with a search space of   10^43.
europe40 has  40 cities with a search space of   10^46.
st70     has  70 cities with a search space of   10^98.
pcb442   has 442 cities with a search space of  10^976.
lu980    has 980 cities with a search space of 10^2504.</pre>
					</p></div><div class="formalpara"><p class="title"><strong>Problem difficulty</strong></p><p>
						Despite TSP’s simple definition, the problem is surprisingly hard to solve. Because it is an NP-hard problem (like most planning problems), the optimal solution for a specific problem dataset can change a lot when that problem dataset is slightly altered:
					</p></div><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/TravellingSalesman/tspOptimalSolutionVolatility.png" alt="tspOptimalSolutionVolatility"/></div></div></section><section class="section" id="ex-tennis-ref"><div class="titlepage"><div><div><h2 class="title">3.9. Tennis club scheduling</h2></div></div></div><p>
					Every week the tennis club has four teams playing round robin against each other. Assign those four spots to the teams fairly.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Conflict: A team can only play once per day.
						</li><li class="listitem">
							Unavailability: Some teams are unavailable on some dates.
						</li></ul></div><p>
					Medium constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Fair assignment: All teams should play an (almost) equal number of times.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Evenly confrontation: Each team should play against every other team an equal number of times.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">munich-7teams has 7 teams, 18 days, 12 unavailabilityPenalties and 72 teamAssignments with a search space of 10^60.</pre>
					</p></div><div class="figure" id="idm45892291041552"><p class="title"><strong>Figure 3.4. Domain model</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/TennisScheduling/tennisClassDiagram.png" alt="tennisClassDiagram"/></div></div></div></section><section class="section" id="ex-meetingScheduling-ref"><div class="titlepage"><div><div><h2 class="title">3.10. Meeting scheduling</h2></div></div></div><p>
					Assign each meeting to a starting time and a room. Meetings have different durations.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Room conflict: Two meetings must not use the same room at the same time.
						</li><li class="listitem">
							Required attendance: A person cannot have two required meetings at the same time.
						</li><li class="listitem">
							Required room capacity: A meeting must not be in a room that doesn’t fit all of the meeting’s attendees.
						</li><li class="listitem">
							Start and end on same day: A meeting shouldn’t be scheduled over multiple days.
						</li></ul></div><p>
					Medium constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Preferred attendance: A person cannot have two preferred meetings at the same time, nor a preferred and a required meeting at the same time.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Sooner rather than later: Schedule all meetings as soon as possible.
						</li><li class="listitem">
							A break between meetings: Any two meetings should have at least one time grain break between them.
						</li><li class="listitem">
							Overlapping meetings: To minimize the number of meetings in parallel so people don’t have to choose one meeting over the other.
						</li><li class="listitem">
							Assign larger rooms first: If a larger room is available any meeting should be assigned to that room in order to accommodate as many people as possible even if they haven’t signed up to that meeting.
						</li><li class="listitem">
							Room stability: If a person has two consecutive meetings with two or less time grains break between them they better be in the same room.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">50meetings-160timegrains-5rooms  has  50 meetings, 160 timeGrains and 5 rooms with a search space of 10^145.
100meetings-320timegrains-5rooms has 100 meetings, 320 timeGrains and 5 rooms with a search space of 10^320.
200meetings-640timegrains-5rooms has 200 meetings, 640 timeGrains and 5 rooms with a search space of 10^701.
400meetings-1280timegrains-5rooms has 400 meetings, 1280 timeGrains and 5 rooms with a search space of 10^1522.
800meetings-2560timegrains-5rooms has 800 meetings, 2560 timeGrains and 5 rooms with a search space of 10^3285.</pre>
					</p></div></section><section class="section" id="ex-curriculumCourse-ref"><div class="titlepage"><div><div><h2 class="title">3.11. Course timetabling (ITC 2007 Track 3 - Curriculum Course Scheduling)</h2></div></div></div><p>
					Schedule each lecture into a timeslot and into a room.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Teacher conflict: A teacher must not have two lectures in the same period.
						</li><li class="listitem">
							Curriculum conflict: A curriculum must not have two lectures in the same period.
						</li><li class="listitem">
							Room occupancy: Two lectures must not be in the same room in the same period.
						</li><li class="listitem">
							Unavailable period (specified per dataset): A specific lecture must not be assigned to a specific period.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Room capacity: A room’s capacity should not be less than the number of students in its lecture.
						</li><li class="listitem">
							Minimum working days: Lectures of the same course should be spread out into a minimum number of days.
						</li><li class="listitem">
							Curriculum compactness: Lectures belonging to the same curriculum should be adjacent to each other (so in consecutive periods).
						</li><li class="listitem">
							Room stability: Lectures of the same course should be assigned to the same room.
						</li></ul></div><p>
					The problem is defined by <a class="link" href="http://www.cs.qub.ac.uk/itc2007/curriculmcourse/course_curriculm_index.htm">the International Timetabling Competition 2007 track 3</a>.
				</p><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">comp01 has 24 teachers,  14 curricula,  30 courses, 160 lectures, 30 periods,  6 rooms and   53 unavailable period constraints with a search space of  10^360.
comp02 has 71 teachers,  70 curricula,  82 courses, 283 lectures, 25 periods, 16 rooms and  513 unavailable period constraints with a search space of  10^736.
comp03 has 61 teachers,  68 curricula,  72 courses, 251 lectures, 25 periods, 16 rooms and  382 unavailable period constraints with a search space of  10^653.
comp04 has 70 teachers,  57 curricula,  79 courses, 286 lectures, 25 periods, 18 rooms and  396 unavailable period constraints with a search space of  10^758.
comp05 has 47 teachers, 139 curricula,  54 courses, 152 lectures, 36 periods,  9 rooms and  771 unavailable period constraints with a search space of  10^381.
comp06 has 87 teachers,  70 curricula, 108 courses, 361 lectures, 25 periods, 18 rooms and  632 unavailable period constraints with a search space of  10^957.
comp07 has 99 teachers,  77 curricula, 131 courses, 434 lectures, 25 periods, 20 rooms and  667 unavailable period constraints with a search space of 10^1171.
comp08 has 76 teachers,  61 curricula,  86 courses, 324 lectures, 25 periods, 18 rooms and  478 unavailable period constraints with a search space of  10^859.
comp09 has 68 teachers,  75 curricula,  76 courses, 279 lectures, 25 periods, 18 rooms and  405 unavailable period constraints with a search space of  10^740.
comp10 has 88 teachers,  67 curricula, 115 courses, 370 lectures, 25 periods, 18 rooms and  694 unavailable period constraints with a search space of  10^981.
comp11 has 24 teachers,  13 curricula,  30 courses, 162 lectures, 45 periods,  5 rooms and   94 unavailable period constraints with a search space of  10^381.
comp12 has 74 teachers, 150 curricula,  88 courses, 218 lectures, 36 periods, 11 rooms and 1368 unavailable period constraints with a search space of  10^566.
comp13 has 77 teachers,  66 curricula,  82 courses, 308 lectures, 25 periods, 19 rooms and  468 unavailable period constraints with a search space of  10^824.
comp14 has 68 teachers,  60 curricula,  85 courses, 275 lectures, 25 periods, 17 rooms and  486 unavailable period constraints with a search space of  10^722.</pre>
					</p></div><div class="figure" id="idm45892302484512"><p class="title"><strong>Figure 3.5. Domain model</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/CourseTimetabling/curriculumCourseClassDiagram.png" alt="curriculumCourseClassDiagram"/></div></div></div></section><section class="section" id="ex-machineReassignment-ref"><div class="titlepage"><div><div><h2 class="title">3.12. Machine reassignment (Google ROADEF 2012)</h2></div></div></div><p>
					Assign each process to a machine. All processes already have an original (unoptimized) assignment. Each process requires an amount of each resource (such as CPU or RAM). This is a more complex version of the Cloud Balancing example.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Maximum capacity: The maximum capacity for each resource for each machine must not be exceeded.
						</li><li class="listitem">
							Conflict: Processes of the same service must run on distinct machines.
						</li><li class="listitem">
							Spread: Processes of the same service must be spread out across locations.
						</li><li class="listitem">
							Dependency: The processes of a service depending on another service must run in the neighborhood of a process of the other service.
						</li><li class="listitem">
							Transient usage: Some resources are transient and count towards the maximum capacity of both the original machine as the newly assigned machine.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Load: The safety capacity for each resource for each machine should not be exceeded.
						</li><li class="listitem">
							Balance: Leave room for future assignments by balancing the available resources on each machine.
						</li><li class="listitem">
							Process move cost: A process has a move cost.
						</li><li class="listitem">
							Service move cost: A service has a move cost.
						</li><li class="listitem">
							Machine move cost: Moving a process from machine A to machine B has another A-B specific move cost.
						</li></ul></div><p>
					The problem is defined by <a class="link" href="http://challenge.roadef.org/2012/en/">the Google ROADEF/EURO Challenge 2012</a>.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/MachineReassignment/cloudOptimizationIsLikeTetris.png" alt="cloudOptimizationIsLikeTetris"/></div></div><div class="figure" id="machineReassignmentValueProposition"><p class="title"><strong>Figure 3.6. Value proposition</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/shared/cloudOptimizationValueProposition.png" alt="cloudOptimizationValueProposition"/></div></div></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">model_a1_1 has  2 resources,  1 neighborhoods,   4 locations,    4 machines,    79 services,   100 processes and 1 balancePenalties with a search space of     10^60.
model_a1_2 has  4 resources,  2 neighborhoods,   4 locations,  100 machines,   980 services,  1000 processes and 0 balancePenalties with a search space of   10^2000.
model_a1_3 has  3 resources,  5 neighborhoods,  25 locations,  100 machines,   216 services,  1000 processes and 0 balancePenalties with a search space of   10^2000.
model_a1_4 has  3 resources, 50 neighborhoods,  50 locations,   50 machines,   142 services,  1000 processes and 1 balancePenalties with a search space of   10^1698.
model_a1_5 has  4 resources,  2 neighborhoods,   4 locations,   12 machines,   981 services,  1000 processes and 1 balancePenalties with a search space of   10^1079.
model_a2_1 has  3 resources,  1 neighborhoods,   1 locations,  100 machines,  1000 services,  1000 processes and 0 balancePenalties with a search space of   10^2000.
model_a2_2 has 12 resources,  5 neighborhoods,  25 locations,  100 machines,   170 services,  1000 processes and 0 balancePenalties with a search space of   10^2000.
model_a2_3 has 12 resources,  5 neighborhoods,  25 locations,  100 machines,   129 services,  1000 processes and 0 balancePenalties with a search space of   10^2000.
model_a2_4 has 12 resources,  5 neighborhoods,  25 locations,   50 machines,   180 services,  1000 processes and 1 balancePenalties with a search space of   10^1698.
model_a2_5 has 12 resources,  5 neighborhoods,  25 locations,   50 machines,   153 services,  1000 processes and 0 balancePenalties with a search space of   10^1698.
model_b_1  has 12 resources,  5 neighborhoods,  10 locations,  100 machines,  2512 services,  5000 processes and 0 balancePenalties with a search space of  10^10000.
model_b_2  has 12 resources,  5 neighborhoods,  10 locations,  100 machines,  2462 services,  5000 processes and 1 balancePenalties with a search space of  10^10000.
model_b_3  has  6 resources,  5 neighborhoods,  10 locations,  100 machines, 15025 services, 20000 processes and 0 balancePenalties with a search space of  10^40000.
model_b_4  has  6 resources,  5 neighborhoods,  50 locations,  500 machines,  1732 services, 20000 processes and 1 balancePenalties with a search space of  10^53979.
model_b_5  has  6 resources,  5 neighborhoods,  10 locations,  100 machines, 35082 services, 40000 processes and 0 balancePenalties with a search space of  10^80000.
model_b_6  has  6 resources,  5 neighborhoods,  50 locations,  200 machines, 14680 services, 40000 processes and 1 balancePenalties with a search space of  10^92041.
model_b_7  has  6 resources,  5 neighborhoods,  50 locations, 4000 machines, 15050 services, 40000 processes and 1 balancePenalties with a search space of 10^144082.
model_b_8  has  3 resources,  5 neighborhoods,  10 locations,  100 machines, 45030 services, 50000 processes and 0 balancePenalties with a search space of 10^100000.
model_b_9  has  3 resources,  5 neighborhoods, 100 locations, 1000 machines,  4609 services, 50000 processes and 1 balancePenalties with a search space of 10^150000.
model_b_10 has  3 resources,  5 neighborhoods, 100 locations, 5000 machines,  4896 services, 50000 processes and 1 balancePenalties with a search space of 10^184948.</pre>
					</p></div><div class="figure" id="idm45892294219056"><p class="title"><strong>Figure 3.7. Domain model</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/MachineReassignment/machineReassignmentClassDiagram.png" alt="machineReassignmentClassDiagram"/></div></div></div></section><section class="section" id="ex-vehicleRouting-ref"><div class="titlepage"><div><div><h2 class="title">3.13. Vehicle routing</h2></div></div></div><p>
					Using a fleet of vehicles, pick up the objects of each customer and bring them to the depot. Each vehicle can service multiple customers, but it has a limited capacity.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/vehicleRoutingUseCase.png" alt="vehicleRoutingUseCase"/></div></div><p>
					Besides the basic case (CVRP), there is also a variant with time windows (CVRPTW).
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Vehicle capacity: a vehicle cannot carry more items then its capacity.
						</li><li class="listitem"><p class="simpara">
							Time windows (only in CVRPTW):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Travel time: Traveling from one location to another takes time.
								</li><li class="listitem">
									Customer service duration: A vehicle must stay at the customer for the length of the service duration.
								</li><li class="listitem">
									Customer ready time: A vehicle may arrive before the customer’s ready time, but it must wait until the ready time before servicing.
								</li><li class="listitem">
									Customer due time: A vehicle must arrive on time, before the customer’s due time.
								</li></ul></div></li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Total distance: Minimize the total distance driven (fuel consumption) of all vehicles.
						</li></ul></div><p>
					The capacitated vehicle routing problem (CVRP) and its time-windowed variant (CVRPTW) are defined by the VRP web.
				</p><div class="figure" id="idm45892298291728"><p class="title"><strong>Figure 3.8. Value proposition</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/vehicleRoutingValueProposition.png" alt="vehicleRoutingValueProposition"/></div></div></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						CVRP instances (without time windows):
					</p></div><pre class="screen">belgium-n50-k10             has  1 depots, 10 vehicles and   49 customers with a search space of   10^74.
belgium-n100-k10            has  1 depots, 10 vehicles and   99 customers with a search space of  10^170.
belgium-n500-k20            has  1 depots, 20 vehicles and  499 customers with a search space of 10^1168.
belgium-n1000-k20           has  1 depots, 20 vehicles and  999 customers with a search space of 10^2607.
belgium-n2750-k55           has  1 depots, 55 vehicles and 2749 customers with a search space of 10^8380.
belgium-road-km-n50-k10     has  1 depots, 10 vehicles and   49 customers with a search space of   10^74.
belgium-road-km-n100-k10    has  1 depots, 10 vehicles and   99 customers with a search space of  10^170.
belgium-road-km-n500-k20    has  1 depots, 20 vehicles and  499 customers with a search space of 10^1168.
belgium-road-km-n1000-k20   has  1 depots, 20 vehicles and  999 customers with a search space of 10^2607.
belgium-road-km-n2750-k55   has  1 depots, 55 vehicles and 2749 customers with a search space of 10^8380.
belgium-road-time-n50-k10   has  1 depots, 10 vehicles and   49 customers with a search space of   10^74.
belgium-road-time-n100-k10  has  1 depots, 10 vehicles and   99 customers with a search space of  10^170.
belgium-road-time-n500-k20  has  1 depots, 20 vehicles and  499 customers with a search space of 10^1168.
belgium-road-time-n1000-k20 has  1 depots, 20 vehicles and  999 customers with a search space of 10^2607.
belgium-road-time-n2750-k55 has  1 depots, 55 vehicles and 2749 customers with a search space of 10^8380.
belgium-d2-n50-k10          has  2 depots, 10 vehicles and   48 customers with a search space of   10^74.
belgium-d3-n100-k10         has  3 depots, 10 vehicles and   97 customers with a search space of  10^170.
belgium-d5-n500-k20         has  5 depots, 20 vehicles and  495 customers with a search space of 10^1168.
belgium-d8-n1000-k20        has  8 depots, 20 vehicles and  992 customers with a search space of 10^2607.
belgium-d10-n2750-k55       has 10 depots, 55 vehicles and 2740 customers with a search space of 10^8380.

A-n32-k5  has 1 depots,  5 vehicles and  31 customers with a search space of  10^40.
A-n33-k5  has 1 depots,  5 vehicles and  32 customers with a search space of  10^41.
A-n33-k6  has 1 depots,  6 vehicles and  32 customers with a search space of  10^42.
A-n34-k5  has 1 depots,  5 vehicles and  33 customers with a search space of  10^43.
A-n36-k5  has 1 depots,  5 vehicles and  35 customers with a search space of  10^46.
A-n37-k5  has 1 depots,  5 vehicles and  36 customers with a search space of  10^48.
A-n37-k6  has 1 depots,  6 vehicles and  36 customers with a search space of  10^49.
A-n38-k5  has 1 depots,  5 vehicles and  37 customers with a search space of  10^49.
A-n39-k5  has 1 depots,  5 vehicles and  38 customers with a search space of  10^51.
A-n39-k6  has 1 depots,  6 vehicles and  38 customers with a search space of  10^52.
A-n44-k7  has 1 depots,  7 vehicles and  43 customers with a search space of  10^61.
A-n45-k6  has 1 depots,  6 vehicles and  44 customers with a search space of  10^62.
A-n45-k7  has 1 depots,  7 vehicles and  44 customers with a search space of  10^63.
A-n46-k7  has 1 depots,  7 vehicles and  45 customers with a search space of  10^65.
A-n48-k7  has 1 depots,  7 vehicles and  47 customers with a search space of  10^68.
A-n53-k7  has 1 depots,  7 vehicles and  52 customers with a search space of  10^77.
A-n54-k7  has 1 depots,  7 vehicles and  53 customers with a search space of  10^79.
A-n55-k9  has 1 depots,  9 vehicles and  54 customers with a search space of  10^82.
A-n60-k9  has 1 depots,  9 vehicles and  59 customers with a search space of  10^91.
A-n61-k9  has 1 depots,  9 vehicles and  60 customers with a search space of  10^93.
A-n62-k8  has 1 depots,  8 vehicles and  61 customers with a search space of  10^94.
A-n63-k9  has 1 depots,  9 vehicles and  62 customers with a search space of  10^97.
A-n63-k10 has 1 depots, 10 vehicles and  62 customers with a search space of  10^98.
A-n64-k9  has 1 depots,  9 vehicles and  63 customers with a search space of  10^99.
A-n65-k9  has 1 depots,  9 vehicles and  64 customers with a search space of 10^101.
A-n69-k9  has 1 depots,  9 vehicles and  68 customers with a search space of 10^108.
A-n80-k10 has 1 depots, 10 vehicles and  79 customers with a search space of 10^130.
F-n45-k4  has 1 depots,  4 vehicles and  44 customers with a search space of  10^60.
F-n72-k4  has 1 depots,  4 vehicles and  71 customers with a search space of 10^108.
F-n135-k7 has 1 depots,  7 vehicles and 134 customers with a search space of 10^240.</pre><p>
					CVRPTW instances (with time windows):
				</p><pre class="screen">belgium-tw-d2-n50-k10    has  2 depots, 10 vehicles and   48 customers with a search space of   10^74.
belgium-tw-d3-n100-k10   has  3 depots, 10 vehicles and   97 customers with a search space of  10^170.
belgium-tw-d5-n500-k20   has  5 depots, 20 vehicles and  495 customers with a search space of 10^1168.
belgium-tw-d8-n1000-k20  has  8 depots, 20 vehicles and  992 customers with a search space of 10^2607.
belgium-tw-d10-n2750-k55 has 10 depots, 55 vehicles and 2740 customers with a search space of 10^8380.
belgium-tw-n50-k10       has  1 depots, 10 vehicles and   49 customers with a search space of   10^74.
belgium-tw-n100-k10      has  1 depots, 10 vehicles and   99 customers with a search space of  10^170.
belgium-tw-n500-k20      has  1 depots, 20 vehicles and  499 customers with a search space of 10^1168.
belgium-tw-n1000-k20     has  1 depots, 20 vehicles and  999 customers with a search space of 10^2607.
belgium-tw-n2750-k55     has  1 depots, 55 vehicles and 2749 customers with a search space of 10^8380.

Solomon_025_C101       has 1 depots,  25 vehicles and   25 customers with a search space of   10^40.
Solomon_025_C201       has 1 depots,  25 vehicles and   25 customers with a search space of   10^40.
Solomon_025_R101       has 1 depots,  25 vehicles and   25 customers with a search space of   10^40.
Solomon_025_R201       has 1 depots,  25 vehicles and   25 customers with a search space of   10^40.
Solomon_025_RC101      has 1 depots,  25 vehicles and   25 customers with a search space of   10^40.
Solomon_025_RC201      has 1 depots,  25 vehicles and   25 customers with a search space of   10^40.
Solomon_100_C101       has 1 depots,  25 vehicles and  100 customers with a search space of  10^185.
Solomon_100_C201       has 1 depots,  25 vehicles and  100 customers with a search space of  10^185.
Solomon_100_R101       has 1 depots,  25 vehicles and  100 customers with a search space of  10^185.
Solomon_100_R201       has 1 depots,  25 vehicles and  100 customers with a search space of  10^185.
Solomon_100_RC101      has 1 depots,  25 vehicles and  100 customers with a search space of  10^185.
Solomon_100_RC201      has 1 depots,  25 vehicles and  100 customers with a search space of  10^185.
Homberger_0200_C1_2_1  has 1 depots,  50 vehicles and  200 customers with a search space of  10^429.
Homberger_0200_C2_2_1  has 1 depots,  50 vehicles and  200 customers with a search space of  10^429.
Homberger_0200_R1_2_1  has 1 depots,  50 vehicles and  200 customers with a search space of  10^429.
Homberger_0200_R2_2_1  has 1 depots,  50 vehicles and  200 customers with a search space of  10^429.
Homberger_0200_RC1_2_1 has 1 depots,  50 vehicles and  200 customers with a search space of  10^429.
Homberger_0200_RC2_2_1 has 1 depots,  50 vehicles and  200 customers with a search space of  10^429.
Homberger_0400_C1_4_1  has 1 depots, 100 vehicles and  400 customers with a search space of  10^978.
Homberger_0400_C2_4_1  has 1 depots, 100 vehicles and  400 customers with a search space of  10^978.
Homberger_0400_R1_4_1  has 1 depots, 100 vehicles and  400 customers with a search space of  10^978.
Homberger_0400_R2_4_1  has 1 depots, 100 vehicles and  400 customers with a search space of  10^978.
Homberger_0400_RC1_4_1 has 1 depots, 100 vehicles and  400 customers with a search space of  10^978.
Homberger_0400_RC2_4_1 has 1 depots, 100 vehicles and  400 customers with a search space of  10^978.
Homberger_0600_C1_6_1  has 1 depots, 150 vehicles and  600 customers with a search space of 10^1571.
Homberger_0600_C2_6_1  has 1 depots, 150 vehicles and  600 customers with a search space of 10^1571.
Homberger_0600_R1_6_1  has 1 depots, 150 vehicles and  600 customers with a search space of 10^1571.
Homberger_0600_R2_6_1  has 1 depots, 150 vehicles and  600 customers with a search space of 10^1571.
Homberger_0600_RC1_6_1 has 1 depots, 150 vehicles and  600 customers with a search space of 10^1571.
Homberger_0600_RC2_6_1 has 1 depots, 150 vehicles and  600 customers with a search space of 10^1571.
Homberger_0800_C1_8_1  has 1 depots, 200 vehicles and  800 customers with a search space of 10^2195.
Homberger_0800_C2_8_1  has 1 depots, 200 vehicles and  800 customers with a search space of 10^2195.
Homberger_0800_R1_8_1  has 1 depots, 200 vehicles and  800 customers with a search space of 10^2195.
Homberger_0800_R2_8_1  has 1 depots, 200 vehicles and  800 customers with a search space of 10^2195.
Homberger_0800_RC1_8_1 has 1 depots, 200 vehicles and  800 customers with a search space of 10^2195.
Homberger_0800_RC2_8_1 has 1 depots, 200 vehicles and  800 customers with a search space of 10^2195.
Homberger_1000_C110_1  has 1 depots, 250 vehicles and 1000 customers with a search space of 10^2840.
Homberger_1000_C210_1  has 1 depots, 250 vehicles and 1000 customers with a search space of 10^2840.
Homberger_1000_R110_1  has 1 depots, 250 vehicles and 1000 customers with a search space of 10^2840.
Homberger_1000_R210_1  has 1 depots, 250 vehicles and 1000 customers with a search space of 10^2840.
Homberger_1000_RC110_1 has 1 depots, 250 vehicles and 1000 customers with a search space of 10^2840.
Homberger_1000_RC210_1 has 1 depots, 250 vehicles and 1000 customers with a search space of 10^2840.</pre><section class="section" id="vehicleRoutingDomainModel"><div class="titlepage"><div><div><h3 class="title">3.13.1. Domain model for Vehicle routing</h3></div></div></div><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/vehicleRoutingClassDiagram.png" alt="vehicleRoutingClassDiagram"/></div></div><p>
						The vehicle routing with time windows domain model makes heavy use of the shadow variable feature. This allows it to express its constraints more naturally, because properties such as <code class="literal">arrivalTime</code> and <code class="literal">departureTime</code>, are directly available on the domain model.
					</p><div class="formalpara"><p class="title"><strong>Road Distances Instead of Air Distances</strong></p><p>
							In the real world, vehicles cannot follow a straight line from location to location: they have to use roads and highways. From a business point of view, this matters a lot:
						</p></div><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/vehicleRoutingDistanceType.png" alt="vehicleRoutingDistanceType"/></div></div><p>
						For the optimization algorithm, this does not matter much, as long as the distance between two points can be looked up (and are preferably precalculated). The road cost does not even need to be a distance. It can also be travel time, fuel cost, or a weighted function of those. There are several technologies available to precalculate road costs, such as <a class="link" href="https://graphhopper.com/">GraphHopper</a> (embeddable, offline Java engine), <a class="link" href="http://open.mapquestapi.com/directions/#matrix">Open MapQuest</a> (web service) and <a class="link" href="https://developers.google.com/maps/documentation/webservices/client-library">Google Maps Client API</a> (web service).
					</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/integrationWithRealMaps.png" alt="integrationWithRealMaps"/></div></div><p>
						There are also several technologies to render it, such as <a class="link" href="http://leafletjs.com">Leaflet</a> and <a class="link" href="https://developers.google.com/maps/">Google Maps for developers</a>.
					</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/vehicleRoutingLeafletAndGoogleMaps.png" alt="vehicleRoutingLeafletAndGoogleMaps"/></div></div><p>
						It is even possible to render the actual road routes with GraphHopper or Google Map Directions, but because of route overlaps on highways, it can become harder to see the standstill order:
					</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/vehicleRoutingGoogleMapsDirections.png" alt="vehicleRoutingGoogleMapsDirections"/></div></div><p>
						Take special care that the road costs between two points use the same optimization criteria as the one used in OptaPlanner. For example, GraphHopper will by default return the fastest route, not the shortest route. Don’t use the km (or miles) distances of the fastest GPS routes to optimize the shortest trip in OptaPlanner: this leads to a suboptimal solution as shown below:
					</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/VehicleRouting/roadDistanceTriangleInequality.png" alt="roadDistanceTriangleInequality"/></div></div><p>
						Contrary to popular belief, most users do not want the shortest route: they want the fastest route instead. They prefer highways over normal roads. They prefer normal roads over dirt roads. In the real world, the fastest and shortest route are rarely the same.
					</p></section></section><section class="section" id="ex-projectJobScheduling-ref"><div class="titlepage"><div><div><h2 class="title">3.14. Project job scheduling</h2></div></div></div><p>
					Schedule all jobs in time and execution mode to minimize project delays. Each job is part of a project. A job can be executed in different ways: each way is an execution mode that implies a different duration but also different resource usages. This is a form of flexible <span class="emphasis"><em>job shop scheduling</em></span>.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/ProjectJobScheduling/projectJobSchedulingUseCase.png" alt="projectJobSchedulingUseCase"/></div></div><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Job precedence: a job can only start when all its predecessor jobs are finished.
						</li><li class="listitem"><p class="simpara">
							Resource capacity: do not use more resources than available.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Resources are local (shared between jobs of the same project) or global (shared between all jobs)
								</li><li class="listitem">
									Resources are renewable (capacity available per day) or nonrenewable (capacity available for all days)
								</li></ul></div></li></ul></div><p>
					Medium constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Total project delay: minimize the duration (makespan) of each project.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Total makespan: minimize the duration of the whole multi-project schedule.
						</li></ul></div><p>
					The problem is defined by <a class="link" href="http://gent.cs.kuleuven.be/mista2013challenge/">the MISTA 2013 challenge</a>.
				</p><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">Schedule A-1  has  2 projects,  24 jobs,   64 execution modes,  7 resources and  150 resource requirements.
Schedule A-2  has  2 projects,  44 jobs,  124 execution modes,  7 resources and  420 resource requirements.
Schedule A-3  has  2 projects,  64 jobs,  184 execution modes,  7 resources and  630 resource requirements.
Schedule A-4  has  5 projects,  60 jobs,  160 execution modes, 16 resources and  390 resource requirements.
Schedule A-5  has  5 projects, 110 jobs,  310 execution modes, 16 resources and  900 resource requirements.
Schedule A-6  has  5 projects, 160 jobs,  460 execution modes, 16 resources and 1440 resource requirements.
Schedule A-7  has 10 projects, 120 jobs,  320 execution modes, 22 resources and  900 resource requirements.
Schedule A-8  has 10 projects, 220 jobs,  620 execution modes, 22 resources and 1860 resource requirements.
Schedule A-9  has 10 projects, 320 jobs,  920 execution modes, 31 resources and 2880 resource requirements.
Schedule A-10 has 10 projects, 320 jobs,  920 execution modes, 31 resources and 2970 resource requirements.
Schedule B-1  has 10 projects, 120 jobs,  320 execution modes, 31 resources and  900 resource requirements.
Schedule B-2  has 10 projects, 220 jobs,  620 execution modes, 22 resources and 1740 resource requirements.
Schedule B-3  has 10 projects, 320 jobs,  920 execution modes, 31 resources and 3060 resource requirements.
Schedule B-4  has 15 projects, 180 jobs,  480 execution modes, 46 resources and 1530 resource requirements.
Schedule B-5  has 15 projects, 330 jobs,  930 execution modes, 46 resources and 2760 resource requirements.
Schedule B-6  has 15 projects, 480 jobs, 1380 execution modes, 46 resources and 4500 resource requirements.
Schedule B-7  has 20 projects, 240 jobs,  640 execution modes, 61 resources and 1710 resource requirements.
Schedule B-8  has 20 projects, 440 jobs, 1240 execution modes, 42 resources and 3180 resource requirements.
Schedule B-9  has 20 projects, 640 jobs, 1840 execution modes, 61 resources and 5940 resource requirements.
Schedule B-10 has 20 projects, 460 jobs, 1300 execution modes, 42 resources and 4260 resource requirements.</pre>
					</p></div></section><section class="section" id="ex-taskAssigning-ref"><div class="titlepage"><div><div><h2 class="title">3.15. Task assigning</h2></div></div></div><p>
					Assign each task to a spot in an employee’s queue. Each task has a duration which is affected by the employee’s affinity level with the task’s customer.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Skill: Each task requires one or more skills. The employee must possess all these skills.
						</li></ul></div><p>
					Soft level 0 constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Critical tasks: Complete critical tasks first, sooner than major and minor tasks.
						</li></ul></div><p>
					Soft level 1 constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Minimize makespan: Reduce the time to complete all tasks.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Start with the longest working employee first, then the second longest working employee and so forth, to create fairness and load balancing.
								</li></ul></div></li></ul></div><p>
					Soft level 2 constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Major tasks: Complete major tasks as soon as possible, sooner than minor tasks.
						</li></ul></div><p>
					Soft level 3 constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Minor tasks: Complete minor tasks as soon as possible.
						</li></ul></div><div class="figure" id="idm45892289243440"><p class="title"><strong>Figure 3.9. Value proposition</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/TaskAssigning/taskAssigningValueProposition.png" alt="taskAssigningValueProposition"/></div></div></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">24tasks-8employees   has  24 tasks, 6 skills,  8 employees,   4 task types and  4 customers with a search space of   10^30.
50tasks-5employees   has  50 tasks, 5 skills,  5 employees,  10 task types and 10 customers with a search space of   10^69.
100tasks-5employees  has 100 tasks, 5 skills,  5 employees,  20 task types and 15 customers with a search space of  10^164.
500tasks-20employees has 500 tasks, 6 skills, 20 employees, 100 task types and 60 customers with a search space of 10^1168.</pre>
					</p></div><div class="figure" id="idm45892289237360"><p class="title"><strong>Figure 3.10. Domain model</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/TaskAssigning/taskAssigningClassDiagram.png" alt="taskAssigningClassDiagram"/></div></div></div></section><section class="section" id="ex-examination-ref"><div class="titlepage"><div><div><h2 class="title">3.16. Exam timetabling (ITC 2007 track 1 - Examination)</h2></div></div></div><p>
					Schedule each exam into a period and into a room. Multiple exams can share the same room during the same period.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/ExamTimetabling/examinationTimetablingUseCase.png" alt="examinationTimetablingUseCase"/></div></div><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Exam conflict: Two exams that share students must not occur in the same period.
						</li><li class="listitem">
							Room capacity: A room’s seating capacity must suffice at all times.
						</li><li class="listitem">
							Period duration: A period’s duration must suffice for all of its exams.
						</li><li class="listitem"><p class="simpara">
							Period related hard constraints (specified per dataset):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Coincidence: Two specified exams must use the same period (but possibly another room).
								</li><li class="listitem">
									Exclusion: Two specified exams must not use the same period.
								</li><li class="listitem">
									After: A specified exam must occur in a period after another specified exam’s period.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Room related hard constraints (specified per dataset):
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Exclusive: One specified exam should not have to share its room with any other exam.
								</li></ul></div></li></ul></div><p>
					Soft constraints (each of which has a parametrized penalty):
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The same student should not have two exams in a row.
						</li><li class="listitem">
							The same student should not have two exams on the same day.
						</li><li class="listitem">
							Period spread: Two exams that share students should be a number of periods apart.
						</li><li class="listitem">
							Mixed durations: Two exams that share a room should not have different durations.
						</li><li class="listitem">
							Front load: Large exams should be scheduled earlier in the schedule.
						</li><li class="listitem">
							Period penalty (specified per dataset): Some periods have a penalty when used.
						</li><li class="listitem">
							Room penalty (specified per dataset): Some rooms have a penalty when used.
						</li></ul></div><p>
					It uses large test data sets of real-life universities.
				</p><p>
					The problem is defined by <a class="link" href="http://www.cs.qub.ac.uk/itc2007/examtrack/exam_track_index.htm">the International Timetabling Competition 2007 track 1</a>. Geoffrey De Smet finished 4th in that competition with a very early version of OptaPlanner. Many improvements have been made since then.
				</p><div id="examinationProblemSize" class="formalpara"><p class="title"><strong>Problem Size</strong></p><p>
						
<pre class="screen">exam_comp_set1 has  7883 students,  607 exams, 54 periods,  7 rooms,  12 period constraints and  0 room constraints with a search space of 10^1564.
exam_comp_set2 has 12484 students,  870 exams, 40 periods, 49 rooms,  12 period constraints and  2 room constraints with a search space of 10^2864.
exam_comp_set3 has 16365 students,  934 exams, 36 periods, 48 rooms, 168 period constraints and 15 room constraints with a search space of 10^3023.
exam_comp_set4 has  4421 students,  273 exams, 21 periods,  1 rooms,  40 period constraints and  0 room constraints with a search space of  10^360.
exam_comp_set5 has  8719 students, 1018 exams, 42 periods,  3 rooms,  27 period constraints and  0 room constraints with a search space of 10^2138.
exam_comp_set6 has  7909 students,  242 exams, 16 periods,  8 rooms,  22 period constraints and  0 room constraints with a search space of  10^509.
exam_comp_set7 has 13795 students, 1096 exams, 80 periods, 15 rooms,  28 period constraints and  0 room constraints with a search space of 10^3374.
exam_comp_set8 has  7718 students,  598 exams, 80 periods,  8 rooms,  20 period constraints and  1 room constraints with a search space of 10^1678.</pre>
					</p></div><section class="section" id="domain_model_for_exam_timetabling"><div class="titlepage"><div><div><h3 class="title">3.16.1. Domain model for exam timetabling</h3></div></div></div><p>
						The following diagram shows the main examination domain classes:
					</p><div class="figure" id="idm45892291070560"><p class="title"><strong>Figure 3.11. Examination domain class diagram</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/ExamTimetabling/examinationDomainDiagram.png" alt="examinationDomainDiagram"/></div></div></div><p>
						Notice that we’ve split up the exam concept into an <code class="literal">Exam</code> class and a <code class="literal">Topic</code> class. The <code class="literal">Exam</code> instances change during solving (this is the planning entity class), when their period or room property changes. The <code class="literal">Topic</code>, <code class="literal">Period</code> and <code class="literal">Room</code> instances never change during solving (these are problem facts, just like some other classes).
					</p></section></section><section class="section" id="ex-nurseRostering-ref"><div class="titlepage"><div><div><h2 class="title">3.17. Nurse rostering (INRC 2010)</h2></div></div></div><p>
					For each shift, assign a nurse to work that shift.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NurseRostering/employeeShiftRosteringUseCase.png" alt="employeeShiftRosteringUseCase"/></div></div><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>No unassigned shifts</strong></span> (built-in): Every shift need to be assigned to an employee.
						</li><li class="listitem">
							<span class="strong strong"><strong>Shift conflict</strong></span>: An employee can have only one shift per day.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Contract obligations. The business frequently violates these, so they decided to define these as soft constraints instead of hard constraints.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<span class="strong strong"><strong>Minimum and maximum assignments</strong></span>: Each employee needs to work more than x shifts and less than y shifts (depending on their contract).
								</li><li class="listitem">
									<span class="strong strong"><strong>Minimum and maximum consecutive working days</strong></span>: Each employee needs to work between x and y days in a row (depending on their contract).
								</li><li class="listitem">
									<span class="strong strong"><strong>Minimum and maximum consecutive free days</strong></span>: Each employee needs to be free between x and y days in a row (depending on their contract).
								</li><li class="listitem">
									<span class="strong strong"><strong>Minimum and maximum consecutive working weekends</strong></span>: Each employee needs to work between x and y weekends in a row (depending on their contract).
								</li><li class="listitem">
									<span class="strong strong"><strong>Complete weekends</strong></span>: Each employee needs to work every day in a weekend or not at all.
								</li><li class="listitem">
									<span class="strong strong"><strong>Identical shift types during weekend</strong></span>: Each weekend shift for the same weekend of the same employee must be the same shift type.
								</li><li class="listitem">
									<span class="strong strong"><strong>Unwanted patterns</strong></span>: A combination of unwanted shift types in a row, for example a late shift followed by an early shift followed by a late shift.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Employee wishes:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<span class="strong strong"><strong>Day on request</strong></span>: An employee wants to work on a specific day.
								</li><li class="listitem">
									<span class="strong strong"><strong>Day off request</strong></span>: An employee does not want to work on a specific day.
								</li><li class="listitem">
									<span class="strong strong"><strong>Shift on request</strong></span>: An employee wants to be assigned to a specific shift.
								</li><li class="listitem">
									<span class="strong strong"><strong>Shift off request</strong></span>: An employee does not want to be assigned to a specific shift.
								</li></ul></div></li><li class="listitem">
							<span class="strong strong"><strong>Alternative skill</strong></span>: An employee assigned to a skill should have a proficiency in every skill required by that shift.
						</li></ul></div><p>
					The problem is defined by <a class="link" href="http://www.kuleuven-kortrijk.be/nrpcompetition">the International Nurse Rostering Competition 2010</a>.
				</p><div class="figure" id="idm45892296919792"><p class="title"><strong>Figure 3.12. Value proposition</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NurseRostering/employeeRosteringValueProposition.png" alt="employeeRosteringValueProposition"/></div></div></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						There are three dataset types:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Sprint: must be solved in seconds.
						</li><li class="listitem">
							Medium: must be solved in minutes.
						</li><li class="listitem">
							Long: must be solved in hours.
						</li></ul></div><pre class="screen">toy1          has 1 skills, 3 shiftTypes, 2 patterns, 1 contracts,  6 employees,  7 shiftDates,  35 shiftAssignments and   0 requests with a search space of   10^27.
toy2          has 1 skills, 3 shiftTypes, 3 patterns, 2 contracts, 20 employees, 28 shiftDates, 180 shiftAssignments and 140 requests with a search space of  10^234.

sprint01      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint02      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint03      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint04      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint05      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint06      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint07      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint08      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint09      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint10      has 1 skills, 4 shiftTypes, 3 patterns, 4 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_hint01 has 1 skills, 4 shiftTypes, 8 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_hint02 has 1 skills, 4 shiftTypes, 0 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_hint03 has 1 skills, 4 shiftTypes, 8 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_late01 has 1 skills, 4 shiftTypes, 8 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_late02 has 1 skills, 3 shiftTypes, 4 patterns, 3 contracts, 10 employees, 28 shiftDates, 144 shiftAssignments and 139 requests with a search space of  10^144.
sprint_late03 has 1 skills, 4 shiftTypes, 8 patterns, 3 contracts, 10 employees, 28 shiftDates, 160 shiftAssignments and 150 requests with a search space of  10^160.
sprint_late04 has 1 skills, 4 shiftTypes, 8 patterns, 3 contracts, 10 employees, 28 shiftDates, 160 shiftAssignments and 150 requests with a search space of  10^160.
sprint_late05 has 1 skills, 4 shiftTypes, 8 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_late06 has 1 skills, 4 shiftTypes, 0 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_late07 has 1 skills, 4 shiftTypes, 0 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.
sprint_late08 has 1 skills, 4 shiftTypes, 0 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and   0 requests with a search space of  10^152.
sprint_late09 has 1 skills, 4 shiftTypes, 0 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and   0 requests with a search space of  10^152.
sprint_late10 has 1 skills, 4 shiftTypes, 0 patterns, 3 contracts, 10 employees, 28 shiftDates, 152 shiftAssignments and 150 requests with a search space of  10^152.

medium01      has 1 skills, 4 shiftTypes, 0 patterns, 4 contracts, 31 employees, 28 shiftDates, 608 shiftAssignments and 403 requests with a search space of  10^906.
medium02      has 1 skills, 4 shiftTypes, 0 patterns, 4 contracts, 31 employees, 28 shiftDates, 608 shiftAssignments and 403 requests with a search space of  10^906.
medium03      has 1 skills, 4 shiftTypes, 0 patterns, 4 contracts, 31 employees, 28 shiftDates, 608 shiftAssignments and 403 requests with a search space of  10^906.
medium04      has 1 skills, 4 shiftTypes, 0 patterns, 4 contracts, 31 employees, 28 shiftDates, 608 shiftAssignments and 403 requests with a search space of  10^906.
medium05      has 1 skills, 4 shiftTypes, 0 patterns, 4 contracts, 31 employees, 28 shiftDates, 608 shiftAssignments and 403 requests with a search space of  10^906.
medium_hint01 has 1 skills, 4 shiftTypes, 7 patterns, 4 contracts, 30 employees, 28 shiftDates, 428 shiftAssignments and 390 requests with a search space of  10^632.
medium_hint02 has 1 skills, 4 shiftTypes, 7 patterns, 3 contracts, 30 employees, 28 shiftDates, 428 shiftAssignments and 390 requests with a search space of  10^632.
medium_hint03 has 1 skills, 4 shiftTypes, 7 patterns, 4 contracts, 30 employees, 28 shiftDates, 428 shiftAssignments and 390 requests with a search space of  10^632.
medium_late01 has 1 skills, 4 shiftTypes, 7 patterns, 4 contracts, 30 employees, 28 shiftDates, 424 shiftAssignments and 390 requests with a search space of  10^626.
medium_late02 has 1 skills, 4 shiftTypes, 7 patterns, 3 contracts, 30 employees, 28 shiftDates, 428 shiftAssignments and 390 requests with a search space of  10^632.
medium_late03 has 1 skills, 4 shiftTypes, 0 patterns, 4 contracts, 30 employees, 28 shiftDates, 428 shiftAssignments and 390 requests with a search space of  10^632.
medium_late04 has 1 skills, 4 shiftTypes, 7 patterns, 3 contracts, 30 employees, 28 shiftDates, 416 shiftAssignments and 390 requests with a search space of  10^614.
medium_late05 has 2 skills, 5 shiftTypes, 7 patterns, 4 contracts, 30 employees, 28 shiftDates, 452 shiftAssignments and 390 requests with a search space of  10^667.

long01        has 2 skills, 5 shiftTypes, 3 patterns, 3 contracts, 49 employees, 28 shiftDates, 740 shiftAssignments and 735 requests with a search space of 10^1250.
long02        has 2 skills, 5 shiftTypes, 3 patterns, 3 contracts, 49 employees, 28 shiftDates, 740 shiftAssignments and 735 requests with a search space of 10^1250.
long03        has 2 skills, 5 shiftTypes, 3 patterns, 3 contracts, 49 employees, 28 shiftDates, 740 shiftAssignments and 735 requests with a search space of 10^1250.
long04        has 2 skills, 5 shiftTypes, 3 patterns, 3 contracts, 49 employees, 28 shiftDates, 740 shiftAssignments and 735 requests with a search space of 10^1250.
long05        has 2 skills, 5 shiftTypes, 3 patterns, 3 contracts, 49 employees, 28 shiftDates, 740 shiftAssignments and 735 requests with a search space of 10^1250.
long_hint01   has 2 skills, 5 shiftTypes, 9 patterns, 3 contracts, 50 employees, 28 shiftDates, 740 shiftAssignments and   0 requests with a search space of 10^1257.
long_hint02   has 2 skills, 5 shiftTypes, 7 patterns, 3 contracts, 50 employees, 28 shiftDates, 740 shiftAssignments and   0 requests with a search space of 10^1257.
long_hint03   has 2 skills, 5 shiftTypes, 7 patterns, 3 contracts, 50 employees, 28 shiftDates, 740 shiftAssignments and   0 requests with a search space of 10^1257.
long_late01   has 2 skills, 5 shiftTypes, 9 patterns, 3 contracts, 50 employees, 28 shiftDates, 752 shiftAssignments and   0 requests with a search space of 10^1277.
long_late02   has 2 skills, 5 shiftTypes, 9 patterns, 4 contracts, 50 employees, 28 shiftDates, 752 shiftAssignments and   0 requests with a search space of 10^1277.
long_late03   has 2 skills, 5 shiftTypes, 9 patterns, 3 contracts, 50 employees, 28 shiftDates, 752 shiftAssignments and   0 requests with a search space of 10^1277.
long_late04   has 2 skills, 5 shiftTypes, 9 patterns, 4 contracts, 50 employees, 28 shiftDates, 752 shiftAssignments and   0 requests with a search space of 10^1277.
long_late05   has 2 skills, 5 shiftTypes, 9 patterns, 3 contracts, 50 employees, 28 shiftDates, 740 shiftAssignments and   0 requests with a search space of 10^1257.</pre><div class="figure" id="idm45892295277888"><p class="title"><strong>Figure 3.13. Domain model</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/NurseRostering/nurseRosteringClassDiagram.png" alt="nurseRosteringClassDiagram"/></div></div></div></section><section class="section" id="ex-travelingTournament-ref"><div class="titlepage"><div><div><h2 class="title">3.18. Traveling tournament problem (TTP)</h2></div></div></div><p>
					Schedule matches between <span class="emphasis"><em>n</em></span> number of teams.
				</p><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/TravellingTournament/travelingTournamentUseCase.png" alt="travelingTournamentUseCase"/></div></div><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Each team plays twice against every other team: once home and once away.
						</li><li class="listitem">
							Each team has exactly one match on each timeslot.
						</li><li class="listitem">
							No team must have more than three consecutive home or three consecutive away matches.
						</li><li class="listitem">
							No repeaters: no two consecutive matches of the same two opposing teams.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Minimize the total distance traveled by all teams.
						</li></ul></div><p>
					The problem is defined on <a class="link" href="http://mat.tepper.cmu.edu/TOURN/">Michael Trick’s website (which contains the world records too)</a>.
				</p><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">1-nl04     has  6 days,  4 teams and   12 matches with a search space of    10^5.
1-nl06     has 10 days,  6 teams and   30 matches with a search space of   10^19.
1-nl08     has 14 days,  8 teams and   56 matches with a search space of   10^43.
1-nl10     has 18 days, 10 teams and   90 matches with a search space of   10^79.
1-nl12     has 22 days, 12 teams and  132 matches with a search space of  10^126.
1-nl14     has 26 days, 14 teams and  182 matches with a search space of  10^186.
1-nl16     has 30 days, 16 teams and  240 matches with a search space of  10^259.
2-bra24    has 46 days, 24 teams and  552 matches with a search space of  10^692.
3-nfl16    has 30 days, 16 teams and  240 matches with a search space of  10^259.
3-nfl18    has 34 days, 18 teams and  306 matches with a search space of  10^346.
3-nfl20    has 38 days, 20 teams and  380 matches with a search space of  10^447.
3-nfl22    has 42 days, 22 teams and  462 matches with a search space of  10^562.
3-nfl24    has 46 days, 24 teams and  552 matches with a search space of  10^692.
3-nfl26    has 50 days, 26 teams and  650 matches with a search space of  10^838.
3-nfl28    has 54 days, 28 teams and  756 matches with a search space of  10^999.
3-nfl30    has 58 days, 30 teams and  870 matches with a search space of 10^1175.
3-nfl32    has 62 days, 32 teams and  992 matches with a search space of 10^1367.
4-super04  has  6 days,  4 teams and   12 matches with a search space of    10^5.
4-super06  has 10 days,  6 teams and   30 matches with a search space of   10^19.
4-super08  has 14 days,  8 teams and   56 matches with a search space of   10^43.
4-super10  has 18 days, 10 teams and   90 matches with a search space of   10^79.
4-super12  has 22 days, 12 teams and  132 matches with a search space of  10^126.
4-super14  has 26 days, 14 teams and  182 matches with a search space of  10^186.
5-galaxy04 has  6 days,  4 teams and   12 matches with a search space of    10^5.
5-galaxy06 has 10 days,  6 teams and   30 matches with a search space of   10^19.
5-galaxy08 has 14 days,  8 teams and   56 matches with a search space of   10^43.
5-galaxy10 has 18 days, 10 teams and   90 matches with a search space of   10^79.
5-galaxy12 has 22 days, 12 teams and  132 matches with a search space of  10^126.
5-galaxy14 has 26 days, 14 teams and  182 matches with a search space of  10^186.
5-galaxy16 has 30 days, 16 teams and  240 matches with a search space of  10^259.
5-galaxy18 has 34 days, 18 teams and  306 matches with a search space of  10^346.
5-galaxy20 has 38 days, 20 teams and  380 matches with a search space of  10^447.
5-galaxy22 has 42 days, 22 teams and  462 matches with a search space of  10^562.
5-galaxy24 has 46 days, 24 teams and  552 matches with a search space of  10^692.
5-galaxy26 has 50 days, 26 teams and  650 matches with a search space of  10^838.
5-galaxy28 has 54 days, 28 teams and  756 matches with a search space of  10^999.
5-galaxy30 has 58 days, 30 teams and  870 matches with a search space of 10^1175.
5-galaxy32 has 62 days, 32 teams and  992 matches with a search space of 10^1367.
5-galaxy34 has 66 days, 34 teams and 1122 matches with a search space of 10^1576.
5-galaxy36 has 70 days, 36 teams and 1260 matches with a search space of 10^1801.
5-galaxy38 has 74 days, 38 teams and 1406 matches with a search space of 10^2042.
5-galaxy40 has 78 days, 40 teams and 1560 matches with a search space of 10^2301.</pre>
					</p></div></section><section class="section" id="ex-cheapTimeScheduling-ref"><div class="titlepage"><div><div><h2 class="title">3.19. Cheap time scheduling</h2></div></div></div><p>
					Schedule all tasks in time and on a machine to minimize power cost. Power prices differ in time. This is a form of <span class="emphasis"><em>job shop scheduling</em></span>.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Start time limits: Each task must start between its earliest start and latest start limit.
						</li><li class="listitem">
							Maximum capacity: The maximum capacity for each resource for each machine must not be exceeded.
						</li><li class="listitem">
							Startup and shutdown: Each machine must be active in the periods during which it has assigned tasks. Between tasks it is allowed to be idle to avoid startup and shutdown costs.
						</li></ul></div><p>
					Medium constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Power cost: Minimize the total power cost of the whole schedule.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Machine power cost: Each active or idle machine consumes power, which infers a power cost (depending on the power price during that time).
								</li><li class="listitem">
									Task power cost: Each task consumes power too, which infers a power cost (depending on the power price during its time).
								</li><li class="listitem">
									Machine startup and shutdown cost: Every time a machine starts up or shuts down, an extra cost is incurred.
								</li></ul></div></li></ul></div><p>
					Soft constraints (addendum to the original problem definition):
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Start early: Prefer starting a task sooner rather than later.
						</li></ul></div><p>
					The problem is defined by <a class="link" href="https://web.archive.org/web/20180318013828/http://iconchallenge.insight-centre.org/">the ICON challenge</a>.
				</p><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">sample01   has 3 resources,   2 machines, 288 periods and   25 tasks with a search space of    10^53.
sample02   has 3 resources,   2 machines, 288 periods and   50 tasks with a search space of   10^114.
sample03   has 3 resources,   2 machines, 288 periods and  100 tasks with a search space of   10^226.
sample04   has 3 resources,   5 machines, 288 periods and  100 tasks with a search space of   10^266.
sample05   has 3 resources,   2 machines, 288 periods and  250 tasks with a search space of   10^584.
sample06   has 3 resources,   5 machines, 288 periods and  250 tasks with a search space of   10^673.
sample07   has 3 resources,   2 machines, 288 periods and 1000 tasks with a search space of  10^2388.
sample08   has 3 resources,   5 machines, 288 periods and 1000 tasks with a search space of  10^2748.
sample09   has 4 resources,  20 machines, 288 periods and 2000 tasks with a search space of  10^6668.
instance00 has 1 resources,  10 machines, 288 periods and  200 tasks with a search space of   10^595.
instance01 has 1 resources,  10 machines, 288 periods and  200 tasks with a search space of   10^599.
instance02 has 1 resources,  10 machines, 288 periods and  200 tasks with a search space of   10^599.
instance03 has 1 resources,  10 machines, 288 periods and  200 tasks with a search space of   10^591.
instance04 has 1 resources,  10 machines, 288 periods and  200 tasks with a search space of   10^590.
instance05 has 2 resources,  25 machines, 288 periods and  200 tasks with a search space of   10^667.
instance06 has 2 resources,  25 machines, 288 periods and  200 tasks with a search space of   10^660.
instance07 has 2 resources,  25 machines, 288 periods and  200 tasks with a search space of   10^662.
instance08 has 2 resources,  25 machines, 288 periods and  200 tasks with a search space of   10^651.
instance09 has 2 resources,  25 machines, 288 periods and  200 tasks with a search space of   10^659.
instance10 has 2 resources,  20 machines, 288 periods and  500 tasks with a search space of  10^1657.
instance11 has 2 resources,  20 machines, 288 periods and  500 tasks with a search space of  10^1644.
instance12 has 2 resources,  20 machines, 288 periods and  500 tasks with a search space of  10^1637.
instance13 has 2 resources,  20 machines, 288 periods and  500 tasks with a search space of  10^1659.
instance14 has 2 resources,  20 machines, 288 periods and  500 tasks with a search space of  10^1643.
instance15 has 3 resources,  40 machines, 288 periods and  500 tasks with a search space of  10^1782.
instance16 has 3 resources,  40 machines, 288 periods and  500 tasks with a search space of  10^1778.
instance17 has 3 resources,  40 machines, 288 periods and  500 tasks with a search space of  10^1764.
instance18 has 3 resources,  40 machines, 288 periods and  500 tasks with a search space of  10^1769.
instance19 has 3 resources,  40 machines, 288 periods and  500 tasks with a search space of  10^1778.
instance20 has 3 resources,  50 machines, 288 periods and 1000 tasks with a search space of  10^3689.
instance21 has 3 resources,  50 machines, 288 periods and 1000 tasks with a search space of  10^3678.
instance22 has 3 resources,  50 machines, 288 periods and 1000 tasks with a search space of  10^3706.
instance23 has 3 resources,  50 machines, 288 periods and 1000 tasks with a search space of  10^3676.
instance24 has 3 resources,  50 machines, 288 periods and 1000 tasks with a search space of  10^3681.
instance25 has 3 resources,  60 machines, 288 periods and 1000 tasks with a search space of  10^3774.
instance26 has 3 resources,  60 machines, 288 periods and 1000 tasks with a search space of  10^3737.
instance27 has 3 resources,  60 machines, 288 periods and 1000 tasks with a search space of  10^3744.
instance28 has 3 resources,  60 machines, 288 periods and 1000 tasks with a search space of  10^3731.
instance29 has 3 resources,  60 machines, 288 periods and 1000 tasks with a search space of  10^3746.
instance30 has 4 resources,  70 machines, 288 periods and 2000 tasks with a search space of  10^7718.
instance31 has 4 resources,  70 machines, 288 periods and 2000 tasks with a search space of  10^7740.
instance32 has 4 resources,  70 machines, 288 periods and 2000 tasks with a search space of  10^7686.
instance33 has 4 resources,  70 machines, 288 periods and 2000 tasks with a search space of  10^7672.
instance34 has 4 resources,  70 machines, 288 periods and 2000 tasks with a search space of  10^7695.
instance35 has 4 resources,  80 machines, 288 periods and 2000 tasks with a search space of  10^7807.
instance36 has 4 resources,  80 machines, 288 periods and 2000 tasks with a search space of  10^7814.
instance37 has 4 resources,  80 machines, 288 periods and 2000 tasks with a search space of  10^7764.
instance38 has 4 resources,  80 machines, 288 periods and 2000 tasks with a search space of  10^7736.
instance39 has 4 resources,  80 machines, 288 periods and 2000 tasks with a search space of  10^7783.
instance40 has 4 resources,  90 machines, 288 periods and 4000 tasks with a search space of 10^15976.
instance41 has 4 resources,  90 machines, 288 periods and 4000 tasks with a search space of 10^15935.
instance42 has 4 resources,  90 machines, 288 periods and 4000 tasks with a search space of 10^15887.
instance43 has 4 resources,  90 machines, 288 periods and 4000 tasks with a search space of 10^15896.
instance44 has 4 resources,  90 machines, 288 periods and 4000 tasks with a search space of 10^15885.
instance45 has 4 resources, 100 machines, 288 periods and 5000 tasks with a search space of 10^20173.
instance46 has 4 resources, 100 machines, 288 periods and 5000 tasks with a search space of 10^20132.
instance47 has 4 resources, 100 machines, 288 periods and 5000 tasks with a search space of 10^20126.
instance48 has 4 resources, 100 machines, 288 periods and 5000 tasks with a search space of 10^20110.
instance49 has 4 resources, 100 machines, 288 periods and 5000 tasks with a search space of 10^20078.</pre>
					</p></div></section><section class="section" id="ex-investment-ref"><div class="titlepage"><div><div><h2 class="title">3.20. Investment asset class allocation (Portfolio Optimization)</h2></div></div></div><p>
					Decide the relative quantity to invest in each asset class.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Risk maximum: the total standard deviation must not be higher than the standard deviation maximum.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Total standard deviation calculation takes asset class correlations into account by applying <a class="link" href="https://en.wikipedia.org/wiki/Modern_portfolio_theory">Markowitz Portfolio Theory</a>.
								</li></ul></div></li><li class="listitem">
							Region maximum: Each region has a quantity maximum.
						</li><li class="listitem">
							Sector maximum: Each sector has a quantity maximum.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Maximize expected return.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">de_smet_1 has 1 regions, 3 sectors and 11 asset classes with a search space of 10^4.
irrinki_1 has 2 regions, 3 sectors and 6 asset classes with a search space of 10^3.</pre>
					</p></div><p>
					Larger datasets have not been created or tested yet, but should not pose a problem. A good source of data is <a class="link" href="https://www.portfoliovisualizer.com/asset-correlations">this Asset Correlation website</a>.
				</p></section><section class="section" id="ex-conferenceScheduling-ref"><div class="titlepage"><div><div><h2 class="title">3.21. Conference scheduling</h2></div></div></div><p>
					Assign each conference talk to a timeslot and a room. Timeslots can overlap. Read and write to and from an <code class="literal">*.xlsx</code> file that can be edited with LibreOffice or Excel.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Talk type of timeslot: The type of a talk must match the timeslot’s talk type.
						</li><li class="listitem">
							Room unavailable timeslots: A talk’s room must be available during the talk’s timeslot.
						</li><li class="listitem">
							Room conflict: Two talks can’t use the same room during overlapping timeslots.
						</li><li class="listitem">
							Speaker unavailable timeslots: Every talk’s speaker must be available during the talk’s timeslot.
						</li><li class="listitem">
							Speaker conflict: Two talks can’t share a speaker during overlapping timeslots.
						</li><li class="listitem"><p class="simpara">
							Generic purpose timeslot and room tags:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Speaker required timeslot tag: If a speaker has a required timeslot tag, then all of his or her talks must be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Speaker prohibited timeslot tag: If a speaker has a prohibited timeslot tag, then all of his or her talks cannot be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Talk required timeslot tag: If a talk has a required timeslot tag, then it must be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Talk prohibited timeslot tag: If a talk has a prohibited timeslot tag, then it cannot be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Speaker required room tag: If a speaker has a required room tag, then all of his or her talks must be assigned to a room with that tag.
								</li><li class="listitem">
									Speaker prohibited room tag: If a speaker has a prohibited room tag, then all of his or her talks cannot be assigned to a room with that tag.
								</li><li class="listitem">
									Talk required room tag: If a talk has a required room tag, then it must be assigned to a room with that tag.
								</li><li class="listitem">
									Talk prohibited room tag: If a talk has a prohibited room tag, then it cannot be assigned to a room with that tag.
								</li></ul></div></li><li class="listitem">
							Talk mutually-exclusive-talks tag: Talks that share such a tag must not be scheduled in overlapping timeslots.
						</li><li class="listitem">
							Talk prerequisite talks: A talk must be scheduled after all its prerequisite talks.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Theme track conflict: Minimize the number of talks that share a theme tag during overlapping timeslots.
						</li><li class="listitem">
							Sector conflict: Minimize the number of talks that share a same sector tag during overlapping timeslots.
						</li><li class="listitem">
							Content audience level flow violation: For every content tag, schedule the introductory talks before the advanced talks.
						</li><li class="listitem">
							Audience level diversity: For every timeslot, maximize the number of talks with a different audience level.
						</li><li class="listitem">
							Language diversity: For every timeslot, maximize the number of talks with a different language.
						</li><li class="listitem"><p class="simpara">
							Generic purpose timeslot and room tags:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Speaker preferred timeslot tag: If a speaker has a preferred timeslot tag, then all of his or her talks should be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Speaker undesired timeslot tag: If a speaker has an undesired timeslot tag, then none of his or her talks should be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Talk preferred timeslot tag: If a talk has a preferred timeslot tag, then it should be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Talk undesired timeslot tag: If a talk has an undesired timeslot tag, then it should not be assigned to a timeslot with that tag.
								</li><li class="listitem">
									Speaker preferred room tag: If a speaker has a preferred room tag, then all of his or her talks should be assigned to a room with that tag.
								</li><li class="listitem">
									Speaker undesired room tag: If a speaker has an undesired room tag, then none of his or her talks should be assigned to a room with that tag.
								</li><li class="listitem">
									Talk preferred room tag: If a talk has a preferred room tag, then it should be assigned to a room with that tag.
								</li><li class="listitem">
									Talk undesired room tag: If a talk has an undesired room tag, then it should not be assigned to a room with that tag.
								</li></ul></div></li><li class="listitem">
							Same day talks: All talks that share a theme tag or content tag should be scheduled in the minimum number of days (ideally in the same day).
						</li></ul></div><div class="figure" id="idm45892290943184"><p class="title"><strong>Figure 3.14. Value proposition</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/UseCasesAndExamples/ConferenceScheduling/conferenceSchedulingValueProposition.png" alt="conferenceSchedulingValueProposition"/></div></div></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">18talks-6timeslots-5rooms    has  18 talks,  6 timeslots and  5 rooms with a search space of  10^26.
36talks-12timeslots-5rooms   has  36 talks, 12 timeslots and  5 rooms with a search space of  10^64.
72talks-12timeslots-10rooms  has  72 talks, 12 timeslots and 10 rooms with a search space of 10^149.
108talks-18timeslots-10rooms has 108 talks, 18 timeslots and 10 rooms with a search space of 10^243.
216talks-18timeslots-20rooms has 216 talks, 18 timeslots and 20 rooms with a search space of 10^552.</pre>
					</p></div></section><section class="section" id="ex-rockTour-ref"><div class="titlepage"><div><div><h2 class="title">3.22. Rock tour</h2></div></div></div><p>
					Drive the rock bank bus from show to show, but schedule shows only on available days.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Schedule every required show.
						</li><li class="listitem">
							Schedule as many shows as possible.
						</li></ul></div><p>
					Medium constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Maximize revenue opportunity.
						</li><li class="listitem">
							Minimize driving time.
						</li><li class="listitem">
							Visit sooner than later.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Avoid long driving times.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">47shows has 47 shows with a search space of 10^59.</pre>
					</p></div></section><section class="section" id="ex-flightCrewScheduling-ref"><div class="titlepage"><div><div><h2 class="title">3.23. Flight crew scheduling</h2></div></div></div><p>
					Assign flights to pilots and flight attendants.
				</p><p>
					Hard constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Required skill: each flight assignment has a required skill. For example, flight AB0001 requires 2 pilots and 3 flight attendants.
						</li><li class="listitem">
							Flight conflict: each employee can only attend one flight at the same time
						</li><li class="listitem">
							Transfer between two flights: between two flights, an employee must be able to transfer from the arrival airport to the departure airport. For example, Ann arrives in Brussels at 10:00 and departs in Amsterdam at 15:00.
						</li><li class="listitem">
							Employee unavailability: the employee must be available on the day of the flight. For example, Ann is on PTO on 1-Feb.
						</li></ul></div><p>
					Soft constraints:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							First assignment departing from home
						</li><li class="listitem">
							Last assignment arriving at home
						</li><li class="listitem">
							Load balance flight duration total per employee
						</li></ul></div><div class="formalpara"><p class="title"><strong>Problem size</strong></p><p>
						
<pre class="screen">175flights-7days-Europe  has 2 skills, 50 airports, 150 employees, 175 flights and  875 flight assignments with a search space of  10^1904.
700flights-28days-Europe has 2 skills, 50 airports, 150 employees, 700 flights and 3500 flight assignments with a search space of  10^7616.
875flights-7days-Europe  has 2 skills, 50 airports, 750 employees, 875 flights and 4375 flight assignments with a search space of 10^12578.
175flights-7days-US      has 2 skills, 48 airports, 150 employees, 175 flights and  875 flight assignments with a search space of  10^1904.</pre>
					</p></div></section></section><section class="chapter" id="examples-download-proc"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Downloading Red Hat build of OptaPlanner examples</h2></div></div></div><p>
				You can download the Red Hat build of OptaPlanner examples as a part of the Red Hat Decision Manager add-ons package available on the Red Hat Customer Portal.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Product: Decision Manager
							</li><li class="listitem">
								Version: 7.13
							</li></ul></div></li><li class="listitem">
						Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13 Add Ons</strong></span>.
					</li><li class="listitem">
						Extract the <code class="literal">rhdm-7.13.0-add-ons.zip</code> file. The extracted <code class="literal">add-ons</code> folder contains the <code class="literal">rhdm-7.13.0-planner-engine.zip</code> file.
					</li><li class="listitem">
						Extract the <code class="literal">rhdm-7.13.0-planner-engine.zip</code> file.
					</li></ol></div><div class="formalpara"><p class="title"><strong>Result</strong></p><p>
					The extracted <code class="literal">rhdm-7.13.0-planner-engine</code> directory contains example source code under the following subdirectories:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">examples/sources/src/main/java/org/optaplanner/examples</code>
					</li><li class="listitem">
						<code class="literal">examples/sources/src/main/resources/org/optaplanner/examples</code>
					</li></ul></div><section class="section" id="optimizer-running-the-examples-proc"><div class="titlepage"><div><div><h2 class="title">4.1. Running OptaPlanner examples</h2></div></div></div><p>
					Red Hat build of OptaPlanner includes several examples that demonstrate a variety of planning use cases. Download and use the examples to explore different types of planning solutions.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have downloaded and extracted the examples as described in <a class="xref" href="#examples-download-proc" title="Chapter 4. Downloading Red Hat build of OptaPlanner examples">Chapter 4, <em>Downloading Red Hat build of OptaPlanner examples</em></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To run the examples, in the <code class="literal">rhdm-7.13.0-planner-engine/examples</code> directory enter one of the following commands:
						</p><p class="simpara">
							Linux or Mac:
						</p><pre class="screen">$ ./runExamples.sh</pre><p class="simpara">
							Windows:
						</p><pre class="screen">$ runExamples.bat</pre><p class="simpara">
							The OptaPlanner Examples window opens.
						</p></li><li class="listitem">
							Select an example to run that example.
						</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Red Hat build of OptaPlanner has no GUI dependencies. It runs just as well on a server or a mobile JVM as it does on the desktop.
					</p></div></div></section><section class="section" id="optimizer-running-the-examples-in-an-IDE-proc"><div class="titlepage"><div><div><h2 class="title">4.2. Running the Red Hat build of OptaPlanner examples in an IDE (IntelliJ, Eclipse, or Netbeans)</h2></div></div></div><p>
					If you use an integrated development environment (IDE), such as IntelliJ, Eclipse, or Netbeans, you can run your downloaded OptaPlanner examples within your development environment.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have downloaded and extracted the OptaPlanner examples as described in <a class="xref" href="#examples-download-proc" title="Chapter 4. Downloading Red Hat build of OptaPlanner examples">Chapter 4, <em>Downloading Red Hat build of OptaPlanner examples</em></a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Open the OptaPlanner examples as a new project:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									For IntelliJ or Netbeans, open <code class="literal">examples/sources/pom.xml</code> as the new project. The Maven integration guides you through the rest of the installation. Skip the rest of the steps in this procedure.
								</li><li class="listitem">
									For Eclipse, open a new project for the <code class="literal">/examples/binaries</code> directory, located under the <code class="literal">rhdm-7.13.0-planner-engine</code> directory.
								</li></ol></div></li><li class="listitem">
							Add all the JAR files that are in the <code class="literal">binaries</code> directory to the classpath, except for the <code class="literal">examples/binaries/optaplanner-examples-7.67.0.Final-redhat-00006.jar</code> file.
						</li><li class="listitem">
							Add the Java source directory <code class="literal">src/main/java</code> and the Java resources directory <code class="literal">src/main/resources</code>, located under the <code class="literal">rhdm-7.13.0-planner-engine/examples/sources/</code> directory.
						</li><li class="listitem"><p class="simpara">
							Create a run configuration:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Main class: <code class="literal">org.optaplanner.examples.app.OptaPlannerExamplesApp</code>
								</li><li class="listitem">
									VM parameters (optional): <code class="literal">-Xmx512M -server -Dorg.optaplanner.examples.dataDir=examples/sources/data</code>
								</li><li class="listitem">
									Working directory: <code class="literal">examples/sources</code>
								</li></ul></div></li><li class="listitem">
							Run the run configuration.
						</li></ol></div></section></section><section class="chapter" id="workbench-er-tutorial-con"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Getting started with OptaPlanner in Business Central: An employee rostering example</h2></div></div></div><p>
				You can build and deploy the <code class="literal">employee-rostering</code> sample project in Business Central. The project demonstrates how to create each of the Business Central assets required to solve the shift rostering planning problem and use Red Hat build of OptaPlanner to find the best possible solution.
			</p><p>
				You can deploy the preconfigured <code class="literal">employee-rostering</code> project in Business Central. Alternatively, you can create the project yourself using Business Central.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">employee-rostering</code> sample project in Business Central does not include a data set. You must supply a data set in XML format using a REST API call.
				</p></div></div><section class="section" id="wb-employee-rostering-example-deploying-in-central-proc"><div class="titlepage"><div><div><h2 class="title">5.1. Deploying the employee rostering sample project in Business Central</h2></div></div></div><p>
					Business Central includes a number of sample projects that you can use to get familiar with the product and its features. The employee rostering sample project is designed and created to demonstrate the shift rostering use case for Red Hat build of OptaPlanner. Use the following procedure to deploy and run the employee rostering sample in Business Central.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat Decision Manager has been downloaded and installed. For installation options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/installing_and_configuring_red_hat_decision_manager#assembly-planning"><span class="emphasis"><em>Planning a Red Hat Decision Manager installation</em></span></a>.
						</li><li class="listitem">
							You have started Red Hat Decision Manager, as described the installation documentation, and you are logged in to Business Central as a user with <code class="literal">admin</code> permissions.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In Business Central, click <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span>.
						</li><li class="listitem">
							In the preconfigured <code class="literal">MySpace</code> space, click <span class="strong strong"><strong>Try Samples</strong></span>.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>employee-rostering</strong></span> from the list of sample projects and click <span class="strong strong"><strong>Ok</strong></span> in the upper-right corner to import the project.
						</li><li class="listitem">
							After the asset list has complied, click <span class="strong strong"><strong>Build &amp; Deploy</strong></span> to deploy the employee rostering example.
						</li></ol></div><p>
					The rest of this document explains each of the project assets and their configuration.
				</p></section><section class="section" id="wb-employee-rostering-example-recreate-con"><div class="titlepage"><div><div><h2 class="title">5.2. Re-creating the employee rostering sample project</h2></div></div></div><p>
					The employee rostering sample project is a preconfigured project available in Business Central. You can learn about how to deploy this project in <a class="xref" href="#wb-employee-rostering-example-deploying-in-central-proc" title="5.1. Deploying the employee rostering sample project in Business Central">Section 5.1, “Deploying the employee rostering sample project in Business Central”</a>.
				</p><p>
					You can create the employee rostering example "from scratch". You can use the workflow in this example to create a similar project of your own in Business Central.
				</p><section class="section" id="wb-employee-rostering-example-setup-proc"><div class="titlepage"><div><div><h3 class="title">5.2.1. Setting up the employee rostering project</h3></div></div></div><p>
						To start developing a solver in Business Central, you must set up the project.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat Decision Manager has been downloaded and installed.
							</li><li class="listitem">
								You have deployed Business Central and logged in with a user that has the <code class="literal">admin</code> role.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Create a new project in Business Central by clicking <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> → <span class="strong strong"><strong>Add Project</strong></span>.
							</li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Add Project</strong></span> window, fill out the following fields:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Name</strong></span>: <code class="literal">employee-rostering</code>
									</li><li class="listitem">
										<span class="strong strong"><strong>Description</strong></span>(optional): Employee rostering problem optimization using OptaPlanner. Assigns employees to shifts based on their skill.
									</li></ul></div><p class="simpara">
								Optional: Click <span class="strong strong"><strong>Configure Advanced Options</strong></span> to populate the <code class="literal">Group ID</code>, <code class="literal">Artifact ID</code>, and <code class="literal">Version</code> information.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Group ID</strong></span>: <code class="literal">employeerostering</code>
									</li><li class="listitem">
										<span class="strong strong"><strong>Artifact ID</strong></span>: <code class="literal">employeerostering</code>
									</li><li class="listitem">
										<span class="strong strong"><strong>Version</strong></span>: <code class="literal">1.0.0-SNAPSHOT</code>
									</li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> to add the project to the Business Central project repository.
							</li></ol></div></section><section class="section" id="wb-employee-rostering-facts-vs-entities-con"><div class="titlepage"><div><div><h3 class="title">5.2.2. Problem facts and planning entities</h3></div></div></div><p>
						Each of the domain classes in the employee rostering planning problem is categorized as one of the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								An unrelated class: not used by any of the score constraints. From a planning standpoint, this data is obsolete.
							</li><li class="listitem">
								A <span class="emphasis"><em>problem fact</em></span> class: used by the score constraints, but does not change during planning (as long as the problem stays the same), for example, <code class="literal">Shift</code> and <code class="literal">Employee</code>. All the properties of a problem fact class are problem properties.
							</li><li class="listitem"><p class="simpara">
								A <span class="emphasis"><em>planning entity</em></span> class: used by the score constraints and changes during planning, for example, <code class="literal">ShiftAssignment</code>. The properties that change during planning are <span class="emphasis"><em>planning variables</em></span>. The other properties are problem properties.
							</p><p class="simpara">
								Ask yourself the following questions:
							</p></li><li class="listitem">
								<span class="emphasis"><em>What class changes during planning?</em></span>
							</li><li class="listitem"><p class="simpara">
								<span class="emphasis"><em>Which class has variables that I want the <code class="literal">Solver</code> to change?</em></span>
							</p><p class="simpara">
								That class is a planning entity.
							</p><p class="simpara">
								A planning entity class needs to be annotated with the <code class="literal">@PlanningEntity</code> annotation, or defined in Business Central using the Red Hat build of OptaPlanner dock in the domain designer.
							</p><p class="simpara">
								Each planning entity class has one or more <span class="emphasis"><em>planning variables</em></span>, and must also have one or more defining properties.
							</p><p class="simpara">
								Most use cases have only one planning entity class, and only one planning variable per planning entity class.
							</p></li></ul></div></section><section class="section" id="wb-employee-rostering-data-model-proc"><div class="titlepage"><div><div><h3 class="title">5.2.3. Creating the data model for the employee rostering project</h3></div></div></div><p>
						Use this section to create the data objects required to run the employee rostering sample project in Business Central.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have completed the project setup described in <a class="xref" href="#wb-employee-rostering-example-setup-proc" title="5.2.1. Setting up the employee rostering project">Section 5.2.1, “Setting up the employee rostering project”</a>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								With your new project, either click <span class="strong strong"><strong>Data Object</strong></span> in the project perspective, or click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Data Object</strong></span> to create a new data object.
							</li><li class="listitem"><p class="simpara">
								Name the first data object <code class="literal">Timeslot</code>, and select <code class="literal">employeerostering.employeerostering</code> as the <span class="strong strong"><strong>Package</strong></span>.
							</p><p class="simpara">
								Click <span class="strong strong"><strong>Ok</strong></span>.
							</p></li><li class="listitem">
								In the <span class="strong strong"><strong>Data Objects</strong></span> perspective, click <span class="strong strong"><strong>+add field</strong></span> to add fields to the <code class="literal">Timeslot</code> data object.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>id</strong></span> field, type <code class="literal">endTime</code>.
							</li><li class="listitem">
								Click the drop-down menu next to <span class="strong strong"><strong>Type</strong></span> and select <code class="literal">LocalDateTime</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create and continue</strong></span> to add another field.
							</li><li class="listitem">
								Add another field with the <span class="strong strong"><strong>id</strong></span> <code class="literal">startTime</code> and <span class="strong strong"><strong>Type</strong></span> <code class="literal">LocalDateTime</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> in the upper-right corner to save the <code class="literal">Timeslot</code> data object.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>x</strong></span> in the upper-right corner to close the <span class="strong strong"><strong>Data Objects</strong></span> perspective and return to the <span class="strong strong"><strong>Assets</strong></span> menu.
							</li><li class="listitem"><p class="simpara">
								Using the previous steps, create the following data objects and their attributes:
							</p><div class="table" id="idm45892289090864"><p class="title"><strong>Table 5.1. Skill</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892289086032" scope="col">id</th><th align="left" valign="top" id="idm45892289084944" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892289086032">
											<p>
												<code class="literal">name</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892289084944">
											<p>
												<code class="literal">String</code>
											</p>
											</td></tr></tbody></table></div></div><div class="table" id="idm45892294419824"><p class="title"><strong>Table 5.2. Employee</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892294414992" scope="col">id</th><th align="left" valign="top" id="idm45892302319152" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892294414992">
											<p>
												<code class="literal">name</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892302319152">
											<p>
												<code class="literal">String</code>
											</p>
											</td></tr><tr><td align="left" valign="top" headers="idm45892294414992">
											<p>
												<code class="literal">skills</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892302319152">
											<p>
												<code class="literal">employeerostering.employeerostering.Skill[List]</code>
											</p>
											</td></tr></tbody></table></div></div><div class="table" id="idm45892288719840"><p class="title"><strong>Table 5.3. Shift</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892288715008" scope="col">id</th><th align="left" valign="top" id="idm45892288713920" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892288715008">
											<p>
												<code class="literal">requiredSkill</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892288713920">
											<p>
												<code class="literal">employeerostering.employeerostering.Skill</code>
											</p>
											</td></tr><tr><td align="left" valign="top" headers="idm45892288715008">
											<p>
												<code class="literal">timeslot</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892288713920">
											<p>
												<code class="literal">employeerostering.employeerostering.Timeslot</code>
											</p>
											</td></tr></tbody></table></div></div><div class="table" id="idm45892287712800"><p class="title"><strong>Table 5.4. DayOffRequest</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892286292480" scope="col">id</th><th align="left" valign="top" id="idm45892286291392" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892286292480">
											<p>
												<code class="literal">date</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892286291392">
											<p>
												<code class="literal">LocalDate</code>
											</p>
											</td></tr><tr><td align="left" valign="top" headers="idm45892286292480">
											<p>
												<code class="literal">employee</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892286291392">
											<p>
												<code class="literal">employeerostering.employeerostering.Employee</code>
											</p>
											</td></tr></tbody></table></div></div><div class="table" id="idm45892294276560"><p class="title"><strong>Table 5.5. ShiftAssignment</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892294271728" scope="col">id</th><th align="left" valign="top" id="idm45892294270640" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892294271728">
											<p>
												<code class="literal">employee</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892294270640">
											<p>
												<code class="literal">employeerostering.employeerostering.Employee</code>
											</p>
											</td></tr><tr><td align="left" valign="top" headers="idm45892294271728">
											<p>
												<code class="literal">shift</code>
											</p>
											</td><td align="left" valign="top" headers="idm45892294270640">
											<p>
												<code class="literal">employeerostering.employeerostering.Shift</code>
											</p>
											</td></tr></tbody></table></div></div></li></ol></div><p>
						For more examples of creating data objects, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/getting_started_with_red_hat_decision_manager#assembly-getting-started-decision-services"><span class="emphasis"><em>Getting started with decision services</em></span></a>.
					</p><section class="section" id="wb-employee-rostering-planning-entity-proc"><div class="titlepage"><div><div><h4 class="title">5.2.3.1. Creating the employee roster planning entity</h4></div></div></div><p>
							In order to solve the employee rostering planning problem, you must create a planning entity and a solver. The planning entity is defined in the domain designer using the attributes available in the Red Hat build of OptaPlanner dock.
						</p><p>
							Use the following procedure to define the <code class="literal">ShiftAssignment</code> data object as the planning entity for the employee rostering example.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have created the relevant data objects and planning entity required to run the employee rostering example by completing the procedures in <a class="xref" href="#wb-employee-rostering-data-model-proc" title="5.2.3. Creating the data model for the employee rostering project">Section 5.2.3, “Creating the data model for the employee rostering project”</a>.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									From the project <span class="strong strong"><strong>Assets</strong></span> menu, open the <code class="literal">ShiftAssignment</code> data object.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Data Objects</strong></span> perspective, open the OptaPlanner dock by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/optimizer-icon.png" alt="OptaPlanner icon"/></span>
									 on the right.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Planning Entity</strong></span>.
								</li><li class="listitem">
									Select <code class="literal">employee</code> from the list of fields under the <code class="literal">ShiftAssignment</code> data object.
								</li><li class="listitem"><p class="simpara">
									In the OptaPlanner dock, select <span class="strong strong"><strong>Planning Variable</strong></span>.
								</p><p class="simpara">
									In the <span class="strong strong"><strong>Value Range Id</strong></span> input field, type <code class="literal">employeeRange</code>. This adds the <code class="literal">@ValueRangeProvider</code> annotation to the planning entity, which you can view by clicking the <code class="literal">Source</code> tab in the designer.
								</p><p class="simpara">
									The value range of a planning variable is defined with the <code class="literal">@ValueRangeProvider</code> annotation. A <code class="literal">@ValueRangeProvider</code> annotation always has a property <code class="literal">id</code>, which is referenced by the <code class="literal">@PlanningVariable</code> property <code class="literal">valueRangeProviderRefs</code>.
								</p></li><li class="listitem">
									Close the dock and click <span class="strong strong"><strong>Save</strong></span> to save the data object.
								</li></ol></div></section><section class="section" id="wb-employee-rostering-planning-solution-proc"><div class="titlepage"><div><div><h4 class="title">5.2.3.2. Creating the employee roster planning solution</h4></div></div></div><p>
							The employee roster problem relies on a defined planning solution. The planning solution is defined in the domain designer using the attributes available in the Red Hat build of OptaPlanner dock.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									You have created the relevant data objects and planning entity required to run the employee rostering example by completing the procedures in <a class="xref" href="#wb-employee-rostering-data-model-proc" title="5.2.3. Creating the data model for the employee rostering project">Section 5.2.3, “Creating the data model for the employee rostering project”</a> and <a class="xref" href="#wb-employee-rostering-planning-entity-proc" title="5.2.3.1. Creating the employee roster planning entity">Section 5.2.3.1, “Creating the employee roster planning entity”</a>.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Create a new data object with the identifier <code class="literal">EmployeeRoster</code>.
								</li><li class="listitem"><p class="simpara">
									Create the following fields:
								</p><div class="table" id="idm45892296897424"><p class="title"><strong>Table 5.6. EmployeeRoster</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892296892592" scope="col">id</th><th align="left" valign="top" id="idm45892296891504" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892296892592">
												<p>
													<code class="literal">dayOffRequestList</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892296891504">
												<p>
													<code class="literal">employeerostering.employeerostering.DayOffRequest[List]</code>
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892296892592">
												<p>
													<code class="literal">shiftAssignmentList</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892296891504">
												<p>
													<code class="literal">employeerostering.employeerostering.ShiftAssignment[List]</code>
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892296892592">
												<p>
													<code class="literal">shiftList</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892296891504">
												<p>
													<code class="literal">employeerostering.employeerostering.Shift[List]</code>
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892296892592">
												<p>
													<code class="literal">skillList</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892296891504">
												<p>
													<code class="literal">employeerostering.employeerostering.Skill[List]</code>
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892296892592">
												<p>
													<code class="literal">timeslotList</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892296891504">
												<p>
													<code class="literal">employeerostering.employeerostering.Timeslot[List]</code>
												</p>
												</td></tr></tbody></table></div></div></li><li class="listitem">
									In the <span class="strong strong"><strong>Data Objects</strong></span> perspective, open the OptaPlanner dock by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/optimizer-icon.png" alt="OptaPlanner icon"/></span>
									 on the right.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Planning Solution</strong></span>.
								</li><li class="listitem">
									Leave the default <code class="literal">Hard soft score</code> as the <span class="strong strong"><strong>Solution Score Type</strong></span>. This automatically generates a <code class="literal">score</code> field in the <code class="literal">EmployeeRoster</code> data object with the solution score as the type.
								</li><li class="listitem"><p class="simpara">
									Add a new field with the following attributes:
								</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892296413392" scope="col">id</th><th align="left" valign="top" id="idm45892296412304" scope="col">Type</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892296413392">
												<p>
													<code class="literal">employeeList</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892296412304">
												<p>
													<code class="literal">employeerostering.employeerostering.Employee[List]</code>
												</p>
												</td></tr></tbody></table></div></li><li class="listitem"><p class="simpara">
									With the <code class="literal">employeeList</code> field selected, open the OptaPlanner dock and select the <span class="strong strong"><strong>Planning Value Range Provider</strong></span> box.
								</p><p class="simpara">
									In the <span class="strong strong"><strong>id</strong></span> field, type <code class="literal">employeeRange</code>. Close the dock.
								</p></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> in the upper-right corner to save the asset.
								</li></ol></div></section></section><section class="section" id="wb-employee-rostering-constraints-con"><div class="titlepage"><div><div><h3 class="title">5.2.4. Employee rostering constraints</h3></div></div></div><p>
						Employee rostering is a planning problem. All planning problems include constraints that must be satisfied in order to find an optimal solution.
					</p><p>
						The employee rostering sample project in Business Central includes the following hard and soft constraints:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Hard constraint</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Employees are only assigned one shift per day.
										</li><li class="listitem">
											All shifts that require a particular employee skill are assigned an employee with that particular skill.
										</li></ul></div></dd><dt><span class="term">Soft constraints</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											All employees are assigned a shift.
										</li><li class="listitem">
											If an employee requests a day off, their shift is reassigned to another employee.
										</li></ul></div></dd></dl></div><p>
						Hard and soft constraints are defined in Business Central using either the free-form DRL designer, or using guided rules.
					</p><section class="section" id="drl-rules-con_getting-started-optaplanner"><div class="titlepage"><div><div><h4 class="title">5.2.4.1. DRL (Drools Rule Language) rules</h4></div></div></div><p>
							DRL (Drools Rule Language) rules are business rules that you define directly in <code class="literal">.drl</code> text files. These DRL files are the source in which all other rule assets in Business Central are ultimately rendered. You can create and manage DRL files within the Business Central interface, or create them externally as part of a Maven or Java project using Red Hat CodeReady Studio or another integrated development environment (IDE). A DRL file can contain one or more rules that define at a minimum the rule conditions (<code class="literal">when</code>) and actions (<code class="literal">then</code>). The DRL designer in Business Central provides syntax highlighting for Java, DRL, and XML.
						</p><p>
							DRL files consist of the following components:
						</p><div class="formalpara"><p class="title"><strong>Components in a DRL file</strong></p><p>
								
<pre class="screen">package

import

function  // Optional

query  // Optional

declare   // Optional

global   // Optional

rule "rule name"
    // Attributes
    when
        // Conditions
    then
        // Actions
end

rule "rule2 name"

...</pre>
							</p></div><p>
							The following example DRL rule determines the age limit in a loan application decision service:
						</p><div class="formalpara"><p class="title"><strong>Example rule for loan application age limit</strong></p><p>
								
<pre class="screen">rule "Underage"
  salience 15
  agenda-group "applicationGroup"
  when
    $application : LoanApplication()
    Applicant( age &lt; 21 )
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</pre>
							</p></div><p>
							A DRL file can contain single or multiple rules, queries, and functions, and can define resource declarations such as imports, globals, and attributes that are assigned and used by your rules and queries. The DRL package must be listed at the top of a DRL file and the rules are typically listed last. All other DRL components can follow any order.
						</p><p>
							Each rule must have a unique name within the rule package. If you use the same rule name more than once in any DRL file in the package, the rules fail to compile. Always enclose rule names with double quotation marks (<code class="literal">rule "rule name"</code>) to prevent possible compilation errors, especially if you use spaces in rule names.
						</p><p>
							All data objects related to a DRL rule must be in the same project package as the DRL file in Business Central. Assets in the same package are imported by default. Existing assets in other packages can be imported with the DRL rule.
						</p></section><section class="section" id="wb-employee-rostering-optimizer-drools-rules-proc"><div class="titlepage"><div><div><h4 class="title">5.2.4.2. Defining constraints for employee rostering using the DRL designer</h4></div></div></div><p>
							You can create constraint definitions for the employee rostering example using the free-form DRL designer in Business Central.
						</p><p>
							Use this procedure to create a <span class="emphasis"><em>hard constraint</em></span> where no employee is assigned a shift that begins less than 10 hours after their previous shift ended.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>DRL file</strong></span>.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>DRL file</strong></span> name field, type <code class="literal">ComplexScoreRules</code>.
								</li><li class="listitem">
									Select the <code class="literal">employeerostering.employeerostering</code> package.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>+Ok</strong></span> to create the DRL file.
								</li><li class="listitem"><p class="simpara">
									In the <span class="strong strong"><strong>Model</strong></span> tab of the DRL designer, define the <code class="literal">Employee10HourShiftSpace</code> rule as a DRL file:
								</p><pre class="screen">package employeerostering.employeerostering;

rule "Employee10HourShiftSpace"
    when
        $shiftAssignment : ShiftAssignment( $employee : employee != null, $shiftEndDateTime : shift.timeslot.endTime)
        ShiftAssignment( this != $shiftAssignment, $employee == employee, $shiftEndDateTime &lt;= shift.timeslot.endTime,
                $shiftEndDateTime.until(shift.timeslot.startTime, java.time.temporal.ChronoUnit.HOURS) &lt;10)
    then
        scoreHolder.addHardConstraintMatch(kcontext, -1);
end</pre></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to save the DRL file.
								</li></ol></div><p>
							For more information about creating DRL files, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/developing_decision_services_in_red_hat_decision_manager#assembly-drl-rules"><span class="emphasis"><em>Designing a decision service using DRL rules</em></span></a>.
						</p></section></section><section class="section" id="wb-employee-rostering-guided-rule-editor-proc"><div class="titlepage"><div><div><h3 class="title">5.2.5. Creating rules for employee rostering using guided rules</h3></div></div></div><p>
						You can create rules that define hard and soft constraints for employee rostering using the guided rules designer in Business Central.
					</p><section class="section" id="guided-rules-con_getting-started-optaplanner"><div class="titlepage"><div><div><h4 class="title">5.2.5.1. Guided rules</h4></div></div></div><p>
							Guided rules are business rules that you create in a UI-based guided rules designer in Business Central that leads you through the rule-creation process. The guided rules designer provides fields and options for acceptable input based on the data objects for the rule being defined. The guided rules that you define are compiled into Drools Rule Language (DRL) rules as with all other rule assets.
						</p><p>
							All data objects related to a guided rule must be in the same project package as the guided rule. Assets in the same package are imported by default. After you create the necessary data objects and the guided rule, you can use the <span class="strong strong"><strong>Data Objects</strong></span> tab of the guided rules designer to verify that all required data objects are listed or to import other existing data objects by adding a <span class="strong strong"><strong>New item</strong></span>.
						</p></section><section class="section" id="wb-employee-rostering-balance-employees-shift-rule-proc"><div class="titlepage"><div><div><h4 class="title">5.2.5.2. Creating a guided rule to balance employee shift numbers</h4></div></div></div><p>
							The <code class="literal">BalanceEmployeesShiftNumber</code> guided rule creates a soft constraint that ensures shifts are assigned to employees in a way that is balanced as evenly as possible. It does this by creating a score penalty that increases when shift distribution is less even. The score formula, implemented by the rule, incentivizes the Solver to distribute shifts in a more balanced way.
						</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/employee-rostering/BalanceEmployeesShiftNumber.png" alt="BalanceEmployeesShiftNumber Guided Rule"/></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Rule</strong></span>.
								</li><li class="listitem">
									Enter <code class="literal">BalanceEmployeesShiftNumber</code> as the <span class="strong strong"><strong>Guided Rule</strong></span> name and select the <code class="literal">employeerostering.employeerostering</code> <span class="strong strong"><strong>Package</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Ok</strong></span> to create the rule asset.
								</li><li class="listitem">
									Add a <span class="strong strong"><strong>WHEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>WHEN</strong></span> field.
								</li><li class="listitem">
									Select <code class="literal">Employee</code> in the <span class="strong strong"><strong>Add a condition to the rule</strong></span> window. Click <span class="strong strong"><strong>+Ok</strong></span>.
								</li><li class="listitem">
									Click the <code class="literal">Employee</code> condition to modify the constraints and add the variable name <code class="literal">$employee</code>.
								</li><li class="listitem"><p class="simpara">
									Add the <span class="strong strong"><strong>WHEN</strong></span> condition <code class="literal">From Accumulate</code>.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Above the <code class="literal">From Accumulate</code> condition, click <span class="strong strong"><strong>click to add pattern</strong></span> and select <code class="literal">Number</code> as the fact type from the drop-down list.
										</li><li class="listitem">
											Add the variable name <code class="literal">$shiftCount</code> to the <code class="literal">Number</code> condition.
										</li><li class="listitem">
											Below the <code class="literal">From Accumulate</code> condition, click <span class="strong strong"><strong>click to add pattern</strong></span> and select the <code class="literal">ShiftAssignment</code> fact type from the drop-down list.
										</li><li class="listitem">
											Add the variable name <code class="literal">$shiftAssignment</code> to the <code class="literal">ShiftAssignment</code> fact type.
										</li><li class="listitem">
											Click the <code class="literal">ShiftAssignment</code> condition again and from the <span class="strong strong"><strong>Add a restriction on a field</strong></span> drop-down list, select <code class="literal">employee</code>.
										</li><li class="listitem">
											Select <code class="literal">equal to</code> from the drop-down list next to the <code class="literal">employee</code> constraint.
										</li><li class="listitem">
											Click the 
											<span class="inlinemediaobject"><img src="images/_images/employee-rostering/6191.png" alt="edit"/></span>
											 icon next to the drop-down button to add a variable, and click <span class="strong strong"><strong>Bound variable</strong></span> in the <span class="strong strong"><strong>Field value</strong></span> window.
										</li><li class="listitem">
											Select <code class="literal">$employee</code> from the drop-down list.
										</li><li class="listitem">
											In the <span class="strong strong"><strong>Function</strong></span> box type <code class="literal">count($shiftAssignment)</code>.
										</li></ol></div></li><li class="listitem">
									Add the <span class="strong strong"><strong>THEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>THEN</strong></span> field.
								</li><li class="listitem"><p class="simpara">
									Select <code class="literal">Modify Soft Score</code> in the <span class="strong strong"><strong>Add a new action</strong></span> window. Click <span class="strong strong"><strong>+Ok</strong></span>.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Type the following expression into the box: <code class="literal">-($shiftCount.intValue()*$shiftCount.intValue())</code>
										</li></ol></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Validate</strong></span> in the upper-right corner to check all rule conditions are valid. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to save the rule.
								</li></ol></div><p>
							For more information about creating guided rules, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/developing_decision_services_in_red_hat_decision_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>.
						</p></section><section class="section" id="wb-employee-rostering-one-shift-per-day-rule-proc"><div class="titlepage"><div><div><h4 class="title">5.2.5.3. Creating a guided rule for no more than one shift per day</h4></div></div></div><p>
							The <code class="literal">OneEmployeeShiftPerDay</code> guided rule creates a hard constraint that employees are not assigned more than one shift per day. In the employee rostering example, this constraint is created using the guided rule designer.
						</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/employee-rostering/OneEmployeeShiftPerDay.png" alt="OneEmployeeShiftPerDay Guided Rule"/></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Rule</strong></span>.
								</li><li class="listitem">
									Enter <code class="literal">OneEmployeeShiftPerDay</code> as the <span class="strong strong"><strong>Guided Rule</strong></span> name and select the <code class="literal">employeerostering.employeerostering</code> <span class="strong strong"><strong>Package</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Ok</strong></span> to create the rule asset.
								</li><li class="listitem">
									Add a <span class="strong strong"><strong>WHEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>WHEN</strong></span> field.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Free form DRL</strong></span> from the <span class="strong strong"><strong>Add a condition to the rule</strong></span> window.
								</li><li class="listitem"><p class="simpara">
									In the free form DRL box, type the following condition:
								</p><pre class="programlisting language-java">$shiftAssignment : ShiftAssignment( employee != null )
		ShiftAssignment( this != $shiftAssignment , employee == $shiftAssignment.employee , shift.timeslot.startTime.toLocalDate() == $shiftAssignment.shift.timeslot.startTime.toLocalDate() )</pre><p class="simpara">
									This condition states that a shift cannot be assigned to an employee that already has another shift assignment on the same day.
								</p></li><li class="listitem">
									Add the <span class="strong strong"><strong>THEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>THEN</strong></span> field.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Add free form DRL</strong></span> from the <span class="strong strong"><strong>Add a new action</strong></span> window.
								</li><li class="listitem"><p class="simpara">
									In the free form DRL box, type the following condition:
								</p><pre class="programlisting language-java">scoreHolder.addHardConstraintMatch(kcontext, -1);</pre></li><li class="listitem">
									Click <span class="strong strong"><strong>Validate</strong></span> in the upper-right corner to check all rule conditions are valid. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to save the rule.
								</li></ol></div><p>
							For more information about creating guided rules, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/developing_decision_services_in_red_hat_decision_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>.
						</p></section><section class="section" id="wb-employee-rostering-shift-required-skills-met-proc"><div class="titlepage"><div><div><h4 class="title">5.2.5.4. Creating a guided rule to match skills to shift requirements</h4></div></div></div><p>
							The <code class="literal">ShiftReqiredSkillsAreMet</code> guided rule creates a hard constraint that ensures all shifts are assigned an employee with the correct set of skills. In the employee rostering example, this constraint is created using the guided rule designer.
						</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/employee-rostering/ShiftRequiredSkillsAreMet.png" alt="ShiftRequiredSkillsAreMet Guided Rule"/></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Rule</strong></span>.
								</li><li class="listitem">
									Enter <code class="literal">ShiftReqiredSkillsAreMet</code> as the <span class="strong strong"><strong>Guided Rule</strong></span> name and select the <code class="literal">employeerostering.employeerostering</code> <span class="strong strong"><strong>Package</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Ok</strong></span> to create the rule asset.
								</li><li class="listitem">
									Add a <span class="strong strong"><strong>WHEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>WHEN</strong></span> field.
								</li><li class="listitem">
									Select <code class="literal">ShiftAssignment</code> in the <span class="strong strong"><strong>Add a condition to the rule</strong></span> window. Click <span class="strong strong"><strong>+Ok</strong></span>.
								</li><li class="listitem">
									Click the <code class="literal">ShiftAssignment</code> condition, and select <code class="literal">employee</code> from the <span class="strong strong"><strong>Add a restriction on a field</strong></span> drop-down list.
								</li><li class="listitem">
									In the designer, click the drop-down list next to <code class="literal">employee</code> and select <code class="literal">is not null</code>.
								</li><li class="listitem"><p class="simpara">
									Click the <code class="literal">ShiftAssignment</code> condition, and click <span class="strong strong"><strong>Expression editor</strong></span>.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											In the designer, click <code class="literal">[not bound]</code> to open the <span class="strong strong"><strong>Expression editor</strong></span>, and bind the expression to the variable <code class="literal">$requiredSkill</code>. Click <span class="strong strong"><strong>Set</strong></span>.
										</li><li class="listitem">
											In the designer, next to <code class="literal">$requiredSkill</code>, select <code class="literal">shift</code> from the first drop-down list, then <code class="literal">requiredSkill</code> from the next drop-down list.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Click the <code class="literal">ShiftAssignment</code> condition, and click <span class="strong strong"><strong>Expression editor</strong></span>.
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											In the designer, next to <code class="literal">[not bound]</code>, select <code class="literal">employee</code> from the first drop-down list, then <code class="literal">skills</code> from the next drop-down list.
										</li><li class="listitem">
											Leave the next drop-down list as <code class="literal">Choose</code>.
										</li><li class="listitem">
											In the next drop-down box, change <code class="literal">please choose</code> to <code class="literal">excludes</code>.
										</li><li class="listitem">
											Click the 
											<span class="inlinemediaobject"><img src="images/_images/employee-rostering/6191.png" alt="edit"/></span>
											 icon next to <code class="literal">excludes</code>, and in the <span class="strong strong"><strong>Field value</strong></span> window, click the <span class="strong strong"><strong>New formula</strong></span> button.
										</li><li class="listitem">
											Type <code class="literal">$requiredSkill</code> into the formula box.
										</li></ol></div></li><li class="listitem">
									Add the <span class="strong strong"><strong>THEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>THEN</strong></span> field.
								</li><li class="listitem">
									Select <code class="literal">Modify Hard Score</code> in the <span class="strong strong"><strong>Add a new action</strong></span> window. Click <span class="strong strong"><strong>+Ok</strong></span>.
								</li><li class="listitem">
									Type <code class="literal">-1</code> into the score actions box.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Validate</strong></span> in the upper-right corner to check all rule conditions are valid. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to save the rule.
								</li></ol></div><p>
							For more information about creating guided rules, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/developing_decision_services_in_red_hat_decision_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>.
						</p></section><section class="section" id="wb-employee-rostering-day-off-request-rule-proc"><div class="titlepage"><div><div><h4 class="title">5.2.5.5. Creating a guided rule to manage day off requests</h4></div></div></div><p>
							The <code class="literal">DayOffRequest</code> guided rule creates a soft constraint. This constraint allows a shift to be reassigned to another employee in the event the employee who was originally assigned the shift is no longer able to work that day. In the employee rostering example, this constraint is created using the guided rule designer.
						</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/employee-rostering/DayOffRequest.png" alt="DayOffRequest Guided Rule"/></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In Business Central, go to <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Design</strong></span> → <span class="strong strong"><strong>Projects</strong></span> and click the project name.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Guided Rule</strong></span>.
								</li><li class="listitem">
									Enter <code class="literal">DayOffRequest</code> as the <span class="strong strong"><strong>Guided Rule</strong></span> name and select the <code class="literal">employeerostering.employeerostering</code> <span class="strong strong"><strong>Package</strong></span>.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Ok</strong></span> to create the rule asset.
								</li><li class="listitem">
									Add a <span class="strong strong"><strong>WHEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>WHEN</strong></span> field.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Free form DRL</strong></span> from the <span class="strong strong"><strong>Add a condition to the rule</strong></span> window.
								</li><li class="listitem"><p class="simpara">
									In the free form DRL box, type the following condition:
								</p><pre class="programlisting language-java">$dayOffRequest : DayOffRequest( )
		ShiftAssignment( employee == $dayOffRequest.employee , shift.timeslot.startTime.toLocalDate() == $dayOffRequest.date )</pre><p class="simpara">
									This condition states if a shift is assigned to an employee who has made a day off request, the employee can be unassigned the shift on that day.
								</p></li><li class="listitem">
									Add the <span class="strong strong"><strong>THEN</strong></span> condition by clicking the 
									<span class="inlinemediaobject"><img src="images/_images/employee-rostering/5686.png" alt="5686"/></span>
									 in the <span class="strong strong"><strong>THEN</strong></span> field.
								</li><li class="listitem">
									Select <span class="strong strong"><strong>Add free form DRL</strong></span> from the <span class="strong strong"><strong>Add a new action</strong></span> window.
								</li><li class="listitem"><p class="simpara">
									In the free form DRL box, type the following condition:
								</p><pre class="programlisting language-java">scoreHolder.addSoftConstraintMatch(kcontext, -100);</pre></li><li class="listitem">
									Click <span class="strong strong"><strong>Validate</strong></span> in the upper-right corner to check all rule conditions are valid. If the rule validation fails, address any problems described in the error message, review all components in the rule, and try again to validate the rule until the rule passes.
								</li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span> to save the rule.
								</li></ol></div><p>
							For more information about creating guided rules, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.13/html-single/developing_decision_services_in_red_hat_decision_manager#assembly-guided-rules"><span class="emphasis"><em>Designing a decision service using guided rules</em></span></a>.
						</p></section></section><section class="section" id="wb-employee-rostering-solver-configuration-proc"><div class="titlepage"><div><div><h3 class="title">5.2.6. Creating a solver configuration for employee rostering</h3></div></div></div><p>
						You can create and edit Solver configurations in Business Central. The Solver configuration designer creates a solver configuration that can be run after the project is deployed.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Red Hat Decision Manager has been downloaded and installed.
							</li><li class="listitem">
								You have created and configured all of the relevant assets for the employee rostering example.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In Business Central, click <span class="strong strong"><strong>Menu</strong></span> → <span class="strong strong"><strong>Projects</strong></span>, and click your project to open it.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Assets</strong></span> perspective, click <span class="strong strong"><strong>Add Asset</strong></span> → <span class="strong strong"><strong>Solver configuration</strong></span>
							</li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Create new Solver configuration</strong></span> window, type the name <code class="literal">EmployeeRosteringSolverConfig</code> for your Solver and click <span class="strong strong"><strong>Ok</strong></span>.
							</p><p class="simpara">
								This opens the <span class="strong strong"><strong>Solver configuration</strong></span> designer.
							</p></li><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Score Director Factory</strong></span> configuration section, define a KIE base that contains scoring rule definitions. The employee rostering sample project uses <code class="literal">defaultKieBase</code>.
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Select one of the KIE sessions defined within the KIE base. The employee rostering sample project uses <code class="literal">defaultKieSession</code>.
									</li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Validate</strong></span> in the upper-right corner to check the <span class="strong strong"><strong>Score Director Factory</strong></span> configuration is correct. If validation fails, address any problems described in the error message, and try again to validate until the configuration passes.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> to save the Solver configuration.
							</li></ol></div></section><section class="section" id="wb-employee-rostering-solver-termination-configuration-proc"><div class="titlepage"><div><div><h3 class="title">5.2.7. Configuring Solver termination for the employee rostering project</h3></div></div></div><p>
						You can configure the Solver to terminate after a specified amount of time. By default, the planning engine is given an unlimited time period to solve a problem instance.
					</p><p>
						The employee rostering sample project is set up to run for 30 seconds.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have created all relevant assets for the employee rostering project and created the <code class="literal">EmployeeRosteringSolverConfig</code> solver configuration in Business Central as described in <a class="xref" href="#wb-employee-rostering-solver-configuration-proc" title="5.2.6. Creating a solver configuration for employee rostering">Section 5.2.6, “Creating a solver configuration for employee rostering”</a>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Open the <code class="literal">EmployeeRosteringSolverConfig</code> from the <span class="strong strong"><strong>Assets</strong></span> perspective. This will open the <span class="strong strong"><strong>Solver configuration</strong></span> designer.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Termination</strong></span> section, click <span class="strong strong"><strong>Add</strong></span> to create new termination element within the selected logical group.
							</li><li class="listitem">
								Select the <code class="literal">Time spent</code> termination type from the drop-down list. This is added as an input field in the termination configuration.
							</li><li class="listitem">
								Use the arrows next to the time elements to adjust the amount of time spent to 30 seconds.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Validate</strong></span> in the upper-right corner to check the <span class="strong strong"><strong>Score Director Factory</strong></span> configuration is correct. If validation fails, address any problems described in the error message, and try again to validate until the configuration passes.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> to save the Solver configuration.
							</li></ol></div></section></section><section class="section" id="wb-employee-rostering-using-rest-proc"><div class="titlepage"><div><div><h2 class="title">5.3. Accessing the solver using the REST API</h2></div></div></div><p>
					After deploying or re-creating the sample solver, you can access it using the REST API.
				</p><p>
					You must register a solver instance using the REST API. Then you can supply data sets and retrieve optimized solutions.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The employee rostering project is set up and deployed according to the previous sections in this document. You can either deploy the sample project, as described in <a class="xref" href="#wb-employee-rostering-example-deploying-in-central-proc" title="5.1. Deploying the employee rostering sample project in Business Central">Section 5.1, “Deploying the employee rostering sample project in Business Central”</a>, or re-create the project, as described in <a class="xref" href="#wb-employee-rostering-example-recreate-con" title="5.2. Re-creating the employee rostering sample project">Section 5.2, “Re-creating the employee rostering sample project”</a>.
						</li></ul></div><section class="section" id="wb-employee-rostering-register-solver-proc"><div class="titlepage"><div><div><h3 class="title">5.3.1. Registering the Solver using the REST API</h3></div></div></div><p>
						You must register the solver instance using the REST API before you can use the solver.
					</p><p>
						Each solver instance is capable of optimizing one planning problem at a time.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a HTTP request using the following header:
							</p><pre class="screen">authorization: admin:admin
X-KIE-ContentType: xstream
content-type: application/xml</pre></li><li class="listitem"><p class="simpara">
								Register the Solver using the following request:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">PUT</span></dt><dd>
											<code class="literal">http://localhost:8080/kie-server/services/rest/server/containers/employeerostering_1.0.0-SNAPSHOT/solvers/EmployeeRosteringSolver</code>
										</dd><dt><span class="term">Request body</span></dt><dd><pre class="programlisting language-xml">&lt;solver-instance&gt;
  &lt;solver-config-file&gt;employeerostering/employeerostering/EmployeeRosteringSolverConfig.solver.xml&lt;/solver-config-file&gt;
&lt;/solver-instance&gt;</pre></dd></dl></div></li></ol></div></section><section class="section" id="wb-employee-rostering-call-solver-proc"><div class="titlepage"><div><div><h3 class="title">5.3.2. Calling the Solver using the REST API</h3></div></div></div><p>
						After registering the solver instance, you can use the REST API to submit a data set to the solver and to retrieve an optimized solution.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create a HTTP request using the following header:
							</p><pre class="screen">authorization: admin:admin
X-KIE-ContentType: xstream
content-type: application/xml</pre></li><li class="listitem"><p class="simpara">
								Submit a request to the Solver with a data set, as in the following example:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">POST</span></dt><dd>
											<code class="literal">http://localhost:8080/kie-server/services/rest/server/containers/employeerostering_1.0.0-SNAPSHOT/solvers/EmployeeRosteringSolver/state/solving</code>
										</dd><dt><span class="term">Request body</span></dt><dd><pre class="programlisting language-xml">&lt;employeerostering.employeerostering.EmployeeRoster&gt;
  &lt;employeeList&gt;
    &lt;employeerostering.employeerostering.Employee&gt;
      &lt;name&gt;John&lt;/name&gt;
      &lt;skills&gt;
        &lt;employeerostering.employeerostering.Skill&gt;
          &lt;name&gt;reading&lt;/name&gt;
        &lt;/employeerostering.employeerostering.Skill&gt;
      &lt;/skills&gt;
    &lt;/employeerostering.employeerostering.Employee&gt;
    &lt;employeerostering.employeerostering.Employee&gt;
      &lt;name&gt;Mary&lt;/name&gt;
      &lt;skills&gt;
        &lt;employeerostering.employeerostering.Skill&gt;
          &lt;name&gt;writing&lt;/name&gt;
        &lt;/employeerostering.employeerostering.Skill&gt;
      &lt;/skills&gt;
    &lt;/employeerostering.employeerostering.Employee&gt;
    &lt;employeerostering.employeerostering.Employee&gt;
      &lt;name&gt;Petr&lt;/name&gt;
      &lt;skills&gt;
        &lt;employeerostering.employeerostering.Skill&gt;
          &lt;name&gt;speaking&lt;/name&gt;
        &lt;/employeerostering.employeerostering.Skill&gt;
      &lt;/skills&gt;
    &lt;/employeerostering.employeerostering.Employee&gt;
  &lt;/employeeList&gt;
  &lt;shiftList&gt;
    &lt;employeerostering.employeerostering.Shift&gt;
      &lt;timeslot&gt;
        &lt;startTime&gt;2017-01-01T00:00:00&lt;/startTime&gt;
        &lt;endTime&gt;2017-01-01T01:00:00&lt;/endTime&gt;
      &lt;/timeslot&gt;
      &lt;requiredSkill reference="../../../employeeList/employeerostering.employeerostering.Employee/skills/employeerostering.employeerostering.Skill"/&gt;
    &lt;/employeerostering.employeerostering.Shift&gt;
    &lt;employeerostering.employeerostering.Shift&gt;
      &lt;timeslot reference="../../employeerostering.employeerostering.Shift/timeslot"/&gt;
      &lt;requiredSkill reference="../../../employeeList/employeerostering.employeerostering.Employee[3]/skills/employeerostering.employeerostering.Skill"/&gt;
    &lt;/employeerostering.employeerostering.Shift&gt;
    &lt;employeerostering.employeerostering.Shift&gt;
      &lt;timeslot reference="../../employeerostering.employeerostering.Shift/timeslot"/&gt;
      &lt;requiredSkill reference="../../../employeeList/employeerostering.employeerostering.Employee[2]/skills/employeerostering.employeerostering.Skill"/&gt;
    &lt;/employeerostering.employeerostering.Shift&gt;
  &lt;/shiftList&gt;
  &lt;skillList&gt;
    &lt;employeerostering.employeerostering.Skill reference="../../employeeList/employeerostering.employeerostering.Employee/skills/employeerostering.employeerostering.Skill"/&gt;
    &lt;employeerostering.employeerostering.Skill reference="../../employeeList/employeerostering.employeerostering.Employee[3]/skills/employeerostering.employeerostering.Skill"/&gt;
    &lt;employeerostering.employeerostering.Skill reference="../../employeeList/employeerostering.employeerostering.Employee[2]/skills/employeerostering.employeerostering.Skill"/&gt;
  &lt;/skillList&gt;
  &lt;timeslotList&gt;
    &lt;employeerostering.employeerostering.Timeslot reference="../../shiftList/employeerostering.employeerostering.Shift/timeslot"/&gt;
  &lt;/timeslotList&gt;
  &lt;dayOffRequestList/&gt;
  &lt;shiftAssignmentList&gt;
    &lt;employeerostering.employeerostering.ShiftAssignment&gt;
      &lt;shift reference="../../../shiftList/employeerostering.employeerostering.Shift"/&gt;
    &lt;/employeerostering.employeerostering.ShiftAssignment&gt;
    &lt;employeerostering.employeerostering.ShiftAssignment&gt;
      &lt;shift reference="../../../shiftList/employeerostering.employeerostering.Shift[3]"/&gt;
    &lt;/employeerostering.employeerostering.ShiftAssignment&gt;
    &lt;employeerostering.employeerostering.ShiftAssignment&gt;
      &lt;shift reference="../../../shiftList/employeerostering.employeerostering.Shift[2]"/&gt;
    &lt;/employeerostering.employeerostering.ShiftAssignment&gt;
  &lt;/shiftAssignmentList&gt;
&lt;/employeerostering.employeerostering.EmployeeRoster&gt;</pre></dd></dl></div></li><li class="listitem"><p class="simpara">
								Request the best solution to the planning problem:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">GET</span></dt><dd><p class="simpara">
											<code class="literal">http://localhost:8080/kie-server/services/rest/server/containers/employeerostering_1.0.0-SNAPSHOT/solvers/EmployeeRosteringSolver/bestsolution</code>
										</p><div class="formalpara"><p class="title"><strong>Example response</strong></p><p>
												
<pre class="programlisting language-xml">&lt;solver-instance&gt;
  &lt;container-id&gt;employee-rostering&lt;/container-id&gt;
  &lt;solver-id&gt;solver1&lt;/solver-id&gt;
  &lt;solver-config-file&gt;employeerostering/employeerostering/EmployeeRosteringSolverConfig.solver.xml&lt;/solver-config-file&gt;
  &lt;status&gt;NOT_SOLVING&lt;/status&gt;
  &lt;score scoreClass="org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore"&gt;0hard/0soft&lt;/score&gt;
  &lt;best-solution class="employeerostering.employeerostering.EmployeeRoster"&gt;
    &lt;employeeList&gt;
      &lt;employeerostering.employeerostering.Employee&gt;
        &lt;name&gt;John&lt;/name&gt;
        &lt;skills&gt;
          &lt;employeerostering.employeerostering.Skill&gt;
            &lt;name&gt;reading&lt;/name&gt;
          &lt;/employeerostering.employeerostering.Skill&gt;
        &lt;/skills&gt;
      &lt;/employeerostering.employeerostering.Employee&gt;
      &lt;employeerostering.employeerostering.Employee&gt;
        &lt;name&gt;Mary&lt;/name&gt;
        &lt;skills&gt;
          &lt;employeerostering.employeerostering.Skill&gt;
            &lt;name&gt;writing&lt;/name&gt;
          &lt;/employeerostering.employeerostering.Skill&gt;
        &lt;/skills&gt;
      &lt;/employeerostering.employeerostering.Employee&gt;
      &lt;employeerostering.employeerostering.Employee&gt;
        &lt;name&gt;Petr&lt;/name&gt;
        &lt;skills&gt;
          &lt;employeerostering.employeerostering.Skill&gt;
            &lt;name&gt;speaking&lt;/name&gt;
          &lt;/employeerostering.employeerostering.Skill&gt;
        &lt;/skills&gt;
      &lt;/employeerostering.employeerostering.Employee&gt;
    &lt;/employeeList&gt;
    &lt;shiftList&gt;
      &lt;employeerostering.employeerostering.Shift&gt;
        &lt;timeslot&gt;
          &lt;startTime&gt;2017-01-01T00:00:00&lt;/startTime&gt;
          &lt;endTime&gt;2017-01-01T01:00:00&lt;/endTime&gt;
        &lt;/timeslot&gt;
        &lt;requiredSkill reference="../../../employeeList/employeerostering.employeerostering.Employee/skills/employeerostering.employeerostering.Skill"/&gt;
      &lt;/employeerostering.employeerostering.Shift&gt;
      &lt;employeerostering.employeerostering.Shift&gt;
        &lt;timeslot reference="../../employeerostering.employeerostering.Shift/timeslot"/&gt;
        &lt;requiredSkill reference="../../../employeeList/employeerostering.employeerostering.Employee[3]/skills/employeerostering.employeerostering.Skill"/&gt;
      &lt;/employeerostering.employeerostering.Shift&gt;
      &lt;employeerostering.employeerostering.Shift&gt;
        &lt;timeslot reference="../../employeerostering.employeerostering.Shift/timeslot"/&gt;
        &lt;requiredSkill reference="../../../employeeList/employeerostering.employeerostering.Employee[2]/skills/employeerostering.employeerostering.Skill"/&gt;
      &lt;/employeerostering.employeerostering.Shift&gt;
    &lt;/shiftList&gt;
    &lt;skillList&gt;
      &lt;employeerostering.employeerostering.Skill reference="../../employeeList/employeerostering.employeerostering.Employee/skills/employeerostering.employeerostering.Skill"/&gt;
      &lt;employeerostering.employeerostering.Skill reference="../../employeeList/employeerostering.employeerostering.Employee[3]/skills/employeerostering.employeerostering.Skill"/&gt;
      &lt;employeerostering.employeerostering.Skill reference="../../employeeList/employeerostering.employeerostering.Employee[2]/skills/employeerostering.employeerostering.Skill"/&gt;
    &lt;/skillList&gt;
    &lt;timeslotList&gt;
      &lt;employeerostering.employeerostering.Timeslot reference="../../shiftList/employeerostering.employeerostering.Shift/timeslot"/&gt;
    &lt;/timeslotList&gt;
    &lt;dayOffRequestList/&gt;
    &lt;shiftAssignmentList/&gt;
    &lt;score&gt;0hard/0soft&lt;/score&gt;
  &lt;/best-solution&gt;
&lt;/solver-instance&gt;</pre>
											</p></div></dd></dl></div></li></ol></div></section></section></section><section class="chapter" id="optaplanner-quarkus-con_getting-started-optaplanner"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Getting Started with OptaPlanner and Quarkus</h2></div></div></div><p>
				You can use the <code class="literal"><a class="link" href="https://code.quarkus.redhat.com">https://code.quarkus.redhat.com</a></code> website to generate a Red Hat build of OptaPlanner Quarkus Maven project and automatically add and configure the extensions that you want to use in your application. You can then download the Quarkus Maven repository or use the online Maven repository with your project.
			</p><section class="section" id="con-apache-maven-plug-ins-and-quarkus_getting-started-optaplanner"><div class="titlepage"><div><div><h2 class="title">6.1. Apache Maven and Red Hat build of Quarkus</h2></div></div></div><p>
					Apache Maven is a distributed build automation tool used in Java application development to create, manage, and build software projects. Maven uses standard configuration files called Project Object Model (POM) files to define projects and manage the build process. POM files describe the module and component dependencies, build order, and targets for the resulting project packaging and output using an XML file. This ensures that the project is built in a correct and uniform manner.
				</p><div class="formalpara"><p class="title"><strong>Maven repositories</strong></p><p>
						A Maven repository stores Java libraries, plug-ins, and other build artifacts. The default public repository is the Maven 2 Central Repository, but repositories can be private and internal within a company to share common artifacts among development teams. Repositories are also available from third parties.
					</p></div><p>
					You can use the online Maven repository with your Quarkus projects or you can download the Red Hat build of Quarkus Maven repository.
				</p><div class="formalpara"><p class="title"><strong>Maven plug-ins</strong></p><p>
						Maven plug-ins are defined parts of a POM file that achieve one or more goals. Quarkus applications use the following Maven plug-ins:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Quarkus Maven plug-in (<code class="literal">quarkus-maven-plugin</code>): Enables Maven to create Quarkus projects, supports the generation of uber-JAR files, and provides a development mode.
						</li><li class="listitem">
							Maven Surefire plug-in (<code class="literal">maven-surefire-plugin</code>): Used during the test phase of the build lifecycle to execute unit tests on your application. The plug-in generates text and XML files that contain the test reports.
						</li></ul></div><section class="section" id="con-online-maven_getting-started-optaplanner"><div class="titlepage"><div><div><h3 class="title">6.1.1. Configuring the Maven <code class="literal">settings.xml</code> file for the online repository</h3></div></div></div><p>
						You can use the online Maven repository with your Maven project by configuring your user <code class="literal">settings.xml</code> file. This is the recommended approach. Maven settings used with a repository manager or repository on a shared server provide better control and manageability of projects.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When you configure the repository by modifying the Maven <code class="literal">settings.xml</code> file, the changes apply to all of your Maven projects.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Open the Maven <code class="literal">~/.m2/settings.xml</code> file in a text editor or integrated development environment (IDE).
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If there is not a <code class="literal">settings.xml</code> file in the <code class="literal">~/.m2/</code> directory, copy the <code class="literal">settings.xml</code> file from the <code class="literal">$MAVEN_HOME/.m2/conf/</code> directory into the <code class="literal">~/.m2/</code> directory.
								</p></div></div></li><li class="listitem"><p class="simpara">
								Add the following lines to the <code class="literal">&lt;profiles&gt;</code> element of the <code class="literal">settings.xml</code> file:
							</p><pre class="programlisting language-xml">&lt;!-- Configure the Maven repository --&gt;
&lt;profile&gt;
  &lt;id&gt;red-hat-enterprise-maven-repository&lt;/id&gt;
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;red-hat-enterprise-maven-repository&lt;/id&gt;
      &lt;url&gt;https://maven.repository.redhat.com/ga/&lt;/url&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;red-hat-enterprise-maven-repository&lt;/id&gt;
      &lt;url&gt;https://maven.repository.redhat.com/ga/&lt;/url&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;
&lt;/profile&gt;</pre></li><li class="listitem"><p class="simpara">
								Add the following lines to the <code class="literal">&lt;activeProfiles&gt;</code> element of the <code class="literal">settings.xml</code> file and save the file.
							</p><pre class="programlisting language-xml">&lt;activeProfile&gt;red-hat-enterprise-maven-repository&lt;/activeProfile&gt;</pre></li></ol></div></section><section class="section" id="con-download-maven_getting-started-optaplanner"><div class="titlepage"><div><div><h3 class="title">6.1.2. Downloading and configuring the Quarkus Maven repository</h3></div></div></div><p>
						If you do not want to use the online Maven repository, you can download and configure the Quarkus Maven repository to create a Quarkus application with Maven. The Quarkus Maven repository contains many of the requirements that Java developers typically use to build their applications. This procedure describes how to edit the <code class="literal">settings.xml</code> file to configure the Quarkus Maven repository.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When you configure the repository by modifying the Maven <code class="literal">settings.xml</code> file, the changes apply to all of your Maven projects.
						</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Download the Red Hat build of Quarkus Maven repository ZIP file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?downloadType=distributions&amp;product=redhat.quarkus">Software Downloads</a> page of the Red Hat Customer Portal (login required).
							</li><li class="listitem">
								Expand the downloaded archive.
							</li><li class="listitem">
								Change directory to the <code class="literal">~/.m2/</code> directory and open the Maven <code class="literal">settings.xml</code> file in a text editor or integrated development environment (IDE).
							</li><li class="listitem"><p class="simpara">
								Add the following lines to the <code class="literal">&lt;profiles&gt;</code> element of the <code class="literal">settings.xml</code> file, where <code class="literal"><span class="emphasis"><em>QUARKUS_MAVEN_REPOSITORY</em></span></code> is the path of the Quarkus Maven repository that you downloaded. The format of <code class="literal"><span class="emphasis"><em>QUARKUS_MAVEN_REPOSITORY</em></span></code> must be <code class="literal">file://$PATH</code>, for example <code class="literal">file:///home/userX/rh-quarkus-2.7.5.GA-maven-repository/maven-repository</code>.
							</p><pre class="programlisting language-xml">&lt;!-- Configure the Quarkus Maven repository --&gt;
&lt;profile&gt;
  &lt;id&gt;red-hat-enterprise-maven-repository&lt;/id&gt;
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;red-hat-enterprise-maven-repository&lt;/id&gt;
      &lt;url&gt;<span class="emphasis"><em>QUARKUS_MAVEN_REPOSITORY</em></span>&lt;/url&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;red-hat-enterprise-maven-repository&lt;/id&gt;
      &lt;url&gt;<span class="emphasis"><em>QUARKUS_MAVEN_REPOSITORY</em></span>&lt;/url&gt;
      &lt;releases&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;
&lt;/profile&gt;</pre></li><li class="listitem"><p class="simpara">
								Add the following lines to the <code class="literal">&lt;activeProfiles&gt;</code> element of the <code class="literal">settings.xml</code> file and save the file.
							</p><pre class="programlisting language-xml">&lt;activeProfile&gt;red-hat-enterprise-maven-repository&lt;/activeProfile&gt;</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If your Maven repository contains outdated artifacts, you might encounter one of the following Maven error messages when you build or deploy your project, where <code class="literal"><span class="emphasis"><em>ARTIFACT_NAME</em></span></code> is the name of a missing artifact and <code class="literal"><span class="emphasis"><em>PROJECT_NAME</em></span></code> is the name of the project you are trying to build:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">Missing artifact <span class="emphasis"><em>PROJECT_NAME</em></span></code>
								</li><li class="listitem">
									<code class="literal">[ERROR] Failed to execute goal on project <span class="emphasis"><em>ARTIFACT_NAME</em></span>; Could not resolve dependencies for <span class="emphasis"><em>PROJECT_NAME</em></span></code>
								</li></ul></div><p>
							To resolve the issue, delete the cached version of your local repository located in the <code class="literal">~/.m2/repository</code> directory to force a download of the latest Maven artifacts.
						</p></div></div></section></section><section class="section" id="proc-quarkus-creating-proj_getting-started-optaplanner"><div class="titlepage"><div><div><h2 class="title">6.2. Creating an OptaPlanner Red Hat build of Quarkus Maven project using the Maven plug-in</h2></div></div></div><p>
					You can get up and running with a Red Hat build of OptaPlanner and Quarkus application using Apache Maven and the Quarkus Maven plug-in.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenJDK 11 or later is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
						</li><li class="listitem">
							Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In a command terminal, enter the following command to verify that Maven is using JDK 11 and that the Maven version is 3.6 or higher:
						</p><pre class="screen">mvn --version</pre></li><li class="listitem">
							If the preceding command does not return JDK 11, add the path to JDK 11 to the PATH environment variable and enter the preceding command again.
						</li><li class="listitem"><p class="simpara">
							To generate a Quarkus OptaPlanner quickstart project, enter the following command:
						</p><pre class="programlisting language-shell">mvn com.redhat.quarkus.platform:quarkus-maven-plugin:2.7.5.Final-redhat-00011:create \
    -DprojectGroupId=com.example \
    -DprojectArtifactId=optaplanner-quickstart  \
    -Dextensions="resteasy,resteasy-jackson,optaplanner-quarkus,optaplanner-quarkus-jackson" \
    -DplatformGroupId=com.redhat.quarkus.platform
    -DplatformVersion=2.7.5.Final-redhat-00011 \
    -DnoExamples</pre><p class="simpara">
							This command create the following elements in the <code class="literal">./optaplanner-quickstart</code> directory:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The Maven structure
								</li><li class="listitem">
									Example <code class="literal">Dockerfile</code> file in <code class="literal">src/main/docker</code>
								</li><li class="listitem"><p class="simpara">
									The application configuration file
								</p><div class="table" id="idm45892286743024"><p class="title"><strong>Table 6.1. Properties used in the mvn <code class="literal">io.quarkus:quarkus-maven-plugin:2.7.5.Final-redhat-00011:create</code> command</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892286737648" scope="col">Property</th><th align="left" valign="top" id="idm45892286736560" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892286737648">
												<p>
													<code class="literal">projectGroupId</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892286736560">
												<p>
													The group ID of the project.
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892286737648">
												<p>
													<code class="literal">projectArtifactId</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892286736560">
												<p>
													The artifact ID of the project.
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892286737648">
												<p>
													<code class="literal">extensions</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892286736560">
												<p>
													A comma-separated list of Quarkus extensions to use with this project. For a full list of Quarkus extensions, enter <code class="literal">mvn quarkus:list-extensions</code> on the command line.
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892286737648">
												<p>
													<code class="literal">noExamples</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892286736560">
												<p>
													Creates a project with the project structure but without tests or classes.
												</p>
												</td></tr></tbody></table></div></div><p class="simpara">
									The values of the <code class="literal">projectGroupID</code> and the <code class="literal">projectArtifactID</code> properties are used to generate the project version. The default project version is <code class="literal">1.0.0-SNAPSHOT</code>.
								</p></li></ul></div></li><li class="listitem"><p class="simpara">
							To view your OptaPlanner project, change directory to the OptaPlanner Quickstarts directory:
						</p><pre class="screen">cd optaplanner-quickstart</pre></li><li class="listitem"><p class="simpara">
							Review the <code class="literal">pom.xml</code> file. The content should be similar to the following example:
						</p><pre class="screen">&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus.platform&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-bom&lt;/artifactId&gt;
      &lt;version&gt;2.7.5.Final-redhat-00011&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus.platform&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-optaplanner-bom&lt;/artifactId&gt;
      &lt;version&gt;2.7.5.Final-redhat-00011&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-resteasy&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-resteasy-jackson&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-quarkus&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-quarkus-jackson&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-junit5&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</pre></li></ol></div></section><section class="section" id="code-quarkus-redhat-com-proc_getting-started-optaplanner"><div class="titlepage"><div><div><h2 class="title">6.3. Creating a Red Hat build of Quarkus Maven project using code.quarkus.redhat.com</h2></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">code.quarkus.redhat.com</code> website to generate a Red Hat build of OptaPlanner Quarkus Maven project and automatically add and configure the extensions that you want to use in your application. In addition, <code class="literal">code.quarkus.redhat.com</code> automatically manages the configuration parameters required to compile your project into a native executable.
				</p><p>
					This section walks you through the process of generating an OptaPlanner Maven project and includes the following topics:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Specifying basic details about your application.
						</li><li class="listitem">
							Choosing the extensions that you want to include in your project.
						</li><li class="listitem">
							Generating a downloadable archive with your project files.
						</li><li class="listitem">
							Using the custom commands for compiling and starting your application.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a web browser.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open <code class="literal"><a class="link" href="https://code.quarkus.redhat.com">https://code.quarkus.redhat.com</a></code> in your web browser:
						</li><li class="listitem">
							Specify details about your project:
						</li><li class="listitem">
							Enter a group name for your project. The format of the name follows the Java package naming convention, for example, <code class="literal">com.example</code>.
						</li><li class="listitem">
							Enter a name that you want to use for Maven artifacts generated from your project, for example <code class="literal">code-with-quarkus</code>.
						</li><li class="listitem"><p class="simpara">
							Select <span class="strong strong"><strong>Build Tool</strong></span> &gt; <span class="strong strong"><strong>Maven</strong></span> to specify that you want to create a Maven project. The build tool that you choose determines the items:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The directory structure of your generated project
								</li><li class="listitem">
									The format of configuration files used in your generated project
								</li><li class="listitem"><p class="simpara">
									The custom build script and command for compiling and starting your application that <code class="literal">code.quarkus.redhat.com</code> displays for you after you generate your project
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										Red Hat provides support for using <code class="literal">code.quarkus.redhat.com</code> to create OptaPlanner Maven projects only. Generating Gradle projects is not supported by Red Hat.
									</p></div></div></li></ul></div></li><li class="listitem">
							Enter a version to be used in artifacts generated from your project. The default value of this field is <code class="literal">1.0.0-SNAPSHOT</code>. Using <a class="link" href="https://semver.org/">semantic versioning</a> is recommended, but you can use a different type of versioning if you prefer.
						</li><li class="listitem"><p class="simpara">
							Enter the package name of artifacts that the build tool generates when you package your project.
						</p><p class="simpara">
							According to the Java package naming conventions the package name should match the group name that you use for your project, but you can specify a different name.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">code.quarkus.redhat.com</code> website automatically uses the latest release of OptaPlanner. You can manually change the BOM version in the <code class="literal">pom.xml</code> file after you generate your project.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Select the following extensions to include as dependencies:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									RESTEasy JAX-RS (quarkus-resteasy)
								</li><li class="listitem">
									RESTEasy Jackson (quarkus-resteasy-jackson)
								</li><li class="listitem">
									OptaPlanner AI constraint solver(optaplanner-quarkus)
								</li><li class="listitem"><p class="simpara">
									OptaPlanner Jackson (optaplanner-quarkus-jackson)
								</p><p class="simpara">
									Red Hat provides different levels of support for individual extensions on the list, which are indicated by labels next to the name of each extension:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<span class="emphasis"><em>SUPPORTED</em></span> extensions are fully supported by Red Hat for use in enterprise applications in production environments.
										</li><li class="listitem">
											<span class="emphasis"><em>TECH-PREVIEW</em></span> extensions are subject to limited support by Red Hat in production environments under the <a class="link" href="https://access.redhat.com/support/offerings/techpreview">Technology Preview Features Support Scope</a>.
										</li><li class="listitem">
											<span class="emphasis"><em>DEV-SUPPORT</em></span> extensions are not supported by Red Hat for use in production environments, but the core functionalities that they provide are supported by Red Hat developers for use in developing new applications.
										</li><li class="listitem"><p class="simpara">
											<span class="emphasis"><em>DEPRECATED</em></span> extension are planned to be replaced with a newer technology or implementation that provides the same functionality.
										</p><p class="simpara">
											Unlabeled extensions are not supported by Red Hat for use in production environments.
										</p></li></ul></div></li></ul></div></li><li class="listitem">
							Select <span class="emphasis"><em>Generate your application</em></span> to confirm your choices and display the overlay screen with the download link for the archive that contains your generated project. The overlay screen also shows the custom command that you can use to compile and start your application.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Download the ZIP</strong></span> to save the archive with the generated project files to your system.
						</li><li class="listitem">
							Extract the contents of the archive.
						</li><li class="listitem"><p class="simpara">
							Navigate to the directory that contains your extracted project files:
						</p><pre class="programlisting language-bash">cd &lt;directory_name&gt;</pre></li><li class="listitem"><p class="simpara">
							Compile and start your application in development mode:
						</p><pre class="programlisting language-bash">./mvnw compile quarkus:dev</pre></li></ol></div></section><section class="section" id="proc-quarkus-creating-proj-cli_getting-started-optaplanner"><div class="titlepage"><div><div><h2 class="title">6.4. Creating a Red Hat build of Quarkus Maven project using the Quarkus CLI</h2></div></div></div><p>
					You can use the Quarkus command line interface (CLI) to create a Quarkus OptaPlanner project.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the Quarkus CLI. For information, see <a class="link" href="https://quarkus.io/guides/cli-tooling">Building Quarkus Apps with Quarkus Command Line Interface</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a Quarkus application:
						</p><pre class="screen">quarkus create app -P io.quarkus:quarkus-bom:2.7.5.Final-redhat-00011</pre></li><li class="listitem"><p class="simpara">
							To view the available extensions, enter the following command:
						</p><pre class="screen">quarkus ext -i</pre><p class="simpara">
							This command returns the following extensions:
						</p><pre class="screen">optaplanner-quarkus
optaplanner-quarkus-benchmark
optaplanner-quarkus-jackson
optaplanner-quarkus-jsonb</pre></li><li class="listitem"><p class="simpara">
							Enter the following command to add extensions to the project’s <code class="literal">pom.xml</code> file:
						</p><pre class="screen">quarkus ext add resteasy-jackson
quarkus ext add optaplanner-quarkus
quarkus ext add optaplanner-quarkus-jackson</pre></li><li class="listitem"><p class="simpara">
							Open the <code class="literal">pom.xml</code> file in a text editor. The contents of the file should look similar to the following example:
						</p><pre class="screen">&lt;?xml version="1.0"?&gt;
&lt;project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;org.acme&lt;/groupId&gt;
  &lt;artifactId&gt;code-with-quarkus-optaplanner&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
  &lt;properties&gt;
	&lt;compiler-plugin.version&gt;3.8.1&lt;/compiler-plugin.version&gt;
	&lt;maven.compiler.parameters&gt;true&lt;/maven.compiler.parameters&gt;
	&lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
	&lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
	&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
	&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
	&lt;quarkus.platform.artifact-id&gt;quarkus-bom&lt;/quarkus.platform.artifact-id&gt;
	&lt;quarkus.platform.group-id&gt;io.quarkus&lt;/quarkus.platform.group-id&gt;
	&lt;quarkus.platform.version&gt;2.7.5.Final-redhat-00011&lt;/quarkus.platform.version&gt;
	&lt;surefire-plugin.version&gt;3.0.0-M5&lt;/surefire-plugin.version&gt;
  &lt;/properties&gt;
  &lt;dependencyManagement&gt;
	&lt;dependencies&gt;
  	&lt;dependency&gt;
    	&lt;groupId&gt;${quarkus.platform.group-id}&lt;/groupId&gt;
    	&lt;artifactId&gt;${quarkus.platform.artifact-id}&lt;/artifactId&gt;
    	&lt;version&gt;${quarkus.platform.version}&lt;/version&gt;
    	&lt;type&gt;pom&lt;/type&gt;
    	&lt;scope&gt;import&lt;/scope&gt;
  	&lt;/dependency&gt;
  	&lt;dependency&gt;
    	&lt;groupId&gt;io.quarkus.platform&lt;/groupId&gt;
    	&lt;artifactId&gt;optaplanner-quarkus&lt;/artifactId&gt;
    	&lt;version&gt;2.2.2.Final&lt;/version&gt;
    	&lt;type&gt;pom&lt;/type&gt;
    	&lt;scope&gt;import&lt;/scope&gt;
  	&lt;/dependency&gt;
	&lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;
  &lt;dependencies&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  	&lt;artifactId&gt;quarkus-arc&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  	&lt;artifactId&gt;quarkus-resteasy&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
  	&lt;artifactId&gt;optaplanner-quarkus&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
  	&lt;artifactId&gt;optaplanner-quarkus-jackson&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  	&lt;artifactId&gt;quarkus-resteasy-jackson&lt;/artifactId&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  	&lt;artifactId&gt;quarkus-junit5&lt;/artifactId&gt;
  	&lt;scope&gt;test&lt;/scope&gt;
	&lt;/dependency&gt;
	&lt;dependency&gt;
  	&lt;groupId&gt;io.rest-assured&lt;/groupId&gt;
  	&lt;artifactId&gt;rest-assured&lt;/artifactId&gt;
  	&lt;scope&gt;test&lt;/scope&gt;
	&lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
	&lt;plugins&gt;
  	&lt;plugin&gt;
    	&lt;groupId&gt;${quarkus.platform.group-id}&lt;/groupId&gt;
    	&lt;artifactId&gt;quarkus-maven-plugin&lt;/artifactId&gt;
    	&lt;version&gt;${quarkus.platform.version}&lt;/version&gt;
    	&lt;extensions&gt;true&lt;/extensions&gt;
    	&lt;executions&gt;
      	&lt;execution&gt;
        	&lt;goals&gt;
          	&lt;goal&gt;build&lt;/goal&gt;
          	&lt;goal&gt;generate-code&lt;/goal&gt;
          	&lt;goal&gt;generate-code-tests&lt;/goal&gt;
        	&lt;/goals&gt;
      	&lt;/execution&gt;
    	&lt;/executions&gt;
  	&lt;/plugin&gt;
  	&lt;plugin&gt;
    	&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    	&lt;version&gt;${compiler-plugin.version}&lt;/version&gt;
    	&lt;configuration&gt;
      	&lt;parameters&gt;${maven.compiler.parameters}&lt;/parameters&gt;
    	&lt;/configuration&gt;
  	&lt;/plugin&gt;
  	&lt;plugin&gt;
    	&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    	&lt;version&gt;${surefire-plugin.version}&lt;/version&gt;
    	&lt;configuration&gt;
      	&lt;systemPropertyVariables&gt;
        	&lt;java.util.logging.manager&gt;org.jboss.logmanager.LogManager&lt;/java.util.logging.manager&gt;
        	&lt;maven.home&gt;${maven.home}&lt;/maven.home&gt;
      	&lt;/systemPropertyVariables&gt;
    	&lt;/configuration&gt;
  	&lt;/plugin&gt;
	&lt;/plugins&gt;
  &lt;/build&gt;
  &lt;profiles&gt;
	&lt;profile&gt;
  	&lt;id&gt;native&lt;/id&gt;
  	&lt;activation&gt;
    	&lt;property&gt;
      	&lt;name&gt;native&lt;/name&gt;
    	&lt;/property&gt;
  	&lt;/activation&gt;
  	&lt;build&gt;
    	&lt;plugins&gt;
      	&lt;plugin&gt;
        	&lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;
        	&lt;version&gt;${surefire-plugin.version}&lt;/version&gt;
        	&lt;executions&gt;
          	&lt;execution&gt;
            	&lt;goals&gt;
              	&lt;goal&gt;integration-test&lt;/goal&gt;
              	&lt;goal&gt;verify&lt;/goal&gt;
            	&lt;/goals&gt;
            	&lt;configuration&gt;
              	&lt;systemPropertyVariables&gt;
                	&lt;native.image.path&gt;${project.build.directory}/${project.build.finalName}-runner&lt;/native.image.path&gt;
                	&lt;java.util.logging.manager&gt;org.jboss.logmanager.LogManager&lt;/java.util.logging.manager&gt;
                	&lt;maven.home&gt;${maven.home}&lt;/maven.home&gt;
              	&lt;/systemPropertyVariables&gt;
            	&lt;/configuration&gt;
          	&lt;/execution&gt;
        	&lt;/executions&gt;
      	&lt;/plugin&gt;
    	&lt;/plugins&gt;
  	&lt;/build&gt;
  	&lt;properties&gt;
    	&lt;quarkus.package.type&gt;native&lt;/quarkus.package.type&gt;
  	&lt;/properties&gt;
	&lt;/profile&gt;
  &lt;/profiles&gt;
&lt;/project&gt;</pre></li></ol></div></section></section></div><div class="part" id="assembly-planner-configuration"><div class="titlepage"><div><div><h1 class="title">Part III. The Red Hat build of OptaPlanner solver</h1></div></div></div><div class="partintro" id="idm45892290171680"><div/><p>
				Solving a planning problem with OptaPlanner consists of the following steps:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						<span class="strong strong"><strong>Model your planning problem</strong></span> as a class annotated with the <code class="literal">@PlanningSolution</code> annotation (for example, the <code class="literal">NQueens</code> class).
					</li><li class="listitem">
						<span class="strong strong"><strong>Configure a Solver</strong></span> (for example a First Fit and Tabu Search solver for any <code class="literal">NQueens</code> instance).
					</li><li class="listitem">
						<span class="strong strong"><strong>Load a problem data set</strong></span> from your data layer (for example a Four Queens instance). That is the planning problem.
					</li><li class="listitem">
						<span class="strong strong"><strong>Solve it</strong></span> with <code class="literal">Solver.solve(problem)</code>, which returns the best solution found.
					</li></ol></div><div class="informalfigure"><div style="text-align: center; " class="mediaobject"><img style="text-align: middle" src="images/_images/optimizer/inputOutputOverview.png" alt="inputOutputOverview"/></div></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#configuring-planner-proc_developing-solvers">7. Configuring the Red Hat build of OptaPlanner solver</a></span><ul><li><span class="section"><a href="#xml-configuration-proc_developing-solvers">7.1. Using an XML file to configure the OptaPlanner solver</a></span></li><li><span class="section"><a href="#using-java-api-proc_developing-solvers">7.2. Using the Java API to configure the OptaPlanner solver</a></span></li><li><span class="section"><a href="#planner-annotations-con_developing-solvers">7.3. OptaPlanner annotation</a></span></li><li><span class="section"><a href="#specifying-domain-access-proc_developing-solvers">7.4. Specifying OptaPlanner domain access</a></span></li><li><span class="section"><a href="#configuring-custom-properties-proc_developing-solvers">7.5. Configuring custom properties</a></span></li></ul></li><li><span class="chapter"><a href="#solver-con_developing-solvers">8. The OptaPlanner Solver</a></span><ul><li><span class="section"><a href="#solving-a-problem-proc_developing-solvers">8.1. Solving a problem</a></span></li><li><span class="section"><a href="#solver-environment-con_developing-solvers">8.2. Solver environment mode</a></span></li><li><span class="section"><a href="#logging-level-proc_developing-solvers">8.3. Changing the OptaPlanner solver logging level</a></span></li><li><span class="section"><a href="#logback-proc_developing-solvers">8.4. Using Logback to log OptaPlanner solver activity</a></span></li><li><span class="section"><a href="#Log4J-proc_developing-solvers">8.5. Using Log4J to log OptaPlanner solver activity</a></span></li><li><span class="section"><a href="#monitoring-the-solver-proc_developing-solvers">8.6. Monitoring the solver</a></span><ul><li><span class="section"><a href="#configuring_a_quarkus_optaplanner_application_for_micrometer">8.6.1. Configuring a Quarkus OptaPlanner application for Micrometer</a></span></li><li><span class="section"><a href="#configuring_a_spring_boot_optaplanner_application_for_micrometer">8.6.2. Configuring a Spring Boot OptaPlanner application for Micrometer</a></span></li><li><span class="section"><a href="#configuring_a_plain_java_optaplanner_application_for_micrometer">8.6.3. Configuring a plain Java OptaPlanner application for Micrometer</a></span></li><li><span class="section"><a href="#additional_metrics">8.6.4. Additional Metrics</a></span></li></ul></li><li><span class="section"><a href="#cofiguring-random-number-proc_developing-solvers">8.7. Configuring the random number generator</a></span></li></ul></li><li><span class="chapter"><a href="#sovlermanager-con_developing-solvers">9. The OptaPlanner SolverManager</a></span><ul><li><span class="section"><a href="#batch-solving-con_developing-solvers">9.1. Batch solving problems</a></span></li><li><span class="section"><a href="#show-progress-proc_developing-solvers">9.2. Solve and listen to show progress</a></span></li></ul></li></ul></div></div><section class="chapter" id="configuring-planner-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Configuring the Red Hat build of OptaPlanner solver</h2></div></div></div><p>
				You can use the following methods to configure your OptaPlanner solver:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Use an XML file.
					</li><li class="listitem">
						Use the <code class="literal">SolverConfig</code> API.
					</li><li class="listitem">
						Add class annotations and JavaBean property annotations on the domain model.
					</li><li class="listitem">
						Control the method that OptaPlanner uses to access your domain.
					</li><li class="listitem">
						Define custom properties.
					</li></ul></div><section class="section" id="xml-configuration-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">7.1. Using an XML file to configure the OptaPlanner solver</h2></div></div></div><p>
					You can use an XML file to configure the solver. In a typical project that follows the Maven directory structure, after you build a <code class="literal">Solver</code> instance with the <code class="literal">SolverFactory</code>, the <code class="literal">solverConfig</code> XML file is located in the <code class="literal">$PROJECT_DIR/src/main/resources/org/optaplanner/examples/&lt;PROJECT&gt;/solver</code> directory, where <code class="literal">&lt;PROJECT&gt;</code> is the name of your OptaPlanner project. Alternatively, you can create a <code class="literal">SolverFactory</code> from a file with <code class="literal">SolverFactory.createFromXmlFile()</code>. However, for portability reasons, a classpath resource is recommended.
				</p><p>
					Both a <code class="literal">Solver</code> and a <code class="literal">SolverFactory</code> have a generic type called <code class="literal">Solution_</code>, which is the class representing a planning problem and solution.
				</p><p>
					OptaPlanner makes it relatively easy to switch optimization algorithms by changing the configuration.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Build a <code class="literal">Solver</code> instance with the <code class="literal">SolverFactory</code>.
						</li><li class="listitem"><p class="simpara">
							Configure the solver configuration XML file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Define the model.
								</li><li class="listitem">
									Define the score function.
								</li><li class="listitem"><p class="simpara">
									Optional: Configure the optimization algorithm.
								</p><p class="simpara">
									The following example is a solver XML file for the NQueens problem:
								</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd"&gt;
  &lt;!-- Define the model --&gt;
  &lt;solutionClass&gt;org.optaplanner.examples.nqueens.domain.NQueens&lt;/solutionClass&gt;
  &lt;entityClass&gt;org.optaplanner.examples.nqueens.domain.Queen&lt;/entityClass&gt;

  &lt;!-- Define the score function --&gt;
  &lt;scoreDirectorFactory&gt;
    &lt;scoreDrl&gt;org/optaplanner/examples/nqueens/solver/nQueensConstraints.drl&lt;/scoreDrl&gt;
  &lt;/scoreDirectorFactory&gt;

  &lt;!-- Configure the optimization algorithms (optional) --&gt;
  &lt;termination&gt;
    ...
  &lt;/termination&gt;
  &lt;constructionHeuristic&gt;
    ...
  &lt;/constructionHeuristic&gt;
  &lt;localSearch&gt;
    ...
  &lt;/localSearch&gt;
&lt;/solver&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										On some environments, for example OSGi and JBoss modules, classpath resources such as the solver config, score DRLs, and domain classe) in your JAR files might not be available to the default <code class="literal">ClassLoader</code> of the <code class="literal">optaplanner-core</code> JAR file. In those cases, provide the <code class="literal">ClassLoader</code> of your classes as a parameter:
									</p><pre class="programlisting language-java">       SolverFactory&lt;NQueens&gt; solverFactory = SolverFactory.createFromXmlResource(
               ".../nqueensSolverConfig.xml", getClass().getClassLoader());</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Configure the <code class="literal">SolverFactory</code> with a solver configuration XML file, provided as a classpath resource as defined by <code class="literal">ClassLoader.getResource()</code>:
						</p><pre class="programlisting language-java">       SolverFasctory&lt;NQueens&gt; solverFactory = SolverFactory.createFromXmlResource(
               "org/optaplanner/examples/nqueens/solver/nqueensSolverConfig.xml");
       Solver&lt;NQueens&gt; solver = solverFactory.buildSolver();</pre></li></ol></div></section><section class="section" id="using-java-api-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">7.2. Using the Java API to configure the OptaPlanner solver</h2></div></div></div><p>
					You can configure a solver by using the <code class="literal">SolverConfig</code> API. This is especially useful to change values dynamically at runtime. The following example changes the running time based on system properties before building the <code class="literal">Solver</code> in the NQueens project:
				</p><pre class="programlisting language-java">        SolverConfig solverConfig = SolverConfig.createFromXmlResource(
                "org/optaplanner/examples/nqueens/solver/nqueensSolverConfig.xml");
        solverConfig.withTerminationConfig(new TerminationConfig()
                        .withMinutesSpentLimit(userInput));

        SolverFactory&lt;NQueens&gt; solverFactory = SolverFactory.create(solverConfig);
        Solver&lt;NQueens&gt; solver = solverFactory.buildSolver();</pre><p>
					Every element in the solver configuration XML file is available as a <code class="literal">Config</code> class or a property on a <code class="literal">Config</code> class in the package namespace <code class="literal">org.optaplanner.core.config</code>. These <code class="literal">Config</code> classes are the Java representation of the XML format. They build the runtime components of the package namespace <code class="literal">org.optaplanner.core.impl</code> and assemble them into an efficient <code class="literal">Solver</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						To configure a <code class="literal">SolverFactory</code> dynamically for each user request, build a template <code class="literal">SolverConfig</code> during initialization and copy it with the copy constructor for each user request. The following example shows how to do this with the NQueens problem:
					</p><pre class="programlisting language-java">    private SolverConfig template;

    public void init() {
        template = SolverConfig.createFromXmlResource(
                "org/optaplanner/examples/nqueens/solver/nqueensSolverConfig.xml");
        template.setTerminationConfig(new TerminationConfig());
    }

    // Called concurrently from different threads
    public void userRequest(..., long userInput) {
        SolverConfig solverConfig = new SolverConfig(template); // Copy it
        solverConfig.getTerminationConfig().setMinutesSpentLimit(userInput);
        SolverFactory&lt;NQueens&gt; solverFactory = SolverFactory.create(solverConfig);
        Solver&lt;NQueens&gt; solver = solverFactory.buildSolver();
        ...
    }</pre></div></div></section><section class="section" id="planner-annotations-con_developing-solvers"><div class="titlepage"><div><div><h2 class="title">7.3. OptaPlanner annotation</h2></div></div></div><p>
					You must specify which classes in your domain model are planning entities, which properties are planning variables, and so on. Use one of the following methods to add annotations to your OptaPlanner project:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Add class annotations and JavaBean property annotations on the domain model. The property annotations must be on the getter method, not on the setter method. Annotated getter methods do not need to be public. This is the recommended method.
						</li><li class="listitem">
							Add class annotations and field annotations on the domain model. Annotated fields do not need to be public.
						</li></ul></div></section><section class="section" id="specifying-domain-access-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">7.4. Specifying OptaPlanner domain access</h2></div></div></div><p>
					By default, OptaPlanner accesses your domain using reflection. Reflection is reliable but slow compared to direct access. Alternatively, you can configure OptaPlanner to access your domain using Gizmo, which will generate bytecode that directly accesses the fields and methods of your domain without reflection. However, this method has the following restrictions:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The planning annotations can only be on public fields and public getters.
						</li><li class="listitem">
							<code class="literal">io.quarkus.gizmo:gizmo</code> must be on the classpath.
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						These restrictions do not apply when you use OptaPlanner with Quarkus because Gizmo is the default domain access type.
					</p></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To use Gizmo outside of Quarkus, set the <code class="literal">domainAccessType</code> in the solver configuration:
					</p></div><pre class="programlisting language-xml">  &lt;solver&gt;
    &lt;domainAccessType&gt;GIZMO&lt;/domainAccessType&gt;
  &lt;/solver&gt;</pre></section><section class="section" id="configuring-custom-properties-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">7.5. Configuring custom properties</h2></div></div></div><p>
					In your OptaPlanner projects, you can add custom properties to solver configuration elements that instantiate classes and have documents that explicitly mention custom properties.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a solver.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add a custom property.
						</p><p class="simpara">
							For example, if your <code class="literal">EasyScoreCalculator</code> has heavy calculations which are cached and you want to increase the cache size in one benchmark add the <code class="literal">myCacheSize</code> property:
						</p><pre class="programlisting language-xml">  &lt;scoreDirectorFactory&gt;
    &lt;easyScoreCalculatorClass&gt;...MyEasyScoreCalculator&lt;/easyScoreCalculatorClass&gt;
    &lt;easyScoreCalculatorCustomProperties&gt;
      &lt;property name="myCacheSize" value="1000"/&gt;&lt;!-- Override value --&gt;
    &lt;/easyScoreCalculatorCustomProperties&gt;
  &lt;/scoreDirectorFactory&gt;</pre></li><li class="listitem"><p class="simpara">
							Add a public setter for each custom property, which is called when a <code class="literal">Solver</code> is built.
						</p><pre class="programlisting language-java">public class MyEasyScoreCalculator extends EasyScoreCalculator&lt;MySolution, SimpleScore&gt; {

        private int myCacheSize = 500; // Default value

        @SuppressWarnings("unused")
        public void setMyCacheSize(int myCacheSize) {
            this.myCacheSize = myCacheSize;
        }

    ...
}</pre><p class="simpara">
							Most value types are supported, including <code class="literal">boolean</code>, <code class="literal">int</code>, <code class="literal">double</code>, <code class="literal">BigDecimal</code>, <code class="literal">String</code> and <code class="literal">enums</code>.
						</p></li></ol></div></section></section><section class="chapter" id="solver-con_developing-solvers"><div class="titlepage"><div><div><h2 class="title">Chapter 8. The OptaPlanner Solver</h2></div></div></div><p>
				A solver finds the best and optimal solution to your planning problem. A solver can only solve one planning problem instance at a time. Solvers are built with the <code class="literal">SolverFactory</code> method:
			</p><pre class="programlisting language-java">public interface Solver&lt;Solution_&gt; {

    Solution_ solve(Solution_ problem);

    ...
}</pre><p>
				A solver should only be accessed from a single thread, except for the methods that are specifically documented in <code class="literal">javadoc</code> as being thread-safe. The <code class="literal">solve()</code> method hogs the current thread. Hogging the thread can cause HTTP timeouts for REST services and it requires extra code to solve multiple data sets in parallel. To avoid such issues, use a <code class="literal">SolverManager</code> instead.
			</p><section class="section" id="solving-a-problem-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.1. Solving a problem</h2></div></div></div><p>
					Use the solver to solve a planning problem.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">Solver</code> built from a solver configuration
						</li><li class="listitem">
							An <code class="literal">@PlanningSolution</code> annotation that represents the planning problem instance
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Provide the planning problem as an argument to the <code class="literal">solve()</code> method. The solver will return the best solution found.
					</p></div><p>
					The following example solves the NQueens problem:
				</p><pre class="programlisting language-java">    NQueens problem = ...;
    NQueens bestSolution = solver.solve(problem);</pre><p>
					In this example, the <code class="literal">solve()</code> method will return an <code class="literal">NQueens</code> instance with every <code class="literal">Queen</code> assigned to a <code class="literal">Row</code>.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The solution instance given to the <code class="literal">solve(Solution)</code> method can be partially or fully initialized, which is often the case in repeated planning.
					</p></div></div><div class="figure" id="idm45892288970368"><p class="title"><strong>Figure 8.1. Best Solution for the Four Queens Puzzle in 8ms (Also an Optimal Solution)</strong></p><div class="figure-contents"><div style="text-align: left; " class="mediaobject"><img style="text-align: left" src="images/_images/optimizer/solvedNQueens04.png" alt="solvedNQueens04"/></div></div></div><p>
					The <code class="literal">solve(Solution)</code> method can take a long time depending on the problem size and the solver configuration. The <code class="literal">Solver</code> intelligently works through the search space of possible solutions and remembers the best solution it encounters during solving. Depending on a number of factors, including problem size, how much time the <code class="literal">Solver</code> has, the solver configuration, and so forth, the <code class="literal">best</code> solution might or might not be an <code class="literal">optimal</code> solution.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The solution instance given to the method <code class="literal">solve(Solution)</code> is changed by the <code class="literal">Solver</code>, but do not mistake it for the best solution.
					</p><p>
						The solution instance returned by the methods <code class="literal">solve(Solution)</code> or <code class="literal">getBestSolution()</code> is most likely a planning clone of the instance given to the method <code class="literal">solve(Solution)</code>, which implies it is a different instance.
					</p></div></div></section><section class="section" id="solver-environment-con_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.2. Solver environment mode</h2></div></div></div><p>
					The solver environment mode enables you to detect common bugs in your implementation. It does not affect the logging level.
				</p><p>
					A solver has a single random instance. Some solver configurations use the random instance a lot more than others. For example, the Simulated Annealing algorithm depends highly on random numbers, while <code class="literal">Tabu Search</code> only depends on it to resolve score ties. The environment mode influences the seed of that random instance.
				</p><p>
					You can set the environment mode in the solver configuration XML file. The following example sets the <code class="literal">FAST_ASSERT</code> mode:
				</p><pre class="programlisting language-xml">&lt;solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd"&gt;
  &lt;environmentMode&gt;FAST_ASSERT&lt;/environmentMode&gt;
  ...
&lt;/solver&gt;</pre><div class="itemizedlist"><p class="title"><strong>The following list describes the environment modes that you can use in the solver configuration file:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">FULL_ASSERT</code> mode turns on all assertions, for example the assertion that the incremental score calculation is uncorrupted for each move, to fail-fast on a bug in a Move implementation, a constraint, the engine itself, and so on. This mode is reproducible. It is also intrusive because it calls the method <code class="literal">calculateScore()</code> more frequently than a non-assert mode. The <code class="literal">FULL_ASSERT</code> mode is very slow because it does not rely on incremental score calculation.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">NON_INTRUSIVE_FULL_ASSERT</code> mode turns on several assertions to fail-fast on a bug in a Move implementation, a constraint, the engine itself, and so on. This mode is reproducible. It is non-intrusive because it does not call the method <code class="literal">calculateScore()</code> more frequently than a non assert mode. The <code class="literal">NON_INTRUSIVE_FULL_ASSERT</code> mode is very slow because it does not rely on incremental score calculation.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">FAST_ASSERT</code> mode turns on most assertions, such as the assertions that an undoMove’s score is the same as before the Move, to fail-fast on a bug in a Move implementation, a constraint, the engine itself, and so on. This mode is reproducible. It is also intrusive because it calls the method <code class="literal">calculateScore()</code> more frequently than a non-assert mode. The <code class="literal">FAST_ASSERT</code> mode is slow. Write a test case that does a short run of your planning problem with the <code class="literal">FAST_ASSERT</code> mode on.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<code class="literal">REPRODUCIBLE</code> mode is the default mode because it is recommended during development. In this mode, two runs in the same OptaPlanner version execute the same code in the same order. Those two runs have the same result at every step, except if the following note applies. This enables you to reproduce bugs consistently. It also enables you to benchmark certain refactorings, such as a score constraint performance optimization, fairly across runs.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Despite using <code class="literal">REPRODCIBLE</code> mode, your application might still not be fully reproducible for the following reasons:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Use of <code class="literal">HashSet</code> or another <code class="literal">Collection</code> which has an inconsistent order between JVM runs for collections of planning entities or planning values but not normal problem facts, especially in the solution implementation. Replace it with <code class="literal">LinkedHashSet</code>.
									</li><li class="listitem">
										Combining a time gradient dependent algorithm, most notably the Simulated Annealing algorithm, together with time spent termination. A sufficiently large difference in allocated CPU time will influence the time gradient values. Replace the Simulated Annealing algorithms with the Late Acceptance algorithm, or replace time spent termination with step count termination.
									</li></ul></div></div></div></li><li class="listitem">
							<code class="literal">REPRODUCIBLE</code> mode can be slightly slower than <code class="literal">NON_REPRODUCIBLE</code> mode. If your production environment can benefit from reproducibility, use this mode in production. In practice, <code class="literal">REPRODUCIBLE</code> mode uses the default fixed random seed if no seed is specified and it also disables certain concurrency optimizations such as work stealing.
						</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">NON_REPRODUCIBLE</code> mode can be slightly faster than <code class="literal">REPRODUCIBLE</code> mode. Avoid using it during development because it makes debugging and bug fixing difficult. If reproducibility isn’t important in your production environment, use <code class="literal">NON_REPRODUCIBLE</code> mode in production. In practice, this mode uses no fixed random seed if no seed is specified.
						</li></ul></div></section><section class="section" id="logging-level-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.3. Changing the OptaPlanner solver logging level</h2></div></div></div><p>
					You can change the logging level in an OptaPlanner solver to review solver activity. The following list describes the different logging levels:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>error</strong></span>: Logs errors, except those that are thrown to the calling code as a <code class="literal">RuntimeException</code>.
						</p><p class="simpara">
							If an error occurs, OptaPlanner normally fails fast. It throws a subclass of <code class="literal">RuntimeException</code> with a detailed message to the calling code. To avoid duplicate log messages, it does not log it as an error. Unless the calling code explicitly catches and eliminates that <code class="literal">RuntimeException</code>, a <code class="literal">Thread’s default `ExceptionHandler</code> will log it as an error anyway. Meanwhile, the code is disrupted from doing further harm or obfuscating the error.
						</p></li><li class="listitem">
							<span class="strong strong"><strong>warn</strong></span>: Logs suspicious circumstances
						</li><li class="listitem">
							<span class="strong strong"><strong>info</strong></span>: Logs every phase and the solver itself
						</li><li class="listitem">
							<span class="strong strong"><strong>debug</strong></span>: Logs every step of every phase
						</li><li class="listitem">
							<span class="strong strong"><strong>trace</strong></span>: Logs every move of every step of every phase
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Specifying <code class="literal">trace</code> logging will slow down performance considerably. However, <code class="literal">trace</code> logging is invaluable during development to discover a bottleneck.
					</p><p>
						Even <code class="literal">debug</code> logging can slow down performance considerably for fast stepping algorithms such as Late Acceptance and Simulated Annealing, but not for slow stepping algorithms such as Tabu Search.
					</p><p>
						Both trace` and <code class="literal">debug</code> logging cause congestion in multithreaded solving with most appenders.
					</p><p>
						In Eclipse, <code class="literal">debug</code> logging to the console tends to cause congestion with score calculation speeds above 10000 per second. Neither IntelliJ or the Maven command line suffer from this problem.
					</p></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Set the logging level to <code class="literal">debug</code> logging to see when the phases end and how fast steps are taken.
					</p></div><p>
					The following example shows output from debug logging:
				</p><pre class="screen">INFO  Solving started: time spent (3), best score (-4init/0), random (JDK with seed 0).
DEBUG     CH step (0), time spent (5), score (-3init/0), selected move count (1), picked move (Queen-2 {null -&gt; Row-0}).
DEBUG     CH step (1), time spent (7), score (-2init/0), selected move count (3), picked move (Queen-1 {null -&gt; Row-2}).
DEBUG     CH step (2), time spent (10), score (-1init/0), selected move count (4), picked move (Queen-3 {null -&gt; Row-3}).
DEBUG     CH step (3), time spent (12), score (-1), selected move count (4), picked move (Queen-0 {null -&gt; Row-1}).
INFO  Construction Heuristic phase (0) ended: time spent (12), best score (-1), score calculation speed (9000/sec), step total (4).
DEBUG     LS step (0), time spent (19), score (-1),     best score (-1), accepted/selected move count (12/12), picked move (Queen-1 {Row-2 -&gt; Row-3}).
DEBUG     LS step (1), time spent (24), score (0), new best score (0), accepted/selected move count (9/12), picked move (Queen-3 {Row-3 -&gt; Row-2}).
INFO  Local Search phase (1) ended: time spent (24), best score (0), score calculation speed (4000/sec), step total (2).
INFO  Solving ended: time spent (24), best score (0), score calculation speed (7000/sec), phase total (2), environment mode (REPRODUCIBLE).</pre><p>
					All time spent values are in milliseconds.
				</p><p>
					Everything is logged to <a class="link" href="http://www.slf4j.org/">SLF4J</a>, which is a simple logging facade that delegates every log message to Logback, Apache Commons Logging, Log4j, or java.util.logging. Add a dependency to the logging adaptor for your logging framework of choice.
				</p></section><section class="section" id="logback-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.4. Using Logback to log OptaPlanner solver activity</h2></div></div></div><p>
					Logback is the recommended logging frameworkd to use with OptaPlanner. Use Logback to log OptaPlanner solver activity.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have an OptaPlanner project.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the following Maven dependency to your OptaPlanner project’s <code class="literal">pom.xml</code> file:
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You do not need to add an extra bridge dependency.
							</p></div></div><pre class="programlisting language-xml">    &lt;dependency&gt;
      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
      &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
      &lt;version&gt;1.x&lt;/version&gt;
    &lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
							Configure the logging level on the <code class="literal">org.optaplanner</code> package in your <code class="literal">logback.xml</code> file as shown in the following example where <code class="literal">&lt;LEVEL&gt;</code> is a logging level listed in <a class="xref" href="#logback-proc_developing-solvers" title="8.4. Using Logback to log OptaPlanner solver activity">Section 8.4, “Using Logback to log OptaPlanner solver activity”</a>.
						</p><pre class="programlisting language-xml">&lt;configuration&gt;

  &lt;logger name="org.optaplanner" level="&lt;LEVEL&gt;"/&gt;

  ...

&lt;/configuration&gt;</pre></li><li class="listitem"><p class="simpara">
							Optional: If you have a multitenant application where multiple <code class="literal">Solver</code> instances might be running at the same time, separate the logging of each instance into separate files:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Surround the <code class="literal">solve()</code> call with <a class="link" href="http://logback.qos.ch/manual/mdc.html">Mapped Diagnostic Context</a> (MDC):
								</p><pre class="programlisting language-java">        MDC.put("tenant.name",tenantName);
        MySolution bestSolution = solver.solve(problem);
        MDC.remove("tenant.name");</pre></li><li class="listitem"><p class="simpara">
									Configure your logger to use different files for each <code class="literal">${tenant.name}</code>. For example, use a <code class="literal">SiftingAppender</code> in the <code class="literal">logback.xml</code> file:
								</p><pre class="programlisting language-xml">  &lt;appender name="fileAppender" class="ch.qos.logback.classic.sift.SiftingAppender"&gt;
    &lt;discriminator&gt;
      &lt;key&gt;tenant.name&lt;/key&gt;
      &lt;defaultValue&gt;unknown&lt;/defaultValue&gt;
    &lt;/discriminator&gt;
    &lt;sift&gt;
      &lt;appender name="fileAppender.${tenant.name}" class="...FileAppender"&gt;
        &lt;file&gt;local/log/optaplanner-${tenant.name}.log&lt;/file&gt;
        ...
      &lt;/appender&gt;
    &lt;/sift&gt;
  &lt;/appender&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										When running multiple solvers or one multithreaded solve, most appenders, including the console, cause congestion with <code class="literal">debug</code> and <code class="literal">trace</code> logging. Switch to an async appender to avoid this problem or turn off <code class="literal">debug</code> logging.
									</p></div></div></li></ol></div></li><li class="listitem">
							If OptaPlanner doesn’t recognize the new level, temporarily add the system property <code class="literal">-Dlogback.<span class="emphasis"><em>LEVEL</em></span>=true</code> to troubleshoot.
						</li></ol></div></section><section class="section" id="Log4J-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.5. Using Log4J to log OptaPlanner solver activity</h2></div></div></div><p>
					If you are already using Log4J and you do not want to switch to its faster successor, Logback, you can configure your OptaPlanner project for Log4J.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have an OptaPlanner project
						</li><li class="listitem">
							You are using the Log4J logging framework
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the bridge dependency to the project <code class="literal">pom.xml</code> file:
						</p><pre class="programlisting language-xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
      &lt;version&gt;1.x&lt;/version&gt;
    &lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
							Configure the logging level on the package <code class="literal">org.optaplanner</code> in your <code class="literal">log4j.xml</code> file as shown in the following example, where <code class="literal">&lt;LEVEL&gt;</code> is a logging level listed in <a class="xref" href="#logback-proc_developing-solvers" title="8.4. Using Logback to log OptaPlanner solver activity">Section 8.4, “Using Logback to log OptaPlanner solver activity”</a>.
						</p><pre class="programlisting language-xml">&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;

  &lt;category name="org.optaplanner"&gt;
    &lt;priority value="&lt;LEVEL&gt;" /&gt;
  &lt;/category&gt;

  ...

&lt;/log4j:configuration&gt;</pre></li><li class="listitem"><p class="simpara">
							Optional: If you have a multitenant application where multiple <code class="literal">Solver</code> instances might be running at the same time, separate the logging of each instance into separate files:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Surround the <code class="literal">solve()</code> call with <a class="link" href="http://logback.qos.ch/manual/mdc.html">Mapped Diagnostic Context</a> (MDC):
								</p><pre class="programlisting language-java">        MDC.put("tenant.name",tenantName);
        MySolution bestSolution = solver.solve(problem);
        MDC.remove("tenant.name");</pre></li><li class="listitem"><p class="simpara">
									Configure your logger to use different files for each <code class="literal">${tenant.name}</code>. For example, use a <code class="literal">SiftingAppender</code> in the <code class="literal">logback.xml</code> file:
								</p><pre class="programlisting language-xml">  &lt;appender name="fileAppender" class="ch.qos.logback.classic.sift.SiftingAppender"&gt;
    &lt;discriminator&gt;
      &lt;key&gt;tenant.name&lt;/key&gt;
      &lt;defaultValue&gt;unknown&lt;/defaultValue&gt;
    &lt;/discriminator&gt;
    &lt;sift&gt;
      &lt;appender name="fileAppender.${tenant.name}" class="...FileAppender"&gt;
        &lt;file&gt;local/log/optaplanner-${tenant.name}.log&lt;/file&gt;
        ...
      &lt;/appender&gt;
    &lt;/sift&gt;
  &lt;/appender&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										When running multiple solvers or one multithreaded solve, most appenders, including the console, cause congestion with <code class="literal">debug</code> and <code class="literal">trace</code> logging. Switch to an async appender to avoid this problem or turn off <code class="literal">debug</code> logging.
									</p></div></div></li></ol></div></li></ol></div></section><section class="section" id="monitoring-the-solver-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.6. Monitoring the solver</h2></div></div></div><p>
					OptaPlanner exposes metrics through <a class="link" href="https://micrometer.io/">Micrometer</a>, a metrics instrumentation library for Java applications. You can use Micrometer with popular monitoring systems to monitor the OptaPlanner solver.
				</p><section class="section" id="configuring_a_quarkus_optaplanner_application_for_micrometer"><div class="titlepage"><div><div><h3 class="title">8.6.1. Configuring a Quarkus OptaPlanner application for Micrometer</h3></div></div></div><p>
						To configure your OptaPlanner Quarkus application to use Micrometer and a specified monitoring system, add the Micrometer dependency to the <code class="literal">pom.xml</code> file.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a Quarkus OptaPlanner application.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Add the following dependency to your application’s <code class="literal">pom.xml</code> file where <code class="literal">&lt;MONITORING_SYSTEM&gt;</code> is a monitoring system supported by Micrometer and Quarkus:
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Prometheus is currently the only monitoring system supported by Quarkus.
								</p></div></div><pre class="screen">&lt;dependency&gt;
 &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
 &lt;artifactId&gt;quarkus-micrometer-registry-&lt;MONITORING_SYSTEM&gt;&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
								To run the application in development mode, enter the following command:
							</p><pre class="screen">mvn compile quarkus:dev</pre></li><li class="listitem"><p class="simpara">
								To view metrics for your application, enter the following URL in a browser:
							</p><pre class="screen">http://localhost:8080/q/metrics</pre></li></ol></div></section><section class="section" id="configuring_a_spring_boot_optaplanner_application_for_micrometer"><div class="titlepage"><div><div><h3 class="title">8.6.2. Configuring a Spring Boot OptaPlanner application for Micrometer</h3></div></div></div><p>
						To configure your Spring Boot OptaPlanner application to use Micrometer and a specified monitoring system, add the Micrometer dependency to the <code class="literal">pom.xml</code> file.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a Spring Boot OptaPlanner application.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Add the following dependency to your application’s <code class="literal">pom.xml</code> file where <code class="literal">&lt;MONITORING_SYSTEM&gt;</code> is a monitoring system supported by Micrometer and Spring Boot:
							</p><pre class="screen">&lt;dependency&gt;
 &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
 &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
 &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
 &lt;artifactId&gt;micrometer-registry-&lt;MONITORING_SYSTEM&gt;&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></li><li class="listitem">
								Add configuration information to the application’s <code class="literal">application.properties</code> file. For information, see the <a class="link" href="https://micrometer.io">Micrometer</a> web site.
							</li><li class="listitem"><p class="simpara">
								To run the application, enter the following command:
							</p><pre class="screen">mvn spring-boot:run</pre></li><li class="listitem"><p class="simpara">
								To view metrics for your application, enter the following URL in a browser:
							</p><p class="simpara">
								<a class="link" href="http://localhost:8080/actuator/metrics">http://localhost:8080/actuator/metrics</a>
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Use the following URL as the Prometheus scraper path: <code class="literal"><a class="link" href="http://localhost:8080/actuator/prometheus">http://localhost:8080/actuator/prometheus</a></code>
								</p></div></div></li></ol></div></section><section class="section" id="configuring_a_plain_java_optaplanner_application_for_micrometer"><div class="titlepage"><div><div><h3 class="title">8.6.3. Configuring a plain Java OptaPlanner application for Micrometer</h3></div></div></div><p>
						To configuring a plain Java OptaPlanner application to use Micrometer, you must add Micrometer dependencies and configuration information for your chosen monitoring system to your project’s <code class="literal">POM.XML</code> file.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have a plain Java OptaPlanner application.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Add the following dependencies to your application’s <code class="literal">pom.xml</code> file where <code class="literal">&lt;MONITORING_SYSTEM&gt;</code> is a monitoring system that is configured with Micrometer and <code class="literal">&lt;VERSION&gt;</code> is the version of Micrometer that you are using:
							</p><pre class="screen">&lt;dependency&gt;
 &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
 &lt;artifactId&gt;micrometer-registry-&lt;MONITORING_SYSTEM&gt;&lt;/artifactId&gt;
 &lt;version&gt;&lt;VERSION&gt;&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
 &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
 &lt;artifactId&gt;micrometer-core&lt;/artifactId&gt;
 &lt;version&gt;`&lt;VERSION&gt;`&lt;/version&gt;
&lt;/dependency&gt;</pre></li><li class="listitem">
								Add Micrometer configuration information for your monitoring system to the beginning of your project’s <code class="literal">pom.xml</code> file. For information, see the <a class="link" href="https://micrometer.io">Micrometer</a> web site.
							</li><li class="listitem"><p class="simpara">
								Add the following line below the configuration information, where <code class="literal">&lt;MONITORING_SYSTEM&gt;</code> is the monitoring system that you added:
							</p><pre class="programlisting language-java numbered">Metrics.addRegistry(&lt;MONITORING_SYSTEM&gt;);</pre><p class="simpara">
								The following example shows how to add the Prometheus monitoring system:
							</p><pre class="programlisting language-java numbered">PrometheusMeterRegistry prometheusRegistry = new PrometheusMeterRegistry(PrometheusConfig.DEFAULT);
try {
    HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);
    server.createContext("/prometheus", httpExchange -&gt; {
        String response = prometheusRegistry.scrape();
        httpExchange.sendResponseHeaders(200, response.getBytes().length);
        try (OutputStream os = httpExchange.getResponseBody()) {
            os.write(response.getBytes());
        }
    });
    new Thread(server::start).start();
} catch (IOException e) {
    throw new RuntimeException(e);
}
Metrics.addRegistry(prometheusRegistry);</pre></li><li class="listitem"><p class="simpara">
								Open your monitoring system to view the metrics for your OptaPlanner project. The following metrics are exposed:
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The names and format of the metrics vary depending on the registry.
								</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">optaplanner.solver.errors.total</code>: the total number of errors that occurred while solving since the start of the measuring.
									</li><li class="listitem">
										<code class="literal">optaplanner.solver.solve-length.active-count</code>: the number of solvers currently solving.
									</li><li class="listitem">
										<code class="literal">optaplanner.solver.solve-length.seconds-max</code>: run time of the longest-running currently active solver.
									</li><li class="listitem">
										<code class="literal">optaplanner.solver.solve-length.seconds-duration-sum</code>: the sum of each active solver’s solve duration. For example, if there are two active solvers, one running for three minutes and the other for one minute, the total solve time is four minutes.
									</li></ul></div></li></ol></div></section><section class="section" id="additional_metrics"><div class="titlepage"><div><div><h3 class="title">8.6.4. Additional Metrics</h3></div></div></div><p>
						For more detailed monitoring, you can configure OptaPlanner to monitor additional metrics at a performance cost. The following example uses the <code class="literal">BEST_SCORE</code> and <code class="literal">SCORE_CALCULATION_COUNT</code> metric:
					</p><pre class="programlisting language-xml">&lt;solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd"&gt;
  &lt;monitoring&gt;
    &lt;metric&gt;BEST_SCORE&lt;/metric&gt;
    &lt;metric&gt;SCORE_CALCULATION_COUNT&lt;/metric&gt;
    ...
  &lt;/monitoring&gt;
  ...
&lt;/solver&gt;</pre><p>
						You can enable the following metrics in this configuration:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">SOLVE_DURATION</code> (default, Micrometer meter ID: "optaplanner.solver.solve.duration"): Measures the duration of solving for the longest active solver, the number of active solvers, and the cumulative duration of all active solvers.
							</li><li class="listitem">
								<code class="literal">ERROR_COUNT</code> (default, Micrometer meter id: "optaplanner.solver.errors"): Measures the number of errors that occur while solving.
							</li><li class="listitem">
								<code class="literal">SCORE_CALCULATION_COUNT</code> (default, Micrometer meter id: "optaplanner.solver.score.calculation.count"): Measures the number of score calculations OptaPlanner performed.
							</li><li class="listitem">
								<code class="literal">BEST_SCORE</code> (Micrometer meter id: "optaplanner.solver.best.score.*"): Measures the score of the best solution OptaPlanner has found so far. There are separate meters for each level of the score. For instance, for a <code class="literal">HardSoftScore</code>, there are <code class="literal">optaplanner.solver.best.score.hard.score</code> and <code class="literal">optaplanner.solver.best.score.soft.score</code> meters.
							</li><li class="listitem">
								<code class="literal">STEP_SCORE</code> (Micrometer meter id: "optaplanner.solver.step.score.*"): Measures the score of each step OptaPlanner takes. There are separate meters for each level of the score. For instance, for a <code class="literal">HardSoftScore</code>, there are <code class="literal">optaplanner.solver.step.score.hard.score</code> and <code class="literal">optaplanner.solver.step.score.soft.score</code> meters.
							</li><li class="listitem">
								<code class="literal">BEST_SOLUTION_MUTATION</code> (Micrometer meter id: "optaplanner.solver.best.solution.mutation"): Measures the number of changed planning variables between consecutive best solutions.
							</li><li class="listitem">
								<code class="literal">MOVE_COUNT_PER_STEP</code> (Micrometer meter id: "optaplanner.solver.step.move.count"): Measures the number of moves evaluated in a step.
							</li><li class="listitem">
								<code class="literal">MEMORY_USE</code> (Micrometer meter id: "jvm.memory.used"): Measures the amount of memory used across the JVM. This does not measure the amount of memory used by a solver; two solvers on the same JVM will report the same value for this metric.
							</li><li class="listitem">
								<code class="literal">CONSTRAINT_MATCH_TOTAL_BEST_SCORE</code> (Micrometer meter id: "optaplanner.solver.constraint.match.best.score.*"): Measures the score impact of each constraint on the best solution OptaPlanner has found so far. There are separate meters for each level of the score, with tags for each constraint. For instance, for a <code class="literal">HardSoftScore</code> for a constraint "Minimize Cost" in package "com.example", there are <code class="literal">optaplanner.solver.constraint.match.best.score.hard.score</code> and <code class="literal">optaplanner.solver.constraint.match.best.score.soft.score</code> meters with tags "constraint.package=com.example" and "constraint.name=Minimize Cost".
							</li><li class="listitem">
								<code class="literal">CONSTRAINT_MATCH_TOTAL_STEP_SCORE</code> (Micrometer meter id: "optaplanner.solver.constraint.match.step.score.*"): Measures the score impact of each constraint on the current step. There are separate meters for each level of the score, with tags for each constraint. For instance, for a <code class="literal">HardSoftScore</code> for a constraint "Minimize Cost" in package "com.example", there are <code class="literal">optaplanner.solver.constraint.match.step.score.hard.score</code> and <code class="literal">optaplanner.solver.constraint.match.step.score.soft.score</code> meters with tags "constraint.package=com.example" and "constraint.name=Minimize Cost".
							</li><li class="listitem">
								<code class="literal">PICKED_MOVE_TYPE_BEST_SCORE_DIFF</code> (Micrometer meter id: "optaplanner.solver.move.type.best.score.diff.*"): Measures how much a particular move type improves the best solution. There are separate meters for each level of the score, with a tag for the move type. For instance, for a <code class="literal">HardSoftScore</code> and a <code class="literal">ChangeMove</code> for the computer of a process, there are <code class="literal">optaplanner.solver.move.type.best.score.diff.hard.score</code> and <code class="literal">optaplanner.solver.move.type.best.score.diff.soft.score</code> meters with the tag <code class="literal">move.type=ChangeMove(Process.computer)</code>.
							</li><li class="listitem">
								<code class="literal">PICKED_MOVE_TYPE_STEP_SCORE_DIFF</code> (Micrometer meter id: "optaplanner.solver.move.type.step.score.diff.*"): Measures how much a particular move type improves the best solution. There are separate meters for each level of the score, with a tag for the move type. For instance, for a <code class="literal">HardSoftScore</code> and a <code class="literal">ChangeMove</code> for the computer of a process, there are <code class="literal">optaplanner.solver.move.type.step.score.diff.hard.score</code> and <code class="literal">optaplanner.solver.move.type.step.score.diff.soft.score</code> meters with the tag <code class="literal">move.type=ChangeMove(Process.computer)</code>.
							</li></ul></div></section></section><section class="section" id="cofiguring-random-number-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">8.7. Configuring the random number generator</h2></div></div></div><p>
					Many heuristics and metaheuristics depend on a pseudorandom number generator for move selection, to resolve score ties, probability based move acceptance, and so on. During solving, the same random instance is reused to improve reproducibility, performance, and uniform distribution of random values.
				</p><p>
					A random seed is a number used to initialize a pseudorandom number generator.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Optional: To change the random seed of a random instance, specify a <code class="literal">randomSeed</code>:
						</p><pre class="programlisting language-xml">&lt;solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd"&gt;
  &lt;randomSeed&gt;0&lt;/randomSeed&gt;
  ...
&lt;/solver&gt;</pre></li><li class="listitem"><p class="simpara">
							Optional: To change the pseudorandom number generator implementation, specify a value for the <code class="literal">randomType</code> property listed in the solver configuration file below, where <code class="literal">&lt;RANDOM_NUMBER_GENERATOR&gt;</code> is a pseudorandom number generator:
						</p><pre class="programlisting language-xml">&lt;solver xmlns="https://www.optaplanner.org/xsd/solver" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="https://www.optaplanner.org/xsd/solver https://www.optaplanner.org/xsd/solver/solver.xsd"&gt;
  &lt;randomType&gt;&lt;RANDOM_NUMBER_GENERATOR&gt;&lt;/randomType&gt;
  ...
&lt;/solver&gt;</pre><p class="simpara">
							The following pseudorandom number generators are supported:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">JDK</code> (default): Standard random number generator implementation (<code class="literal">java.util.Random</code>)
								</li><li class="listitem">
									<code class="literal">MERSENNE_TWISTER</code>: Random number generator implementation by <a class="link" href="http://commons.apache.org/proper/commons-math/userguide/random.html">Commons Math</a>
								</li><li class="listitem">
									<code class="literal">WELL512A</code>, <code class="literal">WELL1024A</code>, <code class="literal">WELL19937A</code>, <code class="literal">WELL19937C</code>, <code class="literal">WELL44497A</code> and <code class="literal">WELL44497B</code>: Random number generator implementation by <a class="link" href="http://commons.apache.org/proper/commons-math/userguide/random.html">Commons Math</a>
								</li></ul></div></li></ol></div><p>
					For most use cases, the value of the <code class="literal">randomType</code> property has no significant impact on the average quality of the best solution on multiple data sets.
				</p></section></section><section class="chapter" id="sovlermanager-con_developing-solvers"><div class="titlepage"><div><div><h2 class="title">Chapter 9. The OptaPlanner SolverManager</h2></div></div></div><p>
				A <code class="literal">SolverManager</code> is a facade for one or more <code class="literal">Solver</code> instances to simplify solving planning problems in REST and other enterprise services.
			</p><p>
				Unlike the <code class="literal">Solver.solve(…​)</code> method, a <code class="literal">SolverManager</code> has the following characteristics:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">SolverManager.solve(…​)</code> returns immediately: it schedules a problem for asynchronous solving without blocking the calling thread. This avoids timeout issues of HTTP and other technologies.
					</li><li class="listitem">
						<code class="literal">SolverManager.solve(…​)</code> solves multiple planning problems of the same domain, in parallel.
					</li></ul></div><p>
				Internally, a <code class="literal">SolverManager</code> manages a thread pool of solver threads, which call <code class="literal">Solver.solve(…​)</code>, and a thread pool of consumer threads, which handle best solution changed events.
			</p><p>
				In Quarkus and Spring Boot, the <code class="literal">SolverManager</code> instance is automatically injected in your code. If you are using a platform other than Quarkus or Spring Boot, build a <code class="literal">SolverManager</code> instance with the <code class="literal">create(…​)</code> method:
			</p><pre class="programlisting language-java">SolverConfig solverConfig = SolverConfig.createFromXmlResource(".../cloudBalancingSolverConfig.xml");
SolverManager&lt;CloudBalance, UUID&gt; solverManager = SolverManager.create(solverConfig, new SolverManagerConfig());</pre><p>
				Each problem submitted to the <code class="literal">SolverManager.solve(…​)</code> methods must have a unique problem ID. Later calls to <code class="literal">getSolverStatus(problemId)</code> or <code class="literal">terminateEarly(problemId)</code> use that problem ID to distinguish between planning problems. The problem ID must be an immutable class, such as <code class="literal">Long</code>, <code class="literal">String</code>, or <code class="literal">java.util.UUID</code>.
			</p><p>
				The <code class="literal">SolverManagerConfig</code> class has a <code class="literal">parallelSolverCount</code> property that controls how many solvers are run in parallel. For example, if the <code class="literal">parallelSolverCount</code> property` is set to <code class="literal">4</code> and you submit five problems, four problems start solving immediately and the fifth problem starts when one of the first problems ends. If those problems solve for five minutes each, the fifth problem takes 10 minutes to finish. By default, <code class="literal">parallelSolverCount</code> is set to <code class="literal">AUTO</code>, which resolves to half the CPU cores, regardless of the <code class="literal">moveThreadCount</code> of the solvers.
			</p><p>
				To retrieve the best solution, after solving terminates normally use <code class="literal">SolverJob.getFinalBestSolution()</code>:
			</p><pre class="programlisting language-java">CloudBalance problem1 = ...;
UUID problemId = UUID.randomUUID();
// Returns immediately
SolverJob&lt;CloudBalance, UUID&gt; solverJob = solverManager.solve(problemId, problem1);
...
CloudBalance solution1;
try {
    // Returns only after solving terminates
    solution1 = solverJob.getFinalBestSolution();
} catch (InterruptedException | ExecutionException e) {
    throw ...;
}</pre><p>
				However, there are better approaches, both for solving batch problems before a user needs the solution as well as for live solving while a user is actively waiting for the solution.
			</p><p>
				The current <code class="literal">SolverManager</code> implementation runs on a single computer node, but future work aims to distribute solver loads across a cloud.
			</p><section class="section" id="batch-solving-con_developing-solvers"><div class="titlepage"><div><div><h2 class="title">9.1. Batch solving problems</h2></div></div></div><p>
					Batch solving is solving multiple data sets in parallel. Batch solving is particularly useful overnight:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							There are typically few or no problem changes in the middle of the night. Some organizations enforce a deadline, for example, <span class="emphasis"><em>submit all day off requests before midnight</em></span>.
						</li><li class="listitem">
							The solvers can run for much longer, often hours, because nobody is waiting for the results and CPU resources are often cheaper.
						</li><li class="listitem">
							Solutions are available when employees arrive at work the next working day.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To batch solve problems in parallel, limited by <code class="literal">parallelSolverCount</code>, call <code class="literal">solve(…​)</code> for each data set created the following class:
					</p></div><p>
					+
				</p><pre class="programlisting language-java">public class TimeTableService {

    private SolverManager&lt;TimeTable, Long&gt; solverManager;

    // Returns immediately, call it for every data set
    public void solveBatch(Long timeTableId) {
        solverManager.solve(timeTableId,
                // Called once, when solving starts
                this::findById,
                // Called once, when solving ends
                this::save);
    }

    public TimeTable findById(Long timeTableId) {...}

    public void save(TimeTable timeTable) {...}

}</pre></section><section class="section" id="show-progress-proc_developing-solvers"><div class="titlepage"><div><div><h2 class="title">9.2. Solve and listen to show progress</h2></div></div></div><p>
					When a solver is running while a user is waiting for a solution, the user might need to wait for several minutes or hours before receiving a result. To assure the user that everything is going well, show progress by displaying the best solution and best score attained so far.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To handle intermediate best solutions, use <code class="literal">solveAndListen(…​)</code>:
						</p><pre class="programlisting language-java">public class TimeTableService {

    private SolverManager&lt;TimeTable, Long&gt; solverManager;

    // Returns immediately
    public void solveLive(Long timeTableId) {
        solverManager.solveAndListen(timeTableId,
                // Called once, when solving starts
                this::findById,
                // Called multiple times, for every best solution change
                this::save);
    }

    public TimeTable findById(Long timeTableId) {...}

    public void save(TimeTable timeTable) {...}

    public void stopSolving(Long timeTableId) {
        solverManager.terminateEarly(timeTableId);
    }

}</pre><p class="simpara">
							This implementation is using the database to communicate with the UI, which polls the database. More advanced implementations push the best solutions directly to the UI or a messaging queue.
						</p></li><li class="listitem">
							When the user is satisfied with the intermediate best solution and does not want to wait any longer for a better one, call <code class="literal">SolverManager.terminateEarly(problemId)</code>.
						</li></ol></div></section></section></div><div class="part" id="assembly-optaplanner-quickstarts_developing-solvers"><div class="titlepage"><div><div><h1 class="title">Part IV. Red Hat build of OptaPlanner quick start guides</h1></div></div></div><div class="partintro" id="idm45892288109392"><div/><p>
				Red Hat build of OptaPlanner provides the following quick start guides to demonstrate how OptaPlanner can integrate with different techologies:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Red Hat build of OptaPlanner on Red Hat build of Quarkus: a school timetable quick start guide
					</li><li class="listitem">
						Red Hat build of OptaPlanner on Red Hat build of Quarkus: a vaccination appointment scheduler quick start guide
					</li><li class="listitem">
						Red Hat build of OptaPlanner on Spring Boot: a school timetable quick start guide
					</li><li class="listitem">
						Red Hat build of OptaPlanner with Java solvers: a cloud balancing quick start guide
					</li></ul></div><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#assembly-optaplanner-school-timetable-quarkus_optaplanner-quickstarts">10. Red Hat build of OptaPlanner on Red Hat build of Quarkus: a school timetable quick start guide</a></span><ul><li><span class="section"><a href="#proc-quarkus-creating-proj_optaplanner-quarkus">10.1. Creating an OptaPlanner Red Hat build of Quarkus Maven project using the Maven plug-in</a></span></li><li><span class="section"><a href="#business-optimizr-domain-objects-proc_optaplanner-quarkus">10.2. Model the domain objects</a></span></li><li><span class="section"><a href="#business-optimizr-define-contraints-proc_optaplanner-quarkus">10.3. Define the constraints and calculate the score</a></span></li><li><span class="section"><a href="#business-optimizr-gather-objects-proc_optaplanner-quarkus">10.4. Gather the domain objects in a planning solution</a></span></li><li><span class="section"><a href="#solver-service-proc_optaplanner-quarkus">10.5. Create the solver service</a></span></li><li><span class="section"><a href="#business-optimizr-set-solver-time-proc_optaplanner-quarkus">10.6. Set the solver termination time</a></span></li><li><span class="section"><a href="#proc-quarkus-compiling-project_optaplanner-quarkus">10.7. Running the school timetable application</a></span></li><li><span class="section"><a href="#testing_the_application">10.8. Testing the application</a></span><ul><li><span class="section"><a href="#business-optimizer-test-constraints-proc_optaplanner-quarkus">10.8.1. Test the school timetable constraints</a></span></li><li><span class="section"><a href="#business-optimizer-test-solver-proc_optaplanner-quarkus">10.8.2. Test the school timetable solver</a></span></li></ul></li><li><span class="section"><a href="#business-optimizer-logging-quarkus-proc_optaplanner-quarkus">10.9. Logging</a></span></li><li><span class="section"><a href="#planner-quarkus-database-proc_optaplanner-quarkus">10.10. Integrating a database with your Quarkus OptaPlanner school timetable application</a></span></li><li><span class="section"><a href="#micrometer-and-quarkus-proc_optaplanner-quarkus">10.11. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Quarkus application</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-optaplanner-vaccination_optaplanner-quickstarts">11. Red Hat build of OptaPlanner on Red Hat build of Quarkus: a vaccination appointment scheduler quick start guide</a></span><ul><li><span class="section"><a href="#vaccination-scheduler-con_optaplanner-quickstarts">11.1. How the OptaPlanner vaccination appointment scheduler works</a></span><ul><li><span class="section"><a href="#vaccination-contraints-con_optaplanner-quickstarts">11.1.1. OptaPlanner vaccination appointment scheduler constraints</a></span></li><li><span class="section"><a href="#optaplanner-solver-con_optaplanner-quickstarts">11.1.2. The OptaPlanner solver</a></span></li><li><span class="section"><a href="#continuous-planning-con_optaplanner-quickstarts">11.1.3. Continuous planning</a></span></li><li><span class="section"><a href="#pinned-planning-entities-con_optaplanner-quickstarts">11.1.4. Pinned planning entities</a></span></li></ul></li><li><span class="section"><a href="#vaccination-scheduler-download-proc_optaplanner-quickstarts">11.2. Downloading and running the OptaPlanner vaccination appointment scheduler</a></span></li><li><span class="section"><a href="#vaccination-scheduler-package-proc_optaplanner-quickstarts">11.3. Package and run the OptaPlanner vaccination appointment scheduler</a></span></li><li><span class="section"><a href="#vaccination-native-proc_optaplanner-quickstarts">11.4. Run the OptaPlanner vaccination appointment scheduler as a native executable</a></span></li><li><span class="section"><a href="#additional_resources">11.5. Additional resources</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-business-optimizer-springboot_optaplanner-quickstarts">12. Red Hat build of OptaPlanner on Spring Boot: a school timetable quick start guide</a></span><ul><li><span class="section"><a href="#spring-boot-ref-download-proc_business-optimizer-spring-boot">12.1. Downloading and building the Spring Boot school timetable quick start</a></span></li><li><span class="section"><a href="#business-optimizr-domain-objects-proc_business-optimizer-spring-boot">12.2. Model the domain objects</a></span></li><li><span class="section"><a href="#business-optimizr-define-contraints-proc_business-optimizer-spring-boot">12.3. Define the constraints and calculate the score</a></span></li><li><span class="section"><a href="#business-optimizr-gather-objects-proc_business-optimizer-spring-boot">12.4. Gather the domain objects in a planning solution</a></span></li><li><span class="section"><a href="#business-optimizr-create-timetable-service-proc_business-optimizer-spring-boot">12.5. Create the Timetable service</a></span></li><li><span class="section"><a href="#business-optimizr-set-solver-time-proc_business-optimizer-spring-boot">12.6. Set the solver termination time</a></span></li><li><span class="section"><a href="#business-optimizer-make-executable-proc_business-optimizer-spring-boot">12.7. Make the application executable</a></span><ul><li><span class="section"><a href="#business-optimizer-try-application-proc_business-optimizer-spring-boot">12.7.1. Try the timetable application</a></span></li><li><span class="section"><a href="#business-optimizer-test-application-proc_business-optimizer-spring-boot">12.7.2. Test the application</a></span></li><li><span class="section"><a href="#business-optimizer-logging-proc_business-optimizer-spring-boot">12.7.3. Logging</a></span></li></ul></li><li><span class="section"><a href="#business-optimizer-database-UI-integration-proc_business-optimizer-spring-boot">12.8. Add Database and UI integration</a></span></li><li><span class="section"><a href="#using_micrometer_and_prometheus_to_monitor_your_school_timetable_optaplanner_spring_boot_application">12.9. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Spring Boot application</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-planner-java">13. Red Hat build of OptaPlanner and Java: a school timetable quickstart guide</a></span><ul><li><span class="section"><a href="#create_the_maven_or_gradle_build_file_and_add_dependencies">13.1. Create the Maven or Gradle build file and add dependencies</a></span></li><li><span class="section"><a href="#business-optimizr-domain-objects-proc_optaplanner-java">13.2. Model the domain objects</a></span></li><li><span class="section"><a href="#business-optimizr-define-contraints-proc_optaplanner-java">13.3. Define the constraints and calculate the score</a></span></li><li><span class="section"><a href="#business-optimizr-gather-objects-proc_optaplanner-java">13.4. Gather the domain objects in a planning solution</a></span></li><li><span class="section"><a href="#the_timetableapp_java_class">13.5. The TimeTableApp.java class</a></span></li><li><span class="section"><a href="#create_and_run_the_school_timetable_application">13.6. Create and run the school timetable application</a></span></li><li><span class="section"><a href="#test_the_application">13.7. Test the application</a></span><ul><li><span class="section"><a href="#business-optimizer-test-constraints-proc_optaplanner-java">13.7.1. Test the school timetable constraints</a></span></li><li><span class="section"><a href="#business-optimizer-test-solver-proc_optaplanner-java">13.7.2. Test the school timetable solver</a></span></li></ul></li><li><span class="section"><a href="#business-optimizer-logging-quarkus-proc_optaplanner-java">13.8. Logging</a></span></li><li><span class="section"><a href="#using_micrometer_and_prometheus_to_monitor_your_school_timetable_optaplanner_java_application">13.9. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Java application</a></span></li></ul></li></ul></div></div><section class="chapter" id="assembly-optaplanner-school-timetable-quarkus_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Red Hat build of OptaPlanner on Red Hat build of Quarkus: a school timetable quick start guide</h2></div></div></div><p>
				This guide walks you through the process of creating a Red Hat build of Quarkus application with Red Hat build of OptaPlanner’s constraint solving artificial intelligence (AI). You will build a REST application that optimizes a school timetable for students and teachers
			</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableAppScreenshot.png" alt="timeTableAppScreenshot"/></div></div><p>
				Your service will assign <code class="literal">Lesson</code> instances to <code class="literal">Timeslot</code> and <code class="literal">Room</code> instances automatically by using AI to adhere to the following hard and soft <span class="emphasis"><em>scheduling constraints</em></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A room can have at most one lesson at the same time.
					</li><li class="listitem">
						A teacher can teach at most one lesson at the same time.
					</li><li class="listitem">
						A student can attend at most one lesson at the same time.
					</li><li class="listitem">
						A teacher prefers to teach in a single room.
					</li><li class="listitem">
						A teacher prefers to teach sequential lessons and dislikes gaps between lessons.
					</li></ul></div><p>
				Mathematically speaking, school timetabling is an <span class="emphasis"><em>NP-hard</em></span> problem. That means it is difficult to scale. Simply iterating through all possible combinations with brute force would take millions of years for a non-trivial data set, even on a supercomputer. Fortunately, AI constraint solvers such as Red Hat build of OptaPlanner have advanced algorithms that deliver a near-optimal solution in a reasonable amount of time. What is considered to be a reasonable amount of time is subjective and depends on the goals of your problem.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenJDK 11 or later is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
					</li><li class="listitem">
						Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
					</li><li class="listitem">
						An IDE, such as IntelliJ IDEA, VSCode, Eclipse, or NetBeans is available.
					</li></ul></div><section class="section" id="proc-quarkus-creating-proj_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.1. Creating an OptaPlanner Red Hat build of Quarkus Maven project using the Maven plug-in</h2></div></div></div><p>
					You can get up and running with a Red Hat build of OptaPlanner and Quarkus application using Apache Maven and the Quarkus Maven plug-in.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenJDK 11 or later is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
						</li><li class="listitem">
							Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							In a command terminal, enter the following command to verify that Maven is using JDK 11 and that the Maven version is 3.6 or higher:
						</p><pre class="screen">mvn --version</pre></li><li class="listitem">
							If the preceding command does not return JDK 11, add the path to JDK 11 to the PATH environment variable and enter the preceding command again.
						</li><li class="listitem"><p class="simpara">
							To generate a Quarkus OptaPlanner quickstart project, enter the following command:
						</p><pre class="programlisting language-shell">mvn com.redhat.quarkus.platform:quarkus-maven-plugin:2.7.5.Final-redhat-00011:create \
    -DprojectGroupId=com.example \
    -DprojectArtifactId=optaplanner-quickstart  \
    -Dextensions="resteasy,resteasy-jackson,optaplanner-quarkus,optaplanner-quarkus-jackson" \
    -DplatformGroupId=com.redhat.quarkus.platform
    -DplatformVersion=2.7.5.Final-redhat-00011 \
    -DnoExamples</pre><p class="simpara">
							This command create the following elements in the <code class="literal">./optaplanner-quickstart</code> directory:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The Maven structure
								</li><li class="listitem">
									Example <code class="literal">Dockerfile</code> file in <code class="literal">src/main/docker</code>
								</li><li class="listitem"><p class="simpara">
									The application configuration file
								</p><div class="table" id="idm45892290992336"><p class="title"><strong>Table 10.1. Properties used in the mvn <code class="literal">io.quarkus:quarkus-maven-plugin:2.7.5.Final-redhat-00011:create</code> command</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"/><col style="width: 70%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892290986960" scope="col">Property</th><th align="left" valign="top" id="idm45892290985872" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892290986960">
												<p>
													<code class="literal">projectGroupId</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892290985872">
												<p>
													The group ID of the project.
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892290986960">
												<p>
													<code class="literal">projectArtifactId</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892290985872">
												<p>
													The artifact ID of the project.
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892290986960">
												<p>
													<code class="literal">extensions</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892290985872">
												<p>
													A comma-separated list of Quarkus extensions to use with this project. For a full list of Quarkus extensions, enter <code class="literal">mvn quarkus:list-extensions</code> on the command line.
												</p>
												</td></tr><tr><td align="left" valign="top" headers="idm45892290986960">
												<p>
													<code class="literal">noExamples</code>
												</p>
												</td><td align="left" valign="top" headers="idm45892290985872">
												<p>
													Creates a project with the project structure but without tests or classes.
												</p>
												</td></tr></tbody></table></div></div><p class="simpara">
									The values of the <code class="literal">projectGroupID</code> and the <code class="literal">projectArtifactID</code> properties are used to generate the project version. The default project version is <code class="literal">1.0.0-SNAPSHOT</code>.
								</p></li></ul></div></li><li class="listitem"><p class="simpara">
							To view your OptaPlanner project, change directory to the OptaPlanner Quickstarts directory:
						</p><pre class="screen">cd optaplanner-quickstart</pre></li><li class="listitem"><p class="simpara">
							Review the <code class="literal">pom.xml</code> file. The content should be similar to the following example:
						</p><pre class="screen">&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus.platform&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-bom&lt;/artifactId&gt;
      &lt;version&gt;2.7.5.Final-redhat-00011&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus.platform&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-optaplanner-bom&lt;/artifactId&gt;
      &lt;version&gt;2.7.5.Final-redhat-00011&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-resteasy&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-resteasy-jackson&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-quarkus&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-quarkus-jackson&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-junit5&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</pre></li></ol></div></section><section class="section" id="business-optimizr-domain-objects-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.2. Model the domain objects</h2></div></div></div><p>
					The goal of the Red Hat build of OptaPlanner timetable project is to assign each lesson to a time slot and a room. To do this, add three classes, <code class="literal">Timeslot</code>, <code class="literal">Lesson</code>, and <code class="literal">Room</code>, as shown in the following diagram:
				</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableClassDiagramPure.png" alt="timeTableClassDiagramPure"/></div></div><div class="formalpara"><p class="title"><strong>Timeslot</strong></p><p>
						The <code class="literal">Timeslot</code> class represents a time interval when lessons are taught, for example, <code class="literal">Monday 10:30 - 11:30</code> or <code class="literal">Tuesday 13:30 - 14:30</code>. In this example, all time slots have the same duration and there are no time slots during lunch or other breaks.
					</p></div><p>
					A time slot has no date because a high school schedule just repeats every week. There is no need for <a class="link" href="https://docs.optaplanner.org/latestFinal/optaplanner-docs/html_single/index.html#continuousPlanning">continuous planning</a>. A timeslot is called a <span class="emphasis"><em>problem fact</em></span> because no <code class="literal">Timeslot</code> instances change during solving. Such classes do not require any OptaPlanner-specific annotations.
				</p><div class="formalpara"><p class="title"><strong>Room</strong></p><p>
						The <code class="literal">Room</code> class represents a location where lessons are taught, for example, <code class="literal">Room A</code> or <code class="literal">Room B</code>. In this example, all rooms are without capacity limits and they can accommodate all lessons.
					</p></div><p>
					<code class="literal">Room</code> instances do not change during solving so <code class="literal">Room</code> is also a <span class="emphasis"><em>problem fact</em></span>.
				</p><div class="formalpara"><p class="title"><strong>Lesson</strong></p><p>
						During a lesson, represented by the <code class="literal">Lesson</code> class, a teacher teaches a subject to a group of students, for example, <code class="literal">Math by A.Turing for 9th grade</code> or <code class="literal">Chemistry by M.Curie for 10th grade</code>. If a subject is taught multiple times each week by the same teacher to the same student group, there are multiple <code class="literal">Lesson</code> instances that are only distinguishable by <code class="literal">id</code>. For example, the 9th grade has six math lessons a week.
					</p></div><p>
					During solving, OptaPlanner changes the <code class="literal">timeslot</code> and <code class="literal">room</code> fields of the <code class="literal">Lesson</code> class to assign each lesson to a time slot and a room. Because OptaPlanner changes these fields, <code class="literal">Lesson</code> is a <span class="emphasis"><em>planning entity</em></span>:
				</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableClassDiagramAnnotated.png" alt="timeTableClassDiagramAnnotated"/></div></div><p>
					Most of the fields in the previous diagram contain input data, except for the orange fields. A lesson’s <code class="literal">timeslot</code> and <code class="literal">room</code> fields are unassigned (<code class="literal">null</code>) in the input data and assigned (not <code class="literal">null</code>) in the output data. OptaPlanner changes these fields during solving. Such fields are called planning variables. In order for OptaPlanner to recognize them, both the <code class="literal">timeslot</code> and <code class="literal">room</code> fields require an <code class="literal">@PlanningVariable</code> annotation. Their containing class, <code class="literal">Lesson</code>, requires an <code class="literal">@PlanningEntity</code> annotation.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Timeslot.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

import java.time.DayOfWeek;
import java.time.LocalTime;

public class Timeslot {

    private DayOfWeek dayOfWeek;
    private LocalTime startTime;
    private LocalTime endTime;

    private Timeslot() {
    }

    public Timeslot(DayOfWeek dayOfWeek, LocalTime startTime, LocalTime endTime) {
        this.dayOfWeek = dayOfWeek;
        this.startTime = startTime;
        this.endTime = endTime;
    }

    @Override
    public String toString() {
        return dayOfWeek + " " + startTime.toString();
    }

    // ********************************
    // Getters and setters
    // ********************************

    public DayOfWeek getDayOfWeek() {
        return dayOfWeek;
    }

    public LocalTime getStartTime() {
        return startTime;
    }

    public LocalTime getEndTime() {
        return endTime;
    }

}</pre><p class="simpara">
							Notice the <code class="literal">toString()</code> method keeps the output short so it is easier to read OptaPlanner’s <code class="literal">DEBUG</code> or <code class="literal">TRACE</code> log, as shown later.
						</p></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Room.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

public class Room {

    private String name;

    private Room() {
    }

    public Room(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return name;
    }

    // ********************************
    // Getters and setters
    // ********************************

    public String getName() {
        return name;
    }

}</pre></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Lesson.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

import org.optaplanner.core.api.domain.entity.PlanningEntity;
import org.optaplanner.core.api.domain.variable.PlanningVariable;

@PlanningEntity
public class Lesson {

    private Long id;

    private String subject;
    private String teacher;
    private String studentGroup;

    @PlanningVariable(valueRangeProviderRefs = "timeslotRange")
    private Timeslot timeslot;

    @PlanningVariable(valueRangeProviderRefs = "roomRange")
    private Room room;

    private Lesson() {
    }

    public Lesson(Long id, String subject, String teacher, String studentGroup) {
        this.id = id;
        this.subject = subject;
        this.teacher = teacher;
        this.studentGroup = studentGroup;
    }

    @Override
    public String toString() {
        return subject + "(" + id + ")";
    }

    // ********************************
    // Getters and setters
    // ********************************

    public Long getId() {
        return id;
    }

    public String getSubject() {
        return subject;
    }

    public String getTeacher() {
        return teacher;
    }

    public String getStudentGroup() {
        return studentGroup;
    }

    public Timeslot getTimeslot() {
        return timeslot;
    }

    public void setTimeslot(Timeslot timeslot) {
        this.timeslot = timeslot;
    }

    public Room getRoom() {
        return room;
    }

    public void setRoom(Room room) {
        this.room = room;
    }

}</pre><p class="simpara">
							The <code class="literal">Lesson</code> class has an <code class="literal">@PlanningEntity</code> annotation, so OptaPlanner knows that this class changes during solving because it contains one or more planning variables.
						</p><p class="simpara">
							The <code class="literal">timeslot</code> field has an <code class="literal">@PlanningVariable</code> annotation, so OptaPlanner knows that it can change its value. In order to find potential <code class="literal">Timeslot</code> instances to assign to this field, OptaPlanner uses the <code class="literal">valueRangeProviderRefs</code> property to connect to a value range provider that provides a <code class="literal">List&lt;Timeslot&gt;</code> to pick from. See <a class="xref" href="#business-optimizr-gather-objects-proc_optaplanner-quarkus" title="10.4. Gather the domain objects in a planning solution">Section 10.4, “Gather the domain objects in a planning solution”</a> for information about value range providers.
						</p><p class="simpara">
							The <code class="literal">room</code> field also has an <code class="literal">@PlanningVariable</code> annotation for the same reasons.
						</p></li></ol></div></section><section class="section" id="business-optimizr-define-contraints-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.3. Define the constraints and calculate the score</h2></div></div></div><p>
					When solving a problem, a <span class="emphasis"><em>score</em></span> represents the quality of a specific solution. The higher the score the better. Red Hat build of OptaPlanner looks for the best solution, which is the solution with the highest score found in the available time. It might be the <span class="emphasis"><em>optimal</em></span> solution.
				</p><p>
					Because the timetable example use case has hard and soft constraints, use the <code class="literal">HardSoftScore</code> class to represent the score:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Hard constraints must not be broken. For example: <span class="emphasis"><em>A room can have at most one lesson at the same time.</em></span>
						</li><li class="listitem">
							Soft constraints should not be broken. For example: <span class="emphasis"><em>A teacher prefers to teach in a single room.</em></span>
						</li></ul></div><p>
					Hard constraints are weighted against other hard constraints. Soft constraints are weighted against other soft constraints. Hard constraints always outweigh soft constraints, regardless of their respective weights.
				</p><p>
					To calculate the score, you could implement an <code class="literal">EasyScoreCalculator</code> class:
				</p><pre class="programlisting language-java">public class TimeTableEasyScoreCalculator implements EasyScoreCalculator&lt;TimeTable&gt; {

    @Override
    public HardSoftScore calculateScore(TimeTable timeTable) {
        List&lt;Lesson&gt; lessonList = timeTable.getLessonList();
        int hardScore = 0;
        for (Lesson a : lessonList) {
            for (Lesson b : lessonList) {
                if (a.getTimeslot() != null &amp;&amp; a.getTimeslot().equals(b.getTimeslot())
                        &amp;&amp; a.getId() &lt; b.getId()) {
                    // A room can accommodate at most one lesson at the same time.
                    if (a.getRoom() != null &amp;&amp; a.getRoom().equals(b.getRoom())) {
                        hardScore--;
                    }
                    // A teacher can teach at most one lesson at the same time.
                    if (a.getTeacher().equals(b.getTeacher())) {
                        hardScore--;
                    }
                    // A student can attend at most one lesson at the same time.
                    if (a.getStudentGroup().equals(b.getStudentGroup())) {
                        hardScore--;
                    }
                }
            }
        }
        int softScore = 0;
        // Soft constraints are only implemented in the "complete" implementation
        return HardSoftScore.of(hardScore, softScore);
    }

}</pre><p>
					Unfortunately, this solution does not scale well because it is non-incremental: every time a lesson is assigned to a different time slot or room, all lessons are re-evaluated to calculate the new score.
				</p><p>
					A better solution is to create a <code class="literal">src/main/java/com/example/solver/TimeTableConstraintProvider.java</code> class to perform incremental score calculation. This class uses OptaPlanner’s ConstraintStream API which is inspired by Java 8 Streams and SQL. The <code class="literal">ConstraintProvider</code> scales an order of magnitude better than the <code class="literal">EasyScoreCalculator</code>: <span class="emphasis"><em>O</em></span>(n) instead of <span class="emphasis"><em>O</em></span>(n²).
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the following <code class="literal">src/main/java/com/example/solver/TimeTableConstraintProvider.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.solver;

import com.example.domain.Lesson;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;
import org.optaplanner.core.api.score.stream.Constraint;
import org.optaplanner.core.api.score.stream.ConstraintFactory;
import org.optaplanner.core.api.score.stream.ConstraintProvider;
import org.optaplanner.core.api.score.stream.Joiners;

public class TimeTableConstraintProvider implements ConstraintProvider {

    @Override
    public Constraint[] defineConstraints(ConstraintFactory constraintFactory) {
        return new Constraint[] {
                // Hard constraints
                roomConflict(constraintFactory),
                teacherConflict(constraintFactory),
                studentGroupConflict(constraintFactory),
                // Soft constraints are only implemented in the "complete" implementation
        };
    }

    private Constraint roomConflict(ConstraintFactory constraintFactory) {
        // A room can accommodate at most one lesson at the same time.

        // Select a lesson ...
        return constraintFactory.from(Lesson.class)
                // ... and pair it with another lesson ...
                .join(Lesson.class,
                        // ... in the same timeslot ...
                        Joiners.equal(Lesson::getTimeslot),
                        // ... in the same room ...
                        Joiners.equal(Lesson::getRoom),
                        // ... and the pair is unique (different id, no reverse pairs)
                        Joiners.lessThan(Lesson::getId))
                // then penalize each pair with a hard weight.
                .penalize("Room conflict", HardSoftScore.ONE_HARD);
    }

    private Constraint teacherConflict(ConstraintFactory constraintFactory) {
        // A teacher can teach at most one lesson at the same time.
        return constraintFactory.from(Lesson.class)
                .join(Lesson.class,
                        Joiners.equal(Lesson::getTimeslot),
                        Joiners.equal(Lesson::getTeacher),
                        Joiners.lessThan(Lesson::getId))
                .penalize("Teacher conflict", HardSoftScore.ONE_HARD);
    }

    private Constraint studentGroupConflict(ConstraintFactory constraintFactory) {
        // A student can attend at most one lesson at the same time.
        return constraintFactory.from(Lesson.class)
                .join(Lesson.class,
                        Joiners.equal(Lesson::getTimeslot),
                        Joiners.equal(Lesson::getStudentGroup),
                        Joiners.lessThan(Lesson::getId))
                .penalize("Student group conflict", HardSoftScore.ONE_HARD);
    }

}</pre></section><section class="section" id="business-optimizr-gather-objects-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.4. Gather the domain objects in a planning solution</h2></div></div></div><p>
					A <code class="literal">TimeTable</code> instance wraps all <code class="literal">Timeslot</code>, <code class="literal">Room</code>, and <code class="literal">Lesson</code> instances of a single dataset. Furthermore, because it contains all lessons, each with a specific planning variable state, it is a <span class="emphasis"><em>planning solution</em></span> and it has a score:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If lessons are still unassigned, then it is an <span class="emphasis"><em>uninitialized</em></span> solution, for example, a solution with the score <code class="literal">-4init/0hard/0soft</code>.
						</li><li class="listitem">
							If it breaks hard constraints, then it is an <span class="emphasis"><em>infeasible</em></span> solution, for example, a solution with the score <code class="literal">-2hard/-3soft</code>.
						</li><li class="listitem">
							If it adheres to all hard constraints, then it is a <span class="emphasis"><em>feasible</em></span> solution, for example, a solution with the score <code class="literal">0hard/-7soft</code>.
						</li></ul></div><p>
					The <code class="literal">TimeTable</code> class has an <code class="literal">@PlanningSolution</code> annotation, so Red Hat build of OptaPlanner knows that this class contains all of the input and output data.
				</p><p>
					Specifically, this class is the input of the problem:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							A <code class="literal">timeslotList</code> field with all time slots
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of problem facts, because they do not change during solving.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A <code class="literal">roomList</code> field with all rooms
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of problem facts, because they do not change during solving.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A <code class="literal">lessonList</code> field with all lessons
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of planning entities because they change during solving.
								</li><li class="listitem"><p class="simpara">
									Of each <code class="literal">Lesson</code>:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											The values of the <code class="literal">timeslot</code> and <code class="literal">room</code> fields are typically still <code class="literal">null</code>, so unassigned. They are planning variables.
										</li><li class="listitem">
											The other fields, such as <code class="literal">subject</code>, <code class="literal">teacher</code> and <code class="literal">studentGroup</code>, are filled in. These fields are problem properties.
										</li></ul></div></li></ul></div></li></ul></div><p>
					However, this class is also the output of the solution:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">lessonList</code> field for which each <code class="literal">Lesson</code> instance has non-null <code class="literal">timeslot</code> and <code class="literal">room</code> fields after solving
						</li><li class="listitem">
							A <code class="literal">score</code> field that represents the quality of the output solution, for example, <code class="literal">0hard/-5soft</code>
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/java/com/example/domain/TimeTable.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.domain;

import java.util.List;

import org.optaplanner.core.api.domain.solution.PlanningEntityCollectionProperty;
import org.optaplanner.core.api.domain.solution.PlanningScore;
import org.optaplanner.core.api.domain.solution.PlanningSolution;
import org.optaplanner.core.api.domain.solution.ProblemFactCollectionProperty;
import org.optaplanner.core.api.domain.valuerange.ValueRangeProvider;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;

@PlanningSolution
public class TimeTable {

    @ValueRangeProvider(id = "timeslotRange")
    @ProblemFactCollectionProperty
    private List&lt;Timeslot&gt; timeslotList;

    @ValueRangeProvider(id = "roomRange")
    @ProblemFactCollectionProperty
    private List&lt;Room&gt; roomList;

    @PlanningEntityCollectionProperty
    private List&lt;Lesson&gt; lessonList;

    @PlanningScore
    private HardSoftScore score;

    private TimeTable() {
    }

    public TimeTable(List&lt;Timeslot&gt; timeslotList, List&lt;Room&gt; roomList,
            List&lt;Lesson&gt; lessonList) {
        this.timeslotList = timeslotList;
        this.roomList = roomList;
        this.lessonList = lessonList;
    }

    // ********************************
    // Getters and setters
    // ********************************

    public List&lt;Timeslot&gt; getTimeslotList() {
        return timeslotList;
    }

    public List&lt;Room&gt; getRoomList() {
        return roomList;
    }

    public List&lt;Lesson&gt; getLessonList() {
        return lessonList;
    }

    public HardSoftScore getScore() {
        return score;
    }

}</pre><div class="formalpara"><p class="title"><strong>The value range providers</strong></p><p>
						The <code class="literal">timeslotList</code> field is a value range provider. It holds the <code class="literal">Timeslot</code> instances which OptaPlanner can pick from to assign to the <code class="literal">timeslot</code> field of <code class="literal">Lesson</code> instances. The <code class="literal">timeslotList</code> field has an <code class="literal">@ValueRangeProvider</code> annotation to connect those two, by matching the <code class="literal">id</code> with the <code class="literal">valueRangeProviderRefs</code> of the <code class="literal">@PlanningVariable</code> in the <code class="literal">Lesson</code>.
					</p></div><p>
					Following the same logic, the <code class="literal">roomList</code> field also has an <code class="literal">@ValueRangeProvider</code> annotation.
				</p><div class="formalpara"><p class="title"><strong>The problem fact and planning entity properties</strong></p><p>
						Furthermore, OptaPlanner needs to know which <code class="literal">Lesson</code> instances it can change as well as how to retrieve the <code class="literal">Timeslot</code> and <code class="literal">Room</code> instances used for score calculation by your <code class="literal">TimeTableConstraintProvider</code>.
					</p></div><p>
					The <code class="literal">timeslotList</code> and <code class="literal">roomList</code> fields have an <code class="literal">@ProblemFactCollectionProperty</code> annotation, so your <code class="literal">TimeTableConstraintProvider</code> can select from those instances.
				</p><p>
					The <code class="literal">lessonList</code> has an <code class="literal">@PlanningEntityCollectionProperty</code> annotation, so OptaPlanner can change them during solving and your <code class="literal">TimeTableConstraintProvider</code> can select from those too.
				</p></section><section class="section" id="solver-service-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.5. Create the solver service</h2></div></div></div><p>
					Solving planning problems on REST threads causes HTTP timeout issues. Therefore, the Quarkus extension injects a SolverManager, which runs solvers in a separate thread pool and can solve multiple data sets in parallel.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/java/org/acme/optaplanner/rest/TimeTableResource.java</code> class:
					</p></div><pre class="programlisting language-java">package org.acme.optaplanner.rest;

import java.util.UUID;
import java.util.concurrent.ExecutionException;
import javax.inject.Inject;
import javax.ws.rs.POST;
import javax.ws.rs.Path;

import org.acme.optaplanner.domain.TimeTable;
import org.optaplanner.core.api.solver.SolverJob;
import org.optaplanner.core.api.solver.SolverManager;

@Path("/timeTable")
public class TimeTableResource {

    @Inject
    SolverManager&lt;TimeTable, UUID&gt; solverManager;

    @POST
    @Path("/solve")
    public TimeTable solve(TimeTable problem) {
        UUID problemId = UUID.randomUUID();
        // Submit the problem to start solving
        SolverJob&lt;TimeTable, UUID&gt; solverJob = solverManager.solve(problemId, problem);
        TimeTable solution;
        try {
            // Wait until the solving ends
            solution = solverJob.getFinalBestSolution();
        } catch (InterruptedException | ExecutionException e) {
            throw new IllegalStateException("Solving failed.", e);
        }
        return solution;
    }

}</pre><p>
					This initial implementation waits for the solver to finish, which can still cause an HTTP timeout. The complete implementation avoids HTTP timeouts much more elegantly.
				</p></section><section class="section" id="business-optimizr-set-solver-time-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.6. Set the solver termination time</h2></div></div></div><p>
					If your planning application does not have a termination setting or a termination event, it theoretically runs forever and in reality eventually causes an HTTP timeout error. To prevent this from occurring, use the <code class="literal">optaplanner.solver.termination.spent-limit</code> parameter to specify the length of time after which the application terminates. In most applications, set the time to at least five minutes (<code class="literal">5m</code>). However, in the Timetable example, limit the solving time to five seconds, which is short enough to avoid the HTTP timeout.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/resources/application.properties</code> file with the following content:
					</p></div><pre class="programlisting language-properties">quarkus.optaplanner.solver.termination.spent-limit=5s</pre></section><section class="section" id="proc-quarkus-compiling-project_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.7. Running the school timetable application</h2></div></div></div><p>
					After you have created the school timetable project, run it in development mode. In development mode, you can update the application sources and configurations while your application is running. Your changes will appear in the running application.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have created the school timetable project.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To compile the application in development mode, enter the following command from the project directory:
						</p><pre class="screen">./mvnw compile quarkus:dev</pre></li><li class="listitem"><p class="simpara">
							Test the REST service. You can use any REST client. The following example uses the Linux command <code class="literal">curl</code> to send a POST request:
						</p><pre class="screen">$ curl -i -X POST http://localhost:8080/timeTable/solve -H "Content-Type:application/json" -d '{"timeslotList":[{"dayOfWeek":"MONDAY","startTime":"08:30:00","endTime":"09:30:00"},{"dayOfWeek":"MONDAY","startTime":"09:30:00","endTime":"10:30:00"}],"roomList":[{"name":"Room A"},{"name":"Room B"}],"lessonList":[{"id":1,"subject":"Math","teacher":"A. Turing","studentGroup":"9th grade"},{"id":2,"subject":"Chemistry","teacher":"M. Curie","studentGroup":"9th grade"},{"id":3,"subject":"French","teacher":"M. Curie","studentGroup":"10th grade"},{"id":4,"subject":"History","teacher":"I. Jones","studentGroup":"10th grade"}]}'</pre><p class="simpara">
							After the time period specified in <code class="literal">termination spent time</code> defined in your <code class="literal">application.properties</code> file, the service returns output similar to the following example:
						</p><pre class="screen">HTTP/1.1 200
Content-Type: application/json
...

{"timeslotList":...,"roomList":...,"lessonList":[{"id":1,"subject":"Math","teacher":"A. Turing","studentGroup":"9th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"08:30:00","endTime":"09:30:00"},"room":{"name":"Room A"}},{"id":2,"subject":"Chemistry","teacher":"M. Curie","studentGroup":"9th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"09:30:00","endTime":"10:30:00"},"room":{"name":"Room A"}},{"id":3,"subject":"French","teacher":"M. Curie","studentGroup":"10th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"08:30:00","endTime":"09:30:00"},"room":{"name":"Room B"}},{"id":4,"subject":"History","teacher":"I. Jones","studentGroup":"10th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"09:30:00","endTime":"10:30:00"},"room":{"name":"Room B"}}],"score":"0hard/0soft"}</pre><p class="simpara">
							Notice that your application assigned all four lessons to one of the two time slots and one of the two rooms. Also notice that it conforms to all hard constraints. For example, M. Curie’s two lessons are in different time slots.
						</p></li><li class="listitem"><p class="simpara">
							To review what OptaPlanner did during the solving time, review the info log on the server side. The following is sample info log output:
						</p><pre class="screen">... Solving started: time spent (33), best score (-8init/0hard/0soft), environment mode (REPRODUCIBLE), random (JDK with seed 0).
... Construction Heuristic phase (0) ended: time spent (73), best score (0hard/0soft), score calculation speed (459/sec), step total (4).
... Local Search phase (1) ended: time spent (5000), best score (0hard/0soft), score calculation speed (28949/sec), step total (28398).
... Solving ended: time spent (5000), best score (0hard/0soft), score calculation speed (28524/sec), phase total (2), environment mode (REPRODUCIBLE).</pre></li></ol></div></section><section class="section" id="testing_the_application"><div class="titlepage"><div><div><h2 class="title">10.8. Testing the application</h2></div></div></div><p>
					A good application includes test coverage. Test the constraints and the solver in your timetable project.
				</p><section class="section" id="business-optimizer-test-constraints-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h3 class="title">10.8.1. Test the school timetable constraints</h3></div></div></div><p>
						To test each constraint of the timetable project in isolation, use a <code class="literal">ConstraintVerifier</code> in unit tests. This tests each constraint’s corner cases in isolation from the other tests, which lowers maintenance when adding a new constraint with proper test coverage.
					</p><p>
						This test verifies that the constraint <code class="literal">TimeTableConstraintProvider::roomConflict</code>, when given three lessons in the same room and two of the lessons have the same timeslot, penalizes with a match weight of 1. So if the constraint weight is <code class="literal">10hard</code> it reduces the score by <code class="literal">-10hard</code>.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Create the <code class="literal">src/test/java/org/acme/optaplanner/solver/TimeTableConstraintProviderTest.java</code> class:
						</p></div><pre class="programlisting language-java">package org.acme.optaplanner.solver;

import java.time.DayOfWeek;
import java.time.LocalTime;

import javax.inject.Inject;

import io.quarkus.test.junit.QuarkusTest;
import org.acme.optaplanner.domain.Lesson;
import org.acme.optaplanner.domain.Room;
import org.acme.optaplanner.domain.TimeTable;
import org.acme.optaplanner.domain.Timeslot;
import org.junit.jupiter.api.Test;
import org.optaplanner.test.api.score.stream.ConstraintVerifier;

@QuarkusTest
class TimeTableConstraintProviderTest {

    private static final Room ROOM = new Room("Room1");
    private static final Timeslot TIMESLOT1 = new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9,0), LocalTime.NOON);
    private static final Timeslot TIMESLOT2 = new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(9,0), LocalTime.NOON);

    @Inject
    ConstraintVerifier&lt;TimeTableConstraintProvider, TimeTable&gt; constraintVerifier;

    @Test
    void roomConflict() {
        Lesson firstLesson = new Lesson(1, "Subject1", "Teacher1", "Group1");
        Lesson conflictingLesson = new Lesson(2, "Subject2", "Teacher2", "Group2");
        Lesson nonConflictingLesson = new Lesson(3, "Subject3", "Teacher3", "Group3");

        firstLesson.setRoom(ROOM);
        firstLesson.setTimeslot(TIMESLOT1);

        conflictingLesson.setRoom(ROOM);
        conflictingLesson.setTimeslot(TIMESLOT1);

        nonConflictingLesson.setRoom(ROOM);
        nonConflictingLesson.setTimeslot(TIMESLOT2);

        constraintVerifier.verifyThat(TimeTableConstraintProvider::roomConflict)
                .given(firstLesson, conflictingLesson, nonConflictingLesson)
                .penalizesBy(1);
    }

}</pre><p>
						Notice how <code class="literal">ConstraintVerifier</code> ignores the constraint weight during testing even if those constraint weights are hardcoded in the <code class="literal">ConstraintProvider</code>. This is because constraint weights change regularly before going into production. This way, constraint weight tweaking does not break the unit tests.
					</p></section><section class="section" id="business-optimizer-test-solver-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h3 class="title">10.8.2. Test the school timetable solver</h3></div></div></div><p>
						This example tests the Red Hat build of OptaPlanner school timetable project on Red Hat build of Quarkus. It uses a JUnit test to generate a test data set and send it to the <code class="literal">TimeTableController</code> to solve.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the <code class="literal">src/test/java/com/example/rest/TimeTableResourceTest.java</code> class with the following content:
							</p><pre class="programlisting language-java">package com.exmaple.optaplanner.rest;

import java.time.DayOfWeek;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;

import io.quarkus.test.junit.QuarkusTest;
import com.exmaple.optaplanner.domain.Room;
import com.exmaple.optaplanner.domain.Timeslot;
import com.exmaple.optaplanner.domain.Lesson;
import com.exmaple.optaplanner.domain.TimeTable;
import com.exmaple.optaplanner.rest.TimeTableResource;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Timeout;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

@QuarkusTest
public class TimeTableResourceTest {

    @Inject
    TimeTableResource timeTableResource;

    @Test
    @Timeout(600_000)
    public void solve() {
        TimeTable problem = generateProblem();
        TimeTable solution = timeTableResource.solve(problem);
        assertFalse(solution.getLessonList().isEmpty());
        for (Lesson lesson : solution.getLessonList()) {
            assertNotNull(lesson.getTimeslot());
            assertNotNull(lesson.getRoom());
        }
        assertTrue(solution.getScore().isFeasible());
    }

    private TimeTable generateProblem() {
        List&lt;Timeslot&gt; timeslotList = new ArrayList&lt;&gt;();
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        List&lt;Room&gt; roomList = new ArrayList&lt;&gt;();
        roomList.add(new Room("Room A"));
        roomList.add(new Room("Room B"));
        roomList.add(new Room("Room C"));

        List&lt;Lesson&gt; lessonList = new ArrayList&lt;&gt;();
        lessonList.add(new Lesson(101L, "Math", "B. May", "9th grade"));
        lessonList.add(new Lesson(102L, "Physics", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(103L, "Geography", "M. Polo", "9th grade"));
        lessonList.add(new Lesson(104L, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(105L, "Spanish", "P. Cruz", "9th grade"));

        lessonList.add(new Lesson(201L, "Math", "B. May", "10th grade"));
        lessonList.add(new Lesson(202L, "Chemistry", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(203L, "History", "I. Jones", "10th grade"));
        lessonList.add(new Lesson(204L, "English", "P. Cruz", "10th grade"));
        lessonList.add(new Lesson(205L, "French", "M. Curie", "10th grade"));
        return new TimeTable(timeslotList, roomList, lessonList);
    }

}</pre><p class="simpara">
								This test verifies that after solving, all lessons are assigned to a time slot and a room. It also verifies that it found a feasible solution (no hard constraints broken).
							</p></li><li class="listitem"><p class="simpara">
								Add test properties to the <code class="literal">src/main/resources/application.properties</code> file:
							</p><pre class="screen"># The solver runs only for 5 seconds to avoid a HTTP timeout in this simple implementation.
# It's recommended to run for at least 5 minutes ("5m") otherwise.
quarkus.optaplanner.solver.termination.spent-limit=5s

# Effectively disable this termination in favor of the best-score-limit
%test.quarkus.optaplanner.solver.termination.spent-limit=1h
%test.quarkus.optaplanner.solver.termination.best-score-limit=0hard/*soft</pre></li></ol></div><p>
						Normally, the solver finds a feasible solution in less than 200 milliseconds. Notice how the <code class="literal">application.properties</code> file overwrites the solver termination during tests to terminate as soon as a feasible solution <code class="literal">(0hard/*soft)</code> is found. This avoids hard coding a solver time, because the unit test might run on arbitrary hardware. This approach ensures that the test runs long enough to find a feasible solution, even on slow systems. But it does not run a millisecond longer than it strictly must, even on fast systems.
					</p></section></section><section class="section" id="business-optimizer-logging-quarkus-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.9. Logging</h2></div></div></div><p>
					After you complete the Red Hat build of OptaPlanner school timetable project, you can use logging information to help you fine-tune the constraints in the <code class="literal">ConstraintProvider</code>. Review the score calculation speed in the <code class="literal">info</code> log file to assess the impact of changes to your constraints. Run the application in debug mode to show every step that your application takes or use trace logging to log every step and every move.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Run the school timetable application for a fixed amount of time, for example, five minutes.
						</li><li class="listitem"><p class="simpara">
							Review the score calculation speed in the <code class="literal">log</code> file as shown in the following example:
						</p><pre class="screen">... Solving ended: ..., score calculation speed (29455/sec), ...</pre></li><li class="listitem">
							Change a constraint, run the planning application again for the same amount of time, and review the score calculation speed recorded in the <code class="literal">log</code> file.
						</li><li class="listitem"><p class="simpara">
							Run the application in debug mode to log every step that the application makes:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To run debug mode from the command line, use the <code class="literal">-D</code> system property.
								</li><li class="listitem"><p class="simpara">
									To permanently enable debug mode, add the following line to the <code class="literal">application.properties</code> file:
								</p><pre class="programlisting language-properties">quarkus.log.category."org.optaplanner".level=debug</pre><p class="simpara">
									The following example shows output in the <code class="literal">log</code> file in debug mode:
								</p><pre class="screen">... Solving started: time spent (67), best score (-20init/0hard/0soft), environment mode (REPRODUCIBLE), random (JDK with seed 0).
...     CH step (0), time spent (128), score (-18init/0hard/0soft), selected move count (15), picked move ([Math(101) {null -&gt; Room A}, Math(101) {null -&gt; MONDAY 08:30}]).
...     CH step (1), time spent (145), score (-16init/0hard/0soft), selected move count (15), picked move ([Physics(102) {null -&gt; Room A}, Physics(102) {null -&gt; MONDAY 09:30}]).
...</pre></li></ul></div></li><li class="listitem">
							Use <code class="literal">trace</code> logging to show every step and every move for each step.
						</li></ol></div></section><section class="section" id="planner-quarkus-database-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.10. Integrating a database with your Quarkus OptaPlanner school timetable application</h2></div></div></div><p>
					After you create your Quarkus OptaPlanner school timetable application, you can integrate it with a database and create a web-based user interface to display the timetable.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a Quarkus OptaPlanner school timetable application.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Use Hibernate and Panache to store <code class="literal">Timeslot</code>, <code class="literal">Room</code>, and <code class="literal">Lesson</code> instances in a database. See <a class="link" href="https://quarkus.io/guides/hibernate-orm-panache">Simplified Hibernate ORM with Panache</a> for more information.
						</li><li class="listitem">
							Expose the instances through REST. For information, see <a class="link" href="https://quarkus.io/guides/rest-json">Writing JSON REST Services</a>.
						</li><li class="listitem"><p class="simpara">
							Update the <code class="literal">TimeTableResource</code> class to read and write a <code class="literal">TimeTable</code> instance in a single transaction:
						</p><pre class="screen">package org.acme.optaplanner.rest;

import javax.inject.Inject;
import javax.transaction.Transactional;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;

import io.quarkus.panache.common.Sort;
import org.acme.optaplanner.domain.Lesson;
import org.acme.optaplanner.domain.Room;
import org.acme.optaplanner.domain.TimeTable;
import org.acme.optaplanner.domain.Timeslot;
import org.optaplanner.core.api.score.ScoreManager;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;
import org.optaplanner.core.api.solver.SolverManager;
import org.optaplanner.core.api.solver.SolverStatus;

@Path("/timeTable")
public class TimeTableResource {

    public static final Long SINGLETON_TIME_TABLE_ID = 1L;

    @Inject
    SolverManager&lt;TimeTable, Long&gt; solverManager;
    @Inject
    ScoreManager&lt;TimeTable, HardSoftScore&gt; scoreManager;

    // To try, open http://localhost:8080/timeTable
    @GET
    public TimeTable getTimeTable() {
        // Get the solver status before loading the solution
        // to avoid the race condition that the solver terminates between them
        SolverStatus solverStatus = getSolverStatus();
        TimeTable solution = findById(SINGLETON_TIME_TABLE_ID);
        scoreManager.updateScore(solution); // Sets the score
        solution.setSolverStatus(solverStatus);
        return solution;
    }

    @POST
    @Path("/solve")
    public void solve() {
        solverManager.solveAndListen(SINGLETON_TIME_TABLE_ID,
                this::findById,
                this::save);
    }

    public SolverStatus getSolverStatus() {
        return solverManager.getSolverStatus(SINGLETON_TIME_TABLE_ID);
    }

    @POST
    @Path("/stopSolving")
    public void stopSolving() {
        solverManager.terminateEarly(SINGLETON_TIME_TABLE_ID);
    }

    @Transactional
    protected TimeTable findById(Long id) {
        if (!SINGLETON_TIME_TABLE_ID.equals(id)) {
            throw new IllegalStateException("There is no timeTable with id (" + id + ").");
        }
        // Occurs in a single transaction, so each initialized lesson references the same timeslot/room instance
        // that is contained by the timeTable's timeslotList/roomList.
        return new TimeTable(
                Timeslot.listAll(Sort.by("dayOfWeek").and("startTime").and("endTime").and("id")),
                Room.listAll(Sort.by("name").and("id")),
                Lesson.listAll(Sort.by("subject").and("teacher").and("studentGroup").and("id")));
    }

    @Transactional
    protected void save(TimeTable timeTable) {
        for (Lesson lesson : timeTable.getLessonList()) {
            // TODO this is awfully naive: optimistic locking causes issues if called by the SolverManager
            Lesson attachedLesson = Lesson.findById(lesson.getId());
            attachedLesson.setTimeslot(lesson.getTimeslot());
            attachedLesson.setRoom(lesson.getRoom());
        }
    }

}</pre><p class="simpara">
							This example includes a <code class="literal">TimeTable</code> instance. However, you can enable multi-tenancy and handle <code class="literal">TimeTable</code> instances for multiple schools in parallel.
						</p><p class="simpara">
							The <code class="literal">getTimeTable()</code> method returns the latest timetable from the database. It uses the <code class="literal">ScoreManager</code> method, which is automatically injected, to calculate the score of that timetable and make it available to the UI.
						</p><p class="simpara">
							The <code class="literal">solve()</code> method starts a job to solve the current timetable and stores the time slot and room assignments in the database. It uses the <code class="literal">SolverManager.solveAndListen()</code> method to listen to intermediate best solutions and update the database accordingly. The UI uses this to show progress while the backend is still solving.
						</p></li><li class="listitem"><p class="simpara">
							Update the <code class="literal">TimeTableResourceTest</code> class to reflect that the <code class="literal">solve()</code> method returns immediately and to poll for the latest solution until the solver finishes solving:
						</p><pre class="screen">package org.acme.optaplanner.rest;

import javax.inject.Inject;

import io.quarkus.test.junit.QuarkusTest;
import org.acme.optaplanner.domain.Lesson;
import org.acme.optaplanner.domain.TimeTable;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Timeout;
import org.optaplanner.core.api.solver.SolverStatus;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

@QuarkusTest
public class TimeTableResourceTest {

    @Inject
    TimeTableResource timeTableResource;

    @Test
    @Timeout(600_000)
    public void solveDemoDataUntilFeasible() throws InterruptedException {
        timeTableResource.solve();
        TimeTable timeTable = timeTableResource.getTimeTable();
        while (timeTable.getSolverStatus() != SolverStatus.NOT_SOLVING) {
            // Quick polling (not a Test Thread Sleep anti-pattern)
            // Test is still fast on fast machines and doesn't randomly fail on slow machines.
            Thread.sleep(20L);
            timeTable = timeTableResource.getTimeTable();
        }
        assertFalse(timeTable.getLessonList().isEmpty());
        for (Lesson lesson : timeTable.getLessonList()) {
            assertNotNull(lesson.getTimeslot());
            assertNotNull(lesson.getRoom());
        }
        assertTrue(timeTable.getScore().isFeasible());
    }

}</pre></li><li class="listitem">
							Build a web UI on top of these REST methods to provide a visual representation of the timetable.
						</li><li class="listitem">
							Review the <a class="link" href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/optaplanner-quickstart">quickstart source code</a>.
						</li></ol></div></section><section class="section" id="micrometer-and-quarkus-proc_optaplanner-quarkus"><div class="titlepage"><div><div><h2 class="title">10.11. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Quarkus application</h2></div></div></div><p>
					OptaPlanner exposes metrics through <a class="link" href="https://micrometer.io/">Micrometer</a>, a metrics instrumentation library for Java applications. You can use Micrometer with Prometheus to monitor the OptaPlanner solver in the school timetable application.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have created the Quarkus OptaPlanner school timetable application.
						</li><li class="listitem">
							Prometheus is installed. For information about installing Prometheus, see the <a class="link" href="https://prometheus.io/">Prometheus</a> website.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the Micrometer Prometheus dependency to the school timetable <code class="literal">pom.xml</code> file:
						</p><pre class="screen">&lt;dependency&gt;
 &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
 &lt;artifactId&gt;quarkus-micrometer-registry-prometheus&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
							Start the school timetable application:
						</p><pre class="screen">mvn compile quarkus:dev</pre></li><li class="listitem">
							Open <code class="literal"><a class="link" href="http://localhost:8080/q/metric">http://localhost:8080/q/metric</a></code> in a web browser.
						</li></ol></div></section></section><section class="chapter" id="assembly-optaplanner-vaccination_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Red Hat build of OptaPlanner on Red Hat build of Quarkus: a vaccination appointment scheduler quick start guide</h2></div></div></div><p class="_abstract _abstract">
				You can use the OptaPlanner vaccination appointment scheduler quick start to develop a vaccination schedule that is both efficient and fair. The vaccination appointment scheduler uses artificial intelligence (AI) to prioritize people and allocate time slots based on multiple constraints and priorities.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenJDK 11 or later is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
					</li><li class="listitem">
						Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
					</li><li class="listitem">
						An IDE, such as IntelliJ IDEA, VSCode, Eclipse, or NetBeans is available.
					</li><li class="listitem">
						You have created a Quakus OptaPlanner project as described in <a class="xref" href="#optaplanner-quarkus-con_getting-started-optaplanner" title="Chapter 6. Getting Started with OptaPlanner and Quarkus">Chapter 6, <em>Getting Started with OptaPlanner and Quarkus</em></a>.
					</li></ul></div><section class="section" id="vaccination-scheduler-con_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">11.1. How the OptaPlanner vaccination appointment scheduler works</h2></div></div></div><p>
					There are two main approaches to scheduling appointments. The system can either let a person choose an appointment slot (user-selects) or the system assigns a slot and tells the person when and where to attend (system-automatically-assigns). The OptaPlanner vaccination appointment scheduler uses the system-automatically-assigns approach. With the OptaPlanner vaccination appointment scheduler, you can create an application where people provide their information to the system and the system assigns an appointment.
				</p><p>
					Characteristics of this approach:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Appointment slots are allocated based on priority.
						</li><li class="listitem">
							The system allocates the best appointment time and location based on preconfigured planning constraints.
						</li><li class="listitem">
							The system is not overwhelmed by a large number of users competing for a limited number of appointments.
						</li></ul></div><p>
					This approach solves the problem of vaccinating as many people as possible by using planning constraints to create a score for each person. The person’s score determines when they get an appointment. The higher the person’s score, the better chance they have of receiving an earlier appointment.
				</p><section class="section" id="vaccination-contraints-con_optaplanner-quickstarts"><div class="titlepage"><div><div><h3 class="title">11.1.1. OptaPlanner vaccination appointment scheduler constraints</h3></div></div></div><p>
						OptaPlanner vaccination appointment scheduler constraints are either hard, medium, or soft:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Hard constraints cannot be broken. If any hard constraint is broken, the plan is unfeasible and cannot be executed:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Capacity: Do not over-book vaccine capacity at any time at any location.
									</li><li class="listitem">
										Vaccine max age: If a vaccine has a maximum age, do not administer it to people who at the time of the first dose vaccination are older than the vaccine maximum age. Ensure people are given a vaccine type appropriate for their age. For example, do not assign a 75 year old person an appointment for a vaccine that has a maximum age restriction of 65 years.
									</li><li class="listitem">
										Required vaccine type: Use the required vaccine type. For example, the second dose of a vaccine must be the same vaccine type as the first dose.
									</li><li class="listitem">
										Ready date: Administer the vaccine on or after the specified date. For example, if a person receives a second dose, do not administer it before the recommended earliest possible vaccination date for the specific vaccine type, for example 26 days after the first dose.
									</li><li class="listitem">
										Due date: Administer the vaccine on or before the specified date. For example, if a person receives a second dose, administer it before the recommended vaccination final due date for the specific vaccine, for example three months after the first dose.
									</li><li class="listitem">
										Restrict maximum travel distance: Assign each person to one of a group of vaccination centers nearest to them. This is typically one of three centers. This restriction is calculated by travel time, not distance, so a person that lives in an urban area usually has a lower maximum distance to travel than a person living in a rural area.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Medium constraints decide who does not get an appointment when there is not enough capacity to assign appointments to everyone. This is called overconstrained planning:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Schedule second dose vaccinations: Do not leave any second dose vaccination appointments unassigned unless the ideal date falls outside of the planning window.
									</li><li class="listitem">
										Schedule people based on their priority rating: Each person has a priority rating. This is typically their age but it can be much higher if they are, for example, a health care worker. Leave only people with the lowest priority ratings unassigned. They will be considered in the next run. This constraint is softer than the previous constraint because the second dose is always prioritized over priority rating.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Soft constraints should not be broken:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Preferred vaccination center: If a person has a preferred vaccination center, give them an appointment at that center.
									</li><li class="listitem">
										Distance: Minimize the distance that a person must travel to their assigned vaccination center.
									</li><li class="listitem">
										Ideal date: Administer the vaccine on or as close to the specified date as possible. For example, if a person receives a second dose, administer it on the ideal date for the specific vaccine, for example 28 days after the first dose. This constraint is softer than the distance constraint to avoid sending people halfway across the country just to be one day closer to their ideal date.
									</li><li class="listitem">
										Priority rating: Schedule people with a higher priority rating earlier in the planning window. This constraint is softer than the distance constraint to avoid sending people halfway across the country. This constraint is also softer than the ideal date constraint because the second dose is prioritized over priority rating.
									</li></ul></div></li></ul></div><p>
						Hard constraints are weighted against other hard constraints. Soft constraints are weighted against other soft constraints. However, hard constraints always take precedence over medium and soft constraints. If a hard constraint is broken, then the plan is not feasible. But if no hard constraints are broken then soft and medium constraints are considered in order to determine priority. Because there are often more people than available appointment slots, you must prioritize. Second dose appointments are always assigned first to avoid creating a backlog that would overwhelm your system later. After that, people are assigned based on their priority rating. Everyone starts with a priority rating that is their age. Doing this prioritizes older people over younger people. After that, people that are in specific priority groups receive, for example, a few hundred extra points. This varies based on the priority of their group. For example, nurses might receive an extra 1000 points. This way, older nurses are prioritized over younger nurses and young nurses are prioritized over people who are not nurses. The following table illustrates this concept:
					</p><div class="table" id="idm45892289146496"><p class="title"><strong>Table 11.1. Priority rating table</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 29%; " class="col_1"/><col style="width: 29%; " class="col_2"/><col style="width: 43%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892289140736" scope="col">Age</th><th align="left" valign="top" id="idm45892289139648" scope="col">Job</th><th align="left" valign="top" id="idm45892289138560" scope="col">Priority rating</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892289140736">
									<p>
										60
									</p>
									</td><td align="left" valign="top" headers="idm45892289139648">
									<p>
										nurse
									</p>
									</td><td align="left" valign="top" headers="idm45892289138560">
									<p>
										1060
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45892289140736">
									<p>
										33
									</p>
									</td><td align="left" valign="top" headers="idm45892289139648">
									<p>
										nurse
									</p>
									</td><td align="left" valign="top" headers="idm45892289138560">
									<p>
										1033
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45892289140736">
									<p>
										71
									</p>
									</td><td align="left" valign="top" headers="idm45892289139648">
									<p>
										retired
									</p>
									</td><td align="left" valign="top" headers="idm45892289138560">
									<p>
										71
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45892289140736">
									<p>
										52
									</p>
									</td><td align="left" valign="top" headers="idm45892289139648">
									<p>
										office worker
									</p>
									</td><td align="left" valign="top" headers="idm45892289138560">
									<p>
										52
									</p>
									</td></tr></tbody></table></div></div></section><section class="section" id="optaplanner-solver-con_optaplanner-quickstarts"><div class="titlepage"><div><div><h3 class="title">11.1.2. The OptaPlanner solver</h3></div></div></div><p>
						At the core of OptaPlanner is the solver, the engine that takes the problem data set and overlays the planning constraints and configurations. The problem data set includes all of the information about the people, the vaccines, and the vaccination centers. The solver works through the various combinations of data and eventually determines an optimized appointment schedule with people assigned to vaccination appointments at a specific center. The following illustration shows a schedule that the solver created:
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/vaccinationSchedulingValueProposal.png" alt="vaccinationSchedulingValueProposal"/></div></div></section><section class="section" id="continuous-planning-con_optaplanner-quickstarts"><div class="titlepage"><div><div><h3 class="title">11.1.3. Continuous planning</h3></div></div></div><p>
						Continuous planning is the technique of managing one or more upcoming planning periods at the same time and repeating that process monthly, weekly, daily, hourly, or even more frequently. The planning window advances incrementally by a specified interval. The following illustration shows a two week planning window that is updated daily:
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/vaccinationSchedulingContinuousPlanning.png" alt="vaccinationSchedulingContinuousPlanning"/></div></div><p>
						The two week planning window is divided in half. The first week is in the published state and the second week is in the draft state. People are assigned to appointments in both the published and draft parts of the planning window. However, only people in the published part of the planning window are notified of their appointments. The other appointments can still change easily in the next run. Doing this gives OptaPlanner the flexibility to change the appointments in the draft part when you run the solver again, if necessary. For example, if a person who needs a second dose has a ready date of Monday and an ideal date of Wednesday, OptaPlanner does not have to give them an appointment for Monday if you can prove OptaPlanner can demonstrate that it can give them a draft appointment later in the week.
					</p><p>
						You can determine the size of the planning window but just be aware of the size of the problem space. The problem space is all of the various elements that go into creating the schedule. The more days you plan ahead, the larger the problem space.
					</p></section><section class="section" id="pinned-planning-entities-con_optaplanner-quickstarts"><div class="titlepage"><div><div><h3 class="title">11.1.4. Pinned planning entities</h3></div></div></div><p>
						If you are continuously planning on a daily basis, there will be appointments within the two week period that are already allocated to people. To ensure that appointments are not double-booked, OptaPlanner marks existing appointments as allocated by pinning them. Pinning is used to anchor one or more specific assignments and force OptaPlanner to schedule around those fixed assignments. A pinned planning entity, such as an appointment, does not change during solving.
					</p><p>
						Whether an entity is pinned or not is determined by the appointment state. An appointment can have five states : <code class="literal">Open</code>, <code class="literal">Invited</code>, <code class="literal">Accepted</code>, <code class="literal">Rejected</code>, or <code class="literal">Rescheduled</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not actually see these states directly in the quick start demo code because the OptaPlanner engine is only interested in whether the appointment is pinned or not.
						</p></div></div><p>
						You need to be able to plan around appointments that have already been scheduled. An appointment with the <code class="literal">Invited</code> or <code class="literal">Accepted</code> state is pinned. Appointments with the <code class="literal">Open</code>, <code class="literal">Reschedule</code>, and <code class="literal">Rejected</code> state are not pinned and are available for scheduling.
					</p><p>
						In this example, when the solver runs it searches across the entire two week planning window in both the published and draft ranges. The solver considers any unpinned entities, appointments with the <code class="literal">Open</code>, <code class="literal">Reschedule</code>, or <code class="literal">Rejected</code> states, in addition to the unscheduled input data, to find the optimal solution. If the solver is run daily, you will see a new day added to the schedule before you run the solver.
					</p><p>
						Notice that the appointments on the new day have been assigned and Amy and Edna who were previously scheduled in the draft part of the planning window are now scheduled in the published part of the window. This was possible because Gus and Hugo requested a reschedule. This will not cause any confusion because Amy and Edna were never notified about their draft dates. Now, because they have appointments in the published section of the planning window, they will be notified and asked to accept or reject their appointments, and their appointments are now pinned.
					</p></section></section><section class="section" id="vaccination-scheduler-download-proc_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">11.2. Downloading and running the OptaPlanner vaccination appointment scheduler</h2></div></div></div><p>
					Download the OptaPlanner vaccination appointment scheduler quick start archive, start it in Quarkus development mode, and view the application in a browser. Quarkus development mode enables you to make changes and update your application while it is running.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Navigate to the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Product: Decision Manager
								</li><li class="listitem">
									Version: 7.13
								</li></ul></div></li><li class="listitem">
							Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Quickstarts</strong></span> (<code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code>).
						</li><li class="listitem">
							Extract the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code> file.
						</li><li class="listitem">
							Navigate to the <code class="literal">optaplanner-quickstarts-8.11.1.Final-redhat-00006</code> directory.
						</li><li class="listitem">
							Navigate to the <code class="literal">optaplanner-quickstarts-8.11.1.Final-redhat-00006/use-cases/vaccination-scheduling</code> directory.
						</li><li class="listitem"><p class="simpara">
							Enter the following command to start the OptaPlanner vaccination appointment scheduler in development mode:
						</p><pre class="programlisting language-shell">$ mvn quarkus:dev</pre></li><li class="listitem"><p class="simpara">
							To view the OptaPlanner vaccination appointment scheduler, enter the following URL in a web browser.
						</p><pre class="screen">http://localhost:8080/</pre></li><li class="listitem">
							To run the OptaPlanner vaccination appointment scheduler, click <span class="strong strong"><strong>Solve</strong></span>.
						</li><li class="listitem">
							Make changes to the source code then press the F5 key to refresh your browser. Notice that the changes that you made are now available.
						</li></ol></div></section><section class="section" id="vaccination-scheduler-package-proc_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">11.3. Package and run the OptaPlanner vaccination appointment scheduler</h2></div></div></div><p>
					When you have completed development work on the OptaPlanner vaccination appointment scheduler in <code class="literal">quarkus:dev</code> mode, run the application as a conventional jar file.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have downloaded the OptaPlanner vaccination appointment scheduler quick start. For more information, see <a class="xref" href="#vaccination-scheduler-download-proc_optaplanner-quickstarts" title="11.2. Downloading and running the OptaPlanner vaccination appointment scheduler">Section 11.2, “Downloading and running the OptaPlanner vaccination appointment scheduler”</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <code class="literal">/use-cases/vaccination-scheduling</code> directory.
						</li><li class="listitem"><p class="simpara">
							To compile the OptaPlanner vaccination appointment scheduler, enter the following command:
						</p><pre class="programlisting language-shell">$ mvn package</pre></li><li class="listitem"><p class="simpara">
							To run the compiled OptaPlanner vaccination appointment scheduler, enter the following command:
						</p><pre class="programlisting language-shell">$ java -jar ./target/*-runner.jar</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								To run the application on port 8081, add <code class="literal">-Dquarkus.http.port=8081</code> to the preceding command.
							</p></div></div></li><li class="listitem"><p class="simpara">
							To start the OptaPlanner vaccination appointment scheduler, enter the following URL in a web browser.
						</p><pre class="screen">http://localhost:8080/</pre></li></ol></div></section><section class="section" id="vaccination-native-proc_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">11.4. Run the OptaPlanner vaccination appointment scheduler as a native executable</h2></div></div></div><p>
					To take advantage of the small memory footprint and access speeds that Quarkus offers, compile the OptaPlanner vaccination appointment scheduler in Quarkus native mode.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Install GraalVM and the <code class="literal">native-image</code> tool. For information, see <a class="link" href="https://quarkus.io/guides/building-native-image#configuring-graalvm">Configuring GraalVMl</a> on the Quarkus website.
						</li><li class="listitem">
							Navigate to the <code class="literal">/use-cases/vaccination-scheduling</code> directory.
						</li><li class="listitem"><p class="simpara">
							To compile the OptaPlanner vaccination appointment scheduler natively, enter the following command:
						</p><pre class="programlisting language-shell">$ mvn package -Dnative -DskipTests</pre></li><li class="listitem"><p class="simpara">
							To run the native executable, enter the following command:
						</p><pre class="programlisting language-shell">$ ./target/*-runner</pre></li><li class="listitem"><p class="simpara">
							To start the OptaPlanner vaccination appointment scheduler, enter the following URL in a web browser.
						</p><pre class="screen">http://localhost:8080/</pre></li></ol></div></section><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h2 class="title">11.5. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://www.youtube.com/watch?v=LTkoaBk-P6U">Vaccination appointment scheduling video</a>
						</li></ul></div></section></section><section class="chapter" id="assembly-business-optimizer-springboot_optaplanner-quickstarts"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Red Hat build of OptaPlanner on Spring Boot: a school timetable quick start guide</h2></div></div></div><p>
				This guide walks you through the process of creating a Spring Boot application with OptaPlanner’s constraint solving artificial intelligence (AI). You will build a REST application that optimizes a school timetable for students and teachers.
			</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableAppScreenshot.png" alt="timeTableAppScreenshot"/></div></div><p>
				Your service will assign <code class="literal">Lesson</code> instances to <code class="literal">Timeslot</code> and <code class="literal">Room</code> instances automatically by using AI to adhere to the following hard and soft <span class="emphasis"><em>scheduling constraints</em></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A room can have at most one lesson at the same time.
					</li><li class="listitem">
						A teacher can teach at most one lesson at the same time.
					</li><li class="listitem">
						A student can attend at most one lesson at the same time.
					</li><li class="listitem">
						A teacher prefers to teach in a single room.
					</li><li class="listitem">
						A teacher prefers to teach sequential lessons and dislikes gaps between lessons.
					</li></ul></div><p>
				Mathematically speaking, school timetabling is an <span class="emphasis"><em>NP-hard</em></span> problem. That means it is difficult to scale. Simply iterating through all possible combinations with brute force would take millions of years for a non-trivial data set, even on a supercomputer. Fortunately, AI constraint solvers such as OptaPlanner have advanced algorithms that deliver a near-optimal solution in a reasonable amount of time. What is considered to be a reasonable amount of time is subjective and depends on the goals of your problem.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenJDK 11 or later is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
					</li><li class="listitem">
						Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
					</li><li class="listitem">
						An IDE, such as IntelliJ IDEA, VSCode, Eclipse, or NetBeans is available.
					</li></ul></div><section class="section" id="spring-boot-ref-download-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.1. Downloading and building the Spring Boot school timetable quick start</h2></div></div></div><p>
					If you want to see a completed example of the school timetable project for Red Hat build of OptaPlanner with Spring Boot product, download the starter application from the Red Hat Customer Portal.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Navigate to the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Product: Decision Manager
								</li><li class="listitem">
									Version: 7.13
								</li></ul></div></li><li class="listitem">
							Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Quickstarts</strong></span> (<code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code>).
						</li><li class="listitem">
							Extract the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code> file.
						</li><li class="listitem">
							Download the <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Maven Repositroy</strong></span> (<code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code>).
						</li><li class="listitem">
							Extract the <code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code> file.
						</li><li class="listitem">
							Copy the contents of the <code class="literal">rhdm-7.13.0-kogito-maven-repository/maven-repository</code> subdirectory into the <code class="literal">~/.m2/repository</code> directory.
						</li><li class="listitem">
							Navigate to the <code class="literal">optaplanner-quickstarts-8.11.1.Final-redhat-00006/technology/java-spring-boot</code> directory.
						</li><li class="listitem"><p class="simpara">
							Enter the following command to build the Spring Boot school timetabling project:
						</p><pre class="screen">mvn clean install -DskipTests</pre></li><li class="listitem"><p class="simpara">
							To build the Spring Boot school timetabling project, enter the following command:
						</p><pre class="screen">mvn spring-boot:run -DskipTests</pre></li><li class="listitem"><p class="simpara">
							To view the project, enter the following URL in a web browser:
						</p><pre class="screen">http://localhost:8080/</pre></li></ol></div></section><section class="section" id="business-optimizr-domain-objects-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.2. Model the domain objects</h2></div></div></div><p>
					The goal of the Red Hat build of OptaPlanner timetable project is to assign each lesson to a time slot and a room. To do this, add three classes, <code class="literal">Timeslot</code>, <code class="literal">Lesson</code>, and <code class="literal">Room</code>, as shown in the following diagram:
				</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableClassDiagramPure.png" alt="timeTableClassDiagramPure"/></div></div><div class="formalpara"><p class="title"><strong>Timeslot</strong></p><p>
						The <code class="literal">Timeslot</code> class represents a time interval when lessons are taught, for example, <code class="literal">Monday 10:30 - 11:30</code> or <code class="literal">Tuesday 13:30 - 14:30</code>. In this example, all time slots have the same duration and there are no time slots during lunch or other breaks.
					</p></div><p>
					A time slot has no date because a high school schedule just repeats every week. There is no need for <a class="link" href="https://docs.optaplanner.org/latestFinal/optaplanner-docs/html_single/index.html#continuousPlanning">continuous planning</a>. A timeslot is called a <span class="emphasis"><em>problem fact</em></span> because no <code class="literal">Timeslot</code> instances change during solving. Such classes do not require any OptaPlanner-specific annotations.
				</p><div class="formalpara"><p class="title"><strong>Room</strong></p><p>
						The <code class="literal">Room</code> class represents a location where lessons are taught, for example, <code class="literal">Room A</code> or <code class="literal">Room B</code>. In this example, all rooms are without capacity limits and they can accommodate all lessons.
					</p></div><p>
					<code class="literal">Room</code> instances do not change during solving so <code class="literal">Room</code> is also a <span class="emphasis"><em>problem fact</em></span>.
				</p><div class="formalpara"><p class="title"><strong>Lesson</strong></p><p>
						During a lesson, represented by the <code class="literal">Lesson</code> class, a teacher teaches a subject to a group of students, for example, <code class="literal">Math by A.Turing for 9th grade</code> or <code class="literal">Chemistry by M.Curie for 10th grade</code>. If a subject is taught multiple times each week by the same teacher to the same student group, there are multiple <code class="literal">Lesson</code> instances that are only distinguishable by <code class="literal">id</code>. For example, the 9th grade has six math lessons a week.
					</p></div><p>
					During solving, OptaPlanner changes the <code class="literal">timeslot</code> and <code class="literal">room</code> fields of the <code class="literal">Lesson</code> class to assign each lesson to a time slot and a room. Because OptaPlanner changes these fields, <code class="literal">Lesson</code> is a <span class="emphasis"><em>planning entity</em></span>:
				</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableClassDiagramAnnotated.png" alt="timeTableClassDiagramAnnotated"/></div></div><p>
					Most of the fields in the previous diagram contain input data, except for the orange fields. A lesson’s <code class="literal">timeslot</code> and <code class="literal">room</code> fields are unassigned (<code class="literal">null</code>) in the input data and assigned (not <code class="literal">null</code>) in the output data. OptaPlanner changes these fields during solving. Such fields are called planning variables. In order for OptaPlanner to recognize them, both the <code class="literal">timeslot</code> and <code class="literal">room</code> fields require an <code class="literal">@PlanningVariable</code> annotation. Their containing class, <code class="literal">Lesson</code>, requires an <code class="literal">@PlanningEntity</code> annotation.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Timeslot.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

import java.time.DayOfWeek;
import java.time.LocalTime;

public class Timeslot {

    private DayOfWeek dayOfWeek;
    private LocalTime startTime;
    private LocalTime endTime;

    private Timeslot() {
    }

    public Timeslot(DayOfWeek dayOfWeek, LocalTime startTime, LocalTime endTime) {
        this.dayOfWeek = dayOfWeek;
        this.startTime = startTime;
        this.endTime = endTime;
    }

    @Override
    public String toString() {
        return dayOfWeek + " " + startTime.toString();
    }

    // ********************************
    // Getters and setters
    // ********************************

    public DayOfWeek getDayOfWeek() {
        return dayOfWeek;
    }

    public LocalTime getStartTime() {
        return startTime;
    }

    public LocalTime getEndTime() {
        return endTime;
    }

}</pre><p class="simpara">
							Notice the <code class="literal">toString()</code> method keeps the output short so it is easier to read OptaPlanner’s <code class="literal">DEBUG</code> or <code class="literal">TRACE</code> log, as shown later.
						</p></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Room.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

public class Room {

    private String name;

    private Room() {
    }

    public Room(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return name;
    }

    // ********************************
    // Getters and setters
    // ********************************

    public String getName() {
        return name;
    }

}</pre></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Lesson.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

import org.optaplanner.core.api.domain.entity.PlanningEntity;
import org.optaplanner.core.api.domain.variable.PlanningVariable;

@PlanningEntity
public class Lesson {

    private Long id;

    private String subject;
    private String teacher;
    private String studentGroup;

    @PlanningVariable(valueRangeProviderRefs = "timeslotRange")
    private Timeslot timeslot;

    @PlanningVariable(valueRangeProviderRefs = "roomRange")
    private Room room;

    private Lesson() {
    }

    public Lesson(Long id, String subject, String teacher, String studentGroup) {
        this.id = id;
        this.subject = subject;
        this.teacher = teacher;
        this.studentGroup = studentGroup;
    }

    @Override
    public String toString() {
        return subject + "(" + id + ")";
    }

    // ********************************
    // Getters and setters
    // ********************************

    public Long getId() {
        return id;
    }

    public String getSubject() {
        return subject;
    }

    public String getTeacher() {
        return teacher;
    }

    public String getStudentGroup() {
        return studentGroup;
    }

    public Timeslot getTimeslot() {
        return timeslot;
    }

    public void setTimeslot(Timeslot timeslot) {
        this.timeslot = timeslot;
    }

    public Room getRoom() {
        return room;
    }

    public void setRoom(Room room) {
        this.room = room;
    }

}</pre><p class="simpara">
							The <code class="literal">Lesson</code> class has an <code class="literal">@PlanningEntity</code> annotation, so OptaPlanner knows that this class changes during solving because it contains one or more planning variables.
						</p><p class="simpara">
							The <code class="literal">timeslot</code> field has an <code class="literal">@PlanningVariable</code> annotation, so OptaPlanner knows that it can change its value. In order to find potential <code class="literal">Timeslot</code> instances to assign to this field, OptaPlanner uses the <code class="literal">valueRangeProviderRefs</code> property to connect to a value range provider that provides a <code class="literal">List&lt;Timeslot&gt;</code> to pick from. See <a class="xref" href="#business-optimizr-gather-objects-proc_business-optimizer-spring-boot" title="12.4. Gather the domain objects in a planning solution">Section 12.4, “Gather the domain objects in a planning solution”</a> for information about value range providers.
						</p><p class="simpara">
							The <code class="literal">room</code> field also has an <code class="literal">@PlanningVariable</code> annotation for the same reasons.
						</p></li></ol></div></section><section class="section" id="business-optimizr-define-contraints-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.3. Define the constraints and calculate the score</h2></div></div></div><p>
					When solving a problem, a <span class="emphasis"><em>score</em></span> represents the quality of a specific solution. The higher the score the better. Red Hat build of OptaPlanner looks for the best solution, which is the solution with the highest score found in the available time. It might be the <span class="emphasis"><em>optimal</em></span> solution.
				</p><p>
					Because the timetable example use case has hard and soft constraints, use the <code class="literal">HardSoftScore</code> class to represent the score:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Hard constraints must not be broken. For example: <span class="emphasis"><em>A room can have at most one lesson at the same time.</em></span>
						</li><li class="listitem">
							Soft constraints should not be broken. For example: <span class="emphasis"><em>A teacher prefers to teach in a single room.</em></span>
						</li></ul></div><p>
					Hard constraints are weighted against other hard constraints. Soft constraints are weighted against other soft constraints. Hard constraints always outweigh soft constraints, regardless of their respective weights.
				</p><p>
					To calculate the score, you could implement an <code class="literal">EasyScoreCalculator</code> class:
				</p><pre class="programlisting language-java">public class TimeTableEasyScoreCalculator implements EasyScoreCalculator&lt;TimeTable&gt; {

    @Override
    public HardSoftScore calculateScore(TimeTable timeTable) {
        List&lt;Lesson&gt; lessonList = timeTable.getLessonList();
        int hardScore = 0;
        for (Lesson a : lessonList) {
            for (Lesson b : lessonList) {
                if (a.getTimeslot() != null &amp;&amp; a.getTimeslot().equals(b.getTimeslot())
                        &amp;&amp; a.getId() &lt; b.getId()) {
                    // A room can accommodate at most one lesson at the same time.
                    if (a.getRoom() != null &amp;&amp; a.getRoom().equals(b.getRoom())) {
                        hardScore--;
                    }
                    // A teacher can teach at most one lesson at the same time.
                    if (a.getTeacher().equals(b.getTeacher())) {
                        hardScore--;
                    }
                    // A student can attend at most one lesson at the same time.
                    if (a.getStudentGroup().equals(b.getStudentGroup())) {
                        hardScore--;
                    }
                }
            }
        }
        int softScore = 0;
        // Soft constraints are only implemented in the "complete" implementation
        return HardSoftScore.of(hardScore, softScore);
    }

}</pre><p>
					Unfortunately, this solution does not scale well because it is non-incremental: every time a lesson is assigned to a different time slot or room, all lessons are re-evaluated to calculate the new score.
				</p><p>
					A better solution is to create a <code class="literal">src/main/java/com/example/solver/TimeTableConstraintProvider.java</code> class to perform incremental score calculation. This class uses OptaPlanner’s ConstraintStream API which is inspired by Java 8 Streams and SQL. The <code class="literal">ConstraintProvider</code> scales an order of magnitude better than the <code class="literal">EasyScoreCalculator</code>: <span class="emphasis"><em>O</em></span>(n) instead of <span class="emphasis"><em>O</em></span>(n²).
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the following <code class="literal">src/main/java/com/example/solver/TimeTableConstraintProvider.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.solver;

import com.example.domain.Lesson;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;
import org.optaplanner.core.api.score.stream.Constraint;
import org.optaplanner.core.api.score.stream.ConstraintFactory;
import org.optaplanner.core.api.score.stream.ConstraintProvider;
import org.optaplanner.core.api.score.stream.Joiners;

public class TimeTableConstraintProvider implements ConstraintProvider {

    @Override
    public Constraint[] defineConstraints(ConstraintFactory constraintFactory) {
        return new Constraint[] {
                // Hard constraints
                roomConflict(constraintFactory),
                teacherConflict(constraintFactory),
                studentGroupConflict(constraintFactory),
                // Soft constraints are only implemented in the "complete" implementation
        };
    }

    private Constraint roomConflict(ConstraintFactory constraintFactory) {
        // A room can accommodate at most one lesson at the same time.

        // Select a lesson ...
        return constraintFactory.from(Lesson.class)
                // ... and pair it with another lesson ...
                .join(Lesson.class,
                        // ... in the same timeslot ...
                        Joiners.equal(Lesson::getTimeslot),
                        // ... in the same room ...
                        Joiners.equal(Lesson::getRoom),
                        // ... and the pair is unique (different id, no reverse pairs)
                        Joiners.lessThan(Lesson::getId))
                // then penalize each pair with a hard weight.
                .penalize("Room conflict", HardSoftScore.ONE_HARD);
    }

    private Constraint teacherConflict(ConstraintFactory constraintFactory) {
        // A teacher can teach at most one lesson at the same time.
        return constraintFactory.from(Lesson.class)
                .join(Lesson.class,
                        Joiners.equal(Lesson::getTimeslot),
                        Joiners.equal(Lesson::getTeacher),
                        Joiners.lessThan(Lesson::getId))
                .penalize("Teacher conflict", HardSoftScore.ONE_HARD);
    }

    private Constraint studentGroupConflict(ConstraintFactory constraintFactory) {
        // A student can attend at most one lesson at the same time.
        return constraintFactory.from(Lesson.class)
                .join(Lesson.class,
                        Joiners.equal(Lesson::getTimeslot),
                        Joiners.equal(Lesson::getStudentGroup),
                        Joiners.lessThan(Lesson::getId))
                .penalize("Student group conflict", HardSoftScore.ONE_HARD);
    }

}</pre></section><section class="section" id="business-optimizr-gather-objects-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.4. Gather the domain objects in a planning solution</h2></div></div></div><p>
					A <code class="literal">TimeTable</code> instance wraps all <code class="literal">Timeslot</code>, <code class="literal">Room</code>, and <code class="literal">Lesson</code> instances of a single dataset. Furthermore, because it contains all lessons, each with a specific planning variable state, it is a <span class="emphasis"><em>planning solution</em></span> and it has a score:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If lessons are still unassigned, then it is an <span class="emphasis"><em>uninitialized</em></span> solution, for example, a solution with the score <code class="literal">-4init/0hard/0soft</code>.
						</li><li class="listitem">
							If it breaks hard constraints, then it is an <span class="emphasis"><em>infeasible</em></span> solution, for example, a solution with the score <code class="literal">-2hard/-3soft</code>.
						</li><li class="listitem">
							If it adheres to all hard constraints, then it is a <span class="emphasis"><em>feasible</em></span> solution, for example, a solution with the score <code class="literal">0hard/-7soft</code>.
						</li></ul></div><p>
					The <code class="literal">TimeTable</code> class has an <code class="literal">@PlanningSolution</code> annotation, so Red Hat build of OptaPlanner knows that this class contains all of the input and output data.
				</p><p>
					Specifically, this class is the input of the problem:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							A <code class="literal">timeslotList</code> field with all time slots
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of problem facts, because they do not change during solving.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A <code class="literal">roomList</code> field with all rooms
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of problem facts, because they do not change during solving.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A <code class="literal">lessonList</code> field with all lessons
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of planning entities because they change during solving.
								</li><li class="listitem"><p class="simpara">
									Of each <code class="literal">Lesson</code>:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											The values of the <code class="literal">timeslot</code> and <code class="literal">room</code> fields are typically still <code class="literal">null</code>, so unassigned. They are planning variables.
										</li><li class="listitem">
											The other fields, such as <code class="literal">subject</code>, <code class="literal">teacher</code> and <code class="literal">studentGroup</code>, are filled in. These fields are problem properties.
										</li></ul></div></li></ul></div></li></ul></div><p>
					However, this class is also the output of the solution:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">lessonList</code> field for which each <code class="literal">Lesson</code> instance has non-null <code class="literal">timeslot</code> and <code class="literal">room</code> fields after solving
						</li><li class="listitem">
							A <code class="literal">score</code> field that represents the quality of the output solution, for example, <code class="literal">0hard/-5soft</code>
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/java/com/example/domain/TimeTable.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.domain;

import java.util.List;

import org.optaplanner.core.api.domain.solution.PlanningEntityCollectionProperty;
import org.optaplanner.core.api.domain.solution.PlanningScore;
import org.optaplanner.core.api.domain.solution.PlanningSolution;
import org.optaplanner.core.api.domain.solution.ProblemFactCollectionProperty;
import org.optaplanner.core.api.domain.valuerange.ValueRangeProvider;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;

@PlanningSolution
public class TimeTable {

    @ValueRangeProvider(id = "timeslotRange")
    @ProblemFactCollectionProperty
    private List&lt;Timeslot&gt; timeslotList;

    @ValueRangeProvider(id = "roomRange")
    @ProblemFactCollectionProperty
    private List&lt;Room&gt; roomList;

    @PlanningEntityCollectionProperty
    private List&lt;Lesson&gt; lessonList;

    @PlanningScore
    private HardSoftScore score;

    private TimeTable() {
    }

    public TimeTable(List&lt;Timeslot&gt; timeslotList, List&lt;Room&gt; roomList,
            List&lt;Lesson&gt; lessonList) {
        this.timeslotList = timeslotList;
        this.roomList = roomList;
        this.lessonList = lessonList;
    }

    // ********************************
    // Getters and setters
    // ********************************

    public List&lt;Timeslot&gt; getTimeslotList() {
        return timeslotList;
    }

    public List&lt;Room&gt; getRoomList() {
        return roomList;
    }

    public List&lt;Lesson&gt; getLessonList() {
        return lessonList;
    }

    public HardSoftScore getScore() {
        return score;
    }

}</pre><div class="formalpara"><p class="title"><strong>The value range providers</strong></p><p>
						The <code class="literal">timeslotList</code> field is a value range provider. It holds the <code class="literal">Timeslot</code> instances which OptaPlanner can pick from to assign to the <code class="literal">timeslot</code> field of <code class="literal">Lesson</code> instances. The <code class="literal">timeslotList</code> field has an <code class="literal">@ValueRangeProvider</code> annotation to connect those two, by matching the <code class="literal">id</code> with the <code class="literal">valueRangeProviderRefs</code> of the <code class="literal">@PlanningVariable</code> in the <code class="literal">Lesson</code>.
					</p></div><p>
					Following the same logic, the <code class="literal">roomList</code> field also has an <code class="literal">@ValueRangeProvider</code> annotation.
				</p><div class="formalpara"><p class="title"><strong>The problem fact and planning entity properties</strong></p><p>
						Furthermore, OptaPlanner needs to know which <code class="literal">Lesson</code> instances it can change as well as how to retrieve the <code class="literal">Timeslot</code> and <code class="literal">Room</code> instances used for score calculation by your <code class="literal">TimeTableConstraintProvider</code>.
					</p></div><p>
					The <code class="literal">timeslotList</code> and <code class="literal">roomList</code> fields have an <code class="literal">@ProblemFactCollectionProperty</code> annotation, so your <code class="literal">TimeTableConstraintProvider</code> can select from those instances.
				</p><p>
					The <code class="literal">lessonList</code> has an <code class="literal">@PlanningEntityCollectionProperty</code> annotation, so OptaPlanner can change them during solving and your <code class="literal">TimeTableConstraintProvider</code> can select from those too.
				</p></section><section class="section" id="business-optimizr-create-timetable-service-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.5. Create the Timetable service</h2></div></div></div><p>
					Now you are ready to put everything together and create a REST service. But solving planning problems on REST threads causes HTTP timeout issues. Therefore, the Spring Boot starter injects a <code class="literal">SolverManager</code>, which runs solvers in a separate thread pool and can solve multiple datasets in parallel.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/java/com/example/solver/TimeTableController.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.solver;

import java.util.UUID;
import java.util.concurrent.ExecutionException;

import com.example.domain.TimeTable;
import org.optaplanner.core.api.solver.SolverJob;
import org.optaplanner.core.api.solver.SolverManager;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/timeTable")
public class TimeTableController {

    @Autowired
    private SolverManager&lt;TimeTable, UUID&gt; solverManager;

    @PostMapping("/solve")
    public TimeTable solve(@RequestBody TimeTable problem) {
        UUID problemId = UUID.randomUUID();
        // Submit the problem to start solving
        SolverJob&lt;TimeTable, UUID&gt; solverJob = solverManager.solve(problemId, problem);
        TimeTable solution;
        try {
            // Wait until the solving ends
            solution = solverJob.getFinalBestSolution();
        } catch (InterruptedException | ExecutionException e) {
            throw new IllegalStateException("Solving failed.", e);
        }
        return solution;
    }

}</pre><p>
					In this example, the initial implementation waits for the solver to finish, which can still cause an HTTP timeout. The <span class="emphasis"><em>complete</em></span> implementation avoids HTTP timeouts much more elegantly.
				</p></section><section class="section" id="business-optimizr-set-solver-time-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.6. Set the solver termination time</h2></div></div></div><p>
					If your planning application does not have a termination setting or a termination event, it theoretically runs forever and in reality eventually causes an HTTP timeout error. To prevent this from occurring, use the <code class="literal">optaplanner.solver.termination.spent-limit</code> parameter to specify the length of time after which the application terminates. In most applications, set the time to at least five minutes (<code class="literal">5m</code>). However, in the Timetable example, limit the solving time to five seconds, which is short enough to avoid the HTTP timeout.
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/resources/application.properties</code> file with the following content:
					</p></div><pre class="programlisting language-properties">quarkus.optaplanner.solver.termination.spent-limit=5s</pre></section><section class="section" id="business-optimizer-make-executable-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.7. Make the application executable</h2></div></div></div><p>
					After you complete the Red Hat build of OptaPlanner Spring Boot timetable project, package everything into a single executable JAR file driven by a standard Java <code class="literal">main()</code> method.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a completed OptaPlanner Spring Boot timetable project.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the <code class="literal">TimeTableSpringBootApp.java</code> class with the following content:
						</p><pre class="programlisting language-java">package com.example;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class TimeTableSpringBootApp {

    public static void main(String[] args) {
        SpringApplication.run(TimeTableSpringBootApp.class, args);
    }

}</pre></li><li class="listitem">
							Replace the <code class="literal">src/main/java/com/example/DemoApplication.java</code> class created by Spring Initializr with the <code class="literal">TimeTableSpringBootApp.java</code> class.
						</li><li class="listitem">
							Run the <code class="literal">TimeTableSpringBootApp.java</code> class as the main class of a regular Java application.
						</li></ol></div><section class="section" id="business-optimizer-try-application-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h3 class="title">12.7.1. Try the timetable application</h3></div></div></div><p>
						After you start the Red Hat build of OptaPlanner Spring Boot timetable application, you can test the REST service with any REST client that you want. This example uses the Linux <code class="literal">curl</code> command to send a POST request.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The OptaPlanner Spring Boot timetable application is running.
							</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Enter the following command:
						</p></div><pre class="screen">$ curl -i -X POST http://localhost:8080/timeTable/solve -H "Content-Type:application/json" -d '{"timeslotList":[{"dayOfWeek":"MONDAY","startTime":"08:30:00","endTime":"09:30:00"},{"dayOfWeek":"MONDAY","startTime":"09:30:00","endTime":"10:30:00"}],"roomList":[{"name":"Room A"},{"name":"Room B"}],"lessonList":[{"id":1,"subject":"Math","teacher":"A. Turing","studentGroup":"9th grade"},{"id":2,"subject":"Chemistry","teacher":"M. Curie","studentGroup":"9th grade"},{"id":3,"subject":"French","teacher":"M. Curie","studentGroup":"10th grade"},{"id":4,"subject":"History","teacher":"I. Jones","studentGroup":"10th grade"}]}'</pre><p>
						After about five seconds, the termination spent time defined in <code class="literal">application.properties</code>, the service returns an output similar to the following example:
					</p><pre class="screen">HTTP/1.1 200
Content-Type: application/json
...

{"timeslotList":...,"roomList":...,"lessonList":[{"id":1,"subject":"Math","teacher":"A. Turing","studentGroup":"9th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"08:30:00","endTime":"09:30:00"},"room":{"name":"Room A"}},{"id":2,"subject":"Chemistry","teacher":"M. Curie","studentGroup":"9th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"09:30:00","endTime":"10:30:00"},"room":{"name":"Room A"}},{"id":3,"subject":"French","teacher":"M. Curie","studentGroup":"10th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"08:30:00","endTime":"09:30:00"},"room":{"name":"Room B"}},{"id":4,"subject":"History","teacher":"I. Jones","studentGroup":"10th grade","timeslot":{"dayOfWeek":"MONDAY","startTime":"09:30:00","endTime":"10:30:00"},"room":{"name":"Room B"}}],"score":"0hard/0soft"}</pre><p>
						Notice that the application assigned all four lessons to one of the two time slots and one of the two rooms. Also notice that it conforms to all hard constraints. For example, M. Curie’s two lessons are in different time slots.
					</p><p>
						On the server side, the <code class="literal">info</code> log shows what OptaPlanner did in those five seconds:
					</p><pre class="screen">... Solving started: time spent (33), best score (-8init/0hard/0soft), environment mode (REPRODUCIBLE), random (JDK with seed 0).
... Construction Heuristic phase (0) ended: time spent (73), best score (0hard/0soft), score calculation speed (459/sec), step total (4).
... Local Search phase (1) ended: time spent (5000), best score (0hard/0soft), score calculation speed (28949/sec), step total (28398).
... Solving ended: time spent (5000), best score (0hard/0soft), score calculation speed (28524/sec), phase total (2), environment mode (REPRODUCIBLE).</pre></section><section class="section" id="business-optimizer-test-application-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h3 class="title">12.7.2. Test the application</h3></div></div></div><p>
						A good application includes test coverage. This example tests the Timetable Red Hat build of OptaPlanner Spring Boot application. It uses a JUnit test to generate a test dataset and send it to the <code class="literal">TimeTableController</code> to solve.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Create the <code class="literal">src/test/java/com/example/solver/TimeTableControllerTest.java</code> class with the following content:
						</p></div><pre class="programlisting language-java">package com.example.solver;

import java.time.DayOfWeek;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.List;

import com.example.domain.Lesson;
import com.example.domain.Room;
import com.example.domain.TimeTable;
import com.example.domain.Timeslot;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Timeout;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

@SpringBootTest(properties = {
        "optaplanner.solver.termination.spent-limit=1h", // Effectively disable this termination in favor of the best-score-limit
        "optaplanner.solver.termination.best-score-limit=0hard/*soft"})
public class TimeTableControllerTest {

    @Autowired
    private TimeTableController timeTableController;

    @Test
    @Timeout(600_000)
    public void solve() {
        TimeTable problem = generateProblem();
        TimeTable solution = timeTableController.solve(problem);
        assertFalse(solution.getLessonList().isEmpty());
        for (Lesson lesson : solution.getLessonList()) {
            assertNotNull(lesson.getTimeslot());
            assertNotNull(lesson.getRoom());
        }
        assertTrue(solution.getScore().isFeasible());
    }

    private TimeTable generateProblem() {
        List&lt;Timeslot&gt; timeslotList = new ArrayList&lt;&gt;();
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        List&lt;Room&gt; roomList = new ArrayList&lt;&gt;();
        roomList.add(new Room("Room A"));
        roomList.add(new Room("Room B"));
        roomList.add(new Room("Room C"));

        List&lt;Lesson&gt; lessonList = new ArrayList&lt;&gt;();
        lessonList.add(new Lesson(101L, "Math", "B. May", "9th grade"));
        lessonList.add(new Lesson(102L, "Physics", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(103L, "Geography", "M. Polo", "9th grade"));
        lessonList.add(new Lesson(104L, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(105L, "Spanish", "P. Cruz", "9th grade"));

        lessonList.add(new Lesson(201L, "Math", "B. May", "10th grade"));
        lessonList.add(new Lesson(202L, "Chemistry", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(203L, "History", "I. Jones", "10th grade"));
        lessonList.add(new Lesson(204L, "English", "P. Cruz", "10th grade"));
        lessonList.add(new Lesson(205L, "French", "M. Curie", "10th grade"));
        return new TimeTable(timeslotList, roomList, lessonList);
    }

}</pre><p>
						This test verifies that after solving, all lessons are assigned to a time slot and a room. It also verifies that it found a feasible solution (no hard constraints broken).
					</p><p>
						Normally, the solver finds a feasible solution in less than 200 milliseconds. Notice how the <code class="literal">@SpringBootTest</code> annotation’s <code class="literal">properties</code> overwrites the solver termination to terminate as soon as a feasible solution (<code class="literal">0hard/*soft</code>) is found. This avoids hard coding a solver time, because the unit test might run on arbitrary hardware. This approach ensures that the test runs long enough to find a feasible solution, even on slow systems. However, it does not run a millisecond longer than it strictly must, even on fast systems.
					</p></section><section class="section" id="business-optimizer-logging-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h3 class="title">12.7.3. Logging</h3></div></div></div><p>
						After you complete the Red Hat build of OptaPlanner Spring Boot timetable application, you can use logging information to help you fine-tune the constraints in the <code class="literal">ConstraintProvider</code>. Review the score calculation speed in the <code class="literal">info</code> log file to assess the impact of changes to your constraints. Run the application in debug mode to show every step that your application takes or use trace logging to log every step and every move.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Run the timetable application for a fixed amount of time, for example, five minutes.
							</li><li class="listitem"><p class="simpara">
								Review the score calculation speed in the <code class="literal">log</code> file as shown in the following example:
							</p><pre class="screen">... Solving ended: ..., score calculation speed (29455/sec), ...</pre></li><li class="listitem">
								Change a constraint, run the planning application again for the same amount of time, and review the score calculation speed recorded in the <code class="literal">log</code> file.
							</li><li class="listitem"><p class="simpara">
								Run the application in debug mode to log every step:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										To run debug mode from the command line, use the <code class="literal">-D</code> system property.
									</li><li class="listitem"><p class="simpara">
										To change logging in the <code class="literal">application.properties</code> file, add the following line to that file:
									</p><pre class="programlisting language-properties">logging.level.org.optaplanner=debug</pre><p class="simpara">
										The following example shows output in the <code class="literal">log</code> file in debug mode:
									</p><pre class="screen">... Solving started: time spent (67), best score (-20init/0hard/0soft), environment mode (REPRODUCIBLE), random (JDK with seed 0).
...     CH step (0), time spent (128), score (-18init/0hard/0soft), selected move count (15), picked move ([Math(101) {null -&gt; Room A}, Math(101) {null -&gt; MONDAY 08:30}]).
...     CH step (1), time spent (145), score (-16init/0hard/0soft), selected move count (15), picked move ([Physics(102) {null -&gt; Room A}, Physics(102) {null -&gt; MONDAY 09:30}]).
...</pre></li></ul></div></li><li class="listitem">
								Use <code class="literal">trace</code> logging to show every step and every move for each step.
							</li></ol></div></section></section><section class="section" id="business-optimizer-database-UI-integration-proc_business-optimizer-spring-boot"><div class="titlepage"><div><div><h2 class="title">12.8. Add Database and UI integration</h2></div></div></div><p>
					After you create the Red Hat build of OptaPlanner application example with Spring Boot, add database and UI integration.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have created the OptaPlanner Spring Boot timetable example.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create Java Persistence API (JPA) repositories for <code class="literal">Timeslot</code>, <code class="literal">Room</code>, and <code class="literal">Lesson</code>. For information about creating JPA repositories, see <a class="link" href="https://spring.io/guides/gs/accessing-data-jpa/"><span class="emphasis"><em>Accessing Data with JPA</em></span></a> on the Spring website.
						</li><li class="listitem">
							Expose the JPA repositories through REST. For information about exposing the repositories, see <a class="link" href="https://spring.io/guides/gs/accessing-data-rest/"><span class="emphasis"><em>Accessing JPA Data with REST</em></span></a> on the Spring website.
						</li><li class="listitem">
							Build a <code class="literal">TimeTableRepository</code> facade to read and write a <code class="literal">TimeTable</code> in a single transaction.
						</li><li class="listitem"><p class="simpara">
							Adjust the <code class="literal">TimeTableController</code> as shown in the following example:
						</p><div class="informalexample"><pre class="programlisting language-java">package com.example.solver;

import com.example.domain.TimeTable;
import com.example.persistence.TimeTableRepository;
import org.optaplanner.core.api.score.ScoreManager;
import org.optaplanner.core.api.solver.SolverManager;
import org.optaplanner.core.api.solver.SolverStatus;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/timeTable")
public class TimeTableController {

    @Autowired
    private TimeTableRepository timeTableRepository;
    @Autowired
    private SolverManager&lt;TimeTable, Long&gt; solverManager;
    @Autowired
    private ScoreManager&lt;TimeTable&gt; scoreManager;

    // To try, GET http://localhost:8080/timeTable
    @GetMapping()
    public TimeTable getTimeTable() {
        // Get the solver status before loading the solution
        // to avoid the race condition that the solver terminates between them
        SolverStatus solverStatus = getSolverStatus();
        TimeTable solution = timeTableRepository.findById(TimeTableRepository.SINGLETON_TIME_TABLE_ID);
        scoreManager.updateScore(solution); // Sets the score
        solution.setSolverStatus(solverStatus);
        return solution;
    }

    @PostMapping("/solve")
    public void solve() {
        solverManager.solveAndListen(TimeTableRepository.SINGLETON_TIME_TABLE_ID,
                timeTableRepository::findById,
                timeTableRepository::save);
    }

    public SolverStatus getSolverStatus() {
        return solverManager.getSolverStatus(TimeTableRepository.SINGLETON_TIME_TABLE_ID);
    }

    @PostMapping("/stopSolving")
    public void stopSolving() {
        solverManager.terminateEarly(TimeTableRepository.SINGLETON_TIME_TABLE_ID);
    }

}</pre></div><p class="simpara">
							For simplicity, this code handles only one <code class="literal">TimeTable</code> instance, but it is straightforward to enable multi-tenancy and handle multiple <code class="literal">TimeTable</code> instances of different high schools in parallel.
						</p><p class="simpara">
							The <code class="literal">getTimeTable()</code> method returns the latest timetable from the database. It uses the <code class="literal">ScoreManager</code> (which is automatically injected) to calculate the score of that timetable so the UI can show the score.
						</p><p class="simpara">
							The <code class="literal">solve()</code> method starts a job to solve the current timetable and store the time slot and room assignments in the database. It uses the <code class="literal">SolverManager.solveAndListen()</code> method to listen to intermediate best solutions and update the database accordingly. This enables the UI to show progress while the backend is still solving.
						</p></li><li class="listitem"><p class="simpara">
							Now that the <code class="literal">solve()</code> method returns immediately, adjust the <code class="literal">TimeTableControllerTest</code> as shown in the following example:
						</p><div class="informalexample"><pre class="programlisting language-java">package com.example.solver;

import com.example.domain.Lesson;
import com.example.domain.TimeTable;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Timeout;
import org.optaplanner.core.api.solver.SolverStatus;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

@SpringBootTest(properties = {
        "optaplanner.solver.termination.spent-limit=1h", // Effectively disable this termination in favor of the best-score-limit
        "optaplanner.solver.termination.best-score-limit=0hard/*soft"})
public class TimeTableControllerTest {

    @Autowired
    private TimeTableController timeTableController;

    @Test
    @Timeout(600_000)
    public void solveDemoDataUntilFeasible() throws InterruptedException {
        timeTableController.solve();
        TimeTable timeTable = timeTableController.getTimeTable();
        while (timeTable.getSolverStatus() != SolverStatus.NOT_SOLVING) {
            // Quick polling (not a Test Thread Sleep anti-pattern)
            // Test is still fast on fast systems and doesn't randomly fail on slow systems.
            Thread.sleep(20L);
            timeTable = timeTableController.getTimeTable();
        }
        assertFalse(timeTable.getLessonList().isEmpty());
        for (Lesson lesson : timeTable.getLessonList()) {
            assertNotNull(lesson.getTimeslot());
            assertNotNull(lesson.getRoom());
        }
        assertTrue(timeTable.getScore().isFeasible());
    }

}</pre></div></li><li class="listitem">
							Poll for the latest solution until the solver finishes solving.
						</li><li class="listitem">
							To visualize the timetable, build an attractive web UI on top of these REST methods.
						</li></ol></div></section><section class="section" id="using_micrometer_and_prometheus_to_monitor_your_school_timetable_optaplanner_spring_boot_application"><div class="titlepage"><div><div><h2 class="title">12.9. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Spring Boot application</h2></div></div></div><p>
					OptaPlanner exposes metrics through <a class="link" href="https://micrometer.io/">Micrometer</a>, a metrics instrumentation library for Java applications. You can use Micrometer with Prometheus to monitor the OptaPlanner solver in the school timetable application.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have created the Spring Boot OptaPlanner school timetable application.
						</li><li class="listitem">
							Prometheus is installed. For information about installing Prometheus, see the <a class="link" href="https://prometheus.io/">Prometheus</a> website.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the <code class="literal">technology/java-spring-boot</code> directory.
						</li><li class="listitem"><p class="simpara">
							Add the Micrometer Prometheus dependencies to the school timetable <code class="literal">pom.xml</code> file:
						</p><pre class="screen">&lt;dependency&gt;
 &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
 &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
 &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
 &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></li><li class="listitem"><p class="simpara">
							Add the following property to the application.properties file:
						</p><pre class="screen">management.endpoints.web.exposure.include=metrics,prometheus</pre></li><li class="listitem"><p class="simpara">
							Start the school timetable application:
						</p><pre class="screen">mvn spring-boot:run</pre></li><li class="listitem">
							Open <code class="literal"><a class="link" href="http://localhost:8080/actuator/prometheus">http://localhost:8080/actuator/prometheus</a></code> in a web browser.
						</li></ol></div></section></section><section class="chapter" id="assembly-planner-java"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Red Hat build of OptaPlanner and Java: a school timetable quickstart guide</h2></div></div></div><p>
				This guide walks you through the process of creating a simple Java application with OptaPlanner’s constraint solving artificial intelligence (AI). You will build a command-line application that optimizes a school timetable for students and teachers:
			</p><pre class="screen">...
INFO  Solving ended: time spent (5000), best score (0hard/9soft), ...
INFO
INFO  |            | Room A     | Room B     | Room C     |
INFO  |------------|------------|------------|------------|
INFO  | MON 08:30  | English    | Math       |            |
INFO  |            | I. Jones   | A. Turing  |            |
INFO  |            | 9th grade  | 10th grade |            |
INFO  |------------|------------|------------|------------|
INFO  | MON 09:30  | History    | Physics    |            |
INFO  |            | I. Jones   | M. Curie   |            |
INFO  |            | 9th grade  | 10th grade |            |
INFO  |------------|------------|------------|------------|
INFO  | MON 10:30  | History    | Physics    |            |
INFO  |            | I. Jones   | M. Curie   |            |
INFO  |            | 10th grade | 9th grade  |            |
INFO  |------------|------------|------------|------------|
...
INFO  |------------|------------|------------|------------|</pre><p>
				Your application will assign <code class="literal">Lesson</code> instances to <code class="literal">Timeslot</code> and <code class="literal">Room</code> instances automatically by using AI to adhere to hard and soft scheduling <span class="emphasis"><em>constraints</em></span>, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A room can have at most one lesson at the same time.
					</li><li class="listitem">
						A teacher can teach at most one lesson at the same time.
					</li><li class="listitem">
						A student can attend at most one lesson at the same time.
					</li><li class="listitem">
						A teacher prefers to teach all lessons in the same room.
					</li><li class="listitem">
						A teacher prefers to teach sequential lessons and dislikes gaps between lessons.
					</li><li class="listitem">
						A student dislikes sequential lessons on the same subject.
					</li></ul></div><p>
				Mathematically speaking, school timetabling is an <span class="emphasis"><em>NP-hard</em></span> problem. This means it is difficult to scale. Simply brute force iterating through all possible combinations takes millions of years for a non-trivial data set, even on a supercomputer. Fortunately, AI constraint solvers such as OptaPlanner have advanced algorithms that deliver a near-optimal solution in a reasonable amount of time.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenJDK (JDK) 11 is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
					</li><li class="listitem">
						Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
					</li><li class="listitem">
						An IDE, such as <a class="link" href="https://www.jetbrains.com/idea">IntelliJ IDEA</a>, VSCode or Eclipse
					</li></ul></div><section class="section" id="create_the_maven_or_gradle_build_file_and_add_dependencies"><div class="titlepage"><div><div><h2 class="title">13.1. Create the Maven or Gradle build file and add dependencies</h2></div></div></div><p>
					You can use Maven or Gradle for the OptaPlanner school timetable application. After you create the build files, add the following dependencies:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">optaplanner-core</code> (compile scope) to solve the school timetable problem
						</li><li class="listitem">
							<code class="literal">optaplanner-test</code> (test scope) to JUnit test the school timetabling constraints
						</li><li class="listitem">
							An implementation such as <code class="literal">logback-classic</code> (runtime scope) to view the steps that OptaPlanner takes
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create the Maven or Gradle build file.
						</li><li class="listitem"><p class="simpara">
							Add <code class="literal">optaplanner-core</code>, <code class="literal">optaplanner-test</code>, and <code class="literal">logback-classic</code> dependencies to your build file:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									For Maven, add the following dependencies to the <code class="literal">pom.xml</code> file:
								</p><pre class="screen">  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-core&lt;/artifactId&gt;
  &lt;/dependency&gt;

  &lt;dependency&gt;
    &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
    &lt;artifactId&gt;optaplanner-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;

  &lt;dependency&gt;
    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
    &lt;version&gt;1.2.3&lt;/version&gt;
  &lt;/dependency&gt;</pre><p class="simpara">
									The following example shows the complete <code class="literal">pom.xml</code> file.
								</p><pre class="programlisting language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;org.acme&lt;/groupId&gt;
  &lt;artifactId&gt;optaplanner-hello-world-school-timetabling-quickstart&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

  &lt;properties&gt;
    &lt;maven.compiler.release&gt;11&lt;/maven.compiler.release&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;

    &lt;version.org.optaplanner&gt;8.11.1.Final-redhat-00006&lt;/version.org.optaplanner&gt;
    &lt;version.org.logback&gt;1.2.3&lt;/version.org.logback&gt;

    &lt;version.compiler.plugin&gt;3.8.1&lt;/version.compiler.plugin&gt;
    &lt;version.surefire.plugin&gt;3.0.0-M5&lt;/version.surefire.plugin&gt;
    &lt;version.exec.plugin&gt;3.0.0&lt;/version.exec.plugin&gt;
  &lt;/properties&gt;

  &lt;dependencyManagement&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
        &lt;artifactId&gt;optaplanner-bom&lt;/artifactId&gt;
        &lt;version&gt;${version.org.optaplanner}&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;import&lt;/scope&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
        &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
        &lt;version&gt;${version.org.logback}&lt;/version&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
      &lt;artifactId&gt;optaplanner-core&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
      &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
      &lt;scope&gt;runtime&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;!-- Testing --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.optaplanner&lt;/groupId&gt;
      &lt;artifactId&gt;optaplanner-test&lt;/artifactId&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
        &lt;version&gt;${version.compiler.plugin}&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;version&gt;${version.surefire.plugin}&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${version.exec.plugin}&lt;/version&gt;
        &lt;configuration&gt;
          &lt;mainClass&gt;org.acme.schooltimetabling.TimeTableApp&lt;/mainClass&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;

  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;jboss-public-repository-group&lt;/id&gt;
      &lt;url&gt;https://repository.jboss.org/nexus/content/groups/public/&lt;/url&gt;
      &lt;releases&gt;
        &lt;!-- Get releases only from Maven Central which is faster. --&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
      &lt;/releases&gt;
      &lt;snapshots&gt;
        &lt;enabled&gt;true&lt;/enabled&gt;
      &lt;/snapshots&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
&lt;/project&gt;</pre></li><li class="listitem"><p class="simpara">
									For Gradle, add the following dependencies to the <code class="literal">gradle.build</code> file:
								</p><pre class="screen">dependencies {
    implementation "org.optaplanner:optaplanner-core:${optaplannerVersion}"
    runtimeOnly "ch.qos.logback:logback-classic:${logbackVersion}"

    testImplementation "org.optaplanner:optaplanner-test:${optaplannerVersion}"
}</pre><p class="simpara">
									The following example shows the completed <code class="literal">gradle.build</code> file.
								</p><pre class="programlisting language-groovy">plugins {
    id "java"
    id "application"
}

def optaplannerVersion = "{project-version}"
def logbackVersion = "1.2.3"

group = "org.acme"
version = "0.1.0-SNAPSHOT"

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.optaplanner:optaplanner-core:${optaplannerVersion}"
    runtimeOnly "ch.qos.logback:logback-classic:${logbackVersion}"

    testImplementation "org.optaplanner:optaplanner-test:${optaplannerVersion}"
}

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

compileJava {
    options.encoding = "UTF-8"
    options.compilerArgs &lt;&lt; "-parameters"
}

compileTestJava {
    options.encoding = "UTF-8"
}

application {
    mainClass = "org.acme.schooltimetabling.TimeTableApp"
}

test {
    // Log the test execution results.
    testLogging {
        events "passed", "skipped", "failed"
    }
}</pre></li></ul></div></li></ol></div></section><section class="section" id="business-optimizr-domain-objects-proc_optaplanner-java"><div class="titlepage"><div><div><h2 class="title">13.2. Model the domain objects</h2></div></div></div><p>
					The goal of the Red Hat build of OptaPlanner timetable project is to assign each lesson to a time slot and a room. To do this, add three classes, <code class="literal">Timeslot</code>, <code class="literal">Lesson</code>, and <code class="literal">Room</code>, as shown in the following diagram:
				</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableClassDiagramPure.png" alt="timeTableClassDiagramPure"/></div></div><div class="formalpara"><p class="title"><strong>Timeslot</strong></p><p>
						The <code class="literal">Timeslot</code> class represents a time interval when lessons are taught, for example, <code class="literal">Monday 10:30 - 11:30</code> or <code class="literal">Tuesday 13:30 - 14:30</code>. In this example, all time slots have the same duration and there are no time slots during lunch or other breaks.
					</p></div><p>
					A time slot has no date because a high school schedule just repeats every week. There is no need for <a class="link" href="https://docs.optaplanner.org/latestFinal/optaplanner-docs/html_single/index.html#continuousPlanning">continuous planning</a>. A timeslot is called a <span class="emphasis"><em>problem fact</em></span> because no <code class="literal">Timeslot</code> instances change during solving. Such classes do not require any OptaPlanner-specific annotations.
				</p><div class="formalpara"><p class="title"><strong>Room</strong></p><p>
						The <code class="literal">Room</code> class represents a location where lessons are taught, for example, <code class="literal">Room A</code> or <code class="literal">Room B</code>. In this example, all rooms are without capacity limits and they can accommodate all lessons.
					</p></div><p>
					<code class="literal">Room</code> instances do not change during solving so <code class="literal">Room</code> is also a <span class="emphasis"><em>problem fact</em></span>.
				</p><div class="formalpara"><p class="title"><strong>Lesson</strong></p><p>
						During a lesson, represented by the <code class="literal">Lesson</code> class, a teacher teaches a subject to a group of students, for example, <code class="literal">Math by A.Turing for 9th grade</code> or <code class="literal">Chemistry by M.Curie for 10th grade</code>. If a subject is taught multiple times each week by the same teacher to the same student group, there are multiple <code class="literal">Lesson</code> instances that are only distinguishable by <code class="literal">id</code>. For example, the 9th grade has six math lessons a week.
					</p></div><p>
					During solving, OptaPlanner changes the <code class="literal">timeslot</code> and <code class="literal">room</code> fields of the <code class="literal">Lesson</code> class to assign each lesson to a time slot and a room. Because OptaPlanner changes these fields, <code class="literal">Lesson</code> is a <span class="emphasis"><em>planning entity</em></span>:
				</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/optimizer/timeTableClassDiagramAnnotated.png" alt="timeTableClassDiagramAnnotated"/></div></div><p>
					Most of the fields in the previous diagram contain input data, except for the orange fields. A lesson’s <code class="literal">timeslot</code> and <code class="literal">room</code> fields are unassigned (<code class="literal">null</code>) in the input data and assigned (not <code class="literal">null</code>) in the output data. OptaPlanner changes these fields during solving. Such fields are called planning variables. In order for OptaPlanner to recognize them, both the <code class="literal">timeslot</code> and <code class="literal">room</code> fields require an <code class="literal">@PlanningVariable</code> annotation. Their containing class, <code class="literal">Lesson</code>, requires an <code class="literal">@PlanningEntity</code> annotation.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Timeslot.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

import java.time.DayOfWeek;
import java.time.LocalTime;

public class Timeslot {

    private DayOfWeek dayOfWeek;
    private LocalTime startTime;
    private LocalTime endTime;

    private Timeslot() {
    }

    public Timeslot(DayOfWeek dayOfWeek, LocalTime startTime, LocalTime endTime) {
        this.dayOfWeek = dayOfWeek;
        this.startTime = startTime;
        this.endTime = endTime;
    }

    @Override
    public String toString() {
        return dayOfWeek + " " + startTime.toString();
    }

    // ********************************
    // Getters and setters
    // ********************************

    public DayOfWeek getDayOfWeek() {
        return dayOfWeek;
    }

    public LocalTime getStartTime() {
        return startTime;
    }

    public LocalTime getEndTime() {
        return endTime;
    }

}</pre><p class="simpara">
							Notice the <code class="literal">toString()</code> method keeps the output short so it is easier to read OptaPlanner’s <code class="literal">DEBUG</code> or <code class="literal">TRACE</code> log, as shown later.
						</p></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Room.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

public class Room {

    private String name;

    private Room() {
    }

    public Room(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return name;
    }

    // ********************************
    // Getters and setters
    // ********************************

    public String getName() {
        return name;
    }

}</pre></li><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/com/example/domain/Lesson.java</code> class:
						</p><pre class="programlisting language-java">package com.example.domain;

import org.optaplanner.core.api.domain.entity.PlanningEntity;
import org.optaplanner.core.api.domain.variable.PlanningVariable;

@PlanningEntity
public class Lesson {

    private Long id;

    private String subject;
    private String teacher;
    private String studentGroup;

    @PlanningVariable(valueRangeProviderRefs = "timeslotRange")
    private Timeslot timeslot;

    @PlanningVariable(valueRangeProviderRefs = "roomRange")
    private Room room;

    private Lesson() {
    }

    public Lesson(Long id, String subject, String teacher, String studentGroup) {
        this.id = id;
        this.subject = subject;
        this.teacher = teacher;
        this.studentGroup = studentGroup;
    }

    @Override
    public String toString() {
        return subject + "(" + id + ")";
    }

    // ********************************
    // Getters and setters
    // ********************************

    public Long getId() {
        return id;
    }

    public String getSubject() {
        return subject;
    }

    public String getTeacher() {
        return teacher;
    }

    public String getStudentGroup() {
        return studentGroup;
    }

    public Timeslot getTimeslot() {
        return timeslot;
    }

    public void setTimeslot(Timeslot timeslot) {
        this.timeslot = timeslot;
    }

    public Room getRoom() {
        return room;
    }

    public void setRoom(Room room) {
        this.room = room;
    }

}</pre><p class="simpara">
							The <code class="literal">Lesson</code> class has an <code class="literal">@PlanningEntity</code> annotation, so OptaPlanner knows that this class changes during solving because it contains one or more planning variables.
						</p><p class="simpara">
							The <code class="literal">timeslot</code> field has an <code class="literal">@PlanningVariable</code> annotation, so OptaPlanner knows that it can change its value. In order to find potential <code class="literal">Timeslot</code> instances to assign to this field, OptaPlanner uses the <code class="literal">valueRangeProviderRefs</code> property to connect to a value range provider that provides a <code class="literal">List&lt;Timeslot&gt;</code> to pick from. See <a class="xref" href="#business-optimizr-gather-objects-proc_optaplanner-java" title="13.4. Gather the domain objects in a planning solution">Section 13.4, “Gather the domain objects in a planning solution”</a> for information about value range providers.
						</p><p class="simpara">
							The <code class="literal">room</code> field also has an <code class="literal">@PlanningVariable</code> annotation for the same reasons.
						</p></li></ol></div></section><section class="section" id="business-optimizr-define-contraints-proc_optaplanner-java"><div class="titlepage"><div><div><h2 class="title">13.3. Define the constraints and calculate the score</h2></div></div></div><p>
					When solving a problem, a <span class="emphasis"><em>score</em></span> represents the quality of a specific solution. The higher the score the better. Red Hat build of OptaPlanner looks for the best solution, which is the solution with the highest score found in the available time. It might be the <span class="emphasis"><em>optimal</em></span> solution.
				</p><p>
					Because the timetable example use case has hard and soft constraints, use the <code class="literal">HardSoftScore</code> class to represent the score:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Hard constraints must not be broken. For example: <span class="emphasis"><em>A room can have at most one lesson at the same time.</em></span>
						</li><li class="listitem">
							Soft constraints should not be broken. For example: <span class="emphasis"><em>A teacher prefers to teach in a single room.</em></span>
						</li></ul></div><p>
					Hard constraints are weighted against other hard constraints. Soft constraints are weighted against other soft constraints. Hard constraints always outweigh soft constraints, regardless of their respective weights.
				</p><p>
					To calculate the score, you could implement an <code class="literal">EasyScoreCalculator</code> class:
				</p><pre class="programlisting language-java">public class TimeTableEasyScoreCalculator implements EasyScoreCalculator&lt;TimeTable&gt; {

    @Override
    public HardSoftScore calculateScore(TimeTable timeTable) {
        List&lt;Lesson&gt; lessonList = timeTable.getLessonList();
        int hardScore = 0;
        for (Lesson a : lessonList) {
            for (Lesson b : lessonList) {
                if (a.getTimeslot() != null &amp;&amp; a.getTimeslot().equals(b.getTimeslot())
                        &amp;&amp; a.getId() &lt; b.getId()) {
                    // A room can accommodate at most one lesson at the same time.
                    if (a.getRoom() != null &amp;&amp; a.getRoom().equals(b.getRoom())) {
                        hardScore--;
                    }
                    // A teacher can teach at most one lesson at the same time.
                    if (a.getTeacher().equals(b.getTeacher())) {
                        hardScore--;
                    }
                    // A student can attend at most one lesson at the same time.
                    if (a.getStudentGroup().equals(b.getStudentGroup())) {
                        hardScore--;
                    }
                }
            }
        }
        int softScore = 0;
        // Soft constraints are only implemented in the "complete" implementation
        return HardSoftScore.of(hardScore, softScore);
    }

}</pre><p>
					Unfortunately, this solution does not scale well because it is non-incremental: every time a lesson is assigned to a different time slot or room, all lessons are re-evaluated to calculate the new score.
				</p><p>
					A better solution is to create a <code class="literal">src/main/java/com/example/solver/TimeTableConstraintProvider.java</code> class to perform incremental score calculation. This class uses OptaPlanner’s ConstraintStream API which is inspired by Java 8 Streams and SQL. The <code class="literal">ConstraintProvider</code> scales an order of magnitude better than the <code class="literal">EasyScoreCalculator</code>: <span class="emphasis"><em>O</em></span>(n) instead of <span class="emphasis"><em>O</em></span>(n²).
				</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the following <code class="literal">src/main/java/com/example/solver/TimeTableConstraintProvider.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.solver;

import com.example.domain.Lesson;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;
import org.optaplanner.core.api.score.stream.Constraint;
import org.optaplanner.core.api.score.stream.ConstraintFactory;
import org.optaplanner.core.api.score.stream.ConstraintProvider;
import org.optaplanner.core.api.score.stream.Joiners;

public class TimeTableConstraintProvider implements ConstraintProvider {

    @Override
    public Constraint[] defineConstraints(ConstraintFactory constraintFactory) {
        return new Constraint[] {
                // Hard constraints
                roomConflict(constraintFactory),
                teacherConflict(constraintFactory),
                studentGroupConflict(constraintFactory),
                // Soft constraints are only implemented in the "complete" implementation
        };
    }

    private Constraint roomConflict(ConstraintFactory constraintFactory) {
        // A room can accommodate at most one lesson at the same time.

        // Select a lesson ...
        return constraintFactory.from(Lesson.class)
                // ... and pair it with another lesson ...
                .join(Lesson.class,
                        // ... in the same timeslot ...
                        Joiners.equal(Lesson::getTimeslot),
                        // ... in the same room ...
                        Joiners.equal(Lesson::getRoom),
                        // ... and the pair is unique (different id, no reverse pairs)
                        Joiners.lessThan(Lesson::getId))
                // then penalize each pair with a hard weight.
                .penalize("Room conflict", HardSoftScore.ONE_HARD);
    }

    private Constraint teacherConflict(ConstraintFactory constraintFactory) {
        // A teacher can teach at most one lesson at the same time.
        return constraintFactory.from(Lesson.class)
                .join(Lesson.class,
                        Joiners.equal(Lesson::getTimeslot),
                        Joiners.equal(Lesson::getTeacher),
                        Joiners.lessThan(Lesson::getId))
                .penalize("Teacher conflict", HardSoftScore.ONE_HARD);
    }

    private Constraint studentGroupConflict(ConstraintFactory constraintFactory) {
        // A student can attend at most one lesson at the same time.
        return constraintFactory.from(Lesson.class)
                .join(Lesson.class,
                        Joiners.equal(Lesson::getTimeslot),
                        Joiners.equal(Lesson::getStudentGroup),
                        Joiners.lessThan(Lesson::getId))
                .penalize("Student group conflict", HardSoftScore.ONE_HARD);
    }

}</pre></section><section class="section" id="business-optimizr-gather-objects-proc_optaplanner-java"><div class="titlepage"><div><div><h2 class="title">13.4. Gather the domain objects in a planning solution</h2></div></div></div><p>
					A <code class="literal">TimeTable</code> instance wraps all <code class="literal">Timeslot</code>, <code class="literal">Room</code>, and <code class="literal">Lesson</code> instances of a single dataset. Furthermore, because it contains all lessons, each with a specific planning variable state, it is a <span class="emphasis"><em>planning solution</em></span> and it has a score:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If lessons are still unassigned, then it is an <span class="emphasis"><em>uninitialized</em></span> solution, for example, a solution with the score <code class="literal">-4init/0hard/0soft</code>.
						</li><li class="listitem">
							If it breaks hard constraints, then it is an <span class="emphasis"><em>infeasible</em></span> solution, for example, a solution with the score <code class="literal">-2hard/-3soft</code>.
						</li><li class="listitem">
							If it adheres to all hard constraints, then it is a <span class="emphasis"><em>feasible</em></span> solution, for example, a solution with the score <code class="literal">0hard/-7soft</code>.
						</li></ul></div><p>
					The <code class="literal">TimeTable</code> class has an <code class="literal">@PlanningSolution</code> annotation, so Red Hat build of OptaPlanner knows that this class contains all of the input and output data.
				</p><p>
					Specifically, this class is the input of the problem:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							A <code class="literal">timeslotList</code> field with all time slots
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of problem facts, because they do not change during solving.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A <code class="literal">roomList</code> field with all rooms
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of problem facts, because they do not change during solving.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							A <code class="literal">lessonList</code> field with all lessons
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									This is a list of planning entities because they change during solving.
								</li><li class="listitem"><p class="simpara">
									Of each <code class="literal">Lesson</code>:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											The values of the <code class="literal">timeslot</code> and <code class="literal">room</code> fields are typically still <code class="literal">null</code>, so unassigned. They are planning variables.
										</li><li class="listitem">
											The other fields, such as <code class="literal">subject</code>, <code class="literal">teacher</code> and <code class="literal">studentGroup</code>, are filled in. These fields are problem properties.
										</li></ul></div></li></ul></div></li></ul></div><p>
					However, this class is also the output of the solution:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">lessonList</code> field for which each <code class="literal">Lesson</code> instance has non-null <code class="literal">timeslot</code> and <code class="literal">room</code> fields after solving
						</li><li class="listitem">
							A <code class="literal">score</code> field that represents the quality of the output solution, for example, <code class="literal">0hard/-5soft</code>
						</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						Create the <code class="literal">src/main/java/com/example/domain/TimeTable.java</code> class:
					</p></div><pre class="programlisting language-java">package com.example.domain;

import java.util.List;

import org.optaplanner.core.api.domain.solution.PlanningEntityCollectionProperty;
import org.optaplanner.core.api.domain.solution.PlanningScore;
import org.optaplanner.core.api.domain.solution.PlanningSolution;
import org.optaplanner.core.api.domain.solution.ProblemFactCollectionProperty;
import org.optaplanner.core.api.domain.valuerange.ValueRangeProvider;
import org.optaplanner.core.api.score.buildin.hardsoft.HardSoftScore;

@PlanningSolution
public class TimeTable {

    @ValueRangeProvider(id = "timeslotRange")
    @ProblemFactCollectionProperty
    private List&lt;Timeslot&gt; timeslotList;

    @ValueRangeProvider(id = "roomRange")
    @ProblemFactCollectionProperty
    private List&lt;Room&gt; roomList;

    @PlanningEntityCollectionProperty
    private List&lt;Lesson&gt; lessonList;

    @PlanningScore
    private HardSoftScore score;

    private TimeTable() {
    }

    public TimeTable(List&lt;Timeslot&gt; timeslotList, List&lt;Room&gt; roomList,
            List&lt;Lesson&gt; lessonList) {
        this.timeslotList = timeslotList;
        this.roomList = roomList;
        this.lessonList = lessonList;
    }

    // ********************************
    // Getters and setters
    // ********************************

    public List&lt;Timeslot&gt; getTimeslotList() {
        return timeslotList;
    }

    public List&lt;Room&gt; getRoomList() {
        return roomList;
    }

    public List&lt;Lesson&gt; getLessonList() {
        return lessonList;
    }

    public HardSoftScore getScore() {
        return score;
    }

}</pre><div class="formalpara"><p class="title"><strong>The value range providers</strong></p><p>
						The <code class="literal">timeslotList</code> field is a value range provider. It holds the <code class="literal">Timeslot</code> instances which OptaPlanner can pick from to assign to the <code class="literal">timeslot</code> field of <code class="literal">Lesson</code> instances. The <code class="literal">timeslotList</code> field has an <code class="literal">@ValueRangeProvider</code> annotation to connect those two, by matching the <code class="literal">id</code> with the <code class="literal">valueRangeProviderRefs</code> of the <code class="literal">@PlanningVariable</code> in the <code class="literal">Lesson</code>.
					</p></div><p>
					Following the same logic, the <code class="literal">roomList</code> field also has an <code class="literal">@ValueRangeProvider</code> annotation.
				</p><div class="formalpara"><p class="title"><strong>The problem fact and planning entity properties</strong></p><p>
						Furthermore, OptaPlanner needs to know which <code class="literal">Lesson</code> instances it can change as well as how to retrieve the <code class="literal">Timeslot</code> and <code class="literal">Room</code> instances used for score calculation by your <code class="literal">TimeTableConstraintProvider</code>.
					</p></div><p>
					The <code class="literal">timeslotList</code> and <code class="literal">roomList</code> fields have an <code class="literal">@ProblemFactCollectionProperty</code> annotation, so your <code class="literal">TimeTableConstraintProvider</code> can select from those instances.
				</p><p>
					The <code class="literal">lessonList</code> has an <code class="literal">@PlanningEntityCollectionProperty</code> annotation, so OptaPlanner can change them during solving and your <code class="literal">TimeTableConstraintProvider</code> can select from those too.
				</p></section><section class="section" id="the_timetableapp_java_class"><div class="titlepage"><div><div><h2 class="title">13.5. The TimeTableApp.java class</h2></div></div></div><p>
					After you have created all of the components of the school timetable application, you will put them all together in the <code class="literal">TimeTableApp.java</code> class.
				</p><p>
					The <code class="literal">main()</code> method performs the following tasks:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Creates the <code class="literal">SolverFactory</code> to build a <code class="literal">Solver</code> for each data set.
						</li><li class="listitem">
							Loads a data set.
						</li><li class="listitem">
							Solves it with <code class="literal">Solver.solve()</code>.
						</li><li class="listitem">
							Visualizes the solution for that data set.
						</li></ol></div><p>
					Typically, an application has a single <code class="literal">SolverFactory</code> to build a new <code class="literal">Solver</code> instance for each problem data set to solve. A <code class="literal">SolverFactory</code> is thread-safe, but a <code class="literal">Solver</code> is not. For the school timetable application, there is only one data set, so only one <code class="literal">Solver</code> instance.
				</p><p>
					Here is the completed <code class="literal">TimeTableApp.java</code> class:
				</p><pre class="programlisting language-java">package org.acme.schooltimetabling;

import java.time.DayOfWeek;
import java.time.Duration;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

import org.acme.schooltimetabling.domain.Lesson;
import org.acme.schooltimetabling.domain.Room;
import org.acme.schooltimetabling.domain.TimeTable;
import org.acme.schooltimetabling.domain.Timeslot;
import org.acme.schooltimetabling.solver.TimeTableConstraintProvider;
import org.optaplanner.core.api.solver.Solver;
import org.optaplanner.core.api.solver.SolverFactory;
import org.optaplanner.core.config.solver.SolverConfig;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class TimeTableApp {

    private static final Logger LOGGER = LoggerFactory.getLogger(TimeTableApp.class);

    public static void main(String[] args) {
        SolverFactory&lt;TimeTable&gt; solverFactory = SolverFactory.create(new SolverConfig()
                .withSolutionClass(TimeTable.class)
                .withEntityClasses(Lesson.class)
                .withConstraintProviderClass(TimeTableConstraintProvider.class)
                // The solver runs only for 5 seconds on this small data set.
                // It's recommended to run for at least 5 minutes ("5m") otherwise.
                .withTerminationSpentLimit(Duration.ofSeconds(10)));

        // Load the problem
        TimeTable problem = generateDemoData();

        // Solve the problem
        Solver&lt;TimeTable&gt; solver = solverFactory.buildSolver();
        TimeTable solution = solver.solve(problem);

        // Visualize the solution
        printTimetable(solution);
    }

    public static TimeTable generateDemoData() {
        List&lt;Timeslot&gt; timeslotList = new ArrayList&lt;&gt;(10);
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        List&lt;Room&gt; roomList = new ArrayList&lt;&gt;(3);
        roomList.add(new Room("Room A"));
        roomList.add(new Room("Room B"));
        roomList.add(new Room("Room C"));

        List&lt;Lesson&gt; lessonList = new ArrayList&lt;&gt;();
        long id = 0;
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "9th grade"));
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "9th grade"));
        lessonList.add(new Lesson(id++, "Physics", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(id++, "Chemistry", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(id++, "Biology", "C. Darwin", "9th grade"));
        lessonList.add(new Lesson(id++, "History", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(id++, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(id++, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(id++, "Spanish", "P. Cruz", "9th grade"));
        lessonList.add(new Lesson(id++, "Spanish", "P. Cruz", "9th grade"));

        lessonList.add(new Lesson(id++, "Math", "A. Turing", "10th grade"));
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "10th grade"));
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "10th grade"));
        lessonList.add(new Lesson(id++, "Physics", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(id++, "Chemistry", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(id++, "French", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(id++, "Geography", "C. Darwin", "10th grade"));
        lessonList.add(new Lesson(id++, "History", "I. Jones", "10th grade"));
        lessonList.add(new Lesson(id++, "English", "P. Cruz", "10th grade"));
        lessonList.add(new Lesson(id++, "Spanish", "P. Cruz", "10th grade"));

        return new TimeTable(timeslotList, roomList, lessonList);
    }

    private static void printTimetable(TimeTable timeTable) {
        LOGGER.info("");
        List&lt;Room&gt; roomList = timeTable.getRoomList();
        List&lt;Lesson&gt; lessonList = timeTable.getLessonList();
        Map&lt;Timeslot, Map&lt;Room, List&lt;Lesson&gt;&gt;&gt; lessonMap = lessonList.stream()
                .filter(lesson -&gt; lesson.getTimeslot() != null &amp;&amp; lesson.getRoom() != null)
                .collect(Collectors.groupingBy(Lesson::getTimeslot, Collectors.groupingBy(Lesson::getRoom)));
        LOGGER.info("|            | " + roomList.stream()
                .map(room -&gt; String.format("%-10s", room.getName())).collect(Collectors.joining(" | ")) + " |");
        LOGGER.info("|" + "------------|".repeat(roomList.size() + 1));
        for (Timeslot timeslot : timeTable.getTimeslotList()) {
            List&lt;List&lt;Lesson&gt;&gt; cellList = roomList.stream()
                    .map(room -&gt; {
                        Map&lt;Room, List&lt;Lesson&gt;&gt; byRoomMap = lessonMap.get(timeslot);
                        if (byRoomMap == null) {
                            return Collections.&lt;Lesson&gt;emptyList();
                        }
                        List&lt;Lesson&gt; cellLessonList = byRoomMap.get(room);
                        if (cellLessonList == null) {
                            return Collections.&lt;Lesson&gt;emptyList();
                        }
                        return cellLessonList;
                    })
                    .collect(Collectors.toList());

            LOGGER.info("| " + String.format("%-10s",
                    timeslot.getDayOfWeek().toString().substring(0, 3) + " " + timeslot.getStartTime()) + " | "
                    + cellList.stream().map(cellLessonList -&gt; String.format("%-10s",
                            cellLessonList.stream().map(Lesson::getSubject).collect(Collectors.joining(", "))))
                            .collect(Collectors.joining(" | "))
                    + " |");
            LOGGER.info("|            | "
                    + cellList.stream().map(cellLessonList -&gt; String.format("%-10s",
                            cellLessonList.stream().map(Lesson::getTeacher).collect(Collectors.joining(", "))))
                            .collect(Collectors.joining(" | "))
                    + " |");
            LOGGER.info("|            | "
                    + cellList.stream().map(cellLessonList -&gt; String.format("%-10s",
                            cellLessonList.stream().map(Lesson::getStudentGroup).collect(Collectors.joining(", "))))
                            .collect(Collectors.joining(" | "))
                    + " |");
            LOGGER.info("|" + "------------|".repeat(roomList.size() + 1));
        }
        List&lt;Lesson&gt; unassignedLessons = lessonList.stream()
                .filter(lesson -&gt; lesson.getTimeslot() == null || lesson.getRoom() == null)
                .collect(Collectors.toList());
        if (!unassignedLessons.isEmpty()) {
            LOGGER.info("");
            LOGGER.info("Unassigned lessons");
            for (Lesson lesson : unassignedLessons) {
                LOGGER.info("  " + lesson.getSubject() + " - " + lesson.getTeacher() + " - " + lesson.getStudentGroup());
            }
        }
    }

}</pre><p>
					The <code class="literal">main()</code> method first creates the <code class="literal">SolverFactory</code>:
				</p><pre class="programlisting language-java">SolverFactory&lt;TimeTable&gt; solverFactory = SolverFactory.create(new SolverConfig()
        .withSolutionClass(TimeTable.class)
        .withEntityClasses(Lesson.class)
        .withConstraintProviderClass(TimeTableConstraintProvider.class)
        // The solver runs only for 5 seconds on this small data set.
        // It's recommended to run for at least 5 minutes ("5m") otherwise.
        .withTerminationSpentLimit(Duration.ofSeconds(5)));</pre><p>
					The <code class="literal">SolverFactory</code> creation registers the <code class="literal">@PlanningSolution</code> class, the <code class="literal">@PlanningEntity</code> classes, and the <code class="literal">ConstraintProvider</code> class, all of which you created earlier.
				</p><p>
					Without a termination setting or a <code class="literal">terminationEarly()</code> event, the solver runs forever. To avoid that, the solver limits the solving time to five seconds.
				</p><p>
					After five seconds, the <code class="literal">main()</code> method loads the problem, solves it, and prints the solution:
				</p><pre class="programlisting language-java">        // Load the problem
        TimeTable problem = generateDemoData();

        // Solve the problem
        Solver&lt;TimeTable&gt; solver = solverFactory.buildSolver();
        TimeTable solution = solver.solve(problem);

        // Visualize the solution
        printTimetable(solution);</pre><p>
					The <code class="literal">solve()</code> method doesn’t return instantly. It runs for five seconds before returning the best solution.
				</p><p>
					OptaPlanner returns <span class="emphasis"><em>the best solution</em></span> found in the available termination time. Due to the nature of NP-hard problems, the best solution might not be optimal, especially for larger data sets. Increase the termination time to potentially find a better solution.
				</p><p>
					The <code class="literal">generateDemoData()</code> method generates the school timetable problem to solve.
				</p><p>
					The <code class="literal">printTimetable()</code> method prettyprints the timetable to the console, so it’s easy to determine visually whether or not it’s a good schedule.
				</p></section><section class="section" id="create_and_run_the_school_timetable_application"><div class="titlepage"><div><div><h2 class="title">13.6. Create and run the school timetable application</h2></div></div></div><p>
					Now that you have completed all of the components of the school timetable Java application, you are ready to put them all together in the <code class="literal">TimeTableApp.java</code> class and run it.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have created all of the required components of the school timetable application.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the <code class="literal">src/main/java/org/acme/schooltimetabling/TimeTableApp.java</code> class:
						</p><pre class="programlisting language-java">package org.acme.schooltimetabling;

import java.time.DayOfWeek;
import java.time.Duration;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

import org.acme.schooltimetabling.domain.Lesson;
import org.acme.schooltimetabling.domain.Room;
import org.acme.schooltimetabling.domain.TimeTable;
import org.acme.schooltimetabling.domain.Timeslot;
import org.acme.schooltimetabling.solver.TimeTableConstraintProvider;
import org.optaplanner.core.api.solver.Solver;
import org.optaplanner.core.api.solver.SolverFactory;
import org.optaplanner.core.config.solver.SolverConfig;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class TimeTableApp {

    private static final Logger LOGGER = LoggerFactory.getLogger(TimeTableApp.class);

    public static void main(String[] args) {
        SolverFactory&lt;TimeTable&gt; solverFactory = SolverFactory.create(new SolverConfig()
                .withSolutionClass(TimeTable.class)
                .withEntityClasses(Lesson.class)
                .withConstraintProviderClass(TimeTableConstraintProvider.class)
                // The solver runs only for 5 seconds on this small data set.
                // It's recommended to run for at least 5 minutes ("5m") otherwise.
                .withTerminationSpentLimit(Duration.ofSeconds(10)));

        // Load the problem
        TimeTable problem = generateDemoData();

        // Solve the problem
        Solver&lt;TimeTable&gt; solver = solverFactory.buildSolver();
        TimeTable solution = solver.solve(problem);

        // Visualize the solution
        printTimetable(solution);
    }

    public static TimeTable generateDemoData() {
        List&lt;Timeslot&gt; timeslotList = new ArrayList&lt;&gt;(10);
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        List&lt;Room&gt; roomList = new ArrayList&lt;&gt;(3);
        roomList.add(new Room("Room A"));
        roomList.add(new Room("Room B"));
        roomList.add(new Room("Room C"));

        List&lt;Lesson&gt; lessonList = new ArrayList&lt;&gt;();
        long id = 0;
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "9th grade"));
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "9th grade"));
        lessonList.add(new Lesson(id++, "Physics", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(id++, "Chemistry", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(id++, "Biology", "C. Darwin", "9th grade"));
        lessonList.add(new Lesson(id++, "History", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(id++, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(id++, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(id++, "Spanish", "P. Cruz", "9th grade"));
        lessonList.add(new Lesson(id++, "Spanish", "P. Cruz", "9th grade"));

        lessonList.add(new Lesson(id++, "Math", "A. Turing", "10th grade"));
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "10th grade"));
        lessonList.add(new Lesson(id++, "Math", "A. Turing", "10th grade"));
        lessonList.add(new Lesson(id++, "Physics", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(id++, "Chemistry", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(id++, "French", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(id++, "Geography", "C. Darwin", "10th grade"));
        lessonList.add(new Lesson(id++, "History", "I. Jones", "10th grade"));
        lessonList.add(new Lesson(id++, "English", "P. Cruz", "10th grade"));
        lessonList.add(new Lesson(id++, "Spanish", "P. Cruz", "10th grade"));

        return new TimeTable(timeslotList, roomList, lessonList);
    }

    private static void printTimetable(TimeTable timeTable) {
        LOGGER.info("");
        List&lt;Room&gt; roomList = timeTable.getRoomList();
        List&lt;Lesson&gt; lessonList = timeTable.getLessonList();
        Map&lt;Timeslot, Map&lt;Room, List&lt;Lesson&gt;&gt;&gt; lessonMap = lessonList.stream()
                .filter(lesson -&gt; lesson.getTimeslot() != null &amp;&amp; lesson.getRoom() != null)
                .collect(Collectors.groupingBy(Lesson::getTimeslot, Collectors.groupingBy(Lesson::getRoom)));
        LOGGER.info("|            | " + roomList.stream()
                .map(room -&gt; String.format("%-10s", room.getName())).collect(Collectors.joining(" | ")) + " |");
        LOGGER.info("|" + "------------|".repeat(roomList.size() + 1));
        for (Timeslot timeslot : timeTable.getTimeslotList()) {
            List&lt;List&lt;Lesson&gt;&gt; cellList = roomList.stream()
                    .map(room -&gt; {
                        Map&lt;Room, List&lt;Lesson&gt;&gt; byRoomMap = lessonMap.get(timeslot);
                        if (byRoomMap == null) {
                            return Collections.&lt;Lesson&gt;emptyList();
                        }
                        List&lt;Lesson&gt; cellLessonList = byRoomMap.get(room);
                        if (cellLessonList == null) {
                            return Collections.&lt;Lesson&gt;emptyList();
                        }
                        return cellLessonList;
                    })
                    .collect(Collectors.toList());

            LOGGER.info("| " + String.format("%-10s",
                    timeslot.getDayOfWeek().toString().substring(0, 3) + " " + timeslot.getStartTime()) + " | "
                    + cellList.stream().map(cellLessonList -&gt; String.format("%-10s",
                            cellLessonList.stream().map(Lesson::getSubject).collect(Collectors.joining(", "))))
                            .collect(Collectors.joining(" | "))
                    + " |");
            LOGGER.info("|            | "
                    + cellList.stream().map(cellLessonList -&gt; String.format("%-10s",
                            cellLessonList.stream().map(Lesson::getTeacher).collect(Collectors.joining(", "))))
                            .collect(Collectors.joining(" | "))
                    + " |");
            LOGGER.info("|            | "
                    + cellList.stream().map(cellLessonList -&gt; String.format("%-10s",
                            cellLessonList.stream().map(Lesson::getStudentGroup).collect(Collectors.joining(", "))))
                            .collect(Collectors.joining(" | "))
                    + " |");
            LOGGER.info("|" + "------------|".repeat(roomList.size() + 1));
        }
        List&lt;Lesson&gt; unassignedLessons = lessonList.stream()
                .filter(lesson -&gt; lesson.getTimeslot() == null || lesson.getRoom() == null)
                .collect(Collectors.toList());
        if (!unassignedLessons.isEmpty()) {
            LOGGER.info("");
            LOGGER.info("Unassigned lessons");
            for (Lesson lesson : unassignedLessons) {
                LOGGER.info("  " + lesson.getSubject() + " - " + lesson.getTeacher() + " - " + lesson.getStudentGroup());
            }
        }
    }

}</pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">TimeTableApp</code> class as the main class of a normal Java application. The following output should result:
						</p><pre class="screen">...
INFO  |            | Room A     | Room B     | Room C     |
INFO  |------------|------------|------------|------------|
INFO  | MON 08:30  | English    | Math       |            |
INFO  |            | I. Jones   | A. Turing  |            |
INFO  |            | 9th grade  | 10th grade |            |
INFO  |------------|------------|------------|------------|
INFO  | MON 09:30  | History    | Physics    |            |
INFO  |            | I. Jones   | M. Curie   |            |
INFO  |            | 9th grade  | 10th grade |            |
...</pre></li><li class="listitem">
							Verify the console output. Does it conform to all hard constraints? What happens if you comment out the <code class="literal">roomConflict</code> constraint in <code class="literal">TimeTableConstraintProvider</code>?
						</li></ol></div><p>
					The <code class="literal">info</code> log shows what OptaPlanner did in those five seconds:
				</p><pre class="screen">... Solving started: time spent (33), best score (-8init/0hard/0soft), environment mode (REPRODUCIBLE), random (JDK with seed 0).
... Construction Heuristic phase (0) ended: time spent (73), best score (0hard/0soft), score calculation speed (459/sec), step total (4).
... Local Search phase (1) ended: time spent (5000), best score (0hard/0soft), score calculation speed (28949/sec), step total (28398).
... Solving ended: time spent (5000), best score (0hard/0soft), score calculation speed (28524/sec), phase total (2), environment mode (REPRODUCIBLE).</pre></section><section class="section" id="test_the_application"><div class="titlepage"><div><div><h2 class="title">13.7. Test the application</h2></div></div></div><p>
					A good application includes test coverage. Test the constraints and the solver in your timetable project.
				</p><section class="section" id="business-optimizer-test-constraints-proc_optaplanner-java"><div class="titlepage"><div><div><h3 class="title">13.7.1. Test the school timetable constraints</h3></div></div></div><p>
						To test each constraint of the timetable project in isolation, use a <code class="literal">ConstraintVerifier</code> in unit tests. This tests each constraint’s corner cases in isolation from the other tests, which lowers maintenance when adding a new constraint with proper test coverage.
					</p><p>
						This test verifies that the constraint <code class="literal">TimeTableConstraintProvider::roomConflict</code>, when given three lessons in the same room and two of the lessons have the same timeslot, penalizes with a match weight of 1. So if the constraint weight is <code class="literal">10hard</code> it reduces the score by <code class="literal">-10hard</code>.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							Create the <code class="literal">src/test/java/org/acme/optaplanner/solver/TimeTableConstraintProviderTest.java</code> class:
						</p></div><pre class="programlisting language-java">package org.acme.optaplanner.solver;

import java.time.DayOfWeek;
import java.time.LocalTime;

import javax.inject.Inject;

import io.quarkus.test.junit.QuarkusTest;
import org.acme.optaplanner.domain.Lesson;
import org.acme.optaplanner.domain.Room;
import org.acme.optaplanner.domain.TimeTable;
import org.acme.optaplanner.domain.Timeslot;
import org.junit.jupiter.api.Test;
import org.optaplanner.test.api.score.stream.ConstraintVerifier;

@QuarkusTest
class TimeTableConstraintProviderTest {

    private static final Room ROOM = new Room("Room1");
    private static final Timeslot TIMESLOT1 = new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9,0), LocalTime.NOON);
    private static final Timeslot TIMESLOT2 = new Timeslot(DayOfWeek.TUESDAY, LocalTime.of(9,0), LocalTime.NOON);

    @Inject
    ConstraintVerifier&lt;TimeTableConstraintProvider, TimeTable&gt; constraintVerifier;

    @Test
    void roomConflict() {
        Lesson firstLesson = new Lesson(1, "Subject1", "Teacher1", "Group1");
        Lesson conflictingLesson = new Lesson(2, "Subject2", "Teacher2", "Group2");
        Lesson nonConflictingLesson = new Lesson(3, "Subject3", "Teacher3", "Group3");

        firstLesson.setRoom(ROOM);
        firstLesson.setTimeslot(TIMESLOT1);

        conflictingLesson.setRoom(ROOM);
        conflictingLesson.setTimeslot(TIMESLOT1);

        nonConflictingLesson.setRoom(ROOM);
        nonConflictingLesson.setTimeslot(TIMESLOT2);

        constraintVerifier.verifyThat(TimeTableConstraintProvider::roomConflict)
                .given(firstLesson, conflictingLesson, nonConflictingLesson)
                .penalizesBy(1);
    }

}</pre><p>
						Notice how <code class="literal">ConstraintVerifier</code> ignores the constraint weight during testing even if those constraint weights are hardcoded in the <code class="literal">ConstraintProvider</code>. This is because constraint weights change regularly before going into production. This way, constraint weight tweaking does not break the unit tests.
					</p></section><section class="section" id="business-optimizer-test-solver-proc_optaplanner-java"><div class="titlepage"><div><div><h3 class="title">13.7.2. Test the school timetable solver</h3></div></div></div><p>
						This example tests the Red Hat build of OptaPlanner school timetable project on Red Hat build of Quarkus. It uses a JUnit test to generate a test data set and send it to the <code class="literal">TimeTableController</code> to solve.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Create the <code class="literal">src/test/java/com/example/rest/TimeTableResourceTest.java</code> class with the following content:
							</p><pre class="programlisting language-java">package com.exmaple.optaplanner.rest;

import java.time.DayOfWeek;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;

import io.quarkus.test.junit.QuarkusTest;
import com.exmaple.optaplanner.domain.Room;
import com.exmaple.optaplanner.domain.Timeslot;
import com.exmaple.optaplanner.domain.Lesson;
import com.exmaple.optaplanner.domain.TimeTable;
import com.exmaple.optaplanner.rest.TimeTableResource;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Timeout;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

@QuarkusTest
public class TimeTableResourceTest {

    @Inject
    TimeTableResource timeTableResource;

    @Test
    @Timeout(600_000)
    public void solve() {
        TimeTable problem = generateProblem();
        TimeTable solution = timeTableResource.solve(problem);
        assertFalse(solution.getLessonList().isEmpty());
        for (Lesson lesson : solution.getLessonList()) {
            assertNotNull(lesson.getTimeslot());
            assertNotNull(lesson.getRoom());
        }
        assertTrue(solution.getScore().isFeasible());
    }

    private TimeTable generateProblem() {
        List&lt;Timeslot&gt; timeslotList = new ArrayList&lt;&gt;();
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(8, 30), LocalTime.of(9, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(9, 30), LocalTime.of(10, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(10, 30), LocalTime.of(11, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(13, 30), LocalTime.of(14, 30)));
        timeslotList.add(new Timeslot(DayOfWeek.MONDAY, LocalTime.of(14, 30), LocalTime.of(15, 30)));

        List&lt;Room&gt; roomList = new ArrayList&lt;&gt;();
        roomList.add(new Room("Room A"));
        roomList.add(new Room("Room B"));
        roomList.add(new Room("Room C"));

        List&lt;Lesson&gt; lessonList = new ArrayList&lt;&gt;();
        lessonList.add(new Lesson(101L, "Math", "B. May", "9th grade"));
        lessonList.add(new Lesson(102L, "Physics", "M. Curie", "9th grade"));
        lessonList.add(new Lesson(103L, "Geography", "M. Polo", "9th grade"));
        lessonList.add(new Lesson(104L, "English", "I. Jones", "9th grade"));
        lessonList.add(new Lesson(105L, "Spanish", "P. Cruz", "9th grade"));

        lessonList.add(new Lesson(201L, "Math", "B. May", "10th grade"));
        lessonList.add(new Lesson(202L, "Chemistry", "M. Curie", "10th grade"));
        lessonList.add(new Lesson(203L, "History", "I. Jones", "10th grade"));
        lessonList.add(new Lesson(204L, "English", "P. Cruz", "10th grade"));
        lessonList.add(new Lesson(205L, "French", "M. Curie", "10th grade"));
        return new TimeTable(timeslotList, roomList, lessonList);
    }

}</pre><p class="simpara">
								This test verifies that after solving, all lessons are assigned to a time slot and a room. It also verifies that it found a feasible solution (no hard constraints broken).
							</p></li><li class="listitem"><p class="simpara">
								Add test properties to the <code class="literal">src/main/resources/application.properties</code> file:
							</p><pre class="screen"># The solver runs only for 5 seconds to avoid a HTTP timeout in this simple implementation.
# It's recommended to run for at least 5 minutes ("5m") otherwise.
quarkus.optaplanner.solver.termination.spent-limit=5s

# Effectively disable this termination in favor of the best-score-limit
%test.quarkus.optaplanner.solver.termination.spent-limit=1h
%test.quarkus.optaplanner.solver.termination.best-score-limit=0hard/*soft</pre></li></ol></div><p>
						Normally, the solver finds a feasible solution in less than 200 milliseconds. Notice how the <code class="literal">application.properties</code> file overwrites the solver termination during tests to terminate as soon as a feasible solution <code class="literal">(0hard/*soft)</code> is found. This avoids hard coding a solver time, because the unit test might run on arbitrary hardware. This approach ensures that the test runs long enough to find a feasible solution, even on slow systems. But it does not run a millisecond longer than it strictly must, even on fast systems.
					</p></section></section><section class="section" id="business-optimizer-logging-quarkus-proc_optaplanner-java"><div class="titlepage"><div><div><h2 class="title">13.8. Logging</h2></div></div></div><p>
					After you complete the Red Hat build of OptaPlanner school timetable project, you can use logging information to help you fine-tune the constraints in the <code class="literal">ConstraintProvider</code>. Review the score calculation speed in the <code class="literal">info</code> log file to assess the impact of changes to your constraints. Run the application in debug mode to show every step that your application takes or use trace logging to log every step and every move.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Run the school timetable application for a fixed amount of time, for example, five minutes.
						</li><li class="listitem"><p class="simpara">
							Review the score calculation speed in the <code class="literal">log</code> file as shown in the following example:
						</p><pre class="screen">... Solving ended: ..., score calculation speed (29455/sec), ...</pre></li><li class="listitem">
							Change a constraint, run the planning application again for the same amount of time, and review the score calculation speed recorded in the <code class="literal">log</code> file.
						</li><li class="listitem"><p class="simpara">
							Run the application in debug mode to log every step that the application makes:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To run debug mode from the command line, use the <code class="literal">-D</code> system property.
								</li><li class="listitem"><p class="simpara">
									To permanently enable debug mode, add the following line to the <code class="literal">application.properties</code> file:
								</p><pre class="programlisting language-properties">quarkus.log.category."org.optaplanner".level=debug</pre><p class="simpara">
									The following example shows output in the <code class="literal">log</code> file in debug mode:
								</p><pre class="screen">... Solving started: time spent (67), best score (-20init/0hard/0soft), environment mode (REPRODUCIBLE), random (JDK with seed 0).
...     CH step (0), time spent (128), score (-18init/0hard/0soft), selected move count (15), picked move ([Math(101) {null -&gt; Room A}, Math(101) {null -&gt; MONDAY 08:30}]).
...     CH step (1), time spent (145), score (-16init/0hard/0soft), selected move count (15), picked move ([Physics(102) {null -&gt; Room A}, Physics(102) {null -&gt; MONDAY 09:30}]).
...</pre></li></ul></div></li><li class="listitem">
							Use <code class="literal">trace</code> logging to show every step and every move for each step.
						</li></ol></div></section><section class="section" id="using_micrometer_and_prometheus_to_monitor_your_school_timetable_optaplanner_java_application"><div class="titlepage"><div><div><h2 class="title">13.9. Using Micrometer and Prometheus to monitor your school timetable OptaPlanner Java application</h2></div></div></div><p>
					OptaPlanner exposes metrics through <a class="link" href="https://micrometer.io/">Micrometer</a>, a metrics instrumentation library for Java applications. You can use Micrometer with Prometheus to monitor the OptaPlanner solver in the school timetable application.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have created the OptaPlanner school timetable application with Java.
						</li><li class="listitem">
							Prometheus is installed. For information about installing Prometheus, see the <a class="link" href="https://prometheus.io/">Prometheus</a> website.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the Micrometer Prometheus dependencies to the school timetable <code class="literal">pom.xml</code> file where <code class="literal">&lt;MICROMETER_VERSION&gt;</code> is the version of Micrometer that you installed:
						</p><pre class="screen">&lt;dependency&gt;
 &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
 &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;
 &lt;version&gt;&lt;MICROMETER_VERSION&gt;&lt;/version&gt;
&lt;/dependency&gt;</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">micrometer-core</code> dependency is also required. However this dependency is contained in the <code class="literal">optaplanner-core</code> dependency so you do not need to add it to the <code class="literal">pom.xml</code> file.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Add the following import statements to the <code class="literal">TimeTableApp.java</code> class.
						</p><pre class="screen">import io.micrometer.core.instrument.Metrics;
import io.micrometer.prometheus.PrometheusConfig;
import io.micrometer.prometheus.PrometheusMeterRegistry;</pre></li><li class="listitem"><p class="simpara">
							Add the following lines to the top of the main method of the <code class="literal">TimeTableApp.java</code> class so Prometheus can scrap data from <code class="literal">com.sun.net.httpserver.HttpServer</code> before the solution starts:
						</p><pre class="programlisting language-java numbered">PrometheusMeterRegistry prometheusRegistry = new PrometheusMeterRegistry(PrometheusConfig.DEFAULT);

        try {
            HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);
            server.createContext("/prometheus", httpExchange -&gt; {
                String response = prometheusRegistry.scrape();
                httpExchange.sendResponseHeaders(200, response.getBytes().length);
                try (OutputStream os = httpExchange.getResponseBody()) {
                    os.write(response.getBytes());
                }
            });

            new Thread(server::start).start();
        } catch (IOException e) {
            throw new RuntimeException(e);
        }

        Metrics.addRegistry(prometheusRegistry);

        solve();
    }</pre></li><li class="listitem"><p class="simpara">
							Add the following line to control the solving time. By adjusting the solving time, you can see how the metrics change based on the time spent solving.
						</p><pre class="screen">withTerminationSpentLimit(Duration.ofMinutes(5)));</pre></li><li class="listitem">
							Start the school timetable application.
						</li><li class="listitem">
							Open <code class="literal"><a class="link" href="http://localhost:8080/prometheus">http://localhost:8080/prometheus</a></code> in a web browser to view the timetable application in Prometheus.
						</li><li class="listitem"><p class="simpara">
							Open your monitoring system to view the metrics for your OptaPlanner project.
						</p><p class="simpara">
							The following metrics are exposed:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">optaplanner_solver_errors_total</code>: the total number of errors that occurred while solving since the start of the measuring.
								</li><li class="listitem">
									<code class="literal">optaplanner_solver_solve_duration_seconds_active_count</code>: the number of solvers currently solving.
								</li><li class="listitem">
									<code class="literal">optaplanner_solver_solve_duration_seconds_max</code>: run time of the longest-running currently active solver.
								</li><li class="listitem">
									<code class="literal">optaplanner_solver_solve_duration_seconds_duration_sum</code>: the sum of each active solver’s solve duration. For example, if there are two active solvers, one running for three minutes and the other for one minute, the total solve time is four minutes.
								</li></ul></div></li></ol></div></section></section></div><div class="part" id="assembly-optaplanner-starter-applications_optaplanner-quickstarts"><div class="titlepage"><div><div><h1 class="title">Part V. Red Hat build of OptaPlanner starter applications</h1></div></div></div><div class="partintro" id="idm45892291317008"><div/><p>
				Red Hat build of OptaPlanner provides the following starter applications that you can deploy out-of-the-box on Red Hat OpenShift Container Platform:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Employee Rostering starter application
					</li><li class="listitem">
						Vechile Route Planning starter application
					</li></ul></div><p>
				OptaPlanner starter applications are more developed than examples and quick start guides. They focus on specific use cases and use the best technologies available to build a planning solution.
			</p><div class="toc"><p><strong>Table of Contents</strong></p><ul class="toc"><li><span class="chapter"><a href="#assembly-optimizer-modifying-ER-template-IDE">14. Using Red Hat build of OptaPlanner in an IDE: an employee rostering example</a></span><ul><li><span class="section"><a href="#optashift-ER-overview-con_employee-rostering-ide">14.1. Overview of the employee rostering starter application</a></span></li><li><span class="section"><a href="#optashift-ER-building-con">14.2. Building and running the employee rostering starter application</a></span><ul><li><span class="section"><a href="#er-deploy-prepare-proc">14.2.1. Preparing deployment files</a></span></li><li><span class="section"><a href="#optashift-ER-running-jar-proc">14.2.2. Running the Employee Rostering starter application JAR file</a></span></li><li><span class="section"><a href="#optashift-ER-building-commandline-proc">14.2.3. Building and running the Employee Rostering starter application using Maven</a></span></li><li><span class="section"><a href="#optashift-ER-building-commandline-db-proc">14.2.4. Building and running the employee rostering starter application with persistent data storage from the command line</a></span></li><li><span class="section"><a href="#optashift-ER-building-IntelliJ-IDEA-proc">14.2.5. Building and running the employee rostering starter application using IntelliJ IDEA</a></span></li></ul></li><li><span class="section"><a href="#er-overview-source-con">14.3. Overview of the source code of the employee rostering starter application</a></span></li><li><span class="section"><a href="#optashift-ER-modifying-proc">14.4. Modifying the employee rostering starter application</a></span></li></ul></li><li><span class="chapter"><a href="#assembly-optimizer-running-employee-rostering-openshift">15. Deploying and using Red Hat build of OptaPlanner in Red Hat OpenShift Container Platform: an employee rostering starter example</a></span><ul><li><span class="section"><a href="#optashift-ER-overview-con_employee-rostering-openshift">15.1. Overview of the employee rostering starter application</a></span></li><li><span class="section"><a href="#optashift-ER-openshift-deploy-con">15.2. Installing and starting the employee rostering starter application on OpenShift</a></span><ul><li><span class="section"><a href="#er-deploy-script-proc">15.2.1. Deploying the application using the provided script</a></span></li></ul></li><li><span class="section"><a href="#er-using-con">15.3. Using the employee rostering starter application</a></span><ul><li><span class="section"><a href="#er-periods-con">15.3.1. The draft and published periods</a></span></li><li><span class="section"><a href="#er-rotation-con">15.3.2. The rotation pattern</a></span></li><li><span class="section"><a href="#er-tenants-con">15.3.3. Employee Rostering tenants</a></span></li><li><span class="section"><a href="#er-skills-proc">15.3.4. Entering skills</a></span></li><li><span class="section"><a href="#er-spots-proc">15.3.5. Entering spots</a></span></li><li><span class="section"><a href="#er-contracts-proc">15.3.6. Entering the list of contracts</a></span></li><li><span class="section"><a href="#er-employees-proc">15.3.7. Entering the list of employees</a></span></li><li><span class="section"><a href="#er-availability-proc">15.3.8. Setting employee availability</a></span></li><li><span class="section"><a href="#er-shiftroster-proc">15.3.9. Viewing and editing shifts in the shift roster</a></span></li><li><span class="section"><a href="#er-solve-proc">15.3.10. Creating and viewing the employee shift roster</a></span></li><li><span class="section"><a href="#er-individualroster-proc">15.3.11. Viewing employee shifts</a></span></li><li><span class="section"><a href="#er-publish-proc">15.3.12. Publishing the shift roster</a></span></li><li><span class="section"><a href="#er-rotation-edit-proc">15.3.13. Viewing and editing the rotation pattern</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#assembly-business-optimizer-vrp">16. Deploying and using the Red Hat build of OptaPlanner vehicle route planning starter application</a></span><ul><li><span class="section"><a href="#vrp-con_business-optimizer-vrp">16.1. What is OptaWeb Vehicle Routing?</a></span></li><li><span class="section"><a href="#download-ref-imp-proc_business-optimizer-vrp">16.2. Download and build the OptaWeb Vehicle Routing deployment files</a></span></li><li><span class="section"><a href="#runlocally-con_business-optimizer-vrp">16.3. Run OptaWeb Vehicle Routing locally using the runLocally.sh script</a></span><ul><li><span class="section"><a href="#run-locally-qs-proc_business-optimizer-vrp">16.3.1. Run the OptaWeb Vehicle Routing runLocally.sh script in quick start mode</a></span></li><li><span class="section"><a href="#run-locally-interactive-proc_business-optimizer-vrp">16.3.2. Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode</a></span></li><li><span class="section"><a href="#run-locally-noninteractive-proc_business-optimizer-vrp">16.3.3. Run the OptaWeb Vehicle Routing runLocally.sh script in non-interactive mode</a></span></li><li><span class="section"><a href="#adjust-data-dir-proc_business-optimizer-vrp">16.3.4. Update the data directory</a></span></li></ul></li><li><span class="section"><a href="#run-vrp-manually-proc_business-optimizer-vrp">16.4. Configure and run OptaWeb Vehicle Routing manually</a></span></li><li><span class="section"><a href="#vrp-run-openshift-proc_business-optimizer-vrp">16.5. Run OptaWeb Vehicle Routing on Red Hat OpenShift Container Platform</a></span><ul><li><span class="section"><a href="#vrp-update-deployed-changes-proc_business-optimizer-vrp">16.5.1. Updating the deployed OptaWeb Vehicle Routing application with local changes</a></span></li></ul></li><li><span class="section"><a href="#use-vrp-con_business-optimizer-vrp">16.6. Using OptaWeb Vehicle Routing</a></span><ul><li><span class="section"><a href="#vrp-create-route-proc_business-optimizer-vrp">16.6.1. Creating a route</a></span></li><li><span class="section"><a href="#vrp-other-actions-proc_business-optimizer-vrp">16.6.2. Viewing and setting other details</a></span></li><li><span class="section"><a href="#vrp-custom-data-sets-proc_business-optimizer-vrp">16.6.3. Creating custom data sets with OptaWeb Vehicle Routing</a></span></li><li><span class="section"><a href="#vrp-troubleshooting-proc_business-optimizer-vrp">16.6.4. Troubleshooting OptaWeb Vehicle Routing</a></span></li></ul></li><li><span class="section"><a href="#optaweb_vehicle_routing_development_guide">16.7. OptaWeb Vehicle Routing development guide</a></span><ul><li><span class="section"><a href="#vrp-structure-con_business-optimizer-vrp">16.7.1. OptaWeb Vehicle Routing project structure</a></span></li><li><span class="section"><a href="#vrp-backend-con_business-optimizer-vrp">16.7.2. The OptaWeb Vehicle Routing back-end module</a></span></li><li><span class="section"><a href="#vrp-frontend-proc_business-optimizer-vrp">16.7.3. Working with the OptaWeb Vehicle Routing front-end module</a></span></li></ul></li><li><span class="section"><a href="#backend-architecture-con_business-optimizer-vrp">16.8. OptaWeb Vehicle Routing back-end architecture</a></span><ul><li><span class="section"><a href="#code_organization">16.8.1. Code organization</a></span></li><li><span class="section"><a href="#dependency_rules">16.8.2. Dependency rules</a></span></li><li><span class="section"><a href="#the_domain_package">16.8.3. The domain package</a></span></li><li><span class="section"><a href="#the_service_package">16.8.4. The service package</a></span></li><li><span class="section"><a href="#the_plugin_package">16.8.5. The plugin package</a></span></li></ul></li><li><span class="section"><a href="#backend-properties-ref_business-optimizer-vrp">16.9. OptaWeb Vehicle Routing back-end configuration properties</a></span></li></ul></li></ul></div></div><section class="chapter" id="assembly-optimizer-modifying-ER-template-IDE"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Using Red Hat build of OptaPlanner in an IDE: an employee rostering example</h2></div></div></div><p>
				As a business rules developer, you can use an IDE to build, run, and modify the <code class="literal">optaweb-employee-rostering</code> starter application that uses the Red Hat build of OptaPlanner functionality.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You use an integrated development environment, such as Red Hat CodeReady Studio or IntelliJ IDEA.
					</li><li class="listitem">
						You have an understanding of the Java language.
					</li><li class="listitem">
						You have an understanding of React and TypeScript. This requirement is necessary to develop the OptaWeb UI.
					</li></ul></div><section class="section" id="optashift-ER-overview-con_employee-rostering-ide"><div class="titlepage"><div><div><h2 class="title">14.1. Overview of the employee rostering starter application</h2></div></div></div><p>
					The employee rostering starter application assigns employees to shifts on various positions in an organization. For example, you can use the application to distribute shifts in a hospital between nurses, guard duty shifts across a number of locations, or shifts on an assembly line between workers.
				</p><p>
					Optimal employee rostering must take a number of variables into account. For example, different skills can be required for shifts in different positions. Also, some employees might be unavailable for some time slots or might prefer a particular time slot. Moreover, an employee can have a contract that limits the number of hours that the employee can work in a single time period.
				</p><p>
					The Red Hat build of OptaPlanner rules for this starter application use both hard and soft constraints. During an optimization, the planning engine may not violate hard constraints, for example, if an employee is unavailable (out sick), or that an employee cannot work two spots in a single shift. The planning engine tries to adhere to soft constraints, such as an employee’s preference to not work a specific shift, but can violate them if the optimal solution requires it.
				</p></section><section class="section" id="optashift-ER-building-con"><div class="titlepage"><div><div><h2 class="title">14.2. Building and running the employee rostering starter application</h2></div></div></div><p>
					You can build the employee rostering starter application from the source code and run it as a JAR file.
				</p><p>
					Alternatively, you can use your IDE, for example, Eclipse (including Red Hat CodeReady Studio), to build and run the application.
				</p><section class="section" id="er-deploy-prepare-proc"><div class="titlepage"><div><div><h3 class="title">14.2.1. Preparing deployment files</h3></div></div></div><p>
						You must download and prepare the deployment files before building and deploying the application.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Navigate to the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Product: Decision Manager
									</li><li class="listitem">
										Version: 7.13
									</li></ul></div></li><li class="listitem">
								Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Quickstarts</strong></span> (<code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code>).
							</li><li class="listitem">
								Extract the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code> file.
							</li><li class="listitem">
								Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13 Maven Repository Kogito and OptaPlanner 8 Maven Repository</strong></span> (<code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code>).
							</li><li class="listitem">
								Extract the <code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code> file.
							</li><li class="listitem">
								Copy the contents of the <code class="literal">rhdm-7.13.0-kogito-maven-repository/maven-repository</code> subdirectory into the <code class="literal">~/.m2/repository</code> directory.
							</li><li class="listitem"><p class="simpara">
								Navigate to the <code class="literal">optaweb-8.11.1.Final-redhat-00006/optaweb-employee-rostering</code> directory. This folder is the base folder in subsequent parts of this document.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									File and folder names might have higher version numbers than specifically noted in this document.
								</p></div></div></li></ol></div></section><section class="section" id="optashift-ER-running-jar-proc"><div class="titlepage"><div><div><h3 class="title">14.2.2. Running the Employee Rostering starter application JAR file</h3></div></div></div><p>
						You can run the Employee Rostering starter application from a JAR file included in the <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Quickstarts</strong></span> download.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have downloaded and extracted the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code> file as described in <a class="xref" href="#er-deploy-prepare-proc" title="14.2.1. Preparing deployment files">Section 14.2.1, “Preparing deployment files”</a>.
							</li><li class="listitem">
								A Java Development Kit is installed.
							</li><li class="listitem">
								Maven is installed.
							</li><li class="listitem">
								The host has access to the Internet. The build process uses the Internet for downloading Maven packages from external repositories.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In a command terminal, change to the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-employee-rostering</code> directory.
							</li><li class="listitem"><p class="simpara">
								Enter the following command:
							</p><pre class="programlisting language-bash">mvn clean install -DskipTests</pre></li><li class="listitem">
								Wait for the build process to complete.
							</li><li class="listitem">
								Navigate to the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-employee-rostering/optaweb-employee-rostering-standalone/target</code> directory.
							</li><li class="listitem"><p class="simpara">
								Enter the following command to run the Employee Rostering JAR file:
							</p><pre class="programlisting language-xml">java -jar quarkus-app/quarkus-run.jar</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The value of the <code class="literal">quarkus.datasource.db-kind</code> parameter is set to <code class="literal">H2</code> by default at build time. To use a different database, you must rebuild the standalone module and specify the database type on the command line. For example, to use a PostgreSQL database, enter the following command:
								</p><p>
									<code class="literal">mvn clean install -DskipTests -Dquarkus.profile=postgres</code>
								</p></div></div></li><li class="listitem">
								To access the application, enter <code class="literal">http://localhost:8080/</code> in a web browser.
							</li></ol></div></section><section class="section" id="optashift-ER-building-commandline-proc"><div class="titlepage"><div><div><h3 class="title">14.2.3. Building and running the Employee Rostering starter application using Maven</h3></div></div></div><p>
						You can use the command line to build and run the employee rostering starter application.
					</p><p>
						If you use this procedure, the data is stored in memory and is lost when the server is stopped. To build and run the application with a database server for persistent storage, see <a class="xref" href="#optashift-ER-building-commandline-db-proc" title="14.2.4. Building and running the employee rostering starter application with persistent data storage from the command line">Section 14.2.4, “Building and running the employee rostering starter application with persistent data storage from the command line”</a>.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have prepared the deployment files as described in <a class="xref" href="#er-deploy-prepare-proc" title="14.2.1. Preparing deployment files">Section 14.2.1, “Preparing deployment files”</a>.
							</li><li class="listitem">
								A Java Development Kit is installed.
							</li><li class="listitem">
								Maven is installed.
							</li><li class="listitem">
								The host has access to the Internet. The build process uses the Internet for downloading Maven packages from external repositories.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to the <code class="literal">optaweb-employee-rostering-backend</code> directory.
							</li><li class="listitem"><p class="simpara">
								Enter the following command:
							</p><pre class="programlisting language-bash">mvn quarkus:dev</pre></li><li class="listitem">
								Navigate to the <code class="literal">optaweb-employee-rostering-frontend</code> directory.
							</li><li class="listitem"><p class="simpara">
								Enter the following command:
							</p><pre class="programlisting language-bash">npm start</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If you use <code class="literal">npm</code> to start the server, <code class="literal">npm</code> monitors code changes.
								</p></div></div></li><li class="listitem">
								To access the application, enter <code class="literal">http://localhost:3000/</code> in a web browser.
							</li></ol></div></section><section class="section" id="optashift-ER-building-commandline-db-proc"><div class="titlepage"><div><div><h3 class="title">14.2.4. Building and running the employee rostering starter application with persistent data storage from the command line</h3></div></div></div><p>
						If you use the command line to build the employee rostering starter application and run it, you can provide a database server for persistent data storage.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have prepared the deployment files as described in <a class="xref" href="#er-deploy-prepare-proc" title="14.2.1. Preparing deployment files">Section 14.2.1, “Preparing deployment files”</a>.
							</li><li class="listitem">
								A Java Development Kit is installed.
							</li><li class="listitem">
								Maven is installed.
							</li><li class="listitem">
								The host has access to the Internet. The build process uses the Internet for downloading Maven packages from external repositories.
							</li><li class="listitem">
								You have a deployed MySQL or PostrgeSQL database server.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In a command terminal, navigate to the <code class="literal">optaweb-employee-rostering-standalone/target</code> directory.
							</li><li class="listitem"><p class="simpara">
								Enter the following command to run the Employee Rostering JAR file:
							</p><pre class="programlisting language-bash">java \
-Dquarkus.datasource.username=&lt;DATABASE_USER&gt; \
-Dquarkus.datasource.password=&lt;DATABASE_PASSWORD&gt; \
-Dquarkus.datasource.jdbc.url=&lt;DATABASE_URL&gt; \
-jar quarkus-app/quarkus-run.jar</pre><p class="simpara">
								In this example, replace the following placeholders:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">&lt;DATABASE_URL&gt;</code>: URL to connect to the database
									</li><li class="listitem">
										<code class="literal">&lt;DATABASE_USER&gt;</code>: The user to connect to the database
									</li><li class="listitem">
										<code class="literal">&lt;DATABASE_PASSWORD&gt;</code>: The password for <code class="literal">&lt;DATABASE_USER&gt;</code>
									</li></ul></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The value of the <code class="literal">quarkus.datasource.db-kind</code> parameter is set to <code class="literal">H2</code> by default at build time. To use a different database, you must rebuild the standalone module and specify the database type on the command line. For example, to use a PostgreSQL database, enter the following command:
						</p><p>
							<code class="literal">mvn clean install -DskipTests -Dquarkus.profile=postgres</code>
						</p></div></div></section><section class="section" id="optashift-ER-building-IntelliJ-IDEA-proc"><div class="titlepage"><div><div><h3 class="title">14.2.5. Building and running the employee rostering starter application using IntelliJ IDEA</h3></div></div></div><p>
						You can use IntelliJ IDEA to build and run the employee rostering starter application.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You have downloaded the Employee Rostering source code, available from the <a class="link" href="https://github.com/kiegroup/optaweb-employee-rostering">Employee Rostering</a> GitHub page.
							</li><li class="listitem">
								IntelliJ IDEA, Maven, and Node.js are installed.
							</li><li class="listitem">
								The host has access to the Internet. The build process uses the Internet for downloading Maven packages from external repositories.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Start IntelliJ IDEA.
							</li><li class="listitem">
								From the IntelliJ IDEA main menu, select <span class="strong strong"><strong>File</strong></span> → <span class="strong strong"><strong>Open</strong></span>.
							</li><li class="listitem">
								Select the root directory of the application source and click <span class="strong strong"><strong>OK</strong></span>.
							</li><li class="listitem">
								From the main menu, select <span class="strong strong"><strong>Run</strong></span> → <span class="strong strong"><strong>Edit Configurations</strong></span>.
							</li><li class="listitem">
								In the window that appears, expand <span class="strong strong"><strong>Templates</strong></span> and select <span class="strong strong"><strong>Maven</strong></span>. The Maven sidebar appears.
							</li><li class="listitem">
								In the Maven sidebar, select <code class="literal">optaweb-employee-rostering-backend</code> from the <span class="strong strong"><strong>Working Directory</strong></span> menu.
							</li><li class="listitem">
								In <span class="strong strong"><strong>Command Line</strong></span>, enter <code class="literal">mvn quarkus:dev</code>.
							</li><li class="listitem">
								To start the back end, click <span class="strong strong"><strong>OK</strong></span> .
							</li><li class="listitem">
								In a command terminal, navigate to the <code class="literal">optaweb-employee-rostering-frontend</code> directory.
							</li><li class="listitem"><p class="simpara">
								Enter the following command to start the front end:
							</p><pre class="screen">npm start</pre></li><li class="listitem">
								To access the application, enter <code class="literal">http://localhost:3000/</code> in a web browser.
							</li></ol></div></section></section><section class="section" id="er-overview-source-con"><div class="titlepage"><div><div><h2 class="title">14.3. Overview of the source code of the employee rostering starter application</h2></div></div></div><p>
					The employee rostering starter application consists of the following principal components:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							A <code class="literal">backend</code> that implements the rostering logic using Red Hat build of OptaPlanner and provides a REST API
						</li><li class="listitem">
							A <code class="literal">frontend</code> module that implements a user interface using React and interacts with the <code class="literal">backend</code> module through the REST API
						</li></ul></div><p>
					You can build and use these components independently. In particular, you can implement a different user interface and use the REST API to call the server.
				</p><p>
					In addition to the two main components, the employee rostering template contains a generator of random source data (useful for demonstration and testing purposes) and a benchmarking application.
				</p><div class="formalpara"><p class="title"><strong>Modules and key classes</strong></p><p>
						The Java source code of the employee rostering template contains several Maven modules. Each of these modules includes a separate Maven project file (<code class="literal">pom.xml</code>), but they are intended for building in a common project.
					</p></div><p>
					The modules contain a number of files, including Java classes. This document lists all the modules, as well as the classes and other files that contain the key information for the employee rostering calculations.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">optaweb-employee-rostering-benchmark</code> module: Contains an additional application that generates random data and benchmarks the solution.
						</li><li class="listitem">
							<code class="literal">optaweb-employee-rostering-distribution</code> module: Contains README files.
						</li><li class="listitem">
							<code class="literal">optaweb-employee-rostering-docs</code> module: Contains documentation files.
						</li><li class="listitem">
							<code class="literal">optaweb-employee-rostering-frontend</code> module: Contains the client application with the user interface, developed in React.
						</li><li class="listitem"><p class="simpara">
							<code class="literal">optaweb-employee-rostering-backend</code> module: Contains the server application that uses OptaPlanner to perform the rostering calculation.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.service.roster/rosterGenerator.java</code>: Generates random input data for demonstration and testing purposes. If you change the required input data, change the generator accordingly.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.employee/EmployeeAvailability.java</code>: Defines availability information for an employee. For every time slot, an employee can be unavailable, available, or the time slot can be designated a preferred time slot for the employee.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.employee/Employee.java</code>: Defines an employee. An employee has a name, a list of skills, and works under a contract. Skills are represented by skill objects.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.roster/Roster.java</code>: Defines the calculated rostering information.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.shift/Shift.java</code>: Defines a shift to which an employee can be assigned. A shift is defined by a time slot and a spot. For example, in a diner there could be a shift in the <span class="strong strong"><strong>Kitchen</strong></span> spot for the February 20 8AM-4PM time slot. Multiple shifts can be defined for a specific spot and time slot. In this case, multiple employees are required for this spot and time slot.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.skill/Skill.java</code>: Defines a skill that an employee can have.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.spot/Spot.java</code>: Defines a spot where employees can be placed. For example, a <code class="literal">Kitchen</code> can be a spot.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.contract/Contract.java</code>: Defines a contract that sets limits on work time for an employee in various time periods.
								</li><li class="listitem">
									<code class="literal">src/main/java/org.optaweb.employeerostering.domain.tenant/Tenant.java</code>: Defines a tenant. Each tenant represents an independent set of data. Changes in the data for one tenant do not affect any other tenants.
								</li><li class="listitem">
									<code class="literal">*View.java</code>: Classes related to domain objects that define value sets that are calculated from other information; the client application can read these values through the REST API, but not write them.
								</li><li class="listitem">
									<code class="literal">*Service.java</code>: Interfaces located in the service package that define the REST API. Both the server and the client application separately define implementations of these interfaces.
								</li></ul></div></li><li class="listitem">
							<code class="literal">optaweb-employee-rostering-standalone</code> module: Contains the assembly configurations for the standalone application.
						</li></ul></div></section><section class="section" id="optashift-ER-modifying-proc"><div class="titlepage"><div><div><h2 class="title">14.4. Modifying the employee rostering starter application</h2></div></div></div><p>
					To modify the employee rostering starter application to suit your needs, you must change the rules that govern the optimization process. You must also ensure that the data structures include the required data and provide the required calculations for the rules. If the required data is not present in the user interface, you must also modify the user interface.
				</p><p>
					The following procedure outlines the general approach to modifying the employee rostering starter application.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have a build environment that successfully builds the application.
						</li><li class="listitem">
							You can read and modify Java code.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Plan the required changes. Answer the following questions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									What are the additional scenarios that <span class="emphasis"><em>must</em></span> be avoided? These scenarios are <span class="emphasis"><em>hard constraints</em></span>.
								</li><li class="listitem">
									What are the additional scenarios that the optimizer must <span class="emphasis"><em>try to avoid</em></span> when possible? These scenarios are <span class="emphasis"><em>soft constraints</em></span>.
								</li><li class="listitem">
									What data is required to calculate if each scenario is happening in a potential solution?
								</li><li class="listitem">
									Which of the data can be derived from the information that the user enters in the existing version?
								</li><li class="listitem">
									Which of the data can be hardcoded?
								</li><li class="listitem">
									Which of the data must be entered by the user and is not entered in the current version?
								</li></ul></div></li><li class="listitem">
							If any required data can be calculated from the current data or can be hardcoded, add the calculations or hardcoding to existing view or utility classes. If the data must be calculated on the server side, add REST API endpoints to read it.
						</li><li class="listitem">
							If any required data must be entered by the user, add the data to the classes representing the data entities (for example, the <code class="literal">Employee</code> class), add REST API endpoints to read and write the data, and modify the user interface to enter the data.
						</li><li class="listitem">
							When all of the data is available, modify the rules. For most modifications, you must add a new rule. The rules are located in the <code class="literal">src/main/java/org/optaweb/employeerostering/service/solver/EmployeeRosteringConstraintProvider.java</code> file of the <code class="literal">optaweb-employee-rostering-backend</code> module.
						</li><li class="listitem">
							After modifying the application, build and run it.
						</li></ol></div></section></section><section class="chapter" id="assembly-optimizer-running-employee-rostering-openshift"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Deploying and using Red Hat build of OptaPlanner in Red Hat OpenShift Container Platform: an employee rostering starter example</h2></div></div></div><p>
				As a business rules developer, you can test and interact with the Red Hat build of OptaPlanner functionality by quickly deploying the <code class="literal">optaweb-employee-rostering</code> starter project included in the Red Hat Decision Manager distribution to OpenShift.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have access to a deployed OpenShift environment. For details, see the documentation for the OpenShift product that you use.
					</li></ul></div><section class="section" id="optashift-ER-overview-con_employee-rostering-openshift"><div class="titlepage"><div><div><h2 class="title">15.1. Overview of the employee rostering starter application</h2></div></div></div><p>
					The employee rostering starter application assigns employees to shifts on various positions in an organization. For example, you can use the application to distribute shifts in a hospital between nurses, guard duty shifts across a number of locations, or shifts on an assembly line between workers.
				</p><p>
					Optimal employee rostering must take a number of variables into account. For example, different skills can be required for shifts in different positions. Also, some employees might be unavailable for some time slots or might prefer a particular time slot. Moreover, an employee can have a contract that limits the number of hours that the employee can work in a single time period.
				</p><p>
					The Red Hat build of OptaPlanner rules for this starter application use both hard and soft constraints. During an optimization, the planning engine may not violate hard constraints, for example, if an employee is unavailable (out sick), or that an employee cannot work two spots in a single shift. The planning engine tries to adhere to soft constraints, such as an employee’s preference to not work a specific shift, but can violate them if the optimal solution requires it.
				</p></section><section class="section" id="optashift-ER-openshift-deploy-con"><div class="titlepage"><div><div><h2 class="title">15.2. Installing and starting the employee rostering starter application on OpenShift</h2></div></div></div><p>
					Use the <code class="literal">runOnOpenShift.sh</code> script to deploy the Employee Rostering starter application to Red Hat OpenShift Container Platform. The <code class="literal">runOnOpenShift.sh</code> shell script is available in the <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Quickstarts</strong></span> distribution.
				</p><p>
					The <code class="literal">runOnOpenShift.sh</code> script builds and packages the application source code locally and uploads it to the OpenShift environment for deployment. This method requires Java Development Kit, Apache Maven, and a bash shell command line.
				</p><section class="section" id="er-deploy-script-proc"><div class="titlepage"><div><div><h3 class="title">15.2.1. Deploying the application using the provided script</h3></div></div></div><p>
						You can deploy the Employee Rostering starter application to Red Hat OpenShift Container Platform using the provided script. The script builds and packages the application source code locally and uploads it to the OpenShift environment for deployment.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								You are logged in to the target OpenShift environment using the <code class="literal">oc</code> command line tool. For more information about this tool, see the <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html-single/cli_reference/"><span class="emphasis"><em>OpenShift Container Platform CLI Reference</em></span></a>.
							</li><li class="listitem">
								OpenJDK 11 or later is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
							</li><li class="listitem">
								Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
							</li><li class="listitem">
								A <code class="literal">bash</code> shell environment is available on your local system.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Navigate to the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Product: Decision Manager
									</li><li class="listitem">
										Version: 7.13.0
									</li></ul></div></li><li class="listitem">
								Download the <span class="strong strong"><strong>Red Hat Decision Manager 7.13 Maven Repository Kogito and OptaPlanner 8 Maven Repository</strong></span> (<code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code>) file.
							</li><li class="listitem">
								Extract the <code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code> file.
							</li><li class="listitem">
								Copy the contents of the <code class="literal">rhdm-7.13.0-kogito-maven-repository/maven-repository</code> subdirectory into the <code class="literal">~/.m2/repository</code> directory.
							</li><li class="listitem">
								Download the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code> file from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?downloadType=distributions&amp;product=rhdm&amp;productChanged=yes">Software Downloads</a> page of the Red Hat Customer Portal.
							</li><li class="listitem">
								Extract the downloaded archive.
							</li><li class="listitem">
								Navigate to the <code class="literal">optaweb-employee-rostering</code> folder.
							</li><li class="listitem"><p class="simpara">
								To build the Employee Rostering application, run the following command:
							</p><pre class="screen">mvn clean install -DskipTests -DskipITs</pre></li><li class="listitem"><p class="simpara">
								Log in to an OpenShift account or a Red Hat Code Ready Container instance. In the following example, <code class="literal">&lt;account-url&gt;</code> is the URL for an OpenShift account or Red Hat Code Ready Container instance and <code class="literal">&lt;login-token&gt;</code> is the login token for that account:
							</p><pre class="screen">oc login &lt;account-url&gt; --token &lt;login-token&gt;</pre></li><li class="listitem"><p class="simpara">
								Create a new project to host Employee Rostering:
							</p><pre class="screen">oc new-project optaweb-employee-rostering</pre></li><li class="listitem"><p class="simpara">
								Run the provision script to build and deploy the application:
							</p><pre class="screen">./runOnOpenShift.sh</pre><p class="simpara">
								Compilation and packaging might take up to 10 minutes to complete. These processes continually show progress on the command line output.
							</p><p class="simpara">
								When the operation completes, the following message is displayed, where <code class="literal">&lt;URL&gt;</code> is the URL for the deployment:
							</p><pre class="screen">You can access the application at &lt;URL&gt; once the deployment is done.</pre></li><li class="listitem"><p class="simpara">
								Enter the URL that you used earlier in the procedure, for either an OpenShift account or Red Hat Code Ready Container instance, to access the deployed application. The first startup can take up to a minute because additional building is completed on the OpenShift platform.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If the application does not open a minute after clicking the link, perform a hard refresh of your browser page.
								</p></div></div></li></ol></div></section></section><section class="section" id="er-using-con"><div class="titlepage"><div><div><h2 class="title">15.3. Using the employee rostering starter application</h2></div></div></div><p>
					You can use the web interface to use the Employee Rostering starter application. The interface is developed in ReactJS. You can also access the REST API to create a custom user interface as necessary.
				</p><section class="section" id="er-periods-con"><div class="titlepage"><div><div><h3 class="title">15.3.1. The draft and published periods</h3></div></div></div><p>
						At any particular moment, you can use the application to create the roster for a time period, called a <span class="emphasis"><em>draft</em></span> period. By default, the length of a draft period is three weeks.
					</p><p>
						When the roster is final for the first week of the draft period, you can <span class="emphasis"><em>publish</em></span> the roster. At this time, the roster for the first week of the current draft period becomes a <span class="emphasis"><em>published</em></span> period. In a published period, the roster is fixed and you can no longer change it automatically (however, emergency manual changes are still possible). This roster can then be distributed to employees so they can plan their time around it. The draft period is shifted a week later.
					</p><p>
						For example, assume that a draft period of September 1 to September 21 is set. You can automatically create the employee roster for this period. Then, when you publish the roster, the period up to September 7 becomes published. The new draft period is September 8 to September 28.
					</p><p>
						For instructions about publishing the roster, see <a class="xref" href="#er-publish-proc" title="15.3.12. Publishing the shift roster">Section 15.3.12, “Publishing the shift roster”</a>.
					</p></section><section class="section" id="er-rotation-con"><div class="titlepage"><div><div><h3 class="title">15.3.2. The rotation pattern</h3></div></div></div><p>
						The employee rostering application supports a <span class="emphasis"><em>rotation pattern</em></span> for shifts and employees.
					</p><p>
						The rotation pattern is a "model" period of any time starting from two days. The pattern is not tied to a particular date.
					</p><p>
						You can create time buckets for every day of the rotation. Every time bucket sets the time of a shift. Optionally, the template can include the name of the default employee for the shift.
					</p><p>
						When you publish the roster, the application adds a new week to the draft period. At this time, the shifts and, if applicable, default employee names are copied from the rotation pattern to the new part of the draft period.
					</p><p>
						When the end of the rotation pattern is reached, it is automatically restarted from the beginning.
					</p><p>
						If weekend shift patterns in your organization are different from weekday shift patterns, use a rotation pattern of one week or a whole number of weeks, for example, 14, 21, or 28 days. The default length is 28 days. Then the pattern is always repeated on the same weekdays and you can set the shifts for different weekdays.
					</p><p>
						For instructions about editing the rotation pattern, see <a class="xref" href="#er-rotation-edit-proc" title="15.3.13. Viewing and editing the rotation pattern">Section 15.3.13, “Viewing and editing the rotation pattern”</a>.
					</p></section><section class="section" id="er-tenants-con"><div class="titlepage"><div><div><h3 class="title">15.3.3. Employee Rostering tenants</h3></div></div></div><p>
						The Employee Rostering application supports multiple <span class="emphasis"><em>tenants</em></span>. Each tenant is an independent set of data, including inputs and roster outputs. Changing data for one tenant does not affect other tenants. You can switch between tenants to use several independent data sets, for example, to prepare employee rosters for different locations.
					</p><p>
						Several sample tenants are present after installation, representing several typical enterprise types such as a factory or hospital. You can select any of these tenants and modify them to suit your needs. You can also create a new tenant to enter data from a blank slate.
					</p><section class="section" id="er-tenant-select-proc"><div class="titlepage"><div><div><h4 class="title">15.3.3.1. Changing an Employee Rostering tenant</h4></div></div></div><p>
							You can change the current tenant. After you select a different tenant, all of the displayed information refers to this tenant and any changes you make affect only this tenant.
						</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									In the Employee Rostering application web interface, in the top right part of the browser window, click the <span class="strong strong"><strong>Tenant</strong></span> list.
								</li><li class="listitem">
									Select a tenant from the list.
								</li></ol></div></section><section class="section" id="er-tenant-create-proc"><div class="titlepage"><div><div><h4 class="title">15.3.3.2. Creating a tenant</h4></div></div></div><p>
							You can create a new tenant to enter data from a blank slate. When creating a tenant, you can set several parameters that determine how the application prepares the output for this tenant.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								You cannot change tenant parameters after you create the tenant.
							</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									To create a new tenant in the Employee Rostering application web interface, in the top right corner of the browser window click the settings (gear) icon then click <span class="strong strong"><strong>Add</strong></span>.
								</li><li class="listitem"><p class="simpara">
									Set the following values:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<span class="strong strong"><strong>Name</strong></span>: The name of the new tenant. This name is displayed in the list of tenants.
										</li><li class="listitem">
											<span class="strong strong"><strong>Schedule Start Date</strong></span>: The start date of the initial draft period. After you publish the roster, this date becomes the start date of the published period. The weekday of this date always remains the weekday that starts the draft period, any particular published period, and the first use of the rotation pattern. So it is usually most convenient to set the start date to the start of a week (Sunday or Monday).
										</li><li class="listitem">
											<span class="strong strong"><strong>Draft Length (days)</strong></span>: The length of the draft period. The draft period stays the same length for the lifetime of the tenant.
										</li><li class="listitem">
											<span class="strong strong"><strong>Publish Notice (days)</strong></span>: The length of the publish notice period. Aspire to publish the final roster for any day at least this time in advance, so employees have enough notice to plan their personal life around their shift times. In the current version, this setting is not enforced in any way.
										</li><li class="listitem">
											<span class="strong strong"><strong>Publish Length (days)</strong></span>: The length of the period that becomes published (fixed) every time you publish the roster. In the current version, this setting is fixed at 7 days.
										</li><li class="listitem">
											<span class="strong strong"><strong>Rotation Length (days)</strong></span>: The length of the rotation pattern.
										</li><li class="listitem">
											<span class="strong strong"><strong>Timezone</strong></span>: The timezone of the environment to which the roster applies. This timezone is used to determine the "current" date for user interface display.
										</li></ul></div></li><li class="listitem">
									Click <span class="strong strong"><strong>Save</strong></span>.
								</li></ol></div><p>
							The tenant is created with blank data.
						</p></section></section><section class="section" id="er-skills-proc"><div class="titlepage"><div><div><h3 class="title">15.3.4. Entering skills</h3></div></div></div><p>
						You can set all <span class="emphasis"><em>skills</em></span> that are required in any position within the roster. For example, a 24-hour diner can require cooking, serving, bussing, and hosting skills, in addition to skills such as general human resources and restaurant operations.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								In the Employee Rostering application web interface, click the <span class="strong strong"><strong>Skills</strong></span> tab.
							</p><p class="simpara">
								You can see the numbers of currently visible skills in the top right part of the browser window, for example, <code class="literal">1-15 of 34</code>. You can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons to display other skills in the list.
							</p><p class="simpara">
								You can enter any part of a skill name in the <span class="strong strong"><strong>Search</strong></span> box to search for skills.
							</p></li><li class="listitem"><p class="simpara">
								Complete the following steps to add a new skill:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li><li class="listitem">
										Enter the name of the new skill in the text field under <span class="strong strong"><strong>Name</strong></span>.
									</li><li class="listitem">
										Click the Save icon.
									</li></ol></div></li><li class="listitem">
								To edit the name of a skill, click the <span class="strong strong"><strong>Edit Skill</strong></span> icon (pencil shape) next to the skill.
							</li><li class="listitem">
								To delete a skill, click the <span class="strong strong"><strong>Delete Skill</strong></span> icon (trashcan shape) next to the skill.
							</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Within each tenant, skill names must be unique. You cannot delete a skill if the skill is associated with an employee or spot.
						</p></div></div></section><section class="section" id="er-spots-proc"><div class="titlepage"><div><div><h3 class="title">15.3.5. Entering spots</h3></div></div></div><p>
						You must enter the list of <span class="emphasis"><em>spots</em></span>, which represent various positions at the business. For a diner, spots include the bar, the bussing stations, the front counter, the various kitchen stations, the serving areas, and the office.
					</p><p>
						For each spot, you can select one or more required skills from the list that you entered in the <span class="strong strong"><strong>Skills</strong></span> tab. The application rosters only employees that have all of the required skills for a spot into that spot. If the spot has no required skill, the application can roster any employee into the spot.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								To enter or change spots in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Spots</strong></span> tab. You can enter any part of a spot name in the <span class="strong strong"><strong>Search</strong></span> box to search for spots.
							</li><li class="listitem"><p class="simpara">
								Complete the following steps to add a new spot:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>Add Spot</strong></span>.
									</li><li class="listitem">
										Enter the name of the new spot in the text field under <span class="strong strong"><strong>Name</strong></span>.
									</li><li class="listitem">
										Optional: Select one or more skills from the drop-down list under <span class="strong strong"><strong>Required skill set</strong></span>.
									</li><li class="listitem">
										Click the Save icon.
									</li></ol></div></li><li class="listitem">
								To edit the name and required skills for a spot, click the <span class="strong strong"><strong>Edit Spot</strong></span> icon (pencil shape) next to the spot.
							</li><li class="listitem">
								To delete a spot, click the <span class="strong strong"><strong>Delete Spot</strong></span> icon (trashcan shape) next to the spot.
							</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Within each tenant, spot names must be unique. You cannot delete a spot when any shifts are created for it.
						</p></div></div></section><section class="section" id="er-contracts-proc"><div class="titlepage"><div><div><h3 class="title">15.3.6. Entering the list of contracts</h3></div></div></div><p>
						You must enter the list of all of the types of contracts that the business uses for employees.
					</p><p>
						A contract determines the maximum time that the employee can work in a day, calendar week, calendar month, or calendar year.
					</p><p>
						When creating a contract, you can set any of the limitations or none at all. For example, a part-time employee might not be allowed to work more than 20 hours in a week, while a full-time employee might be limited to 10 hours in a day and 1800 hours in a year. Another contract might include no limitations on worked hours.
					</p><p>
						You must enter all work time limits for contracts in minutes.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To enter or change the list of contracts in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Contracts</strong></span> tab.
							</p><p class="simpara">
								You can see the numbers of currently visible contracts in the top right part of the browser window, for example, <code class="literal">1-15 of 34</code>. You can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons to display other contracts in the list.
							</p><p class="simpara">
								You can enter any part of a contract name in the <span class="strong strong"><strong>Search</strong></span> box to search for contracts.
							</p></li><li class="listitem"><p class="simpara">
								Complete the following steps to add a new contract:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li><li class="listitem">
										Enter the name of the contract in the text field under <span class="strong strong"><strong>Name</strong></span>.
									</li><li class="listitem"><p class="simpara">
										Enter the required time limits under <span class="strong strong"><strong>Maximum minutes</strong></span>:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												If the employee must not work more than a set time per day, enable the check box at <span class="strong strong"><strong>Per Day</strong></span> and enter the amount of minutes in the field next to this check box.
											</li><li class="listitem">
												If the employee must not work more than a set time per calendar week, enable the check box at <span class="strong strong"><strong>Per Week</strong></span> and enter the amount of minutes in the field next to this check box.
											</li><li class="listitem">
												If the employee must not work more than a set time per calendar month, enable the check box at <span class="strong strong"><strong>Per Month</strong></span> and enter the amount of minutes in the field next to this check box.
											</li><li class="listitem">
												If the employee must not work more than a set time per calendar year, enable the check box at <span class="strong strong"><strong>Per Year</strong></span> and enter the amount of minutes in the field next to this check box.
											</li></ul></div></li><li class="listitem">
										Click the Save icon.
									</li></ol></div></li><li class="listitem">
								To edit the name and time limits for a contract, click the <span class="strong strong"><strong>Edit Contract</strong></span> icon (pencil shape) next to the name of the contract.
							</li><li class="listitem">
								To delete a contract, click the <span class="strong strong"><strong>Delete Contract</strong></span> icon (trashcan shape) next to the name of the contract.
							</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Within each tenant, contract names must be unique. You cannot delete a contract if it is assigned to any employee.
						</p></div></div></section><section class="section" id="er-employees-proc"><div class="titlepage"><div><div><h3 class="title">15.3.7. Entering the list of employees</h3></div></div></div><p>
						You must enter the list of all employees of the business, the skills they possess, and the contracts that apply to them. The application rosters these employees to spots according to their skills and according to the work time limits in the contracts.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To enter or change the list of employees in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Employees</strong></span> tab.
							</p><p class="simpara">
								You can see the numbers of currently visible employees in the top right part of the browser window, for example, <code class="literal">1-15 of 34</code>. You can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons to display other employees in the list.
							</p><p class="simpara">
								You can enter any part of an employee name in the <span class="strong strong"><strong>Search</strong></span> box to search for employees.
							</p></li><li class="listitem"><p class="simpara">
								Complete the following steps to add a new employee:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li><li class="listitem">
										Enter the name of the employee in the text field under <span class="strong strong"><strong>Name</strong></span>.
									</li><li class="listitem">
										Optional: Select one or more skills from the drop-down list under <span class="strong strong"><strong>Skill set</strong></span>.
									</li><li class="listitem">
										Select a contract from the drop-down list under <span class="strong strong"><strong>Contract</strong></span>.
									</li><li class="listitem">
										Click the Save icon.
									</li></ol></div></li><li class="listitem">
								To edit the name and skills for an employee, click the <span class="strong strong"><strong>Edit Employee</strong></span> icon (pencil shape) next to the name of the employee.
							</li><li class="listitem">
								To delete an employee, click the <span class="strong strong"><strong>Delete Employee</strong></span> icon (trashcan shape) next to the name of the employee.
							</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Within each tenant, employee names must be unique. You cannot delete employees if they are rostered to any shifts.
						</p></div></div></section><section class="section" id="er-availability-proc"><div class="titlepage"><div><div><h3 class="title">15.3.8. Setting employee availability</h3></div></div></div><p>
						You can set the availability of employees for particular time spans.
					</p><p>
						If an employee is <span class="emphasis"><em>unavailable</em></span> for a particular time span, the employee can never be assigned to any shift during this time span (for example, if the employee has called in sick or is on vacation). <span class="emphasis"><em>Undesired</em></span> and <span class="emphasis"><em>desired</em></span> are employee preferences for particular time spans; the application accommodates them when possible.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To view and edit employee availability in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Availability Roster</strong></span> tab.
							</p><p class="simpara">
								In the top left part of the window, you can see the dates for which the roster is displayed. To view other weeks, you can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons next to the <span class="strong strong"><strong>Week of</strong></span> field. Alternatively, you can click the date field and change the date to view the week that includes this date.
							</p></li><li class="listitem">
								To create an availability entry for an employee, click empty space on the schedule and then select an employee. Initially, an <code class="literal">Unavailable</code> entry for the entire day is created.
							</li><li class="listitem"><p class="simpara">
								To change an availability entry, click the entry. You can change the following settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>From</strong></span> and <span class="strong strong"><strong>To</strong></span> date and time: The time span to which the availability entry applies.
									</li><li class="listitem"><p class="simpara">
										Status: you can select <span class="strong strong"><strong>Unavailable</strong></span>, <span class="strong strong"><strong>Desired</strong></span>, or <span class="strong strong"><strong>Undesired</strong></span> status from a drop-down list.
									</p><p class="simpara">
										To save the entry, click <span class="strong strong"><strong>Apply</strong></span>.
									</p></li></ul></div></li><li class="listitem"><p class="simpara">
								To delete an availability entry, click the entry, then click <span class="strong strong"><strong>Delete availability</strong></span>.
							</p><p class="simpara">
								You can also change or delete an availability entry by moving the mouse pointer over the entry and then clicking one of the icons displayed over the entry:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Click the 
										<span class="inlinemediaobject"><img src="images/_images/employee-rostering/unavailable-icon.png" alt="Unavailable"/></span>
										 icon to set the status of the entry to <span class="strong strong"><strong>Unavailable</strong></span>.
									</li><li class="listitem">
										Click the 
										<span class="inlinemediaobject"><img src="images/_images/employee-rostering/undesired-icon.png" alt="Undesired"/></span>
										 icon to set the status of the entry to <span class="strong strong"><strong>Undesired</strong></span>.
									</li><li class="listitem">
										Click the 
										<span class="inlinemediaobject"><img src="images/_images/employee-rostering/desired-icon.png" alt="Desired"/></span>
										 icon to set the status of the entry to <span class="strong strong"><strong>Desired</strong></span>.
									</li><li class="listitem">
										Click the 
										<span class="inlinemediaobject"><img src="images/_images/employee-rostering/delete-icon.png" alt="Delete"/></span>
										 icon to delete the entry.
									</li></ul></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If an employee is already assigned to a shift and then you create or change an availability entry during this shift, the assignment is not changed automatically. You must create the employee shift roster again to apply new or changed availability entries.
						</p></div></div></section><section class="section" id="er-shiftroster-proc"><div class="titlepage"><div><div><h3 class="title">15.3.9. Viewing and editing shifts in the shift roster</h3></div></div></div><p>
						The Shift Roster is a table of all spots and all possible time spans.
					</p><p>
						If an employee must be present in a spot during a time span, a <span class="emphasis"><em>shift</em></span> must exist for this spot and this time span. If a spot requires several employees at the same time, you can create several shifts for the same spot and time span.
					</p><p>
						Each shift is represented by a rectangle at the intersection of a spot (row) and time span (column).
					</p><p>
						When new time is added to the draft period, the application copies the shifts (and default employees, if present) from the rotation pattern into this new part of the draft period. You can also manually add and edit shifts in the draft period.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								To view and edit the shift roster in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Shift</strong></span> tab.
							</p><p class="simpara">
								In the top left part of the window, you can see the dates for which the roster is displayed. To view other weeks, you can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons next to the <span class="strong strong"><strong>Week of</strong></span> field. Alternatively, you can click the date field and change the date to view the week that includes this date.
							</p></li><li class="listitem">
								To add a shift, click an open area of the schedule. The application adds a shift, determining the slot and time span automatically from the location of the click.
							</li><li class="listitem"><p class="simpara">
								To edit a shift, click the shift. You can set the following values for a shift:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>From</strong></span> and <span class="strong strong"><strong>To</strong></span> date and time: The exact time and duration of the shift.
									</li><li class="listitem">
										<span class="strong strong"><strong>Employee</strong></span>: The employee assigned to the shift.
									</li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Pinned</strong></span>: Whether the employee is <span class="emphasis"><em>pinned</em></span> to the shift. If an employee is pinned, automatic employee rostering cannot change the assignment of the employee to the shift. A pinned employee is not automatically replicated to any other shift.
									</p><p class="simpara">
										To save the changes, click <span class="strong strong"><strong>Apply</strong></span>.
									</p></li></ul></div></li><li class="listitem">
								To delete a shift, click the shift, and then click <span class="strong strong"><strong>Delete shift</strong></span>.
							</li></ol></div></section><section class="section" id="er-solve-proc"><div class="titlepage"><div><div><h3 class="title">15.3.10. Creating and viewing the employee shift roster</h3></div></div></div><p>
						You can use the application to create and view the optimal shift roster for all employees.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								To view and edit the shift roster in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Shift</strong></span> tab.
							</li><li class="listitem">
								To create the optimal shift roster, click <span class="strong strong"><strong>Schedule</strong></span>. The application takes 30 seconds to find the optimal solution.
							</li></ol></div><div class="formalpara"><p class="title"><strong>Result</strong></p><p>
							When the operation is finished, the Shift Roster view contains the optimal shift roster. The new roster is created for the draft period. The operation does not modify the published periods.
						</p></div><p>
						In the top left part of the window, you can see the dates for which the roster is displayed. To view other weeks, you can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons next to the <span class="strong strong"><strong>Week of</strong></span> field. Alternatively, you can click the date field and change the date to view the week that includes this date.
					</p><p>
						In the draft period, the borders of boxes that represent shifts are dotted lines. In the published periods, the borders are unbroken lines.
					</p><p>
						The color of the boxes that represent shifts shows the constraint status of every shift:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Strong green: Soft constraint matched; for example, the shift is in a "desired" timeslot for the employee.
							</li><li class="listitem">
								Pale green: No constraint broken.
							</li><li class="listitem">
								Grey: Soft constraint broken; for example, the shift is in an "undesired" timeslot for the employee.
							</li><li class="listitem">
								Yellow: Medium constraint broken; for example, no employee is assigned to the shift.
							</li><li class="listitem">
								Red: Hard constraint broken; for example, an employee has two shifts at the same time.
							</li></ul></div></section><section class="section" id="er-individualroster-proc"><div class="titlepage"><div><div><h3 class="title">15.3.11. Viewing employee shifts</h3></div></div></div><p>
						You can view the assigned shifts for particular employees in an employee-centric table. The information is the same as the Shift Roster, but the viewing format might be more convenient for informing employees about their assigned shifts.
					</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
							To view a table of employees and shifts in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Availability Roster</strong></span> tab.
						</p></div><p>
						In the top left part of the window, you can see the dates for which the roster is displayed. To view other weeks, you can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons next to the <span class="strong strong"><strong>Week of</strong></span> field. Alternatively, you can click the date field and change the date to view the week that includes this date.
					</p><p>
						You can see the numbers of currently visible employees in the top right part of the browser window, for example, <code class="literal">1-10 of 34</code>. You can use the <span class="strong strong"><strong>&lt;</strong></span> and <span class="strong strong"><strong>&gt;</strong></span> buttons next to the numbers to display other employees in the list.
					</p><p>
						In the draft period, the borders of boxes representing shifts are dotted lines. In the published periods, the borders are unbroken lines.
					</p></section><section class="section" id="er-publish-proc"><div class="titlepage"><div><div><h3 class="title">15.3.12. Publishing the shift roster</h3></div></div></div><p>
						When you publish the shift roster, the first week of the draft period becomes published. Automatic employee rostering no longer changes any shift assignments in the published period, though emergency manual changing is still possible. The draft period is shifted one week later. For details about draft and published periods, see <a class="xref" href="#er-periods-con" title="15.3.1. The draft and published periods">Section 15.3.1, “The draft and published periods”</a>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								To view and edit the shift roster in the Employee Rostering application web interface, click the <span class="strong strong"><strong>Shift</strong></span> tab.
							</li><li class="listitem">
								Review the shift roster for the first week of the draft period to ensure that it is acceptable.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Publish</strong></span>.
							</li></ol></div></section><section class="section" id="er-rotation-edit-proc"><div class="titlepage"><div><div><h3 class="title">15.3.13. Viewing and editing the rotation pattern</h3></div></div></div><p>
						The rotation pattern enables you to add, move, and delete shifts so you can manage your employee resources efficiently. It is defined by time buckets and seats.
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/_images/employee-rostering/rotation.png" alt="rotation"/></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A time bucket describes a time slot (for example, 9:00 a.m. to 5:00 p.m.) for a particular spot or location <span class="strong strong"><strong>(A)</strong></span> (for example, Anaesthetics), over two or more days, and any skills that are required (for example, firearm training).
							</li><li class="listitem">
								A seat <span class="strong strong"><strong>(B)</strong></span> is an employee assignment for a particular day in a specific time bucket.
							</li><li class="listitem">
								An employee stub is an icon that represents an employee that is available to be assigned to a time bucket. Employee stubs are listed in the <span class="strong strong"><strong>Employee Stub List</strong></span>.
							</li></ul></div><p>
						For more information about the rotation pattern, see <a class="xref" href="#er-rotation-con" title="15.3.2. The rotation pattern">Section 15.3.2, “The rotation pattern”</a>.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Click the <span class="strong strong"><strong>Rotation</strong></span> tab to view and edit the rotation pattern.
							</li><li class="listitem">
								Select a spot from the <span class="strong strong"><strong>Rotation</strong></span> menu.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add New Time Bucket</strong></span>. The <span class="strong strong"><strong>Creating Working Time Bucket</strong></span> dialog is displayed.
							</li><li class="listitem">
								Specify a start and end time, select any additional required skills, select the days for this time bucket, and click <span class="strong strong"><strong>Save</strong></span>. The unassigned seats for that time bucket appears on the <span class="strong strong"><strong>Rotation</strong></span> page organized by time ranges.
							</li><li class="listitem">
								To create an employee stub list so that you can add employees to the rotation, click <span class="strong strong"><strong>Edit Employee Stub List</strong></span>.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Edit Employee Stub List</strong></span> dialog, click <span class="strong strong"><strong>Add Employee</strong></span> and select an employee from the list.
							</li><li class="listitem">
								Add all of the employees required for this stub list and click <span class="strong strong"><strong>Save</strong></span>. The employees appear above the time buckets on the <span class="strong strong"><strong>Rotation</strong></span> page.
							</li><li class="listitem">
								Click an employee icon to select an employee from the employee stub list.
							</li><li class="listitem"><p class="simpara">
								Click and drag the mouse over the seats of a time bucket to assign the selected employee to those seats. The seat is populated with the employee icon.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									A time bucket can only have one employee assigned to it for each day. To add multiple employees to the same time bucket, copy the time bucket and change the employee name as required.
								</p></div></div></li><li class="listitem">
								To provision the schedule, click <span class="strong strong"><strong>Scheduling</strong></span> and select the spot that you created the rotation for.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Provision</strong></span> and specify the date range.
							</li><li class="listitem">
								Deselect the spots that you do not want to include in this schedule.
							</li><li class="listitem">
								Click the arrow next to the selected spot and deselect any time buckets that you do not want to use in your schedule.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Provision Shifts</strong></span>. The calendar is populated with shifts generated from the time buckets.
							</li><li class="listitem">
								To modify a shift, click a generated shift on the calendar.
							</li></ol></div></section></section></section><section class="chapter" id="assembly-business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Deploying and using the Red Hat build of OptaPlanner vehicle route planning starter application</h2></div></div></div><p>
				As a developer, you can use the OptaWeb Vehicle Routing starter application to optimize your vehicle fleet deliveries.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenJDK (JDK) 11 is installed. Red Hat build of Open JDK is available from the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required).
					</li><li class="listitem">
						Apache Maven 3.6 or higher is installed. Maven is available from the <a class="link" href="https://maven.apache.org/">Apache Maven Project</a> website.
					</li></ul></div><section class="section" id="vrp-con_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.1. What is OptaWeb Vehicle Routing?</h2></div></div></div><p>
					The main purpose of many businesses is to transport various types of cargo. The goal of these businesses is to deliver a piece of cargo from the loading point to a destination and use its vehicle fleet in the most efficient way. One of the main objectives is to minimize travel costs which are measured in either time or distance.
				</p><p>
					This type of optimization problem is referred to as the vehicle routing problem (VRP) and has many variations.
				</p><p>
					Red Hat build of OptaPlanner can solve many of these vehicle routing variations and provides solution examples. OptaPlanner enables developers to focus on modeling business rules and requirements instead of learning <a class="link" href="https://en.wikipedia.org/wiki/Constraint_programming">constraint programming</a> theory. OptaWeb Vehicle Routing expands the vehicle routing capabilities of OptaPlanner by providing a starter application that answers questions such as these:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Where do I get the distances and travel times?
						</li><li class="listitem">
							How do I visualize the solution on a map?
						</li><li class="listitem">
							How do I build an application that runs in the cloud?
						</li></ul></div><p>
					OptaWeb Vehicle Routing uses OpenStreetMap (OSM) data files. For information about OpenStreetMap, see the <a class="link" href="https://wiki.openstreetmap.org/wiki/About_OpenStreetMap">OpenStreetMap</a> web site.
				</p><p>
					Use the following definitions when working with OptaWeb Vehicle Routing:
				</p><p>
					<span class="strong strong"><strong>Region</strong></span>: An arbitrary area on the map of Earth, represented by an OSM file. A region can be a country, a city, a continent, or a group of countries that are frequently used together. For example, the DACH region includes Germany (DE), Austria (AT), and Switzerland (CH).
				</p><p>
					<span class="strong strong"><strong>Country code</strong></span>: A two-letter code assigned to a country by the ISO-3166 standard. You can use a country code to filter geosearch results. Because you can work with a region that spans multiple countries (for example, the DACH region), OptaWeb Vehicle Routing accepts a list of country codes so that geosearch filtering can be used with such regions. For a list of country codes, see <a class="link" href="https://www.iso.org/iso-3166-country-codes.html"><span class="emphasis"><em>ISO 3166 Country Codes</em></span></a>
				</p><p>
					<span class="strong strong"><strong>Geosearch</strong></span>: A type of query where you provide an address or a place name of a region as the search keyword and receive a number of GPS locations as a result. The number of locations returned depends on how unique the search keyword is. Because most place names are not unique, filter out nonrelevant results by including only places in the country or countries that are in your working region.
				</p></section><section class="section" id="download-ref-imp-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.2. Download and build the OptaWeb Vehicle Routing deployment files</h2></div></div></div><p>
					You must download and prepare the deployment files before building and deploying OptaWeb Vehicle Routing.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Navigate to the <a class="link" href="https://access.redhat.com/jbossnetwork/restricted/listSoftware.html">Software Downloads</a> page in the Red Hat Customer Portal (login required), and select the product and version from the drop-down options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Product: Decision Manager
								</li><li class="listitem">
									Version: 7.13.0
								</li></ul></div></li><li class="listitem">
							Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13.0 Kogito and OptaPlanner 8 Decision Services Quickstarts</strong></span> (<code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code>).
						</li><li class="listitem">
							Extract the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts.zip</code> file.
						</li><li class="listitem">
							Download <span class="strong strong"><strong>Red Hat Decision Manager 7.13 Maven Repository Kogito and OptaPlanner 8 Maven Repository</strong></span> (<code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code>).
						</li><li class="listitem">
							Extract the <code class="literal">rhdm-7.13.0-kogito-maven-repository.zip</code> file.
						</li><li class="listitem">
							Copy the contents of the <code class="literal">rhdm-7.13.0-kogito-maven-repository/maven-repository</code> subdirectory into the <code class="literal">~/.m2/repository</code> directory.
						</li><li class="listitem">
							Navigate to the <code class="literal">optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing</code> directory.
						</li><li class="listitem"><p class="simpara">
							Enter the following command to build OptaWeb Vehicle Routing:
						</p><pre class="screen">mvn clean package -DskipTests</pre></li></ol></div></section><section class="section" id="runlocally-con_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.3. Run OptaWeb Vehicle Routing locally using the runLocally.sh script</h2></div></div></div><p>
					Linux users can use the <code class="literal">runLocally.sh</code> Bash script to run OptaWeb Vehicle Routing.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">runLocally.sh</code> script does not run on macOS. If you cannot use the <code class="literal">runLocally.sh</code> script, see <a class="xref" href="#run-vrp-manually-proc_business-optimizer-vrp" title="16.4. Configure and run OptaWeb Vehicle Routing manually">Section 16.4, “Configure and run OptaWeb Vehicle Routing manually”</a>.
					</p></div></div><p>
					The <code class="literal">runLocally.sh</code> script automates the following setup steps that otherwise must be carried out manually:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Create the data directory.
						</li><li class="listitem">
							Download selected OpenStreetMap (OSM) files from Geofabrik.
						</li><li class="listitem">
							Try to associate a country code with each downloaded OSM file automatically.
						</li><li class="listitem">
							Build the project if the standalone JAR file does not exist.
						</li><li class="listitem">
							Launch OptaWeb Vehicle Routing by taking a single region argument or by selecting the region interactively.
						</li></ul></div><p>
					See the following sections for instructions about executing the <code class="literal">runLocally.sh</code> script:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="xref" href="#run-locally-qs-proc_business-optimizer-vrp" title="16.3.1. Run the OptaWeb Vehicle Routing runLocally.sh script in quick start mode">Section 16.3.1, “Run the OptaWeb Vehicle Routing runLocally.sh script in quick start mode”</a>
						</li><li class="listitem">
							<a class="xref" href="#run-locally-interactive-proc_business-optimizer-vrp" title="16.3.2. Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode">Section 16.3.2, “Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode”</a>
						</li><li class="listitem">
							<a class="xref" href="#run-locally-noninteractive-proc_business-optimizer-vrp" title="16.3.3. Run the OptaWeb Vehicle Routing runLocally.sh script in non-interactive mode">Section 16.3.3, “Run the OptaWeb Vehicle Routing runLocally.sh script in non-interactive mode”</a>
						</li></ul></div><section class="section" id="run-locally-qs-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.3.1. Run the OptaWeb Vehicle Routing runLocally.sh script in quick start mode</h3></div></div></div><p>
						The easiest way to get started with OptaWeb Vehicle Routing is to run the <code class="literal">runLocally.sh</code> script without any arguments.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing has been successfully built with Maven as described in <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
							</li><li class="listitem">
								Internet access is available.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Enter the following command in the <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing</code> directory.
							</p><pre class="screen"> ./runLocally.sh</pre></li><li class="listitem">
								If prompted to create the <code class="literal">.optaweb-vehicle-routing</code> directory, enter <code class="literal">y</code>. You are prompted to create this directory the first time you run the script.
							</li><li class="listitem"><p class="simpara">
								If prompted to download an OSM file, enter <code class="literal">y</code>. The first time that you run the script, OptaWeb Vehicle Routing downloads the Belgium OSM file.
							</p><p class="simpara">
								The application starts after the OSM file is downloaded.
							</p></li><li class="listitem"><p class="simpara">
								To open the OptaWeb Vehicle Routing user interface, enter the following URL in a web browser:
							</p><pre class="screen">http://localhost:8080</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The first time that you run the script, it will take a few minutes to start because the OSM file must be imported by GraphHopper and stored as a road network graph. The next time you run the <code class="literal">runlocally.sh</code> script, load times will be significantly faster.
						</p></div></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
							<a class="xref" href="#use-vrp-con_business-optimizer-vrp" title="16.6. Using OptaWeb Vehicle Routing">Section 16.6, “Using OptaWeb Vehicle Routing”</a>
						</p></div></section><section class="section" id="run-locally-interactive-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.3.2. Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode</h3></div></div></div><p>
						Use interactive mode to see the list of downloaded OSM files and country codes assigned to each region. You can use the interactive mode to download additional OSM files from Geofabrik without visiting the website and choosing a destination for the download.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing has been successfully built with Maven as described in <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
							</li><li class="listitem">
								Internet access is available.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing</code>.
							</li><li class="listitem"><p class="simpara">
								Enter the following command to run the script in interactive mode:
							</p><pre class="screen">./runLocally.sh -i</pre></li><li class="listitem">
								At the <code class="literal">Your choice</code> prompt, enter <code class="literal">d</code> to display the download menu. A list of previously downloaded regions appears followed by a list of regions that you can download.
							</li><li class="listitem"><p class="simpara">
								Optional: Select a region from the list of previously downloaded regions:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Enter the number associated with a region in the list of downloaded regions.
									</li><li class="listitem">
										Press the Enter key.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Optional: Download a region:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Enter the number associated with the region that you want to download. For example, to select the map of Europe, enter <code class="literal">5</code>.
									</li><li class="listitem">
										To download the map, enter <code class="literal">d</code> then press the Enter key.
									</li><li class="listitem"><p class="simpara">
										To download a specific region within the map, enter <code class="literal">e</code> then enter the number associated with the region that you want to download, and press the Enter key.
									</p><div class="admonition warning"><div class="admonition_header">Using large OSM files</div><div><p>
											For the best user experience, use smaller regions such as individual European or US states. Using OSM files larger than 1 GB will require significant RAM size and take a lot of time (up to several hours) for the initial processing.
										</p></div></div><p class="simpara">
										The application starts after the OSM file is downloaded.
									</p></li></ol></div></li><li class="listitem"><p class="simpara">
								To open the OptaWeb Vehicle Routing user interface, enter the following URL in a web browser:
							</p><pre class="screen">http://localhost:8080</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
							<a class="xref" href="#use-vrp-con_business-optimizer-vrp" title="16.6. Using OptaWeb Vehicle Routing">Section 16.6, “Using OptaWeb Vehicle Routing”</a>
						</p></div></section><section class="section" id="run-locally-noninteractive-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.3.3. Run the OptaWeb Vehicle Routing runLocally.sh script in non-interactive mode</h3></div></div></div><p>
						Use OptaWeb Vehicle Routing in non-interactive mode to start OptaWeb Vehicle Routing with a single command that includes an OSM file that you downloaded previously. This is useful when you want to switch between regions quickly or when doing a demo.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing has been successfully built with Maven as described in <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
							</li><li class="listitem">
								The OSM file for the region that you want to use has been downloaded. For information about downloading OSM files, see <a class="xref" href="#run-locally-interactive-proc_business-optimizer-vrp" title="16.3.2. Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode">Section 16.3.2, “Run the OptaWeb Vehicle Routing runLocally.sh script in interactive mode”</a>.
							</li><li class="listitem">
								Internet access is available.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								Change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing</code>.
							</li><li class="listitem"><p class="simpara">
								Execute the following command where <code class="literal">&lt;OSM_FILE_NAME&gt;</code> is an OSM file that you downloaded previously:
							</p><pre class="screen">./runLocally.sh &lt;OSM_FILE_NAME&gt;</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
							<a class="xref" href="#use-vrp-con_business-optimizer-vrp" title="16.6. Using OptaWeb Vehicle Routing">Section 16.6, “Using OptaWeb Vehicle Routing”</a>
						</p></div></section><section class="section" id="adjust-data-dir-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.3.4. Update the data directory</h3></div></div></div><p>
						You can update the data directory that OptaWeb Vehicle Routing uses if you want to use a different data directory. The default data directory is <code class="literal">$HOME/.optaweb-vehicle-routing</code>.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing has been successfully built with Maven as described in <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								To use a different data directory, add the directory’s absolute path to the <code class="literal">.DATA_DIR_LAST</code> file in the current data directory.
							</li><li class="listitem"><p class="simpara">
								To change country codes associated with a region, edit the corresponding file in the <code class="literal">country_codes</code> directory, in the current data directory.
							</p><p class="simpara">
								For example, if you downloaded an OSM file for Scotland and the script fails to guess the country code, set the content of <code class="literal">country_codes/scotland-latest</code> to GB.
							</p></li><li class="listitem">
								To remove a region, delete the corresponding OSM file from <code class="literal">openstreetmap</code> directory in the data directory and delete the region’s directory in the <code class="literal">graphhopper</code> directory.
							</li></ul></div></section></section><section class="section" id="run-vrp-manually-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.4. Configure and run OptaWeb Vehicle Routing manually</h2></div></div></div><p>
					The easiest way to run OptaWeb Vehicle Routing is to use the <code class="literal">runlocally.sh</code> script. However, if Bash is not available on your system you can manually complete the steps that the <code class="literal">runlocally.sh</code> script performs.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							OptaWeb Vehicle Routing has been successfully built with Maven as described in <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
						</li><li class="listitem">
							Internet access is available.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Download routing data.
						</p><p class="simpara">
							The routing engine requires geographical data to calculate the time it takes vehicles to travel between locations. You must download and store OpenStreetMap (OSM) data files on the local file system before you run OptaWeb Vehicle Routing.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The OSM data files are typically between 100 MB to 1 GB and take time to download so it is a good idea to download the files before building or starting the OptaWeb Vehicle Routing application.
							</p></div></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Open <code class="literal"><a class="link" href="http://download.geofabrik.de/">http://download.geofabrik.de/</a></code> in a web browser.
								</li><li class="listitem">
									Click a region in the <span class="strong strong"><strong>Sub Region</strong></span> list, for example <span class="strong strong"><strong>Europe</strong></span>. The subregion page opens.
								</li><li class="listitem">
									In the <span class="strong strong"><strong>Sub Regions</strong></span> table, download the OSM file (<code class="literal">.osm.pbf</code>) for a country, for example Belgium.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create the data directory structure.
						</p><p class="simpara">
							OptaWeb Vehicle Routing reads and writes several types of data on the file system. It reads OSM (OpenStreetMap) files from the <code class="literal">openstreetmap</code> directory, writes a road network graph to the <code class="literal">graphhopper</code> directory, and persists user data in a directory called <code class="literal">db</code>. Create a new directory dedicated to storing all of these data to make it easier to upgrade to a newer version of OptaWeb Vehicle Routing in the future and continue working with the data you created previously.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Create the <code class="literal">$HOME/.optaweb-vehicle-routing</code> directory.
								</li><li class="listitem"><p class="simpara">
									Create the <code class="literal">openstreetmap</code> directory in the <code class="literal">$HOME/.optaweb-vehicle-routing</code> directory:
								</p><pre class="screen">$HOME/.optaweb-vehicle-routing
└── openstreetmap</pre></li><li class="listitem"><p class="simpara">
									Move all of your downloaded OSM files (files with the extension <code class="literal">.osm.pbf</code>) to the <code class="literal">openstreetmap</code> directory.
								</p><p class="simpara">
									The rest of the directory structure is created by the OptaWeb Vehicle Routing application when it runs for the first time. After that, your directory structure is similar to the following example:
								</p><pre class="screen">$HOME/.optaweb-vehicle-routing

├── db
│   └── vrp.mv.db
├── graphhopper
│   └── belgium-latest
└── openstreetmap
    └── belgium-latest.osm.pbf</pre></li></ol></div></li><li class="listitem">
							Change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing/optaweb-vehicle-routing-standalone/target</code>.
						</li><li class="listitem"><p class="simpara">
							To run OptaWeb Vehicle Routing, enter the following command:
						</p><pre class="screen">java \
-Dapp.demo.data-set-dir=$HOME/.optaweb-vehicle-routing/dataset \
-Dapp.persistence.h2-dir=$HOME/.optaweb-vehicle-routing/db \
-Dapp.routing.gh-dir=$HOME/.optaweb-vehicle-routing/graphhopper \
-Dapp.routing.osm-dir=$HOME/.optaweb-vehicle-routing/openstreetmap \
-Dapp.routing.osm-file=&lt;OSM_FILE_NAME&gt; \
-Dapp.region.country-codes=&lt;COUNTRY_CODE_LIST&gt; \
-jar quarkus-app/quarkus-run.jar</pre><p class="simpara">
							In this command, replace the following variables:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">&lt;OSM_FILE_NAME&gt;</code>: The OSM file for the region that you want to use and that you downloaded previously
								</li><li class="listitem"><p class="simpara">
									<code class="literal">&lt;COUNTRY_CODE_LIST&gt;</code>: A comma-separated list of country codes used to filter geosearch queries. For a list of country codes, see <a class="link" href="https://www.iso.org/iso-3166-country-codes.html"><span class="emphasis"><em>ISO 3166 Country Codes</em></span></a>.
								</p><p class="simpara">
									The application starts after the OSM file is downloaded.
								</p><p class="simpara">
									In the following example, OptaWeb Vehicle Routing downloads the OSM map of Central America (<code class="literal">central-america-latest.osm.pbf</code>) and searches in the countries Belize (BZ) and Guatemala (GT).
								</p><pre class="screen">java \
-Dapp.demo.data-set-dir=$HOME/.optaweb-vehicle-routing/dataset \
-Dapp.persistence.h2-dir=$HOME/.optaweb-vehicle-routing/db \
-Dapp.routing.gh-dir=$HOME/.optaweb-vehicle-routing/graphhopper \
-Dapp.routing.osm-dir=$HOME/.optaweb-vehicle-routing/openstreetmap \
-Dapp.routing.osm-file=entral-america-latest.osm.pbf \
-Dapp.region.country-codes=BZ,GT \
-jar quarkus-app/quarkus-run.jar</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							To open the OptaWeb Vehicle Routing user interface, enter the following URL in a web browser:
						</p><pre class="screen">http://localhost:8080</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
						<a class="xref" href="#use-vrp-con_business-optimizer-vrp" title="16.6. Using OptaWeb Vehicle Routing">Section 16.6, “Using OptaWeb Vehicle Routing”</a>
					</p></div></section><section class="section" id="vrp-run-openshift-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.5. Run OptaWeb Vehicle Routing on Red Hat OpenShift Container Platform</h2></div></div></div><p>
					Linux users can use the <code class="literal">runOnOpenShift.sh</code> Bash script to install OptaWeb Vehicle Routing on Red Hat OpenShift Container Platform.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">runOnOpenShift.sh</code> script does not run on macOS.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have access to an OpenShift cluster and the OpenShift command-line interface (<code class="literal">oc</code>) has been installed. For information about Red Hat OpenShift Container Platform, see <a class="link" href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.5/html-single/installing/index"><span class="emphasis"><em>Installing OpenShift Container Platform</em></span></a>.
						</li><li class="listitem">
							OptaWeb Vehicle Routing has been successfully built with Maven as described in <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
						</li><li class="listitem">
							Internet access is available.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to or start a Red Hat OpenShift Container Platform cluster.
						</li></ol></div><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Enter the following command where <code class="literal">&lt;PROJECT_NAME&gt;</code> is the name of your new project:
						</p><pre class="screen">oc new-project &lt;PROJECT_NAME&gt;</pre></li><li class="listitem">
							If necessary, change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing</code>.
						</li><li class="listitem"><p class="simpara">
							Enter the following command to execute the <code class="literal">runOnOpenShift.sh</code> script and download an OpenStreetMap (OSM) file:
						</p><pre class="screen">./runOnOpenShift.sh &lt;OSM_FILE_NAME&gt; &lt;COUNTRY_CODE_LIST&gt; &lt;OSM_FILE_DOWNLOAD_URL&gt;</pre><p class="simpara">
							In this command, replace the following variables:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">&lt;OSM_FILE_NAME&gt;</code>: The name of a file downloaded from <code class="literal">&lt;OSM_FILE_DOWNLOAD_URL&gt;</code>.
								</li><li class="listitem">
									<code class="literal">&lt;COUNTRY_CODE_LIST&gt;</code>: A comma-separated list of country codes used to filter geosearch queries. For a list of country codes, see <a class="link" href="https://www.iso.org/iso-3166-country-codes.html"><span class="emphasis"><em>ISO 3166 Country Codes</em></span></a>.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">&lt;OSM_FILE_DOWNLOAD_URL&gt;</code>: The URL of an OSM data file in PBF format accessible from OpenShift. The file will be downloaded during backend startup and saved as <code class="literal">/deployments/local/&lt;OSM_FILE_NAME&gt;</code>.
								</p><p class="simpara">
									In the following example, OptaWeb Vehicle Routing downloads the OSM map of Central America (<code class="literal">central-america-latest.osm.pbf</code>) and searches in the countries Belize (BZ) and Guatemala (GT).
								</p><pre class="screen">./runOnOpenShift.sh central-america-latest.osm.pbf BZ,GT http://download.geofabrik.de/europe/central-america-latest.osm.pbf</pre></li></ul></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						For help with the <code class="literal">runOnOpenShift.sh</code> script, enter <code class="literal">./runOnOpenShift.sh --help</code>.
					</p></div></div><section class="section" id="vrp-update-deployed-changes-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.5.1. Updating the deployed OptaWeb Vehicle Routing application with local changes</h3></div></div></div><p>
						After you deploy your OptaWeb Vehicle Routing application on Red Hat OpenShift Container Platform, you can update the back end and front end.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing has been successfully built with Maven and deployed on OpenShift.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To update the back end, perform the following steps:
							</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
										Change the source code and build the back-end module with Maven.
									</li><li class="listitem">
										Change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing</code>.
									</li><li class="listitem"><p class="simpara">
										Enter the following command to start the OpenShift build:
									</p><pre class="programlisting language-shell">oc start-build backend --from-dir=. --follow</pre></li></ol></div></li><li class="listitem"><p class="simpara">
								To update the front end, perform the following steps:
							</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
										Change the source code and build the front-end module with the <code class="literal">npm</code> utility.
									</li><li class="listitem">
										Change directory to <code class="literal">sources/optaweb-vehicle-routing-frontend</code>.
									</li><li class="listitem"><p class="simpara">
										Enter the following command to start the OpenShift build:
									</p><pre class="programlisting language-shell">oc start-build frontend --from-dir=docker --follow</pre></li></ol></div></li></ul></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
							<a class="xref" href="#use-vrp-con_business-optimizer-vrp" title="16.6. Using OptaWeb Vehicle Routing">Section 16.6, “Using OptaWeb Vehicle Routing”</a>
						</p></div></section></section><section class="section" id="use-vrp-con_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.6. Using OptaWeb Vehicle Routing</h2></div></div></div><p>
					In the OptaWeb Vehicle Routing application, you can mark a number of locations on the map. The first location is assumed to be the depot. Vehicles must deliver goods from this depot to every other location that you marked.
				</p><p>
					You can set the number of vehicles and the carrying capacity of every vehicle. However, the route is not guaranteed to use all vehicles. The application uses as many vehicles as required for an optimal route.
				</p><p>
					The current version has certain limitations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Every delivery to a location is supposed to take one point of vehicle capacity. For example, a vehicle with a capacity of 10 can visit up to 10 locations before returning to the depot.
						</li><li class="listitem">
							Setting custom names of vehicles and locations is not supported.
						</li></ul></div><section class="section" id="vrp-create-route-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.6.1. Creating a route</h3></div></div></div><p>
						To create an optimal route, use the <span class="strong strong"><strong>Demo</strong></span> tab of the OptaWeb Vehicle Routing user interface.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing is running and you have access to the user interface.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In OptaWeb Vehicle Routing, click <span class="strong strong"><strong>Demo</strong></span> to open the <span class="strong strong"><strong>Demo</strong></span> tab.
							</li><li class="listitem">
								Use the blue minus and plus buttons above the map to set the number of vehicles. Each vehicle has a default capacity of 10.
							</li><li class="listitem"><p class="simpara">
								Use the plus button in a square on the map to zoom in as required.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Do not double-click to zoom in. A double click also creates a location.
								</p></div></div></li><li class="listitem">
								Click a location for the depot.
							</li><li class="listitem">
								Click other locations on the map for delivery points.
							</li><li class="listitem"><p class="simpara">
								If you want to delete a location:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Hover the mouse cursor over the location to see the location name.
									</li><li class="listitem">
										Find the location name in the list in the left part of the screen.
									</li><li class="listitem">
										Click the <span class="strong strong"><strong>X</strong></span> icon next to the name.
									</li></ol></div></li></ol></div><p>
						Every time you add or remove a location or change the number of vehicles, the application creates and displays a new optimal route. If the solution uses several vehicles, the application shows the route for every vehicle in a different color.
					</p></section><section class="section" id="vrp-other-actions-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.6.2. Viewing and setting other details</h3></div></div></div><p>
						You can use other tabs in the OptaWeb Vehicle Routing user interface to view and set additional details.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing is running and you have access to the user interface.
							</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								Click the <span class="strong strong"><strong>Vehicles</strong></span> tab to view, add, and remove vehicles, and also set the capacity for every vehicle.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Visits</strong></span> tab to view and remove locations.
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>Route</strong></span> tab to select each vehicle and view the route for the selected vehicle.
							</li></ul></div></section><section class="section" id="vrp-custom-data-sets-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.6.3. Creating custom data sets with OptaWeb Vehicle Routing</h3></div></div></div><p>
						There is a built-in demo data set consisting of a several large Belgian cities. If you want to have more demos available in the <span class="strong strong"><strong>Load demo</strong></span> menu, you can prepare your own data sets.
					</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								In OptaWeb Vehicle Routing, add a depot and one or more of visits by clicking on the map or using geosearch.
							</li><li class="listitem"><p class="simpara">
								Click <span class="strong strong"><strong>Export</strong></span> and save the file in the data set directory.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The data set directory is the directory specified in the <code class="literal">app.demo.data-set-dir</code> property.
								</p><p>
									If the application is running through the <code class="literal">runLocally.sh</code> script, the data set directory is set to <code class="literal">$HOME/.optaweb-vehicle-routing/dataset</code>.
								</p><p>
									Otherwise, the property is taken from the <code class="literal">application.properties</code> file and defaults to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing/optaweb-vehicle-routing-standalone/target/local/dataset</code>.
								</p><p>
									You can edit the <code class="literal">app.demo.data-set-dir</code> property to specify a diffent data directory.
								</p></div></div></li><li class="listitem">
								Edit the YAML file and choose a unique name for the data set.
							</li><li class="listitem">
								Restart the back end.
							</li></ol></div><p>
						After you restart the back end, files in the data set directory appear in the <span class="strong strong"><strong>Load demo</strong></span> menu.
					</p></section><section class="section" id="vrp-troubleshooting-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.6.4. Troubleshooting OptaWeb Vehicle Routing</h3></div></div></div><p>
						If the OptaWeb Vehicle Routing behaves unexpectedly, follow this procedure to trouble-shoot.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								OptaWeb Vehicle Routing is running and behaving unexpectedly.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
								To identify issues, review the back-end terminal output log.
							</li><li class="listitem"><p class="simpara">
								To resolve issues, remove the back-end database:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Stop the back end by pressing Ctrl+C in the back-end terminal window.
									</li><li class="listitem">
										Remove the <code class="literal">optaweb-vehicle-routing/optaweb-vehicle-routing-backend/local/db</code> directory.
									</li><li class="listitem">
										Restart OptaWeb Vehicle Routing.
									</li></ol></div></li></ol></div></section></section><section class="section" id="optaweb_vehicle_routing_development_guide"><div class="titlepage"><div><div><h2 class="title">16.7. OptaWeb Vehicle Routing development guide</h2></div></div></div><p>
					This section describes how to configure and run the back-end and front-end modules in development mode.
				</p><section class="section" id="vrp-structure-con_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.7.1. OptaWeb Vehicle Routing project structure</h3></div></div></div><p>
						The OptaWeb Vehicle Routing project is a multi-module Maven project.
					</p><div class="figure" id="idm45892292405552"><p class="title"><strong>Figure 16.1. Module dependency tree diagram</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><object style="text-align: middle" type="image/svg+xml" data="images/_images/vrp/modules.dot.svg"><embed type="image/svg+xml" src="images/_images/vrp/modules.dot.svg"/></object></div></div></div><p>
						The back-end and front-end modules are at the bottom of the module tree. These modules contain the application source code.
					</p><p>
						The standalone module is an assembly module that combines the back end and front end into a single executable JAR file.
					</p><p>
						The distribution module represents the final assembly step. It takes the standalone application and the documentation and wraps them in an archive that is easy to distribute.
					</p><p>
						The back end and front end are separate projects that you can build and deploy separately. In fact, they are written in completely different languages and built with different tools. Both projects have tools that provide a modern developer experience with fast turn-around between code changes and the running application.
					</p><p>
						The next sections describe how to run both back-end and front-end projects in development mode.
					</p></section><section class="section" id="vrp-backend-con_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.7.2. The OptaWeb Vehicle Routing back-end module</h3></div></div></div><p>
						The back-end module contains a server-side application that uses Red Hat build of OptaPlanner to optimize vehicle routes. Optimization is a CPU-intensive computation that must avoid any I/O operations in order to perform to its full potential. Because one of the chief objectives is to minimize travel cost, either time or distance, OptaWeb Vehicle Routing keeps the travel cost information in RAM memory. While solving, OptaPlanner needs to know the travel cost between every pair of locations entered by the user. This information is stored in a structure called the <span class="emphasis"><em>distance matrix</em></span>.
					</p><p>
						When you enter a new location, OptaWeb Vehicle Routing calculates the travel cost between the new location and every other location that has been entered so far, and stores the travel cost in the distance matrix. The travel cost calculation is performed by the <a class="link" href="https://github.com/graphhopper/graphhopper">GraphHopper</a> routing engine.
					</p><p>
						The back-end module implements the following additional functionality:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Persistence
							</li><li class="listitem">
								WebSocket connection for the front end
							</li><li class="listitem">
								Data set loading, export, and import
							</li></ul></div><p>
						To learn more about the back-end code architecture, see <a class="xref" href="#backend-architecture-con_business-optimizer-vrp" title="16.8. OptaWeb Vehicle Routing back-end architecture">Section 16.8, “OptaWeb Vehicle Routing back-end architecture”</a>.
					</p><p>
						The next sections describe how to configure and run the back end in development mode.
					</p><section class="section" id="vrp-backend-spring-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h4 class="title">16.7.2.1. Running the OptaWeb Vehicle Routing back-end module</h4></div></div></div><p>
							You can run the back-end module in Quarkus development mode.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									OptaWeb Vehicle Routing has been configured as described in <a class="xref" href="#run-vrp-manually-proc_business-optimizer-vrp" title="16.4. Configure and run OptaWeb Vehicle Routing manually">Section 16.4, “Configure and run OptaWeb Vehicle Routing manually”</a>.
								</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
									Change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing/optaweb-vehicle-routing-backend</code>.
								</li><li class="listitem"><p class="simpara">
									To run the back end in development mode, enter the following command:
								</p><pre class="programlisting language-shell">mvn compile quarkus:dev</pre></li></ol></div></section><section class="section" id="vrp-backend-intellij-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h4 class="title">16.7.2.2. Running the OptaWeb Vehicle Routing back-end module from IntelliJ IDEA Ultimate</h4></div></div></div><p>
							You can use IntelliJ IDEA Ulitmate to run the OptaWeb Vehicle Routing back-end module to make it easier to develop your project. IntelliJ IDEA Ultimate includes a Quarkus plug-in that automatically creates run configurations for modules that use the Quarkus framework.
						</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
								Use the <span class="strong strong"><strong>optaweb-vehicle-routing-backend</strong></span> run configuration to run the back end.
							</p></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
								For more information, see <a class="link" href="https://www.jetbrains.com/help/idea/quarkus.html#run-app">Run the Quarkus application</a>.
							</p></div></section><section class="section" id="vrp-auto-restart-con_business-optimizer-vrp"><div class="titlepage"><div><div><h4 class="title">16.7.2.3. Quarkus development mode</h4></div></div></div><p>
							In development mode, if there are changes to the back-end source code or configuration and you refresh the browser tab where the front end runs, the back-end automatically restarts.
						</p><p>
							Learn more about <a class="link" href="https://quarkus.io/guides/maven-tooling#development-mode">Quarkus development mode</a>.
						</p></section><section class="section" id="vrp-backend-config-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h4 class="title">16.7.2.4. Changing OptaWeb Vehicle Routing back-end module system property values</h4></div></div></div><p>
							You can temporarily or permanently override the default system property values of the OptaWeb Vehicle Routing back-end module.
						</p><p>
							The OptaWeb Vehicle Routing back-end module system properties are stored in the <code class="literal">/src/main/resources/application.properties</code> file. This file is under version control. Use it to permanently store default configuration property values and to define Quarkus profiles.
						</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
									The OptaWeb Vehicle Routing starter application has been downloaded and extracted. For information, see <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
								</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									To temporarily override a default system property value, include the <code class="literal">-D&lt;PROPERTY&gt;=&lt;VALUE&gt;</code> argument when you run the <code class="literal">mvn</code> or <code class="literal">java</code> command, where <code class="literal">&lt;PROPERTY&gt;</code> is the name of the property that you want to change and <code class="literal">&lt;VALUE&gt;</code> is the value that you want to temporarily assign to that property. The following example shows how to temporarily change the value of the <code class="literal">quarkus.http.port</code> system property to <code class="literal">8181</code> when you use Maven to compile a Quarkus project in <code class="literal">dev</code> mode:
								</p><pre class="screen">mvn compile quarkus:dev -Dquarkus.http.port=8181</pre><p class="simpara">
									This temporarily changes the value of the property stored in the <code class="literal">/src/main/resources/application.properties</code> file.
								</p></li><li class="listitem"><p class="simpara">
									To change a configuration value permanently, for example to store a configuration that is specific to your development environment, copy the contents of the <code class="literal">env-example</code> file to the <code class="literal">optaweb-vehicle-routing-backend/.env</code> file.
								</p><p class="simpara">
									This file is excluded from version control and therefore it does not exist when you clone the repository. You can make changes in the <code class="literal">.env</code> file without affecting the Git working tree.
								</p></li></ul></div><div class="formalpara"><p class="title"><strong>Additional resources</strong></p><p>
								For a complete list of OptaWeb Vehicle Routing configuration properties, see <a class="xref" href="#backend-properties-ref_business-optimizer-vrp" title="16.9. OptaWeb Vehicle Routing back-end configuration properties">Section 16.9, “OptaWeb Vehicle Routing back-end configuration properties”</a>.
							</p></div></section><section class="section" id="vrp-backend-logging-con_business-optimizer-vrp"><div class="titlepage"><div><div><h4 class="title">16.7.2.5. OptaWeb Vehicle Routing backend logging</h4></div></div></div><p>
							OptaWeb Vehicle Routing uses the SLF4J API and Logback as the logging framework. For more information, see <a class="link" href="https://quarkus.io/guides/logging">Quarkus - Configuring Logging</a>.
						</p></section></section><section class="section" id="vrp-frontend-proc_business-optimizer-vrp"><div class="titlepage"><div><div><h3 class="title">16.7.3. Working with the OptaWeb Vehicle Routing front-end module</h3></div></div></div><p>
						The front-end project was bootstrapped with <a class="link" href="https://create-react-app.dev/">Create React App</a>. Create React App provides a number of scripts and dependencies that help with development and with building the application for production.
					</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								The OptaWeb Vehicle Routing starter application has been downloaded and extracted. For information, see <a class="xref" href="#download-ref-imp-proc_business-optimizer-vrp" title="16.2. Download and build the OptaWeb Vehicle Routing deployment files">Section 16.2, “Download and build the OptaWeb Vehicle Routing deployment files”</a>.
							</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								On Fedora, enter the following command to set up the development environment:
							</p><pre class="programlisting language-shell">sudo dnf install npm</pre><p class="simpara">
								See <a class="link" href="https://docs.npmjs.com/downloading-and-installing-node-js-and-npm">Downloading and installing Node.js and npm</a> for more information about installing npm.
							</p></li><li class="listitem">
								Change directory to <code class="literal">rhdm-7.13.0-kogito-and-optaplanner-quickstarts/optaweb-8.11.1.Final-redhat-00006/optaweb-vehicle-routing/optaweb-vehicle-routing-frontend</code>.
							</li><li class="listitem"><p class="simpara">
								Install <code class="literal">npm</code> dependencies:
							</p><pre class="programlisting language-shell">npm install</pre><p class="simpara">
								Unlike Maven, the <code class="literal">npm</code> package manager installs dependencies in <code class="literal">node_modules</code> under the project directory and does that only when you execute <code class="literal">npm install</code>. Whenever the dependencies listed in <code class="literal">package.json</code> change, for example when you pull changes to the master branch, you must execute <code class="literal">npm install</code> before you run the development server.
							</p></li><li class="listitem"><p class="simpara">
								Enter the following command to run the development server:
							</p><pre class="programlisting language-shell">npm start</pre></li><li class="listitem"><p class="simpara">
								If it does not open automatically, open <code class="literal">http://localhost:3000/</code> in a web browser.
							</p><p class="simpara">
								By default, the <code class="literal">npm start</code> command attempts to open this URL in your default browser.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									If you do not want the <code class="literal">npm start</code> command to open a new browser tab each time you run it, export the <code class="literal">BROWSER=none</code> environment variable. You can use <code class="literal">.env.local</code> file to make this preference permanent. To do that, enter the following command:
								</p><pre class="programlisting language-shell">echo BROWSER=none &gt;&gt; .env.local</pre></div></div><p class="simpara">
								The browser refreshes the page whenever you make changes in the front-end source code. The development server process running in the terminal picks up the changes as well and prints compilation and lint errors to the console.
							</p></li><li class="listitem"><p class="simpara">
								Enter the following command to run tests:
							</p><pre class="screen">npm test</pre></li><li class="listitem"><p class="simpara">
								Change the value of the <code class="literal">REACT_APP_BACKEND_URL</code> environment variable to specify the location of the back-end project to be used by <code class="literal">npm</code> when you execute <code class="literal">npm start</code> or <code class="literal">npm run build</code>, for example:
							</p><pre class="screen">REACT_APP_BACKEND_URL=http://10.0.0.123:8081</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Environment variables are hard coded inside the JavaScript bundle during the <code class="literal">npm</code> build process, so you must specify the back-end location before you build and deploy the front end.
								</p></div></div><p class="simpara">
								To learn more about the React environment variables, see <a class="link" href="https://create-react-app.dev/docs/adding-custom-environment-variables/"><span class="emphasis"><em>Adding Custom Environment Variables</em></span></a>.
							</p></li><li class="listitem"><p class="simpara">
								To build the front end, enter one of the following commands:
							</p><pre class="screen">./mvnw install</pre><pre class="screen">mvn install</pre></li></ol></div></section></section><section class="section" id="backend-architecture-con_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.8. OptaWeb Vehicle Routing back-end architecture</h2></div></div></div><p>
					Domain model and use cases are essential for the application. The OptaWeb Vehicle Routing domain model is at the center of the architecture and is surround by the application layer that embeds use cases. Functions such as route optimization, distance calculation, persistence, and network communication are considered implementation details and are placed at the outermost layer of the architecture.
				</p><div class="figure" id="idm45892288805920"><p class="title"><strong>Figure 16.2. Diagram of application layers</strong></p><div class="figure-contents"><div style="text-align: center; " class="mediaobject"><object style="text-align: middle" type="image/svg+xml" data="images/_images/vrp/backend-layers.svg"><embed type="image/svg+xml" src="images/_images/vrp/backend-layers.svg"/></object></div></div></div><section class="section" id="code_organization"><div class="titlepage"><div><div><h3 class="title">16.8.1. Code organization</h3></div></div></div><p>
						The back-end code is organized in three layers, illustrated in the preceding graphic.
					</p><pre class="literallayout">org.optaweb.vehiclerouting
├── domain
├── plugin          # Infrastructure layer
│   ├── persistence
│   ├── planner
│   ├── routing
│   └── rest
└── service         # Application layer
    ├── demo
    ├── distance
    ├── error
    ├── location
    ├── region
    ├── reload
    ├── route
    └── vehicle</pre><p>
						The <code class="literal">service</code> package contains the application layer that implements use cases. The <code class="literal">plugin</code> package contains the infrastructure layer.
					</p><p>
						Code in each layer is further organized by function. This means that each service or plug-in has its own package.
					</p></section><section class="section" id="dependency_rules"><div class="titlepage"><div><div><h3 class="title">16.8.2. Dependency rules</h3></div></div></div><p>
						Compile-time dependencies are only allowed to point from outer layers towards the center. Following this rule helps to keep the domain model independent of underlying frameworks and other implementation details and models the behavior of business entities more precisely. With presentation and persistence being pushed out to the periphery, it is easier to test the behavior of business entities and use cases.
					</p><p>
						The domain has no dependencies.
					</p><p>
						Services only depend on the domain. If a service needs to send a result (for example to the database or to the client), it uses an output boundary interface. Its implementation is injected by the <a class="link" href="https://quarkus.io/guides/cdi">contexts and dependency injection</a> (CDI) container.
					</p><p>
						Plug-ins depend on services in two ways. First, they invoke services based on events such as a user input or a route update coming from the optimization engine. Services are injected into plug-ins which moves the burden of their construction and dependency resolution to the IoC container. Second, plug-ins implement service output boundary interfaces to handle use case results, for example persisting changes to the database or sending a response to the web UI.
					</p></section><section class="section" id="the_domain_package"><div class="titlepage"><div><div><h3 class="title">16.8.3. The domain package</h3></div></div></div><p>
						The <code class="literal">domain</code> package contains <span class="emphasis"><em>business objects</em></span> that model the domain of this project, for example <code class="literal">Location</code>, <code class="literal">Vehicle</code>, <code class="literal">Route</code>. These objects are strictly business-oriented and must not be influenced by any tools and frameworks, for example object-relational mapping tools and web service frameworks.
					</p></section><section class="section" id="the_service_package"><div class="titlepage"><div><div><h3 class="title">16.8.4. The service package</h3></div></div></div><p>
						The <code class="literal">service</code> package contains classes that implement <span class="emphasis"><em>use cases</em></span>. A use case describes something that you want to do, for example adding a new location, changing vehicle capacity, or finding coordinates for an address. The business rules that govern use cases are expressed using the domain objects.
					</p><p>
						Services often need to interact with plug-ins in the outer layer, such as persistence, web, and optimization. To satisfy the dependency rules between layers, the interaction between services and plug-ins is expressed in terms of interfaces that define the dependencies of a service. A plug-in can satisfy a dependency of a service by providing a bean that implements the boundary interface of the service. The CDI container creates an instance of the plug-in bean and injects it to the service at runtime. This is an example of the inversion of control principle.
					</p></section><section class="section" id="the_plugin_package"><div class="titlepage"><div><div><h3 class="title">16.8.5. The plugin package</h3></div></div></div><p>
						The <code class="literal">plugin</code> package contains infrastructure functions such as optimization, persistence, routing, and network.
					</p></section></section><section class="section" id="backend-properties-ref_business-optimizer-vrp"><div class="titlepage"><div><div><h2 class="title">16.9. OptaWeb Vehicle Routing back-end configuration properties</h2></div></div></div><p>
					You can set the OptaWeb Vehicle Routing application properties listed in the following table.
				</p><div class="informaltable"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 25%; " class="col_2"/><col style="width: 25%; " class="col_3"/><col style="width: 25%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm45892288769696" scope="col">Property</th><th align="left" valign="top" id="idm45892288768608" scope="col">Type</th><th align="left" valign="top" id="idm45892288767520" scope="col">Example</th><th align="left" valign="top" id="idm45892288766432" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.demo.data-set-dir</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									Relative or absolute path
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">/home/user/.optaweb-vehicle-routing/dataset</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									Custom data sets are loaded from this directory. Defaults to <code class="literal">local/dataset</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.persistence.h2-dir</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									Relative or absolute path
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">/home/user/.optaweb-vehicle-routing/db</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									The directory used by H2 to store the database file. Defaults to <code class="literal">local/db</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.region.country-codes</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									List of <code class="literal"><a class="link" href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2</a></code> country codes
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">US</code>, <code class="literal">GB,IE</code>, <code class="literal">DE,AT,CH</code>, may be empty
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									Restricts geosearch results.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.routing.engine</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									Enumeration
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">air</code>, <code class="literal">graphhopper</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									Routing engine implementation. Defaults to <code class="literal">graphhopper</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.routing.gh-dir</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									Relative or absolute path
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">/home/user/.optaweb-vehicle-routing/graphhopper</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									The directory used by GraphHopper to store road network graphs. Defaults to <code class="literal">local/graphhopper</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.routing.osm-dir</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									Relative or absolute path
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">/home/user/.optaweb-vehicle-routing/openstreetmap</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									The directory that contains OSM files. Defaults to <code class="literal">local/openstreetmap</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">app.routing.osm-file</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									File name
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">belgium-latest.osm.pbf</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									Name of the OSM file to be loaded by GraphHopper. The file must be placed under <code class="literal">app.routing.osm-dir</code>.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">optaplanner.solver.termination.spent-limit</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									<code class="literal">java.time.Duration</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">1m</code>
										</li><li class="listitem">
											<code class="literal">150s</code>
										</li><li class="listitem">
											<code class="literal">P2dT21h</code> (<code class="literal">PnDTnHnMn.nS</code>)
										</li></ul></div>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									How long the solver should run after a location change occurs.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">server.address</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									IP address or hostname
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">10.0.0.123</code>, <code class="literal">my-vrp.geo-1.openshiftapps.com</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									Network address to which to bind the server.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45892288769696">
								<p>
									<code class="literal"><code class="literal">server.port</code></code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288768608">
								<p>
									Port number
								</p>
								</td><td align="left" valign="top" headers="idm45892288767520">
								<p>
									<code class="literal">4000</code>, <code class="literal">8081</code>
								</p>
								</td><td align="left" valign="top" headers="idm45892288766432">
								<p>
									Server HTTP port.
								</p>
								</td></tr></tbody></table></div></section></section></div><section class="appendix" id="versioning-information"><div class="titlepage"><div><div><h1 class="title">Appendix A. Versioning information</h1></div></div></div><p>
			Documentation last updated on Thursday, March 24, 2022.
		</p></section><section class="appendix" id="author-group"><div class="titlepage"><div><div><h1 class="title">Appendix B. Contact information</h1></div></div></div><p>
			Red Hat Decision Manager documentation team: <a class="link" href="mailto:brms-docs@redhat.com">brms-docs@redhat.com</a>
		</p></section><div><div xml:lang="en-US" class="legalnotice" id="idm45892287759744"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2022 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>