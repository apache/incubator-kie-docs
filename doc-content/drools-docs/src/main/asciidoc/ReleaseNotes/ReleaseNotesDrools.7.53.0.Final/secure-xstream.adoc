[id='secure-xstream']

= `BatchExecutionHelperProviderImpl.newXStreamMarshaller()` creates a secure XStream instance

Now `BatchExecutionHelperProviderImpl.newXStreamMarshaller()` creates a secure `XStream` instance. It means that the `XStream` instance accepts only pre-defined kie classes in payloads by default. If you use the `XStream` instance created by the method, you need to add allowed classes (for example, domain model classes) in your application code. Otherwise you will hit a ForbiddenClassException.

.Example code to add allowed classes
[source,java]
----
        final BatchExecutionHelperProviderImpl batchExecutionHelperProvider = new BatchExecutionHelperProviderImpl();
        XStream xstream = batchExecutionHelperProvider.newXStreamMarshaller();
        String[] allowList = new String[]{
                                          "org.example.model.Person",
                                          "org.example.model.Company"
        };
        xstream.addPermission( new WildcardTypePermission( allowList ) );
----
