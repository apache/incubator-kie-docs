[[_drools.testscenarioprevieweditor]]
= Test Scenarios (Preview)

The aim of the new Test Scenarios (Preview) editor is to help the user test the proper function of created rules and knowledge bases.
Compared with the current Test Scenarios editor, the new version is significantly enhanced by an improved user experience that introduces a tabular layout, which guides the user during the definition of a scenario template and all the assorted test cases.
Running the defined scenarios verifies that the system works as expected and does not contain any regressions after a change.

.Example Test Scenario (Preview)
image::Workbench/AuthoringAssets/sc1.png[align="center"]

The editor's layout consists of a table, which contains a header and the individual rows.
The header (test scenario template) is divided into two parts; the *given* data object fields, which represent the input information, and the *expected* data object fields, whose values are checked based on the given information and which constitute the expected result.
The rows (test scenario definitions) represent the separate test cases.

An integral part of the editor is the right panel, which can be used for configuring the data object mappings or for accessing the cheat sheet that contains a set of notes used for quick reference.

NOTE: Because the editor is currently available only as a Preview, it is disabled by default.
To enable the editor, click *Settings* -> *Roles*, select a role from the left panel, click *Editors*, and from the list of exceptions, enable *Test Scenarios (Preview)*.
Save the changes.

WARNING: The project must contain a default KieSession to retrieve a corresponding KieBase.

[[_drools.testscenariopreviewcreate]]
== Creating a Test Scenario
To create a test scenario (Preview), make sure the Test Scenarios (Preview) editor is enabled.
Click *Add Asset* in the project Library a select *Test Scenario (Preview)*.
Enter a name of the test scenario and select a package.
After you click *Ok*, the editor opens.
All test scenarios (Preview) are files with the `.scesim` file name extension.

Hereinafter, the test scenario (Preview) asset will be referred to as a test scenario for simplification.

=== Loading and Importing Data Objects

All data objects that are located in the same package as a test scenario are automatically loaded and displayed in the right *Test Tools* panel in the *Test Editor* tab.
To update the list of data objects in the panel in case the data objects change (for example when a new data object is created or a data object is deleted), the test scenario must be closed and reopened.
After you click the name of the data object in the list, its fields and their types are displayed.

.Test Tools panel
image::Workbench/AuthoringAssets/sc2.png[align="center"]

In the panel, it is possible to search the data objects using the *Search* text box. To search data object, start typing the name (or any part of the name) and press *Enter* or click the search button.

To load a data object that is located in a different package than the opened test scenario, the data object must be imported first.
To import a data object, select the *Data Objects* tab directly in the editor, click *New item* and in the *Add Import* dialog window, choose the data object from the drop-down list and click *Ok*.
After you save, close, and reopen the test scenario, the data object from a different package will be displayed in the list of all available data objects.

=== Basic Interaction Using the Contextual Menu

The contextual menu enables the user to perform basic operations on the table such as adding, deleting, and duplicating rows and columns.
To perform such interaction with the table, right-click on its any part.

.Contextual menu of a row
image::Workbench/AuthoringAssets/sc3.png[align="center"]

Based on the part of the table you select, different operations are available:

.Contextual Menu Options
[cols="1,2,3"]
|===
| Table part | Cell label | Available options

.3+^.^| Header
.^| OTHER and Description
.^| insert top row, insert bottom row

.^| GIVEN and EXPECTED
.^| insert leftmost column, insert rightmost column, insert top row, insert bottom row


.^| GIVEN 1, 2, etc. and EXPECTED 3, 4, etc.
.^| insert column left, insert column right, delete column, insert top row, insert bottom row

^.^| Rows
.^| --
.^| insert column left, insert column right, delete column, insert top row, insert bottom row, insert row above, insert row below, duplicate row, delete row
|===


.Description of Table Interactions
[cols="1,2"]
|===
| Interaction | Description

.^| _insert top row_
.^| Inserts a new row to the very top of the table.

.^| _insert bottom row_
.^| Inserts a new row to the very bottom of the table.

.^| _insert leftmost column_
.^| Inserts a new leftmost column of either the GIVEN part, or the EXPECTED part (based on the user's selection).

.^| _insert rightmost column_
.^| Inserts a new rightmost column of either the GIVEN part, or the EXPECTED part (based on the user's selection).

.^| _insert column left_
.^| Inserts a new column to the left of the selected column. The new column will be of the same type as the selected column (GIVEN or EXPECTED).

.^| _insert column right_
.^| Inserts a new column to the right of the selected column. The new column will be of the same type as the selected column (GIVEN or EXPECTED).

.^| _delete column_
.^| Deletes the selected column.

.^| _insert row above_
.^| Inserts a new row above the selected row.

.^| _insert row below_
.^| Inserts a new row below the selected row.

.^| _duplicate row_
.^| Duplicates the selected row.

.^| _delete row_
.^| Deletes the selected row.
|===


[[_drools.testscenariopreviewtemplate]]
== Test Scenario Template

The header of the grid define the template for each scenarios. Each column is mapped to a field of a data object both
in Given and Expected sections. Use contextual menu to add all the columns needed, then right click on the cell in
the header to open the right panel and define the mapping: *Select Data Object* component is used for that.

A Cheat Sheet is also available in the right panel to access notes and quick overview of supported commands

[[_drools.testscenariopreviewscenario]]
== Test Scenario Definition

Use contextual menu to add/remove scenarios. A scenario is defined by a description and by a set of input values (Given)
and a set of output values to be verified (Expected). Inline editing is available for each cell using a double click on
it

[[_drools.testscenariopreviewrun]]
== Running a Test Scenario

To run a test scenario, click *Run Test* at the top of the Test Scenarios (Preview) editor.
The *Reporting* panel opens at the bottom of the editor with the test results; a red bar indicates test failures, while a green bar indicates that all tests were successful.
In the table below the bar and the information about the number of run tests and duration, detailed failure stack traces are displayed.

.Reporting panel
image::Workbench/AuthoringAssets/sc4.png[align="center"]
