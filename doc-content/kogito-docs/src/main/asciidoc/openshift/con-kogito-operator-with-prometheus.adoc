[id='con-kogito-operator-with-prometheus_{context}']
= {PRODUCT} Operator interaction with Prometheus

When you deploy a {PRODUCT} service uses the `monitoring-prometheus-addon` add-on to enable Prometheus metrics monitoring and https://github.com/coreos/prometheus-operator[Prometheus Operator] already installed, the {PRODUCT} Operator creates a `ServiceMonitor` custom resource to expose the metrics for Prometheus to scrape:

.Example `ServiceMonitor` resource for Prometheus
[source,yaml]
----
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  labels:
    app: onboarding-service
  name: onboarding-service
  namespace: kogito
spec:
  endpoints:
  - path: /metrics
    targetPort: 8080
    scheme: http
  namespaceSelector:
    matchNames:
    - kogito
  selector:
    matchLabels:
      app: onboarding-service
----

You must manually configure your `Prometheus` custom resource that is managed by the Prometheus Operator to select the `ServiceMonitor` resource:

.Example `Prometheus` resource
[source,yaml]
----
apiVersion: monitoring.coreos.com/v1
kind: Prometheus
metadata:
  name: prometheus
spec:
  serviceAccountName: prometheus
  serviceMonitorSelector:
    matchLabels:
      app: onboarding-service
----

After you configure your Prometheus resource with the `ServiceMonitor` resource, you can see the endpoint being scraped by Prometheus in the **Targets** page of the Prometheus web console:

image::kogito/openshift/kogito-operator-prometheus-targets.png[Image of Kogito service targets view in Prometheus]

The metrics exposed by the {PRODUCT} service appear in the **Graph** view:

image::kogito/openshift/kogito-operator-prometheus-graph.png[Image of Kogito service graph view in Prometheus]

.Additional resources
ifdef::KOGITO[]
* {URL_CONFIGURING_KOGITO}#proc-prometheus-metrics-monitoring_kogito-configuring[Enabling Prometheus metrics monitoring in {PRODUCT}]
endif::[]
ifdef::KOGITO-COMM[]
* xref:proc-prometheus-metrics-monitoring_kogito-configuring[]
endif::[]
* https://github.com/coreos/prometheus-operator/blob/master/Documentation/user-guides/getting-started.md[Prometheus Operator]
