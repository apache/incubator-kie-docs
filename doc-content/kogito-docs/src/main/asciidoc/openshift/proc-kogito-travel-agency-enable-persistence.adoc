[id='proc-kogito-travel-agency-enable-persistence_{context}']
= Installing the Infinispan persistence infrastructure for {PRODUCT} services on OpenShift

{PRODUCT} supports runtime persistence for process data in your services. {PRODUCT} persistence is based on https://infinispan.org/[Infinispan] and enables you to configure key-value storage definitions to persist data, such as active nodes and process instance variables, so that the data is preserved across application restarts.

The {PRODUCT} Operator uses the https://github.com/infinispan/infinispan-operator[Infinispan Operator] to deploy the Infinispan infrastructure in a {PRODUCT} project. For optimal {PRODUCT} deployment on OpenShift, install the Infinispan Operator and enable Inifinispan persistence for your {PRODUCT} services. You can install the Infinispan infrastructure using the {PRODUCT} Operator page in the OpenShift web console or using the {PRODUCT} CLI.

This example uses the {PRODUCT} CLI to install the Infinispan infrastructure and the {PRODUCT} Operator page in the web console to verify that the infrastructure is enabled.

[NOTE]
====
Instead of explicitly enabling Infinispan persistence, you can enable the {PRODUCT} Data Index Service to automatically generate the required Infinispan infrastructure for the {PRODUCT} services. However, for the first {PRODUCT} services that you deploy, consider following this procedure to create your infrastructure manually and to better understand {PRODUCT} deployment features.

For information about enabling the Data Index Service, see xref:proc-kogito-travel-agency-enable-data-index_kogito-deploying-on-openshift[].
====

.Prerequisites
* The https://github.com/infinispan/infinispan-operator[Infinispan Operator] is installed in the same OpenShift namespace as your {PRODUCT} project. You can install the Infinispan Operator using the *Operators* -> *OperatorHub* page in the OpenShift web console or manually as described in the https://infinispan.org/infinispan-operator/master/operator.html[Infinispan Operator Guide].

.Procedure
. In a command terminal, enter the following command to install the Infinispan infrastructure for the {PRODUCT} services:
+
.Installing Infinispan infrastructure
[source]
----
$ kogito install infinispan
----
. In the OpenShift web console, use the left menu to navigate to the following windows to verify the installed Infinispan infrastructure:

* *Operators* -> *Installed Operators* -> *{PRODUCT}* -> *{PRODUCT} Infra*: A new `kogito-infra` custom resource is listed.
+
.{PRODUCT} infrastructure resource for Infinispan
image::kogito/openshift/kogito-ocp-infra.png[Image of Kogito Infras page in web console]
* *Operators* -> *Installed Operators* -> *Infinispan* -> *Infinispan Cluster*: A new `kogito-infinispan` custom resource is listed.
+
.Infinispan cluster resource
image::kogito/openshift/kogito-ocp-infinispan-infra.png[Image of Infinispan Cluster page in web console]
* *Workloads* -> *Stateful Sets*: A new `kogito-infinispan` stateful set is deployed.
+
.Stateful set for Infinispan
image::kogito/openshift/kogito-ocp-stateful-sets-infinispan.png[Image of Stateful Sets page in web console]
