[id='proc-kogito-travel-agency-enable-messaging_{context}']
= Installing the Kafka messaging infrastructure for {PRODUCT} services on OpenShift

{PRODUCT} supports the https://github.com/eclipse/microprofile-reactive-messaging[MicroProfile Reactive Messaging] specification for messaging in your services. {PRODUCT} messaging is based on https://kafka.apache.org/[Apache Kafka] and enables you to configure messages as either input or output of business process execution.

The {PRODUCT} Operator uses the https://strimzi.io/[Strimzi Operator] to deploy and manage the Kafka infrastructure in a {PRODUCT} project. For optimal {PRODUCT} deployment on OpenShift, install the Strimzi Operator and enable Kafka messaging for your {PRODUCT} services. You can install the Kafka infrastructure using the {PRODUCT} Operator page in the OpenShift web console or using the {PRODUCT} CLI.

This example uses the {PRODUCT} CLI to install the Kafka infrastructure and the {PRODUCT} Operator page in the web console to verify that the infrastructure is enabled.

[NOTE]
====
Instead of explicitly enabling Kafka messaging, you can enable the {PRODUCT} Data Index Service to automatically generate the required Kafka infrastructure for the {PRODUCT} services. However, for the first {PRODUCT} services that you deploy, consider following this procedure to create your infrastructure manually and to better understand {PRODUCT} deployment features.

For information about enabling the Data Index Service, see xref:proc-kogito-travel-agency-enable-data-index_kogito-deploying-on-openshift[].
====

.Prerequisites
* The https://strimzi.io/[Strimzi Operator] is installed in the same OpenShift namespace as your {PRODUCT} project. You can install the Strimzi Operator using the *Operators* -> *OperatorHub* page in the OpenShift web console or manually as described in the https://strimzi.io/docs/operators/master/quickstart.html[Strimzi Quick Start guide].

.Procedure
. In a command terminal, enter the following command to install the Kafka infrastructure for the {PRODUCT} services:
+
.Installing Kafka infrastructure
[source]
----
$ kogito install kafka
----
. In the OpenShift web console, use the left menu to navigate to the following windows to verify the installed Kafka infrastructure:

* *Operators* -> *Installed Operators* -> *{PRODUCT}* -> *{PRODUCT} Infra*: Select the `kogito-infra` custom resource and note that the *Install Kafka* option is enabled.
+
.Kafka enabled
image::kogito/openshift/kogito-ocp-infra-kafka.png[Image of Kogito infra details in web console]
* *Operators* -> *Installed Operators* -> *Strimzi* -> *Kafka*: A new `kogito-kafka` custom resource is listed.
+
.Kafka custom resource
image::kogito/openshift/kogito-ocp-kafka-infra.png[Image of Kafkas page in web console]
* *Workloads* -> *Stateful Sets*: New `kogito-kafka-kafka` and `kogito-kafka-zookeeper` stateful sets are deployed.
+
.Stateful sets for Kafka
image::kogito/openshift/kogito-ocp-stateful-sets-kafka.png[Image of Stateful Sets page in web console]
