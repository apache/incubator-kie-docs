<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>{PRODUCT} Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="paragraph">
<p>Unresolved directive in index.adoc - include::{artifact-dir}/document-attributes.adoc[]</p>
</div>
<h1 id="_product_documentation" class="sect0">{PRODUCT} Documentation</h1>
<div class="paragraph">
<p>The {PRODUCT} Community <a href="https://kogito.kie.org/community/" class="bare">https://kogito.kie.org/community/</a>
:context: kogito-docs
:doctype: book
:title-logo-image: <span class="image"><img src="logos/kogitoLogo.png" alt="kogitoLogo"></span>
:toc: left
:toclevels: 3
:sectnums:
:sectanchors:
:sectlinks:
:sectnumlevels: 4
:icons: font
:docinfo:
:experimental:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="logos/kogitoLogo.png" alt="kogitoLogo">
</div>
</div>
<h1 id="_welcome" class="discrete">Welcome</h1>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>{PRODUCT} is currently in early stages of development. {PRODUCT} releases contain features and APIs that might not be fully tested and that might change in future versions. Users are discouraged from using {PRODUCT} software in production or for business-critical workloads.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect1">
<h2 id="con-kogito-automation_{context}">{PRODUCT} business automation</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>{PRODUCT} is a cloud-native business automation technology for building cloud-ready business applications. The name <em>Kogito</em> derives from the Latin "Cogito", as in "Cogito, ergo sum" ("I think, therefore I am"), and is pronounced <code>[ˈkoː.d͡ʒi.to]</code> (<em>KO-jee-to</em>). The letter <em>K</em> has reference to Kubernetes, the base for {OPENSHIFT} as the target cloud platform for {PRODUCT}, and to the Knowledge Is Everything (KIE) open source business automation project from which {PRODUCT} originates.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} is designed specifically to excel in a hybrid cloud environment and to be adaptable to your domain and tooling needs. The core objective of {PRODUCT} is to help you mold a set of business processes and decisions into your own domain-specific cloud-native set of services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-assets-to-cloud_enterprise.png" alt="Image of business assets moving to cloud services">
</div>
<div class="title">Figure 1. Business processes and decisions to cloud services</div>
</div>
<div class="paragraph">
<p>When you are using {PRODUCT}, you are building a cloud-native application as a set of independent domain-specific services, collaborating to achieve some business value. The processes and decisions that you use to describe the target behavior are executed as part of the services that you create. The resulting services are highly distributed and scalable with no centralized orchestration service, and the runtime that your service uses is optimized for what your service needs.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} includes components that are based on well-known business automation KIE projects, specifically <a href="https://drools.org">Drools</a>, <a href="https://jbpm.org">jBPM</a>, and <a href="https://optaplanner.org">OptaPlanner</a>, to offer dependable, open source solutions for business rules, business processes, and constraint solving.</p>
</div>
<div class="sect2">
<h3 id="_cloud_first_priority">Cloud-first priority</h3>
<div class="paragraph">
<p>{PRODUCT} is designed to run and scale on a cloud infrastructure. You can use {PRODUCT} with the latest cloud-based technologies, such as Quarkus, Knative, and Apache Kafka, to get fast boot times and instant scaling on container application platforms, such as {OPENSHIFT}.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-related-technolgies_enterprise.png" alt="Image of cloud-based technologies">
</div>
<div class="title">Figure 2. Technologies used with {PRODUCT}</div>
</div>
<div class="paragraph">
<p>For example, {PRODUCT} is compatible with the following technologies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>{OPENSHIFT}</strong>, based on Kubernetes, is the target platform for building and managing containerized applications.</p>
</li>
<li>
<p><strong>Quarkus</strong> is the new native Java stack for Kubernetes that you can use when you build applications with {PRODUCT} services.</p>
</li>
<li>
<p><strong>Spring Boot</strong> is also supported with {PRODUCT} if you need to use the Spring Framework with {PRODUCT}.</p>
</li>
<li>
<p><strong>GraalVM</strong> with Quarkus enables you to use native compilation with {PRODUCT}, resulting in fast start-up times and minimal footprint. For example, a native {PRODUCT} service starts in about 0.003ms, about 100 times faster than a non-native start-up. Fast start-up is almost a necessity in a cloud ecosystem, especially if you need small serverless applications.</p>
</li>
<li>
<p><strong>Knative</strong> enables you to build serverless applications with {PRODUCT} that you can scale up or down (to zero) as needed.</p>
</li>
<li>
<p><strong>Prometheus</strong> and <strong>Grafana</strong> are compatible with {PRODUCT} services for monitoring and analytics with optional extensions.</p>
</li>
<li>
<p><strong>Kafka</strong>, <strong>Infinispan</strong>, and <strong>Keycloak</strong> are also some of the middleware technologies that {PRODUCT} supports for messaging, persistence, and security.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_domain_specific_flexibility">Domain-specific flexibility</h3>
<div class="paragraph">
<p>{PRODUCT} adapts to your business domain instead of forcing you to modify your domain to work with {PRODUCT}. You can expose your {PRODUCT} services with domain-specific APIs, based on the processes and decisions that you have defined. Domain-specific APIs for {PRODUCT} services do not require third-party or internal APIs.</p>
</div>
<div class="paragraph">
<p>For example, a process for onboarding employees could generate remote REST API endpoints that you can use to onboard new employees or get information on their status, all using domain-specific JSON data.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-domain-api-endpoints-example.png" alt="Image of REST API endpoints in Swagger UI">
</div>
<div class="title">Figure 3. Example custom API endpoints in Swagger</div>
</div>
<div class="paragraph">
<p>You can also expose domain-specific data through events or in a data index so that the data can be consumed and queried by other services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_developer_centered_experience">Developer-centered experience</h3>
<div class="paragraph">
<p>Another focus of {PRODUCT} is optimal developer experience. You can use much or all of your existing tooling and workflow to develop, build, and deploy {PRODUCT} services, whether locally for testing or into the cloud. Quarkus offers development mode features to help with local testing, such as live reload of your processes and decisions in your running applications for advanced debugging.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} tooling is embeddable so that you can continue using the workflow you already use for cloud-native services. For example, the <strong>{PRODUCT} Bundle</strong> VSCode extension enables you to edit your Business Process Model and Notation (BPMN) 2.0 business processes and Decision Model and Notation (DMN) decision models directly in your VSCode IDE, next to your other application code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-run-quarkus-devmode-demo.gif" alt="Demo of {PRODUCT} BPMN2 extension in VSCode">
</div>
<div class="title">Figure 4. Building a {PRODUCT} process service in VSCode</div>
</div>
<div class="paragraph">
<p>To deploy your services into the cloud, you can use the {URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-operator-and-cli_kogito-deploying-on-openshift[{PRODUCT} Operator], which guides you through every step. The {PRODUCT} Operator is based on the <a href="https://sdk.operatorframework.io/">Operator SDK</a> and automates many of the deployment steps for you. For example, when you give the operator a link to the Git repository that contains your application, the operator can automatically configure the components required to build your project from source and deploy the resulting services. {PRODUCT} also offers a command-line interface (CLI) to simplify some of these deployment tasks.</p>
</div>
</div>
<div class="sect2">
<h3 id="con-kogito-quarkus-springboot_{context}">{PRODUCT} on Quarkus and Spring Boot</h3>
<div class="paragraph _abstract">
<p>The primary Java frameworks that {PRODUCT} supports are Quarkus (recommended) and Spring Boot.</p>
</div>
<div class="paragraph">
<p><a href="https://quarkus.io/">Quarkus</a> is a Kubernetes-native Java framework with a container-first approach to building Java applications, especially for Java virtual machines (JVMs) such as GraalVM and HotSpot. Quarkus optimizes Java specifically for Kubernetes by reducing the size of both the Java application and container image footprint, eliminating some of the Java programming workload from previous generations, and reducing the amount of memory required to run those images.</p>
</div>
<div class="paragraph">
<p>For {PRODUCT} services, Quarkus is the preferred framework for optimal Kubernetes compatibility and enhanced developer features, such as live reload in development mode for advanced debugging.</p>
</div>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-boot">Spring Boot</a> is a Java-based framework for building standalone production-ready Spring applications. Spring Boot enables you to develop Spring applications with minimal configurations and without an entire Spring configuration setup.</p>
</div>
<div class="paragraph">
<p>For {PRODUCT} services, Spring Boot is supported for developers who need to use {PRODUCT} in an existing Spring Framework environment.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-kogito-creating-running">Creating and running your first {PRODUCT} services</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a developer of business processes and decisions, you can use {PRODUCT} business automation to build  cloud-native applications that adapt to your business domain and tooling.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>JDK 11 or later is installed.</p>
</li>
<li>
<p>Apache Maven 3.6.2 or later is installed.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="ref-kogito-app-examples_kogito-creating-running">Example applications with {PRODUCT} services</h3>
<div class="paragraph _abstract">
<p>{PRODUCT} includes example applications in the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub. These example applications contain various types of {PRODUCT} services on Quarkus or Spring Boot to help you develop your own applications. The services use one or more Business Process Model and Notation (BPMN) process models, Decision Model and Notation (DMN) decision models, Drools Rule Language (DRL) rule units, XLS spreadsheet decision tables, or Java classes to define the service logic.</p>
</div>
<div class="paragraph">
<p>For information about each example application and instructions for using them, see the <code>README</code> file in the relevant application folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In the <a href="https://github.com/kiegroup/kogito-examples"><code>{PRODUCT_INIT}-examples</code></a> repository in GitHub, the example applications in the default <code>stable</code> branch use the latest version of {PRODUCT}.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following list describes some of the examples provided with {PRODUCT}:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Decision services</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>dmn-quarkus-example</code> and <code>dmn-springboot-example</code>: A decision service (on Quarkus or Spring Boot) that uses DMN to determine driver penalty and suspension based on traffic violations.</p>
</li>
<li>
<p><code>rules-quarkus-helloworld</code>: A Hello World decision service on Quarkus with a single DRL rule unit.</p>
</li>
<li>
<p><code>ruleunit-quarkus-example</code> and <code>ruleunit-springboot-example</code>: A decision service (on Quarkus or Spring Boot) that uses DRL with rule units to validate a loan application and that exposes REST operations to view application status.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Decision services that use the {PRODUCT} Trusty Service and Explainability Service</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>dmn-tracing-quarkus</code>: A DMN decision service on Quarkus that uses the <code>tracing-decision-quarkus-addon</code> add-on to generate tracing events that the {PRODUCT} Trusty Service and Explainability Service can consume and expose.</p>
</li>
<li>
<p><code>trusty-demonstration</code>: A tutorial for deploying the <code>dmn-tracing-quarkus</code> example application on Kubernetes as a demonstration of {PRODUCT} Trusty Service and Explainability Service capabilities in a cloud environment.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>process-quarkus-example</code> and <code>process-springboot-example</code>: A process service (on Quarkus or Spring Boot) for ordering items and that exposes REST operations to create new orders or to list and delete active orders.</p>
</li>
<li>
<p><code>onboarding-example</code>: A combination of a process service and two decision services that use DMN and DRL for onboarding new employees.</p>
</li>
<li>
<p><code>flexible-process-quarkus</code> and <code>flexible-process-springboot</code>: A process service (on Quarkus or Spring Boot) that uses flexible processes for case management in {PRODUCT}.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services that use {PRODUCT_OP}</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>process-optaplanner-quarkus</code> and <code>process-optaplanner-springboot</code>: A process service (on Quarkus or Spring Boot) that uses {PRODUCT_OP} to optimize airline flight schedules and seat assignments. For information about {PRODUCT_OP} integration with {PRODUCT}, see the <a href="https://docs.optaplanner.org/latestFinal/optaplanner-docs/html_single/index.html#integrationWithQuarkus">{PRODUCT_OP} documentation</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services for OpenShift deployment</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>kogito-travel-agency</code>: A combination of process services and decision services that use DRL and XLS for travel booking, intended for deployment on {OPENSHIFT}.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Serverless Workflow services</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>serverless-workflow-greeting-quarkus</code> and <code>serverless-workflow-greeting-springboot</code>: A Serverless Workflow greeting service with both JSON and YAML workflow definitions.</p>
</li>
<li>
<p><code>serverless-workflow-service-calls-quarkus</code> and <code>serverless-workflow-service-calls-springboot</code>: A Serverless Workflow service for returning country information.</p>
</li>
<li>
<p><code>serverless-workflow-events-quarkus</code>: A Serverless Workflow service for processing job applicant approvals and that showcases event-driven services.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="proc-kogito-app-examples-running_kogito-creating-running">Running the {PRODUCT} example applications</h4>
<div class="paragraph _abstract">
<p>To get started quickly with {PRODUCT}, you can run any of the example applications in the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub and experiment with the {PRODUCT} services.</p>
</div>
<div class="paragraph">
<p>For this procedure, use the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-quarkus-example"><code>process-quarkus-example</code></a> or <a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-springboot-example"><code>process-springboot-example</code></a> application. You can follow similar steps with the other {PRODUCT} examples on Quarkus or Spring Boot.</p>
</div>
<div class="paragraph">
<p>In the <code>process-quarkus-example</code> and <code>process-springboot-example</code> applications, the <code>orders.bpmn2</code> process describes the steps that need to be followed when ordering items. The process includes a script task for writing debug information and a call activity for invoking a subprocess, using a custom <code>Order</code> data object.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/bpmn-model-example-orders.png" alt="Image of `orders.bpmn` example process">
</div>
<div class="title">Figure 5. Example <code>orders.bpmn2</code> process</div>
</div>
<div class="paragraph">
<p>The <code>Add items</code> subprocess invokes the following <code>orderItems.bpmn2</code> process, which uses a <code>CalculationService.calculateTotal</code> custom Java service and a user task to verify the order.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/bpmn-model-example-order-items.png" alt="Image of `orderItems.bpmn` example process">
</div>
<div class="title">Figure 6. Example <code>orderItems.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>The <code>persons.bpmn2</code> process invokes a Drools Rule Languge (DRL) rule unit in a business rule task to determine customer age, followed by a user task for special handling requirements for children, if applicable.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of `persons` process diagram">
</div>
<div class="title">Figure 7. Example <code>persons.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>Based on these processes and on application configurations, this example service exposes REST operations to create new orders, to list and delete active orders, and to determine the age of a specified person.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the latest <a href="https://github.com/kiegroup/kogito-examples/releases"><code>kogito-examples</code></a> release to a local directory and extract the file.</p>
</li>
<li>
<p>In a command terminal, navigate to the extracted <code>kogito-examples-<em>RELEASE</em>/process-<em>PLATFORM</em>-example</code> folder, and enter one of the following commands to build and run the example.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Quarkus and Spring Boot support the following run modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Development mode</strong>: For local testing. On Quarkus, development mode also offers live reload of your processes and decisions in your running applications for advanced debugging.</p>
</li>
<li>
<p><strong>JVM mode</strong>: For compatibility with a Java virtual machine (JVM).</p>
</li>
<li>
<p><strong>Native mode</strong>: (Quarkus only, requires GraalVM) For direct binary execution as native code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command that you use depends on your preferred run mode and application environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For development mode:</p>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p>For JVM mode:</p>
<div class="listingblock">
<div class="title">On Quarkus and Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/sample-kogito-1.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
</li>
<li>
<p>For native mode (requires GraalVM):</p>
<div class="listingblock">
<div class="title">On Quarkus only</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative
$ ./target/sample-kogito-1.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>After the {PRODUCT} service is running, use a REST client, curl utility, or the Swagger UI configured for the application at <a href="http://localhost:8080/swagger-ui/" class="bare">http://localhost:8080/swagger-ui/</a> to send API requests with the following components:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>URL</strong>: <code>http://localhost:8080/</code></p>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> and <code>PUT</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, <code>PUT</code> or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example POST request body to create an order (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "approver": "john",
  "order": {
    "orderNumber": "12345",
    "shipped": false
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to create an order</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json' -d '{"approver" : "john", "order" : {"orderNumber" : "12345", "shipped" : false}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "approver": "john",
  "id": "6b53c227-6d5e-40b7-8c8c-a541a2a47d58",
  "order": {
    "orderNumber": "12345",
    "shipped": false,
    "total": 0.3845152065899532
  }
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-swagger-example-jbpm.png" alt="Image of Swagger UI for example application">
</div>
<div class="title">Figure 8. Swagger UI to interact with all application endpoints (http://localhost:8080/swagger-ui/)</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For the predefined {PRODUCT} example applications, the Swagger UI for interacting with service endpoints is available only on Quarkus examples that you run in
development mode or in native mode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This example procedure uses the following curl commands for convenience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an order:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json' -d '{"approver" : "john", "order" : {"orderNumber" : "12345", "shipped" : false}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"approver":"john","id":"6b53c227-6d5e-40b7-8c8c-a541a2a47d58","order":{"orderNumber":"12345","shipped":false,"total":0.3845152065899532}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new order has an <code>"id"</code> field with a generated UUID that you can use to retrieve details about this specific order, if needed.</p>
</div>
</li>
<li>
<p>View active orders:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>[{"approver":"john","id":"6b53c227-6d5e-40b7-8c8c-a541a2a47d58","order":{"orderNumber":"12345","shipped":false,"total":0.3845152065899532}}]</code></pre>
</div>
</div>
</li>
<li>
<p>View order details using the returned UUID:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orders/6b53c227-6d5e-40b7-8c8c-a541a2a47d58 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"approver":"john","id":"6b53c227-6d5e-40b7-8c8c-a541a2a47d58","order":{"orderNumber":"12345","shipped":false,"total":0.3845152065899532}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You use the <code>"id"</code> value for the order that was returned when you created the order or when you retrieved active orders.</p>
</div>
</li>
<li>
<p>Cancel the order using the returned UUID:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE http://localhost:8080/orders/6b53c227-6d5e-40b7-8c8c-a541a2a47d58 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-kogito-modelers_kogito-creating-running">{PRODUCT} BPMN and DMN modelers</h3>
<div class="paragraph _abstract">
<p>{PRODUCT} provides the following extensions or applications that you can use to design Business Process Model and Notation (BPMN) process models and Decision Model and Notation (DMN) decision models for your {PRODUCT} services using graphical modelers.</p>
</div>
<div class="paragraph">
<p>For convenience, all {PRODUCT} BPMN and DMN modelers are available in the <a href="https://kiegroup.github.io/kogito-online/#/download">Business Modeler Hub</a> desktop application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>{PRODUCT} VSCode extension</strong>: (Recommended) Enables you to view and design BPMN models, DMN models, and test scenario files in Visual Studio Code (VSCode). The VSCode extension in the {PRODUCT} Business Modeler Hub requires VSCode 1.46.0 or later.</p>
<div class="paragraph">
<p>To install the {PRODUCT} VSCode extension directly in VSCode without the {PRODUCT} Business Modeler Hub, select the <strong>Extensions</strong> menu option in VSCode and search for and install the <strong>{PRODUCT} Bundle</strong> extension.</p>
</div>
</li>
<li>
<p><strong>{PRODUCT} GitHub Chrome extension</strong>: Enables you to view and design BPMN and DMN models in GitHub repositories in Google Chrome.</p>
<div class="paragraph">
<p>To install the {PRODUCT} GitHub Chrome extension without the {PRODUCT} Business Modeler Hub, you can download and extract the <code>chrome_extension_kogito_kie_editors<em>_VERSION</em>.zip</code> file from the <a href="https://github.com/kiegroup/kogito-tooling/releases"><code>kogito-tooling</code></a> releases page in GitHub, and then in the upper-right corner in Chrome, go to <strong>Customize and control</strong> &#8594; <strong>Settings</strong> &#8594; <strong>Extensions</strong> &#8594; <strong>Load unpacked</strong> and open the extracted <code>dist</code> folder.</p>
</div>
</li>
<li>
<p><strong>Business Modeler desktop application</strong>: Enables you to view and design BPMN and DMN models locally.</p>
<div class="paragraph">
<p>To run the {PRODUCT} Business Modeler desktop application without the {PRODUCT} Business Modeler Hub, you can download and extract the <code>business_modeler_preview<em>_RELEASE</em>.zip</code> file from the <a href="https://github.com/kiegroup/kogito-tooling/releases"><code>kogito-tooling</code></a> releases page in GitHub, and then follow the instructions in the application <code>README</code> file to run the application on your specific operating system.</p>
</div>
</li>
<li>
<p><strong>Business Modeler online viewer</strong>: Enables you to view and design BPMN and DMN models online at <code><a href="https://kiegroup.github.io/kogito-online/" class="bare">https://kiegroup.github.io/kogito-online/</a></code>. The online modeler supports the <code>.new</code> format, so you can also enter <code>bpmn.new</code> or <code>dmn.new</code> in a web browser to start designing a new BPMN or DMN model in the online modeler.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="proc-kogito-modelers_kogito-creating-running">Installing and using the {PRODUCT} Business Modeler Hub</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a <a href="https://kiegroup.github.io/kogito-online/#/download">Business Modeler Hub</a> desktop application with all {PRODUCT} extensions or applications for modeling Business Process Model and Notation (BPMN) process models and Decision Model and Notation (DMN) decision models in {PRODUCT} services. {PRODUCT} currently provides extensions for VSCode (recommended) and GitHub modelers, a desktop application for offline modeling, and an online modeler.</p>
</div>
<div class="paragraph">
<p>As you develop {PRODUCT} services, you can use the {PRODUCT} Business Modeler Hub to install, launch, or uninstall the available modeling extensions or applications as needed.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a web browser, go to the <a href="https://kiegroup.github.io/kogito-online/#/download">Business Modeler Hub</a> download page, select the relevant <strong>Operating System</strong> option, and click <strong>Download</strong>.</p>
</li>
<li>
<p>Extract the downloaded <code>business_modeler_hub_preview<em>_RELEASE</em></code> binary file to a local directory.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>On Linux: In a command terminal, navigate to the directory where you downloaded the <code>business_modeler_hub_preview<em>_RELEASE</em></code> binary file and enter the following command to extract the contents:</p>
<div class="listingblock">
<div class="title">Extract the {PRODUCT} Business Modeler Hub distribution</div>
<div class="content">
<pre class="highlight"><code>$ tar -xzpf business_modeler_hub_preview<em>_RELEASE</em>.tar.gz</code></pre>
</div>
</div>
</li>
<li>
<p>On Windows or Mac: In your file browser, navigate to the directory where you downloaded the <code>business_modeler_hub_preview<em>_RELEASE</em></code> binary file and extract the ZIP file.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In a command terminal, navigate to the extracted <code>business_modeler_hub_preview<em>_RELEASE</em></code> folder and enter the following command to run the application:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Run the {PRODUCT} Business Modeler Hub application</div>
<div class="content">
<pre class="highlight"><code>$ cd <em>PATH_TO_MODELER_HUB</em>
$ ./Business\ Modeler\ Hub\ Preview-<em>RELEASE</em>/Business\ Modeler\ Hub\ Preview</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>Business Modeler Hub</strong> opens in a new window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-modeler-hub.png" alt="Image of Business Modeler Hub">
</div>
<div class="title">Figure 9. {PRODUCT} Business Modeler Hub window</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the <strong>Business Modeler Hub</strong> window does not appear, review the <code>README</code> documentation in the Business Modeler Hub application folder for any details specific to your operating system.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the {PRODUCT} Business Modeler Hub to install, launch, or uninstall the available extensions or applications as needed.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-vscode-extension_kogito-creating-running">Installing the {PRODUCT} VSCode extension bundle without the {PRODUCT} Business Modeler Hub</h4>
<div class="paragraph _abstract">
<p>Although you can install and launch the {PRODUCT} Visual Studio Code (VSCode) extension from the <a href="https://kiegroup.github.io/kogito-online/#/download">Business Modeler Hub</a> desktop application, along with all other available {PRODUCT} modelers, you can also install {PRODUCT} VSCode extensions from Visual Studio Marketplace directly in VSCode.</p>
</div>
<div class="paragraph">
<p>VSCode is the preferred integrated development environment (IDE) for developing {PRODUCT} services. {PRODUCT} provides a <strong>{PRODUCT} Bundle</strong> VSCode extension that enables you to design Decision Model and Notation (DMN) decision models, Business Process Model and Notation (BPMN) 2.0 business processes, and test scenarios directly in VSCode. {PRODUCT} also provides individual <strong>DMN Editor</strong> and <strong>BPMN Editor</strong> VSCode extensions for DMN or BPMN support only, if needed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a> 1.46.0 or later is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, select the <strong>Extensions</strong> menu option and search for <strong>{PRODUCT} Bundle</strong> for DMN, BPMN, and test scenario file support.</p>
<div class="paragraph">
<p>For DMN or BPMN file support only, you can also search for the individual <strong>DMN Editor</strong> or <strong>BPMN Editor</strong> extensions.</p>
</div>
</li>
<li>
<p>When the {PRODUCT} extension appears in the extension list in VSCode, select it and click <strong>Install</strong>.</p>
</li>
<li>
<p>For optimal VSCode editor behavior, after the extension installation is complete, reload or close and re-launch your instance of VSCode.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you install the VSCode extension bundle, any <code>.dmn</code> or <code>.bpmn2</code> files that you open in VSCode are automatically displayed as graphical models. Additionally, any <code>.scesim</code> files that you open are automatically displayed as tabular test scenario models for testing the functionality of your business decisions.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN, BPMN, or test scenario modelers open only the XML source of a DMN, BPMN, or test scenario file and displays an error message, review the reported errors and the model file to ensure that all elements are correctly defined.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For new DMN or BPMN models, you can also enter <code>dmn.new</code> or <code>bpmn.new</code> in a web browser to design your DMN or BPMN model in the {PRODUCT} online modeler. When you finish creating your model, you can click <strong>Download</strong> in the online modeler page to import your DMN or BPMN file into your {PRODUCT} project in VSCode.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-creating-project_kogito-creating-running">Creating a Maven project for a {PRODUCT} service</h3>
<div class="paragraph _abstract">
<p>Before you can begin developing {PRODUCT} services, you need to create a Maven project where you can build your {PRODUCT} assets and any other related resources for your application.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to a local folder where you want to store the new {PRODUCT} project.</p>
</li>
<li>
<p>Enter the following command to generate a project within a defined folder:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-quarkus-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion={PRODUCT_VERSION_LONG} \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-springboot-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion={PRODUCT_VERSION_LONG} \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a <code>sample-kogito</code> Maven project and imports the {PRODUCT} extension for all required dependencies and configurations to prepare your application for business automation.</p>
</div>
</div>
</div>
</li>
<li>
<p>Open or import the project in your VSCode IDE to view the contents.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="proc-kogito-creating-project-custom_kogito-creating-running">Creating a custom {PRODUCT} project using code scaffolding</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This feature is experimental and might be substantially modified or removed in a future release. This feature also requires a special project setup. The generated code uses APIs that in {PRODUCT} are not final and will not function the same way in future releases.
</td>
</tr>
</table>
</div>
<div class="paragraph _abstract">
<p>The Quarkus extension and Maven plug-in within a standard {PRODUCT} project generate all the required code and boilerplate for your {PRODUCT} services so that you do not have to write the project setup code yourself. By default, a {PRODUCT} project generates a REST service from business assets automatically. The generated service usually exposes default REST endpoints using the information that is inferred from the business assets that you include in your project.</p>
</div>
<div class="paragraph">
<p>If you want to customize the code for your {PRODUCT} project, such as adding more REST endpoints, you can use <em>code scaffolding</em> to generate the project code to a specified user directory and then modify the code as needed.</p>
</div>
<div class="paragraph">
<p>With code scaffolding, you generate your {PRODUCT} project with the {PRODUCT} Maven archetype as usual, but you disable the project ability to automatically regenerate the project code and explicitly instruct {PRODUCT} to generate the code in a custom target directory. The code is generated one time in the specified target directory and is not regenerated at build time unless you explicitly request it. You can customize the project code in the specified target directory as needed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
On Quarkus, disabling code regeneration also disables hot reload of business assets in development mode. This limitation will be improved in a future release.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to a local folder where you want to store the custom {PRODUCT} project and enter the following command to generate your {PRODUCT} project with the {PRODUCT} Maven archetype as usual:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-quarkus-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion={PRODUCT_VERSION_LONG} \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-springboot-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion={PRODUCT_VERSION_LONG} \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a <code>sample-kogito</code> Maven project and imports the {PRODUCT} extension for all required dependencies and configurations to prepare your application for business automation.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the project <code>pom.xml</code> file, modify the project dependencies and plug-ins to disable code regeneration:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>On Quarkus</strong>: Delete the <code>kogito-quarkus</code> dependency and add the <code>kogito-maven-plugin</code> plug-in, as shown in the following examples:</p>
<div class="listingblock">
<div class="title">Deleting the <code>kogito-quarkus</code> dependency</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
    &lt;artifactId&gt;kogito-quarkus&lt;/artifactId&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Adding the <code>kogito-maven-plugin</code> plug-in</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
  ...
  &lt;plugins&gt;
    ...
    &lt;plugin&gt;
      &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
      &lt;artifactId&gt;kogito-maven-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
        &lt;onDemand&gt;true&lt;/onDemand&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
    ...
  &lt;/plugins&gt;
  ...
&lt;/build&gt;</code></pre>
</div>
</div>
</li>
<li>
<p><strong>On Spring Boot</strong>: Modify the existing <code>kogito-maven-plugin</code> plug-in as shown in the following example:</p>
<div class="listingblock">
<div class="title">Modifying the <code>kogito-maven-plugin</code> plug-in</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
  ...
  &lt;plugins&gt;
    ...
    &lt;plugin&gt;
      &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
      &lt;artifactId&gt;kogito-maven-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
        &lt;onDemand&gt;true&lt;/onDemand&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
    ...
  &lt;/plugins&gt;
  ...
&lt;/build&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In a command terminal, navigate to the root of your {PRODUCT} project and enter the following command to generate your modified project using code scaffolding:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Generating the {PRODUCT} project using code scaffolding</div>
<div class="content">
<pre class="highlight"><code> $ mvn compile kogito:scaffold</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command compiles the assets in your project and generates the code in the <code>src/main/java</code> directory. In the automatic {PRODUCT} project build, the default directory is <code>target/generated-sources/kogito</code>.</p>
</div>
<div class="paragraph">
<p>If you want to override the default location for code generation, use the following command to define a custom target directory:</p>
</div>
<div class="listingblock">
<div class="title">Generating the {PRODUCT} project using code scaffolding with a custom directory</div>
<div class="content">
<pre class="highlight"><code> $ mvn compile kogito:scaffold -Dkogito.codegen.sources.directory=src/main/generated-java</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>kogito.codegen.sources.directory</code> parameter defines the custom target directory where you want the code to be generated, such as <code>src/main/generated-java</code> in this example.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you invoke the generation command again with the same target directory, the files are overwritten. This limitation will be fixed in a future release.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After you run the scaffolding command, either the default <code>src/main/java</code> directory or the custom target directory that you defined now contains the following resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your existing project files</p>
</li>
<li>
<p>Generated data classes corresponding to process variables or Decision Model and Notation (DMN) definitions</p>
</li>
<li>
<p>Generated REST endpoints</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example project contains a <code>persons</code> Business Process Model and Notation (BPMN) process model, so the generated REST endpoints are modified as shown in the following Java object:</p>
</div>
<div class="listingblock">
<div class="title">Modified REST endpoints for a <code>person</code> BPMN process model</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.travels;

// Imports

@Path("/persons")
@ApplicationScoped
public class PersonsResource {

    @Inject
    @Named("persons")
    Process&lt;PersonsModel&gt; process;

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    public PersonsModelOutput createResource_persons(
            @Context HttpHeaders httpHeaders,
            @QueryParam("businessKey") String businessKey,
            @Valid @NotNull PersonsModelInput resource) {
        ...
    }

    // Other endpoints
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>PersonsModel</code>, <code>PersonModelInput</code>, and <code>PersonsModelOutput</code> elements are the generated data models. These models are inferred automatically from the process variables in the process. Input and output models are inferred by how you tagged your process variables.</p>
</div>
<div class="paragraph">
<p>Similar endpoints are generated for any available rule units. This example project contains a <code>PersonValidationService</code> class for a rule unit model, so the generated REST endpoints are modified as shown in the following Java object:</p>
</div>
<div class="listingblock">
<div class="title">Modified REST endpoints for a <code>PersonValidationService</code> rule unit class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.travels;

// Imports

@Path("/persons-validation-service")
@ApplicationScoped
public class PersonsValidationServiceResource {

    @Inject
    RuleUnit&lt;PersonValidationService&gt; unit;

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    public QueryResult fireRules(PersonValidationService resource) {
        ...
    }

    // Other endpoints
}</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_PROCESS_SERVICES}#con-bpmn-variables_kogito-developing-process-services[Variables in {PRODUCT} processes]</p>
</li>
<li>
<p><a href="#proc-kogito-designing-app-rule-units_kogito-creating-running">Using DRL rule units as an alternative decision service</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-designing-app_kogito-creating-running">Designing the application logic for a {PRODUCT} service using DMN and BPMN</h3>
<div class="paragraph _abstract">
<p>After you create your {PRODUCT} project, you can create or import Business Process Model and Notation (BPMN) 2.0 business processes, Decision Model and Notation (DMN) decision models, Drools Rule Language (DRL) business rules, XLS or XLSX decision tables, and other assets in the <code>src/main/resources</code> folder of your project. You can also include Java classes in the <code>src/main/java</code> folder of your project that act as Java services or that provide implementations that you call from your business processes or decisions.</p>
</div>
<div class="paragraph">
<p>The example for this procedure is a basic {PRODUCT} service that provides a REST endpoint <code>/persons</code>. This endpoint is automatically generated based on an example <code>PersonProcess.bpmn2</code> business process that employs an example <code>PersonDecisions.dmn</code> DMN model to make decisions based on the data being processed.</p>
</div>
<div class="paragraph">
<p>The business process contains the business logic of the {PRODUCT} service. The process provides the complete set of steps to achieve the business goal. The process is also the entry point to the service that can be consumed by other services.</p>
</div>
<div class="paragraph">
<p>The business decision contains the decision logic of the {PRODUCT} service. In this example, the decision logic is invoked as part of the business process. You can define business rules and decisions in several ways, such as with DMN models, DRL rules, or XLS or XLSX decision tables. The example for this procedure uses a DMN model.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Maven project that you generated for your {PRODUCT} service, navigate to the <code>src/main/java/org/acme</code> folder and add the following <code>Person.java</code> file:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example person Java object</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme;

import java.io.Serializable;

public class Person {

	private String name;
	private int age;
	private boolean adult;

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public int getAge() {
		return age;
	}

	public void setAge(int age) {
		this.age = age;
	}

	public boolean isAdult() {
		return adult;
	}

	public void setAdult(boolean adult) {
		this.adult = adult;
	}

	@Override
	public String toString() {
		return "Person [name=" + name + ", age=" + age + ", adult=" + adult + "]";
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example Java object sets and retrieves a person&#8217;s name, age, and adult status.</p>
</div>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>src/main/resources</code> folder and add the following <code>PersonDecisions.dmn</code> DMN decision model:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person.png" alt="Image of PersonDecisions decision diagram">
</div>
<div class="title">Figure 10. Example <code>PersonDecisions</code> DMN decision requirements diagram (DRD)</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person-logic.png" alt="Image of PersonDecisions decision table">
</div>
<div class="title">Figure 11. Example DMN boxed expression for <code>isAdult</code> decision</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person-data-types.png" alt="Image of PersonDecisions data types">
</div>
<div class="title">Figure 12. Example DMN data types</div>
</div>
<div class="paragraph">
<p>This example DMN model consists of a basic DMN input node and a decision node defined by a DMN decision table with a custom structured data type.</p>
</div>
<div class="paragraph">
<p>In VSCode (recommended), you can add the <strong>{PRODUCT} Bundle</strong> VSCode extension to design the decision requirements diagram (DRD), boxed expression, and data types with the {PRODUCT} DMN modeler.</p>
</div>
<div class="paragraph">
<p>To create this example DMN model quickly, you can copy the following <code>PersonDecisions.dmn</code> file content:</p>
</div>
<div class="listingblock">
<div class="title">Example DMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dmn:definitions xmlns:dmn="http://www.omg.org/spec/DMN/20180521/MODEL/" xmlns="https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:kie="http://www.drools.org/kie/dmn/1.2" xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:feel="http://www.omg.org/spec/DMN/20180521/FEEL/" id="_84B432F5-87E7-43B1-9101-1BAFE3D18FC5" name="PersonDecisions" typeLanguage="http://www.omg.org/spec/DMN/20180521/FEEL/" namespace="https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1"&gt;
  &lt;dmn:extensionElements/&gt;
  &lt;dmn:itemDefinition id="_DEF2C3A7-F3A9-4ABA-8D0A-C823E4EB43AB" name="tPerson" isCollection="false"&gt;
    &lt;dmn:itemComponent id="_DB46DB27-0752-433F-ABE3-FC9E3BDECC97" name="Age" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_8C6D865F-E9C8-43B0-AB4D-3F2075A4ECA6" name="Name" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_9033704B-4E1C-42D3-AC5E-0D94107303A1" name="Adult" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;boolean&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:inputData id="_F9685B74-0C69-4982-B3B6-B04A14D79EDB" name="Person"&gt;
    &lt;dmn:extensionElements/&gt;
    &lt;dmn:variable id="_0E345A3C-BB1F-4FB2-B00F-C5691FD1D36C" name="Person" typeRef="tPerson"/&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:decision id="_0D2BD7A9-ACA1-49BE-97AD-19699E0C9852" name="isAdult"&gt;
    &lt;dmn:extensionElements/&gt;
    &lt;dmn:variable id="_54CD509F-452F-40E5-941C-AFB2667D4D45" name="isAdult" typeRef="boolean"/&gt;
    &lt;dmn:informationRequirement id="_2F819B03-36B7-4DEB-AED6-2B46AE3ADB75"&gt;
      &lt;dmn:requiredInput href="#_F9685B74-0C69-4982-B3B6-B04A14D79EDB"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:decisionTable id="_58370567-05DE-4EC0-AC2D-A23803C1EAAE" hitPolicy="UNIQUE" preferredOrientation="Rule-as-Row"&gt;
      &lt;dmn:input id="_ADEF36CD-286A-454A-ABD8-9CF96014021B"&gt;
        &lt;dmn:inputExpression id="_4930C2E5-7401-46DD-8329-EAC523BFA492" typeRef="number"&gt;
          &lt;dmn:text&gt;Person.Age&lt;/dmn:text&gt;
        &lt;/dmn:inputExpression&gt;
      &lt;/dmn:input&gt;
      &lt;dmn:output id="_9867E9A3-CBF6-4D66-9804-D2206F6B4F86" typeRef="boolean"/&gt;
      &lt;dmn:rule id="_59D6BFF0-35B4-4B7E-8D7B-E31CB0DB8242"&gt;
        &lt;dmn:inputEntry id="_7DC55D63-234F-497B-A12A-93DA358C0136"&gt;
          &lt;dmn:text&gt;&amp;gt; 18&lt;/dmn:text&gt;
        &lt;/dmn:inputEntry&gt;
        &lt;dmn:outputEntry id="_B3BB5B97-05B9-464A-AB39-58A33A9C7C00"&gt;
          &lt;dmn:text&gt;true&lt;/dmn:text&gt;
        &lt;/dmn:outputEntry&gt;
      &lt;/dmn:rule&gt;
      &lt;dmn:rule id="_8FCD63FE-8AD8-4F56-AD12-923E87AFD1B1"&gt;
        &lt;dmn:inputEntry id="_B4EF7F13-E486-46CB-B14E-1D21647258D9"&gt;
          &lt;dmn:text&gt;&amp;lt;= 18&lt;/dmn:text&gt;
        &lt;/dmn:inputEntry&gt;
        &lt;dmn:outputEntry id="_F3A9EC8E-A96B-42A0-BF87-9FB1F2FDB15A"&gt;
          &lt;dmn:text&gt;false&lt;/dmn:text&gt;
        &lt;/dmn:outputEntry&gt;
      &lt;/dmn:rule&gt;
    &lt;/dmn:decisionTable&gt;
  &lt;/dmn:decision&gt;
  &lt;dmndi:DMNDI&gt;
    &lt;dmndi:DMNDiagram&gt;
      &lt;di:extension&gt;
        &lt;kie:ComponentsWidthsExtension&gt;
          &lt;kie:ComponentWidths dmnElementRef="_58370567-05DE-4EC0-AC2D-A23803C1EAAE"&gt;
            &lt;kie:width&gt;50&lt;/kie:width&gt;
            &lt;kie:width&gt;100&lt;/kie:width&gt;
            &lt;kie:width&gt;100&lt;/kie:width&gt;
            &lt;kie:width&gt;100&lt;/kie:width&gt;
          &lt;/kie:ComponentWidths&gt;
        &lt;/kie:ComponentsWidthsExtension&gt;
      &lt;/di:extension&gt;
      &lt;dmndi:DMNShape id="dmnshape-_F9685B74-0C69-4982-B3B6-B04A14D79EDB" dmnElementRef="_F9685B74-0C69-4982-B3B6-B04A14D79EDB" isCollapsed="false"&gt;
        &lt;dmndi:DMNStyle&gt;
          &lt;dmndi:FillColor red="255" green="255" blue="255"/&gt;
          &lt;dmndi:StrokeColor red="0" green="0" blue="0"/&gt;
          &lt;dmndi:FontColor red="0" green="0" blue="0"/&gt;
        &lt;/dmndi:DMNStyle&gt;
        &lt;dc:Bounds x="404" y="464" width="100" height="50"/&gt;
        &lt;dmndi:DMNLabel/&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNShape id="dmnshape-_0D2BD7A9-ACA1-49BE-97AD-19699E0C9852" dmnElementRef="_0D2BD7A9-ACA1-49BE-97AD-19699E0C9852" isCollapsed="false"&gt;
        &lt;dmndi:DMNStyle&gt;
          &lt;dmndi:FillColor red="255" green="255" blue="255"/&gt;
          &lt;dmndi:StrokeColor red="0" green="0" blue="0"/&gt;
          &lt;dmndi:FontColor red="0" green="0" blue="0"/&gt;
        &lt;/dmndi:DMNStyle&gt;
        &lt;dc:Bounds x="404" y="311" width="100" height="50"/&gt;
        &lt;dmndi:DMNLabel/&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNEdge id="dmnedge-_2F819B03-36B7-4DEB-AED6-2B46AE3ADB75" dmnElementRef="_2F819B03-36B7-4DEB-AED6-2B46AE3ADB75"&gt;
        &lt;di:waypoint x="504" y="489"/&gt;
        &lt;di:waypoint x="404" y="336"/&gt;
      &lt;/dmndi:DMNEdge&gt;
    &lt;/dmndi:DMNDiagram&gt;
  &lt;/dmndi:DMNDI&gt;
&lt;/dmn:definitions&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create this example DMN model in VSCode using the {PRODUCT} DMN modeler, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the empty <code>PersonDecisions.dmn</code> file and in the upper-right corner of the DMN modeler, click the <strong>Properties</strong> icon and confirm that the DMN model <strong>Name</strong> is set to <code>PersonDecisions</code>.</p>
</li>
<li>
<p>In the left palette, select <strong>DMN Input Data</strong>, drag the node to the canvas, and double-click the node to name it <code>Person</code>.</p>
</li>
<li>
<p>In the left palette, select <strong>DMN Decision</strong>, drag the node to the canvas, double-click the node to name it <code>isAdult</code>, and link to it from the input node.</p>
</li>
<li>
<p>Select the decision node to display the node options and click the <strong>Edit</strong> icon to open the DMN boxed expression editor to define the decision logic for the node.</p>
</li>
<li>
<p>Click the undefined expression field and select <strong>Decision Table</strong>.</p>
</li>
<li>
<p>Click the upper-left corner of the decision table to set the hit policy to <strong>Unique</strong>.</p>
</li>
<li>
<p>Set the input and output columns so that the input source <code>Person.Age</code> with type <code>number</code> determines the age limit and the output target <code>isAdult</code> with type <code>boolean</code> determines adult status:</p>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person-logic.png" alt="Image of PersonDecisions decision table">
</div>
<div class="title">Figure 13. Example DMN decision table for <code>isAdult</code> decision</div>
</div>
</li>
<li>
<p>In the upper tab options, select the <strong>Data Types</strong> tab and add the following <code>tPerson</code> structured data type and nested data types:</p>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person-data-types.png" alt="Image of PersonDecisions data types">
</div>
<div class="title">Figure 14. Example DMN data types</div>
</div>
</li>
<li>
<p>After you define the data types, select the <strong>Editor</strong> tab to return to the DMN modeler canvas.</p>
</li>
<li>
<p>Select the <strong>Person</strong> input node, click the <strong>Properties</strong> icon, and under <strong>Information item</strong>, set the <strong>Data type</strong> to <code>tPerson</code>.</p>
</li>
<li>
<p>Select the <strong>isAdult</strong> decision node, click the <strong>Properties</strong> icon, and under <strong>Information item</strong>, confirm that the <strong>Data type</strong> is still set to <code>boolean</code>. You previously set this data type when you created the decision table.</p>
</li>
<li>
<p>Save the DMN decision file.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>In the <code>src/main/resources</code> folder, add the following <code>PersonProcess.bpmn2</code> BPMN process model:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of person process diagram">
</div>
<div class="title">Figure 15. Example <code>PersonProcess</code> BPMN process</div>
</div>
<div class="paragraph">
<p>This example process consists of the following basic BPMN components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start event</p>
</li>
<li>
<p>Business rule task</p>
</li>
<li>
<p>Exclusive gateway</p>
</li>
<li>
<p>User task</p>
</li>
<li>
<p>End events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In VSCode (recommended), you can add the <strong>{PRODUCT} Bundle</strong> VSCode extension to model the business process with the {PRODUCT} BPMN modeler.</p>
</div>
<div class="paragraph">
<p>To create this example process quickly, you can copy the following <code>PersonProcess.bpmn2</code> file content:</p>
</div>
<div class="listingblock">
<div class="title">Example BPMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:bpsim="http://www.bpsim.org/schemas/1.0" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:drools="http://www.jboss.org/drools" id="_J4ElsVJgEDiScotxwBQ14Q" exporter="jBPM Process Modeler" exporterVersion="2.0" targetNamespace="http://www.omg.org/bpmn20"&gt;
  &lt;bpmn2:itemDefinition id="_personItem" structureRef="org.acme.Person"/&gt;
  &lt;bpmn2:itemDefinition id="_isAdultItem" structureRef="Boolean"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_SkippableInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_PriorityInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_CommentInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_DescriptionInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_CreatedByInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_TaskNameInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_GroupIdInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_ContentInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotStartedReassignInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotCompletedReassignInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotStartedNotifyInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotCompletedNotifyInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_personInputXItem" structureRef="org.acme.Person"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_namespaceInputXItem" structureRef="java.lang.String"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_modelInputXItem" structureRef="java.lang.String"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_decisionInputXItem" structureRef="java.lang.String"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_PersonInputXItem" structureRef="org.acme.Person"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_isAdultOutputXItem" structureRef="Boolean"/&gt;
  &lt;bpmn2:process id="persons" drools:packageName="org.acme" drools:version="1.0" drools:adHoc="false" name="Person Process" isExecutable="true" processType="Public"&gt;
    &lt;bpmn2:property id="person" itemSubjectRef="_personItem" name="person"/&gt;
    &lt;bpmn2:property id="isAdult" itemSubjectRef="_isAdultItem" name="isAdult"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_1" sourceRef="StartEvent_1" targetRef="BusinessRuleTask_1"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_2" sourceRef="BusinessRuleTask_1" targetRef="ExclusiveGateway_1"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_3" sourceRef="ExclusiveGateway_1" targetRef="UserTask_1"&gt;
      &lt;bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression" language="http://www.java.com/java"&gt;return isAdult == false;&lt;/bpmn2:conditionExpression&gt;
    &lt;/bpmn2:sequenceFlow&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_4" sourceRef="UserTask_1" targetRef="EndEvent_1"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_5" sourceRef="ExclusiveGateway_1" targetRef="EndEvent_2"&gt;
      &lt;bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression" language="http://www.java.com/java"&gt;return isAdult == true;&lt;/bpmn2:conditionExpression&gt;
    &lt;/bpmn2:sequenceFlow&gt;
    &lt;bpmn2:startEvent id="StartEvent_1" name="StartProcess"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;StartProcess&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_1&lt;/bpmn2:outgoing&gt;
    &lt;/bpmn2:startEvent&gt;
    &lt;bpmn2:businessRuleTask id="BusinessRuleTask_1" name="Evaluate person" implementation="http://www.jboss.org/drools/dmn"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;Evaluate person&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_1&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_2&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:ioSpecification&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_namespaceInputX" drools:dtype="java.lang.String" itemSubjectRef="_BusinessRuleTask_1_namespaceInputXItem" name="namespace"/&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_decisionInputX" drools:dtype="java.lang.String" itemSubjectRef="_BusinessRuleTask_1_decisionInputXItem" name="decision"/&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_modelInputX" drools:dtype="java.lang.String" itemSubjectRef="_BusinessRuleTask_1_modelInputXItem" name="model"/&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_PersonInputX" drools:dtype="org.acme.Person" itemSubjectRef="_BusinessRuleTask_1_PersonInputXItem" name="Person"/&gt;
        &lt;bpmn2:dataOutput id="BusinessRuleTask_1_isAdultOutputX" drools:dtype="Boolean" itemSubjectRef="_BusinessRuleTask_1_isAdultOutputXItem" name="isAdult"/&gt;
        &lt;bpmn2:inputSet&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_namespaceInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_decisionInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_modelInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_PersonInputX&lt;/bpmn2:dataInputRefs&gt;
        &lt;/bpmn2:inputSet&gt;
        &lt;bpmn2:outputSet&gt;
          &lt;bpmn2:dataOutputRefs&gt;BusinessRuleTask_1_isAdultOutputX&lt;/bpmn2:dataOutputRefs&gt;
        &lt;/bpmn2:outputSet&gt;
      &lt;/bpmn2:ioSpecification&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_namespaceInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;BusinessRuleTask_1_namespaceInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_decisionInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;isAdult&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;BusinessRuleTask_1_decisionInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_modelInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;PersonDecisions&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;BusinessRuleTask_1_modelInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:sourceRef&gt;person&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_PersonInputX&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataOutputAssociation&gt;
        &lt;bpmn2:sourceRef&gt;BusinessRuleTask_1_isAdultOutputX&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;isAdult&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataOutputAssociation&gt;
    &lt;/bpmn2:businessRuleTask&gt;
    &lt;bpmn2:exclusiveGateway id="ExclusiveGateway_1" name="Exclusive Gateway 1" gatewayDirection="Diverging"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;Exclusive Gateway 1&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_2&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_5&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_3&lt;/bpmn2:outgoing&gt;
    &lt;/bpmn2:exclusiveGateway&gt;
    &lt;bpmn2:userTask id="UserTask_1" name="Special handling for children"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;Special handling for children&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_3&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_4&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:ioSpecification&gt;
        &lt;bpmn2:dataInput id="UserTask_1_TaskNameInputX" drools:dtype="Object" itemSubjectRef="_UserTask_1_TaskNameInputXItem" name="TaskName"/&gt;
        &lt;bpmn2:dataInput id="UserTask_1_personInputX" drools:dtype="org.acme.Person" itemSubjectRef="_UserTask_1_personInputXItem" name="person"/&gt;
        &lt;bpmn2:dataInput id="UserTask_1_SkippableInputX" drools:dtype="Object" itemSubjectRef="_UserTask_1_SkippableInputXItem" name="Skippable"/&gt;
        &lt;bpmn2:dataInput id="UserTask_1_PriorityInputX" drools:dtype="Object" itemSubjectRef="_UserTask_1_PriorityInputXItem" name="Priority"/&gt;
        &lt;bpmn2:inputSet&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_TaskNameInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_personInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_SkippableInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_PriorityInputX&lt;/bpmn2:dataInputRefs&gt;
        &lt;/bpmn2:inputSet&gt;
      &lt;/bpmn2:ioSpecification&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_TaskNameInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;ChildrenHandling&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;UserTask_1_TaskNameInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:sourceRef&gt;person&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_personInputX&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_SkippableInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;true&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;UserTask_1_SkippableInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_PriorityInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;1&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;UserTask_1_PriorityInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
    &lt;/bpmn2:userTask&gt;
    &lt;bpmn2:endEvent id="EndEvent_1" name="End Event 1"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;End Event 1&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_4&lt;/bpmn2:incoming&gt;
    &lt;/bpmn2:endEvent&gt;
    &lt;bpmn2:endEvent id="EndEvent_2" name="End Event 2"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;End Event 2&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_5&lt;/bpmn2:incoming&gt;
    &lt;/bpmn2:endEvent&gt;
  &lt;/bpmn2:process&gt;
  &lt;bpmndi:BPMNDiagram&gt;
    &lt;bpmndi:BPMNPlane bpmnElement="persons"&gt;
      &lt;bpmndi:BPMNShape id="shape_EndEvent_2" bpmnElement="EndEvent_2"&gt;
        &lt;dc:Bounds height="56" width="56" x="622" y="201"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_EndEvent_1" bpmnElement="EndEvent_1"&gt;
        &lt;dc:Bounds height="56" width="56" x="622" y="105"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_UserTask_1" bpmnElement="UserTask_1"&gt;
        &lt;dc:Bounds height="78" width="134" x="449" y="94"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_ExclusiveGateway_1" bpmnElement="ExclusiveGateway_1"&gt;
        &lt;dc:Bounds height="56" width="56" x="365" y="105"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_BusinessRuleTask_1" bpmnElement="BusinessRuleTask_1"&gt;
        &lt;dc:Bounds height="71" width="141" x="180" y="97"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_StartEvent_1" bpmnElement="StartEvent_1"&gt;
        &lt;dc:Bounds height="56" width="56" x="80" y="105"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_ExclusiveGateway_1_to_shape_EndEvent_2" bpmnElement="SequenceFlow_5"&gt;
        &lt;di:waypoint x="390" y="155"/&gt;
        &lt;di:waypoint x="393" y="231"/&gt;
        &lt;di:waypoint x="622" y="219"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_UserTask_1_to_shape_EndEvent_1" bpmnElement="SequenceFlow_4"&gt;
        &lt;di:waypoint x="583" y="133"/&gt;
        &lt;di:waypoint x="622" y="123"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_ExclusiveGateway_1_to_shape_UserTask_1" bpmnElement="SequenceFlow_3"&gt;
        &lt;di:waypoint x="415" y="130"/&gt;
        &lt;di:waypoint x="449" y="133"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_BusinessRuleTask_1_to_shape_ExclusiveGateway_1" bpmnElement="SequenceFlow_2"&gt;
        &lt;di:waypoint x="321" y="132.5"/&gt;
        &lt;di:waypoint x="365" y="130"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_StartEvent_1_to_shape_BusinessRuleTask_1" bpmnElement="SequenceFlow_1"&gt;
        &lt;di:waypoint x="116" y="123"/&gt;
        &lt;di:waypoint x="180" y="132.5"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
    &lt;/bpmndi:BPMNPlane&gt;
  &lt;/bpmndi:BPMNDiagram&gt;
  &lt;bpmn2:relationship type="BPSimData"&gt;
    &lt;bpmn2:extensionElements&gt;
      &lt;bpsim:BPSimData&gt;
        &lt;bpsim:Scenario id="default" name="Simulationscenario"&gt;
          &lt;bpsim:ScenarioParameters/&gt;
          &lt;bpsim:ElementParameters elementRef="UserTask_1"&gt;
            &lt;bpsim:TimeParameters&gt;
              &lt;bpsim:ProcessingTime&gt;
                &lt;bpsim:NormalDistribution mean="0" standardDeviation="0"/&gt;
              &lt;/bpsim:ProcessingTime&gt;
            &lt;/bpsim:TimeParameters&gt;
            &lt;bpsim:ResourceParameters&gt;
              &lt;bpsim:Availability&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Availability&gt;
              &lt;bpsim:Quantity&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Quantity&gt;
            &lt;/bpsim:ResourceParameters&gt;
            &lt;bpsim:CostParameters&gt;
              &lt;bpsim:UnitCost&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:UnitCost&gt;
            &lt;/bpsim:CostParameters&gt;
          &lt;/bpsim:ElementParameters&gt;
          &lt;bpsim:ElementParameters elementRef="BusinessRuleTask_1"&gt;
            &lt;bpsim:TimeParameters&gt;
              &lt;bpsim:ProcessingTime&gt;
                &lt;bpsim:NormalDistribution mean="0" standardDeviation="0"/&gt;
              &lt;/bpsim:ProcessingTime&gt;
            &lt;/bpsim:TimeParameters&gt;
            &lt;bpsim:ResourceParameters&gt;
              &lt;bpsim:Availability&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Availability&gt;
              &lt;bpsim:Quantity&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Quantity&gt;
            &lt;/bpsim:ResourceParameters&gt;
            &lt;bpsim:CostParameters&gt;
              &lt;bpsim:UnitCost&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:UnitCost&gt;
            &lt;/bpsim:CostParameters&gt;
          &lt;/bpsim:ElementParameters&gt;
          &lt;bpsim:ElementParameters elementRef="StartEvent_1"&gt;
            &lt;bpsim:TimeParameters&gt;
              &lt;bpsim:ProcessingTime&gt;
                &lt;bpsim:NormalDistribution mean="0" standardDeviation="0"/&gt;
              &lt;/bpsim:ProcessingTime&gt;
            &lt;/bpsim:TimeParameters&gt;
          &lt;/bpsim:ElementParameters&gt;
        &lt;/bpsim:Scenario&gt;
      &lt;/bpsim:BPSimData&gt;
    &lt;/bpmn2:extensionElements&gt;
    &lt;bpmn2:source&gt;_J4ElsVJgEDiScotxwBQ14Q&lt;/bpmn2:source&gt;
    &lt;bpmn2:target&gt;_J4ElsVJgEDiScotxwBQ14Q&lt;/bpmn2:target&gt;
  &lt;/bpmn2:relationship&gt;
&lt;/bpmn2:definitions&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create this example BPMN process in VSCode using the {PRODUCT} BPMN modeler, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the empty <code>PersonProcess.bpmn2</code> file and in the upper-right corner of the BPMN modeler, click the <strong>Properties</strong> icon and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Process</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: <code>Person Process</code></p>
</li>
<li>
<p><strong>ID</strong>: <code>persons</code></p>
</li>
<li>
<p><strong>Package</strong>: <code>org.acme</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Process Data</strong>: Add the following process variables:</p>
<div class="ulist">
<ul>
<li>
<p><code>person</code> with the type <code>org.acme.Person</code> (Use the <strong>Custom</strong> data type option to define the custom type.)</p>
</li>
<li>
<p><code>isAdult</code> with the type <code>Boolean</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>Business Rule</strong>, drag the task to the canvas, and link to it from the start event.</p>
</li>
<li>
<p>Select the business rule task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Set the rule task <strong>Name</strong> to <code>Evaluate person</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule Language</strong>: <code>DMN</code></p>
</li>
<li>
<p><strong>Namespace</strong>: The <code>namespace</code> property value from the <code>PersonDecisions.dmn</code> file that you created previously, such as <code>https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1</code></p>
</li>
<li>
<p><strong>Decision Name</strong>: <code>isAdult</code></p>
</li>
<li>
<p><strong>DMN Model Name</strong>: <code>PersonDecisions</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Data Assignments</strong>: Add the following assignments:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Data Input</strong>: Add a data input with the name <code>Person</code>, with the type <code>org.acme.Person</code>, and with the source <code>person</code>.</p>
</li>
<li>
<p><strong>Data Output</strong>: Add a data output with the name <code>isAdult</code>, with the type <code>Boolean</code>, and with the source <code>isAdult</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>Gateways</strong> &#8594; <strong>Exclusive</strong>, drag the gateway to the canvas, and link to it from the rule task.</p>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>User</strong>, drag the user task to the canvas, and link to it from the exclusive gateway.</p>
</li>
<li>
<p>Select the user task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Set the user task <strong>Name</strong> to <code>Special handling for children</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the <strong>Task Name</strong> to <code>ChildrenHandling</code>, and add a data input with the name <code>person</code>, the type <code>org.acme.Person</code>, and the source <code>person</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>End Events</strong> &#8594; <strong>End</strong>, drag two end events to the canvas, and link to one end event from the user task and to the other end event from the exclusive gateway.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the end event and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition <code>return isAdult == true;</code>.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the user task and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition to <code>return isAdult == false;</code></p>
</li>
<li>
<p>Save the BPMN process file.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="proc-kogito-designing-app-rule-units_kogito-creating-running">Using DRL rule units as an alternative decision service</h4>
<div class="paragraph _abstract">
<p>As an alternative to using Decision Model and Notation (DMN) to define this example decision service, you can also use a Drools Rule Language (DRL) file implemented as a rule unit.</p>
</div>
<div class="paragraph">
<p>A DRL rule unit is a module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained. For more information about rule units, see {URL_DECISION_SERVICES}#con-drl-rule-units_kogito-drl-rules[<em>{DECISION_SERVICES}</em>].</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <code>src/main/resources</code> folder of your example {PRODUCT} project, instead of using a DMN file, add the following <code>PersonRules.drl</code> file:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: /person[ age &gt; 18 ]
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example rule determines that any person who is older than 18 is classified as an adult. The rule file also declares that the rule belongs to the rule unit <code>PersonRules</code>. This is the rule unit that you define as part of the business rule task in the example BPMN process. When you build the project, the rule unit is generated and associated with the DRL file.</p>
</div>
<div class="paragraph">
<p>The rule also defines the condition using OOPath notation. OOPath is an object-oriented syntax extension to XPath for navigating through related elements while handling collections and filtering constraints.</p>
</div>
<div class="paragraph">
<p>You can also rewrite the same rule condition in a more explicit form using the traditional rule pattern syntax, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file using traditional notation</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: Person(age &gt; 18) from person
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>In the <code>src/main/resources</code> folder, use the {PRODUCT} BPMN modeler in VSCode to open the <code>PersonProcess.bpmn2</code> process diagram that you created.</p>
</li>
<li>
<p>Select the <code>Evaluate person</code> business rule task and modify the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Implementation/Execution</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule Language</strong>: <code>DRL</code> (instead of <code>DMN</code>)</p>
</li>
<li>
<p><strong>Rule Flow Group</strong>: <code>unit:org.acme.PersonRules</code></p>
<div class="paragraph">
<p>This rule unit syntax in the <strong>Rule Flow Group</strong> field specifies that you are using the <code>org.acme.PersonRules</code> rule unit instead of a traditional rule flow group. This is the rule unit that you referenced in the example DRL file. When you build the project, the business process implicitly declares the rule unit as part of the business rule task to execute the DRL file.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Data Assignments</strong>: Open the assignment settings and change the data input <strong>Name</strong> to <code>person</code> (instead of <code>Person</code>). This accommodates the input variable syntax required by the DRL file.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the end event and for the <strong>Implementation/Execution</strong> property, verify that the <strong>Condition Expression</strong> is set to <code>Java</code> and change the condition to <code>return person.isAdult();</code>.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the user task and for the <strong>Implementation/Execution</strong> property, verify that the <strong>Condition Expression</strong> is set to <code>Java</code> and change the condition <code>return ! person.isAdult();</code>.</p>
</li>
<li>
<p>Save the process file to update the model.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-testing-decision-logic_kogito-creating-running">Testing the decision logic for a {PRODUCT} service using test scenarios</h3>
<div class="paragraph _abstract">
<p>As you develop business decisions in your {PRODUCT} services, you can use test scenarios to validate the functionality of your decisions before you begin running and using your {PRODUCT} services. With a test scenario, you use data from your project to set given conditions and expected results based on one or more defined business decisions. When you run the scenario, the expected results and actual results of the decision instance are compared. If the expected results match the actual results, the test is successful. If the expected results do not match the actual results, then the test fails.</p>
</div>
<div class="paragraph">
<p>You define test scenarios in <code>.scesim</code> (scenario simulation) files that you can model in Visual Studio Code (VSCode) using the <strong>{PRODUCT} Bundle</strong> VSCode extension. You can use one or multiple <code>.scesim</code> files in your {PRODUCT} project, and each <code>.scesim</code> file can contain one or multiple test scenarios based on the defined decision data.</p>
</div>
<div class="paragraph">
<p>The example for this procedure uses a basic <code>PersonDecisionsTest.scesim</code> test scenario file that validates the decision logic in the example <code>PersonDecisions.dmn</code> Decision Model and Notation (DMN) model that you created previously.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Test scenarios in {PRODUCT} currently support DMN decision services only. Test scenarios will support Drools Rule Language (DRL) decision services in a future release.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created the <code>PersonDecisions.dmn</code> DMN model that determines whether a specified person is an adult or is underage. For more information about this DMN model, see <a href="#proc-kogito-designing-app_kogito-creating-running">Designing the application logic for a {PRODUCT} service using DMN and BPMN</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Maven project that contains your {PRODUCT} decision services, add the following dependency to the <code>pom.xml</code> file to enable test scenario execution for your project:</p>
<div class="listingblock">
<div class="title">Dependency to enable test scenario execution</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;kogito-scenario-simulation&lt;/artifactId&gt;
  &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>src/main</code> folder of the project and create a <code>test</code> folder with the following subfolders. If you have an existing <code>test</code> folder structure, you can adapt the steps that follow according to your project layout.</p>
<div class="listingblock">
<div class="title">Test folder structure for test scenarios</div>
<div class="content">
<pre class="highlight"><code>src/main/test/
          └── java/testscenario
          └── resources</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>test/java/testscenario</code> folder and add the following <code>KogitoScenarioJunitActivatorTest.java</code> class:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Activator class for test scenarios</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package testscenario;

@org.junit.runner.RunWith(org.kogito.scenariosimulation.runner.KogitoJunitActivator.class)
public class KogitoScenarioJunitActivatorTest {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This activator class is a custom <a href="https://junit.org/junit5/">JUnit 5</a> runner that enables the execution of test scenario files in your {PRODUCT} project. When you run test scenarios, this class loads all <code>.scesim</code> files available in the project and executes them. For each row (scenario) in a test scenario file, the activator class generates a JUnit test result.</p>
</div>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>test/resources</code> folder and add the following <code>PersonDecisionsTest.scesim</code> test scenario file:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-test-scenario-example-person.png" alt="Image of PersonDecisionsTest test scenario">
</div>
<div class="title">Figure 16. Example test scenarios for <code>PersonDecisions</code> DMN decision logic</div>
</div>
<div class="paragraph">
<p>The <strong>GIVEN</strong> columns specify input conditions based on the corresponding decision service. The <strong>EXPECT</strong> column specifies the expected results of the decision service based on the defined <strong>GIVEN</strong> conditions. Each row in the table is a defined scenario with example values for the <strong>GIVEN</strong> and <strong>EXPECT</strong> definitions to test the decision logic of the corresponding decision service.</p>
</div>
<div class="paragraph">
<p>This example test scenario file tests the decision logic for the following <code>PersonDecisions.dmn</code> model that you created previously. This DMN model determines whether a specified person is an adult or is underage.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person.png" alt="Image of PersonDecisions decision diagram">
</div>
<div class="title">Figure 17. Example <code>PersonDecisions</code> DMN decision requirements diagram (DRD)</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-dmn-example-person-logic.png" alt="Image of PersonDecisions decision table">
</div>
<div class="title">Figure 18. Example DMN boxed expression for <code>isAdult</code> decision</div>
</div>
<div class="paragraph">
<p>In VSCode (recommended), you can add the <strong>{PRODUCT} Bundle</strong> VSCode extension to design the test scenarios with the test scenario modeler.</p>
</div>
<div class="paragraph">
<p>To create these example test scenarios quickly, you can copy the following <code>PersonDecisionsTest.scesim</code> file content:</p>
</div>
<div class="listingblock">
<div class="title">Example test scenario file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;ScenarioSimulationModel version="1.8"&gt;
  &lt;simulation&gt;
    &lt;scesimModelDescriptor&gt;
      &lt;factMappings&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;Index&lt;/name&gt;
            &lt;type&gt;OTHER&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;#&lt;/name&gt;
            &lt;className&gt;java.lang.Integer&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.Integer&lt;/className&gt;
          &lt;factAlias&gt;#&lt;/factAlias&gt;
          &lt;columnWidth&gt;70&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;Description&lt;/name&gt;
            &lt;type&gt;OTHER&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Scenario description&lt;/name&gt;
            &lt;className&gt;java.lang.String&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.String&lt;/className&gt;
          &lt;factAlias&gt;Scenario description&lt;/factAlias&gt;
          &lt;columnWidth&gt;300&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Person&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Age&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|1&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Person&lt;/name&gt;
            &lt;className&gt;Person&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Person&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Age&lt;/expressionAlias&gt;
          &lt;genericTypes/&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Person&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Name&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|2&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Person&lt;/name&gt;
            &lt;className&gt;Person&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;string&lt;/className&gt;
          &lt;factAlias&gt;Person&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Name&lt;/expressionAlias&gt;
          &lt;genericTypes/&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;isAdult&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|4&lt;/name&gt;
            &lt;type&gt;EXPECT&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;isAdult&lt;/name&gt;
            &lt;className&gt;isAdult&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;boolean&lt;/className&gt;
          &lt;factAlias&gt;isAdult&lt;/factAlias&gt;
          &lt;expressionAlias&gt;value&lt;/expressionAlias&gt;
          &lt;genericTypes/&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
      &lt;/factMappings&gt;
    &lt;/scesimModelDescriptor&gt;
    &lt;scesimData&gt;
      &lt;Scenario&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Scenario description&lt;/name&gt;
              &lt;className&gt;java.lang.String&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Description&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;Is an adult&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;20&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|2&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;"John Quark"&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;isAdult&lt;/name&gt;
              &lt;className&gt;isAdult&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|4&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;true&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;#&lt;/name&gt;
              &lt;className&gt;java.lang.Integer&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Index&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;1&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/Scenario&gt;
      &lt;Scenario&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Scenario description&lt;/name&gt;
              &lt;className&gt;java.lang.String&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Description&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;Is underage&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;15&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|2&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;"Jenny Quark"&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;isAdult&lt;/name&gt;
              &lt;className&gt;isAdult&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|4&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;false&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;#&lt;/name&gt;
              &lt;className&gt;java.lang.Integer&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Index&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;2&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/Scenario&gt;
    &lt;/scesimData&gt;
  &lt;/simulation&gt;
  &lt;background&gt;
    &lt;scesimModelDescriptor&gt;
      &lt;factMappings&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|1&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Empty&lt;/name&gt;
            &lt;className&gt;java.lang.Void&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.Void&lt;/className&gt;
          &lt;factAlias&gt;INSTANCE 1&lt;/factAlias&gt;
          &lt;expressionAlias&gt;PROPERTY 1&lt;/expressionAlias&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
      &lt;/factMappings&gt;
    &lt;/scesimModelDescriptor&gt;
    &lt;scesimData&gt;
      &lt;BackgroundData&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Empty&lt;/name&gt;
              &lt;className&gt;java.lang.Void&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/BackgroundData&gt;
    &lt;/scesimData&gt;
  &lt;/background&gt;
  &lt;settings&gt;
    &lt;dmnFilePath&gt;src/main/resources/PersonDecisions.dmn&lt;/dmnFilePath&gt;
    &lt;type&gt;DMN&lt;/type&gt;
    &lt;dmnNamespace&gt;https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1&lt;/dmnNamespace&gt;
    &lt;dmnName&gt;PersonDecisions&lt;/dmnName&gt;
    &lt;skipFromBuild&gt;false&lt;/skipFromBuild&gt;
    &lt;stateless&gt;false&lt;/stateless&gt;
  &lt;/settings&gt;
  &lt;imports&gt;
    &lt;imports/&gt;
  &lt;/imports&gt;
&lt;/ScenarioSimulationModel&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create this example test scenario file in VSCode using the {PRODUCT} test scenario modeler, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the empty <code>PersonDecisionsTest.scesim</code> file and in the <strong>Create Test Scenario</strong> window that appears, set the <strong>Source type</strong> to <strong>DMN</strong>, select the <code>PersonDecisions.dmn</code> DMN model from the drop-down options, and click <strong>Create</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-test-scenario-example-person-create.png" alt="Image of Create Test Scenario window">
</div>
<div class="title">Figure 19. Create test scenario definition</div>
</div>
<div class="paragraph">
<p>The test scenario modeler automatically generates a scenario template based on the available DMN data types and fields that you defined in the DMN model.</p>
</div>
<div class="paragraph">
<p>You can right-click the relevant header cells to insert or delete columns as needed to modify the table structure. You can also select the relevant header cells to modify or insert data objects from the <strong>Test Tools</strong> panel in the right toolbar.</p>
</div>
</li>
<li>
<p>For this example, modify the generated test scenario header cells and specified data objects as needed to create the following test scenario template. Use the <strong>Test Tools</strong> panel in the right toolbar to select and insert the data objects as needed. Many of the header cell values might already be defined for you.</p>
<div class="ulist">
<ul>
<li>
<p><strong>GIVEN</strong>: Verify that the first header cell (instance) is set to the <strong>Person</strong> data object and that the subheader cells (properties) are set to the <strong>Age</strong> and <strong>Name</strong> data objects. Delete any other columns under <strong>GIVEN</strong> that were automatically generated, if applicable.</p>
</li>
<li>
<p><strong>EXPECT</strong>: Verify that the first header cell (instance) is set to the <strong>isAdult</strong> data object and that the subheader cell (property) is set to the <strong>value</strong> data object. Delete any other columns under <strong>EXPECT</strong> that were automatically generated, if applicable.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-test-scenario-example-person-headers-create.png" alt="Image of test scenario template">
</div>
<div class="title">Figure 20. Define test scenario header cells</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In row 1, create a test scenario with the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Scenario description</strong>: <code>Is an adult</code></p>
</li>
<li>
<p><strong>GIVEN</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Person</strong> &#8594; <strong>Age</strong>: <code>20</code></p>
</li>
<li>
<p><strong>Person</strong> &#8594; <strong>Name</strong>: <code>John Quark</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>EXPECT</strong>: Set the following value:</p>
<div class="ulist">
<ul>
<li>
<p><strong>isAdult</strong> &#8594; <strong>value</strong>: <code>true</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example scenario tests whether the person John Quark with 20 years of age is correctly identified by the <code>isAdult</code> DMN decision as an adult (<code>true</code>), based on the decision logic that adults are more than 18 years old.</p>
</div>
</li>
<li>
<p>Right-click any cell in row 1, select <strong>Insert row below</strong>, and in row 2, create another test scenario with the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Scenario description</strong>: <code>Is underage</code></p>
</li>
<li>
<p><strong>GIVEN</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Person</strong> &#8594; <strong>Age</strong>: <code>15</code></p>
</li>
<li>
<p><strong>Person</strong> &#8594; <strong>Name</strong>: <code>Jenny Quark</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>EXPECT</strong>: Set the following value:</p>
<div class="ulist">
<ul>
<li>
<p><strong>isAdult</strong> &#8594; <strong>value</strong>: <code>false</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example scenario tests whether the person Jenny Quark with 15 years of age is correctly identified by the <code>isAdult</code> DMN decision as not an adult (<code>false</code>), based on the decision logic that adults are more than 18 years old.</p>
</div>
</li>
<li>
<p>Save the test scenario file.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>After you define and save the test scenarios, in a command terminal, navigate to the project that contains your {PRODUCT} decision service and test scenarios and enter the following command to run the test scenarios:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Run the test scenarios</div>
<div class="content">
<pre class="highlight"><code>mvn clean test</code></pre>
</div>
</div>
<div class="paragraph">
<p>A summary of the test scenario execution appears in the command terminal, and detailed reports are generated in the <code>target/surefire-reports</code> folder of your {PRODUCT} project.</p>
</div>
<div class="paragraph">
<p>In the following example output, the test scenarios were executed successfully and encountered no errors:</p>
</div>
<div class="listingblock">
<div class="title">Terminal output for successful test scenarios</div>
<div class="content">
<pre class="highlight"><code>[INFO] --- maven-surefire-plugin:2.22.1:test (default-test) @ sample-kogito ---
[INFO]
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running testscenario.KogitoScenarioJunitActivatorTest
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.535 s - in testscenario.KogitoScenarioJunitActivatorTest
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  52.884 s
[INFO] Finished at: 2020-05-05T15:19:53-04:00
[INFO] ------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expected results defined in the test scenarios matched the actual results of the <code>isAdult</code> DMN decision instance in the <code>PersonDecisions.dmn</code> file. This match of expected and actual results for the decision instance means that the decision logic functions as intended.</p>
</div>
<div class="paragraph">
<p>In the following example output, the test scenarios were executed and the <code>Is underage</code> scenario encountered an error:</p>
</div>
<div class="listingblock">
<div class="title">Terminal output for a test scenario that encountered a decision error</div>
<div class="content">
<pre class="highlight"><code>[INFO] --- maven-surefire-plugin:2.22.1:test (default-test) @ sample-kogito ---
[INFO]
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running testscenario.KogitoScenarioJunitActivatorTest
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
[ERROR] Tests run: 2, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.534 s &lt;&lt;&lt; FAILURE! - in testscenario.KogitoScenarioJunitActivatorTest
[ERROR] #2: Is underage  Time elapsed: 0.06 s  &lt;&lt;&lt; ERROR!
org.drools.scenariosimulation.backend.runner.IndexedScenarioException: #2: Scenario 'Is underage' failed(/home/jsmith/sample-kogito/target/test-classes/PersonDecisionsTest.scesim)
Caused by: org.drools.scenariosimulation.backend.runner.ScenarioException: Scenario 'Is underage' failed

[INFO]
[INFO] Results:
[INFO]
[ERROR] Errors:
[ERROR]   KogitoScenarioJunitActivatorTest » IndexedScenario #2: Scenario 'Is underage' ...
[INFO]
[ERROR] Tests run: 2, Failures: 0, Errors: 1, Skipped: 0
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  6.521 s
[INFO] Finished at: 2020-05-05T15:26:10-04:00
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.22.1:test (default-test) on project sample-kogito: There are test failures.
[ERROR]
[ERROR] Please refer to /home/jsmith/sample-kogito/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expected results defined in the <code>Is underage</code> test scenario did not match the actual results of the <code>isAdult</code> DMN decision instance in the <code>PersonDecisions.dmn</code> file. This mismatch of expected and actual results for the decision instance means that either the test scenario identified a flaw in the decision logic or the test scenario is incorrectly defined. In this case, the <code>Is underage</code> test scenario was intentionally modified incorrectly with an age of <code>20</code> instead of an age of <code>18</code> or less. Reverting the age to <code>15</code> as shown in the previous example resolves the error.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-running-app_kogito-creating-running">Running a {PRODUCT} service</h3>
<div class="paragraph _abstract">
<p>After you design the business decisions and processes for your {PRODUCT} service, you can run your Quarkus or Spring Boot application in one of the following modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Development mode</strong>: For local testing. On Quarkus, development mode also offers live reload of your processes and decisions in your running applications for advanced debugging.</p>
</li>
<li>
<p><strong>JVM mode</strong>: For compatibility with a Java virtual machine (JVM).</p>
</li>
<li>
<p><strong>Native mode</strong>: (Quarkus only, requires GraalVM) For direct binary execution as native code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In a command terminal, navigate to the project that contains your {PRODUCT} service and enter one of the following commands, depending on your preferred run mode and application environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For development mode:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile spring-boot:run</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>For JVM mode:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus and Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/sample-kogito-1.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>For native mode (requires GraalVM):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus only</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative
$ ./target/sample-kogito-1.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-interacting-app_kogito-creating-running">Interacting with a running {PRODUCT} service</h3>
<div class="paragraph _abstract">
<p>After your {PRODUCT} service is running, you can send REST API requests to interact with your application and execute your services according to how you set up the application.</p>
</div>
<div class="paragraph">
<p>This example tests the <code>/persons</code> REST API endpoint that is automatically generated based on the <code>PersonProcess.bpmn2</code> business process, according to the decisions in the <code>PersonDecisions.dmn</code> file (or the rules in the <code>PersonRules.drl</code> file if you used a DRL rule unit).</p>
</div>
<div class="paragraph">
<p>For this example, use a REST client, curl utility, or the Swagger UI configured for the application at <a href="http://localhost:8080/swagger-ui/" class="bare">http://localhost:8080/swagger-ui/</a> to send API requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>URL</strong>: <code>http://localhost:8080/persons</code></p>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-swagger-example.png" alt="Image of Swagger UI for example application">
</div>
<div class="title">Figure 21. Swagger UI to interact with all application endpoints (http://localhost:8080/swagger-ui/)</div>
</div>
<div class="paragraph">
<p>This example procedure uses curl commands for convenience.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In a command terminal window that is separate from your running application, navigate to the project that contains your {PRODUCT} service and use any of the following curl commands with JSON requests to interact with your running service:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
On Spring Boot, you might need to modify how your application exposes API endpoints in order for these example requests to function. For more information, see the <code>README</code> file included in the example Spring Boot project that you created for this tutorial.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Add an adult person:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"3af806dd-8819-4734-a934-728f4c819682","person":{"name":"John Quark","age":20,"adult":false},"isAdult":true}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add an underage person:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"Jenny Quark", "age": 15}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"8eef502b-012b-4628-acb7-73418a089c08","person":{"name":"Jenny Quark","age":15,"adult":false},"isAdult":false}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>View active process instances:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>[{"id":"8eef502b-012b-4628-acb7-73418a089c08","person":{"name":"Jenny Quark","age":15,"adult":false},"isAdult":false}]</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>View process instance details using the returned process UUID:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/persons/8eef502b-012b-4628-acb7-73418a089c08/tasks -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code>{"cdec4241-d676-47de-8c55-4ee4f9598bac":"ChildrenHandling"}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>View task instance details using the returned process and task UUIDs:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/persons/8eef502b-012b-4628-acb7-73418a089c08/ChildrenHandling/cdec4241-d676-47de-8c55-4ee4f9598bac -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"person":{"name":"Jenny Quark","age":15,"adult":false},"name":"ChildrenHandling","id":"cdec4241-d676-47de-8c55-4ee4f9598bac"}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Complete the evaluation using the returned UUIDs:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons/8eef502b-012b-4628-acb7-73418a089c08/ChildrenHandling/cdec4241-d676-47de-8c55-4ee4f9598bac -H 'content-type: application/json' -H 'accept: application/json' -d '{}'</code></pre>
</div>
</div>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-kogito-deploying-on-openshift">Deploying {PRODUCT} services on {OPENSHIFT}</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a developer of business processes and decisions, you can deploy {PRODUCT} services on {OPENSHIFT} for cloud implementation. The {PRODUCT} Operator automates many of the deployment steps for you or guides you through the deployment process. You can use the {PRODUCT} command-line interface (CLI) to interact with the {PRODUCT} Operator for deployment tasks.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>{OPENSHIFT} 4.3 or later is installed.</p>
</li>
<li>
<p>The OpenShift project for the deployment is created.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="con-kogito-on-ocp_kogito-deploying-on-openshift">{PRODUCT} on {OPENSHIFT}</h3>
<div class="paragraph _abstract">
<p>You can deploy {PRODUCT} services on {OPENSHIFT} for cloud implementation. In this architecture, {PRODUCT} services are deployed as OpenShift pods that you can scale up and down individually to provide as few or as many containers as required for a particular service. You can use standard OpenShift methods to manage the pods and balance the load.</p>
</div>
<div class="paragraph">
<p>To help you deploy your services on OpenShift, {PRODUCT} provides an operator and a command-line interface (CLI):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>{PRODUCT} Operator</strong>: An operator that guides you through the deployment process. The {PRODUCT} Operator is based on the <a href="https://sdk.operatorframework.io/">Operator SDK</a> and automates many of the deployment steps for you. For example, when you give the operator a link to the Git repository that contains your application, the operator can automatically configure the components required to build your project from source and deploy the resulting services.</p>
</li>
<li>
<p><strong>{PRODUCT} command-line interface (CLI)</strong>: A CLI tool that enables you to interact with the {PRODUCT} Operator for deployment tasks. The {PRODUCT} CLI also enables you to deploy {PRODUCT} services from source instead of relying on custom resources and YAML files. You can use the {PRODUCT} CLI as a command-line alternative for deploying {PRODUCT} services without the {OPENSHIFT} web console.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-deploying-on-ocp-console_kogito-deploying-on-openshift">Deploying {PRODUCT} services on OpenShift using the OpenShift web console</h3>
<div class="paragraph _abstract">
<p>After you create your {PRODUCT} services as part of a business application, you can use the {OPENSHIFT} web console to deploy your services. The {PRODUCT} Operator page in the OpenShift web console guides you through the deployment process. The {PRODUCT} Operator is based on the <a href="https://sdk.operatorframework.io/">Operator SDK</a> and automates many of the deployment steps for you. For example, when you give the operator a link to the Git repository that contains your application, the operator can automatically configure the components required to build your project from source and deploy the resulting services.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The application with your {PRODUCT} services is in a Git repository that is reachable from your OpenShift environment.</p>
</li>
<li>
<p>You have access to the OpenShift web console with <code>cluster-admin</code> permissions.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the OpenShift web console, go to <strong>Operators</strong> &#8594; <strong>OperatorHub</strong> in the left menu, search for and select <strong>Kogito</strong>, and follow the on-screen instructions to install the latest operator version.</p>
</li>
<li>
<p>After you install the {PRODUCT} Operator, in the OpenShift web console, go to <strong>Operators</strong> &#8594; <strong>Installed Operators</strong> and select <strong>Kogito</strong>.</p>
</li>
<li>
<p>In the operator page, select the <strong>Kogito Build</strong> tab and click <strong>Create KogitoBuild</strong> to create the {PRODUCT} build definition.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-create-build.png" alt="Image of Kogito build page in web console">
</div>
<div class="title">Figure 22. Create a {PRODUCT} build definition</div>
</div>
</li>
<li>
<p>In the application window, use the <strong>Form View</strong> or <strong>YAML View</strong> to configure the build definition.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>At a minimum, define the application configurations shown in the following example YAML file:</p>
</div>
<div class="listingblock">
<div class="title">Example YAML definition for an application with {PRODUCT} build</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1 # {PRODUCT} API for this service
kind: KogitoBuild  # Application type
metadata:
  name: example-quarkus  # Application name
  namespace: kogito  # OpenShift project namespace
spec:
  type: RemoteSource
  gitSource:
    uri: 'https://github.com/kiegroup/kogito-examples'  # Git repository containing application (uses default branch)
    contextDir: process-quarkus-example  # Git folder location of application</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you have configured an internal Maven repository, you can use it as a Maven mirror service and specify the Maven mirror URL in your {PRODUCT} build definition to substantially shorten build time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  mavenMirrorURL: http://nexus3-nexus.apps-crc.testing/repository/maven-public/</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about internal Maven repositories, see the <a href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html">Apache Maven</a> documentation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>After you define your application data, click <strong>Create</strong> to generate the {PRODUCT} build.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Your application is listed in the <strong>{PRODUCT}Builds</strong> page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-create-build-listed.png" alt="Image of Kogito build listed in web console">
</div>
<div class="title">Figure 23. New {PRODUCT} build instance</div>
</div>
<div class="paragraph">
<p>You can select the application name to view or modify application settings and YAML details:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-build-details.png" alt="Image of Kogito service details page in web console">
</div>
<div class="title">Figure 24. View {PRODUCT} build details</div>
</div>
</div>
</div>
</li>
<li>
<p>In the operator page, select the <strong>Kogito Service</strong> tab and click <strong>Create KogitoRuntime</strong> to create the {PRODUCT} service definition.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-create-runtime.png" alt="Image of Kogito service page in web console">
</div>
<div class="title">Figure 25. Create a {PRODUCT} service definition</div>
</div>
</li>
<li>
<p>In the application window, use the <strong>Form View</strong> or <strong>YAML View</strong> to configure the service definition.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>At a minimum, define the application configurations shown in the following example YAML file:</p>
</div>
<div class="listingblock">
<div class="title">Example YAML definition for an application with {PRODUCT} services</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1 # {PRODUCT} API for this service
kind: KogitoRuntime  # Application type
metadata:
  name: example-quarkus  # Application name
  namespace: kogito  # OpenShift project namespace</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>After you define your application data, click <strong>Create</strong> to generate the {PRODUCT} service.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Your application is listed in the {PRODUCT} service page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-create-runtime-listed.png" alt="Image of Kogito service listed in web console">
</div>
<div class="title">Figure 26. New {PRODUCT} service instance</div>
</div>
<div class="paragraph">
<p>You can select the application name to view or modify application settings and YAML details:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-runtime-details.png" alt="Image of Kogito service details page in web console">
</div>
<div class="title">Figure 27. View {PRODUCT} service details</div>
</div>
</div>
</div>
</li>
<li>
<p>In the left menu of the web console, go to <strong>Builds</strong> &#8594; <strong>Builds</strong> to view the status of your application build.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can select a specific build to view build details:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-app-build-details.png" alt="Image of Kogito service build details page in web console">
</div>
<div class="title">Figure 28. View {PRODUCT} service build details</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For every {PRODUCT} service that you create for OpenShift deployment, two builds are generated and listed in the <strong>Builds</strong> page in the web console: a traditional runtime build and a Source-to-Image (S2I) build with the suffix <code>-builder</code>. The S2I mechanism builds the application in an OpenShift build and then passes the built application to the next OpenShift build to be packaged into the runtime container image. The {PRODUCT} S2I build configuration also enables you to build the project directly from a Git repository on the OpenShift platform.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>After the application build is complete, go to <strong>Workloads</strong> &#8594; <strong>Deployments</strong> to view the application deployments, pod status, and other details.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can select the application name to increase or decrease the pod count or modify deployment settings:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-service-deployment-details.png" alt="Image of Kogito service deployment details page in web console">
</div>
<div class="title">Figure 29. View {PRODUCT} service deployment details</div>
</div>
</div>
</div>
</li>
<li>
<p>After your {PRODUCT} service is deployed, in the left menu of the web console, go to <strong>Networking</strong> &#8594; <strong>Routes</strong> to view the access link to the deployed application.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can select the application name to view or modify route settings:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-service-route-details.png" alt="Image of Kogito service route details page in web console">
</div>
<div class="title">Figure 30. View {PRODUCT} service route details</div>
</div>
<div class="paragraph">
<p>With the application route, you can integrate your {PRODUCT} services with your business automation solutions as needed.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-deploying-on-ocp-kogito-cli_kogito-deploying-on-openshift">Deploying {PRODUCT} services on OpenShift using the {PRODUCT} CLI</h3>
<div class="paragraph _abstract">
<p>The {PRODUCT} command-line interface (CLI) enables you to interact with the {PRODUCT} Operator for deployment tasks. The {PRODUCT} CLI also enables you to deploy {PRODUCT} services from source instead of relying on custom resources and YAML files. You can use the {PRODUCT} CLI as a command-line alternative for deploying {PRODUCT} services without the {OPENSHIFT} web console.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> OpenShift CLI is installed and you are logged in to the relevant OpenShift cluster. For <code>oc</code> installation and login instructions, see the
<a href="https://docs.openshift.com/container-platform/4.2/cli_reference/openshift_cli/getting-started-cli.html">OpenShift documentation</a>.</p>
</li>
<li>
<p>You have OpenShift permissions to create resources in a specified namespace.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://github.com/kiegroup/kogito-cloud-operator/releases"><code>{PRODUCT_INIT}-cloud-operator</code></a> releases page in GitHub and download the latest version of the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file that is specific to your operating system.</p>
</li>
<li>
<p>Extract the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file to a local directory:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>On Linux or Mac: In a command terminal, navigate to the directory where you downloaded the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file and enter the following command to extract the contents:</p>
<div class="listingblock">
<div class="title">Extract the {PRODUCT} CLI distribution</div>
<div class="content">
<pre class="highlight"><code>$ tar -xvf {PRODUCT_INIT}-cli-<em>RELEASE</em>.tar.gz</code></pre>
</div>
</div>
</li>
<li>
<p>On Windows: In your file browser, navigate to the directory where you downloaded the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file and extract the ZIP file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>{PRODUCT_INIT}</code> executable file appears.</p>
</div>
</div>
</div>
</li>
<li>
<p>Move the extracted <code>{PRODUCT_INIT}</code> file to an existing directory in your <code>PATH</code> variable:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>On Linux or Mac: In a command terminal, enter the following command:</p>
<div class="listingblock">
<div class="title">Move the <code>{PRODUCT_INIT}</code> file</div>
<div class="content">
<pre class="highlight"><code>$ cp /<em>PATH_TO_{PRODUCT_INIT_CAP}</em> /usr/local/bin</code></pre>
</div>
</div>
</li>
<li>
<p>On Windows: Update the relevant <code>PATH</code> environment variables in your system settings to include the path to the {PRODUCT} CLI folder. For example, on Windows 10, go to <strong>Settings</strong> &#8594; <strong>System Info</strong> &#8594; <strong>Advanced System Settings</strong> &#8594; <strong>Advanced</strong> &#8594; <strong>Environment Variables</strong> and in the <strong>User</strong> or <strong>System</strong> variables, add the path for the {PRODUCT} CLI folder to the <code>PATH</code> variable. Close and reopen your Windows command prompt to apply the changes.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>With the {PRODUCT} CLI now installed, enter the following commands to deploy your {PRODUCT} services on OpenShift from source:</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You must be logged in to the relevant OpenShift cluster using the <code>oc login</code> command.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from existing namespace</div>
<div class="content">
<pre class="highlight"><code>// Uses the provisioned namespace in your OpenShift cluster
$ {PRODUCT_INIT} use-project <em>PROJECT_NAME</em>

// Deploys a new {PRODUCT} service from a Git source
$ {PRODUCT_INIT} deploy-service example-quarkus https://github.com/kiegroup/kogito-examples --context-dir process-quarkus-example</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the default branch in the specified Git repository, usually <code>master</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The first time that you use the {PRODUCT} CLI to interact with a project or service, the {PRODUCT} Operator is automatically installed and used to execute the relevant tasks.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you can generate a new namespace in your cluster during deployment:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from new namespace</div>
<div class="content">
<pre class="highlight"><code>// Creates a new namespace in your cluster
$ {PRODUCT_INIT} new-project <em>NEW_PROJECT_NAME</em>

// Deploys a new {PRODUCT} service from a Git source
$ {PRODUCT_INIT} deploy-service example-quarkus https://github.com/kiegroup/kogito-examples --context-dir process-quarkus-example</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also combine the commands to create the namespace and deploy the service using the following abbreviated syntax:</p>
</div>
<div class="listingblock">
<div class="title">Abbreviated command for {PRODUCT} service deployment</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} deploy-service example-quarkus https://github.com/kiegroup/kogito-examples --context-dir process-quarkus-example --project <em>PROJECT_NAME</em></code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="con-kogito-travel-agency_kogito-deploying-on-openshift">Travel agency tutorial for {PRODUCT} services on OpenShift</h3>
<div class="paragraph _abstract">
<p>The <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application in GitHub contains {PRODUCT} services related to travel booking. The purpose of this example application is to help you get started with deploying {PRODUCT} services on {OPENSHIFT}.</p>
</div>
<div class="paragraph">
<p>The example application illustrates many of the configuration options you can use whether you are deploying services locally or on {OPENSHIFT}, such as process persistence with Infinispan, messaging with Apache Kafka, and application data indexing with the {PRODUCT} Data Index Service.</p>
</div>
<div class="paragraph">
<p>For more information about this example application, see the <code>README</code> file in the application folder.</p>
</div>
<div class="paragraph">
<p>This tutorial demonstrates the following two related services in the <code>kogito-travel-agency</code> extended example application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended/travels"><code>travels</code></a>: Service for booking a trip to a specified destination, including flight and hotel</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended/visas"><code>visas</code></a>: Service for managing travel visas, if required</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following Business Model and Notation (BPMN) 2.0 process models are the core processes in these services:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-travel-agency-process.png" alt="Image of travel agency example process">
</div>
<div class="title">Figure 31. Travels core process</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-visas-process.png" alt="Image of visas example process">
</div>
<div class="title">Figure 32. Visas core process</div>
</div>
<div class="paragraph">
<p>These two services communicate with each other through events. The travel agency service schedules specified travel plans and sends visa applications for travelers that require visas to visit a specified country. The visa service then evaluates any visa applications and responds with the visa approval or rejection.</p>
</div>
<div class="paragraph">
<p>The services expose REST API endpoints that are generated from the BPMN business process definitions in the services. Internally, the services communicate using Apache Kafka messaging. The logic to interact with Kafka to produce and consume messages is also generated from the BPMN process definitions.</p>
</div>
<div class="ulist">
<div class="title">Tutorial objectives</div>
<ul>
<li>
<p>Deploy an application with advanced {PRODUCT} services, including supporting services and infrastructure.</p>
</li>
<li>
<p>Deploy {PRODUCT} infrastructures (Infinispan, Kafka, and Data Index Service) using the {PRODUCT} Operator and {PRODUCT} CLI.</p>
</li>
<li>
<p>Deploy {PRODUCT} service definitions using the {PRODUCT} CLI.</p>
</li>
<li>
<p>Use binary builds to deploy {PRODUCT} services on OpenShift.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a> 1.46.0 or later is installed.</p>
</li>
<li>
<p>The <strong>{PRODUCT} Bundle</strong> VSCode extension is installed and enabled in your VSCode IDE.</p>
</li>
<li>
<p>{OPENSHIFT} 4.3 or later is installed.</p>
</li>
<li>
<p>The <code>oc</code> OpenShift CLI is installed. For <code>oc</code> installation instructions, see the
<a href="https://docs.openshift.com/container-platform/4.2/cli_reference/openshift_cli/getting-started-cli.html">OpenShift documentation</a>.</p>
</li>
<li>
<p>You have access to the OpenShift web console with <code>cluster-admin</code> permissions.</p>
</li>
<li>
<p>The {PRODUCT} command-line interface (CLI) is installed from the latest <a href="https://github.com/kiegroup/kogito-cloud-operator/releases">{PRODUCT} CLI distribution</a>.</p>
</li>
<li>
<p>Git is installed.</p>
</li>
<li>
<p>JDK 11 or later is installed. (<a href="https://www.graalvm.org/">GraalVM</a> is recommended.)</p>
</li>
<li>
<p>Apache Maven 3.6.2 or later is installed.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-clone-repo_kogito-deploying-on-openshift">Cloning the {PRODUCT} examples Git repository</h4>
<div class="paragraph _abstract">
<p>For this travel agency tutorial, you need local access to the example services, so you must first clone the <a href="https://github.com/kiegroup/kogito-examples"><code>{PRODUCT_INIT}-examples</code></a> Git repository to your local system.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In a command terminal, navigate to a directory where you want to store the {PRODUCT} example applications and enter the following command to clone the repository:</p>
</div>
<div class="listingblock">
<div class="title">Cloning the {PRODUCT} examples repository</div>
<div class="content">
<pre class="highlight"><code>$ git clone https://github.com/kiegroup/kogito-examples.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>The cloned <code>{PRODUCT_INIT}-examples</code> repository contains various types of {PRODUCT} services on Quarkus or Spring Boot to help you develop your own applications.</p>
</div>
<div class="paragraph">
<p>For this travel agency tutorial, you need the <code>kogito-travel-agency</code> extended example application, which contains the following services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended/travels"><code>travels</code></a>: Service for booking a trip to a specified destination, including flight and hotel</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended/visas"><code>visas</code></a>: Service for managing travel visas, if required</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-configure-ocp_kogito-deploying-on-openshift">Configuring access to your OpenShift environment</h4>
<div class="paragraph _abstract">
<p>To complete the travel agency tutorial, you must ensure that you have proper access to both the {OPENSHIFT} web console and to the <code>oc</code> CLI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can use different types of OpenShift 4.x environments, such as a full OpenShift cluster or a small <a href="https://github.com/code-ready/crc">CodeReady Containers</a> environment. However, the OpenShift environment must have access to the public Internet in order to be able to pull in the required container images and build artifacts.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the OpenShift web console and in the upper-right corner of the screen, select your profile and click <strong>Copy Login Command</strong>.</p>
</li>
<li>
<p>In the new window that appears, log in again to re-authenticate your user and then click <strong>Display Token</strong>.</p>
</li>
<li>
<p>Copy the <code>oc login</code> command and enter it in a command terminal:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example <code>oc</code> CLI login token</div>
<div class="content">
<pre class="highlight"><code>$ oc login --token=<em>OPENSHIFT_TOKEN</em> --server=https://<em>WEB_CONSOLE_SERVER</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>If your authentication fails or you do not have <code>cluster-admin</code> permissions, contact your OpenShift administrator.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-create-ocp-project_kogito-deploying-on-openshift">Creating an OpenShift project and installing the {PRODUCT} Operator using the {PRODUCT} CLI</h4>
<div class="paragraph _abstract">
<p>To set up an example application with {PRODUCT} services for deployment on {OPENSHIFT}, you must create a project (namespace) in OpenShift in which you can install the application and the {PRODUCT} Operator. The {PRODUCT} Operator is based on the <a href="https://sdk.operatorframework.io/">Operator SDK</a> and automates many of the deployment steps for you. The first time that you use the {PRODUCT} CLI to interact with a project or service, the {PRODUCT} Operator is automatically installed and used to execute the relevant tasks.</p>
</div>
<div class="paragraph">
<p>You can create the project and install the {PRODUCT} Operator using the OpenShift web console or using the {PRODUCT} CLI. This example uses the {PRODUCT} CLI.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In a command terminal, enter the following command to create an OpenShift project for the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application using the {PRODUCT} CLI:</p>
</div>
<div class="listingblock">
<div class="title">Creating the OpenShift project</div>
<div class="content">
<pre class="highlight"><code>$ kogito new-project kogito-travel-agency
Project `kogito-travel-agency` created successfully</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not have <code>cluster-admin</code> permissions and another user created the <code>kogito-travel-agency</code> project for you, you can alternatively use the following command to connect the {PRODUCT} CLI tooling to the existing project:</p>
</div>
<div class="listingblock">
<div class="title">Connecting to an existing OpenShift project</div>
<div class="content">
<pre class="highlight"><code>$ kogito use-project kogito-travel-agency
Project set to 'kogito-travel-agency'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>kogito new-project</code> and <code>kogito use-project</code> commands automatically install the <strong>{PRODUCT} Operator</strong> if it is not installed already.</p>
</div>
<div class="paragraph">
<p>If your {PRODUCT} project requires persistence and messaging infrastructures, you can use the left menu of the OpenShift web console to navigate to <strong>Operators</strong> &#8594; <strong>OperatorHub</strong> and install the <a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a> for persistence and the <a href="https://strimzi.io/docs/latest/">Strimzi Operator</a> for Apache Kafka clusters and messaging. You can also install these operators manually using the <a href="https://infinispan.org/infinispan-operator/master/operator.html">Infinispan Operator Guide</a> or the <a href="https://strimzi.io/docs/operators/master/quickstart.html">Strimzi Quick Start guide</a>. The {PRODUCT} Operator uses these operators to create the needed persistence and messaging infrastructures.</p>
</div>
<div class="paragraph">
<p>After you create the OpenShift project using the {PRODUCT} CLI and install the {PRODUCT} Operator, the operator is listed with any other installed operators in the OpenShift web console in <strong>Operators</strong> &#8594; <strong>Installed Operators</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-installed-operators.png" alt="Image of installed operators in web console">
</div>
<div class="title">Figure 33. Installed operators in web console</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-enable-persistence_kogito-deploying-on-openshift">Installing the Infinispan persistence infrastructure for {PRODUCT} services on OpenShift</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} supports runtime persistence for process data in your services. {PRODUCT} persistence is based on <a href="https://infinispan.org/">Infinispan</a> and enables you to configure key-value storage definitions to persist data, such as active nodes and process instance variables, so that the data is preserved across application restarts.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the <a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a> to deploy the Infinispan infrastructure in a {PRODUCT} project. For optimal {PRODUCT} deployment on OpenShift, install the Infinispan Operator and enable Infinispan persistence for your {PRODUCT} services. You can install the Infinispan infrastructure using the {PRODUCT} Operator page in the OpenShift web console or using the {PRODUCT} CLI.</p>
</div>
<div class="paragraph">
<p>This example uses the {PRODUCT} CLI to install the Infinispan infrastructure and the {PRODUCT} Operator page in the web console to verify that the infrastructure is enabled.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a> is installed in the same OpenShift namespace as your {PRODUCT} project. You can install the Infinispan Operator using the <strong>Operators</strong> &#8594; <strong>OperatorHub</strong> page in the OpenShift web console or manually as described in the <a href="https://infinispan.org/infinispan-operator/master/operator.html">Infinispan Operator Guide</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, enter the following command to install the Infinispan infrastructure for the {PRODUCT} services:</p>
<div class="listingblock">
<div class="title">Installing Infinispan infrastructure</div>
<div class="content">
<pre class="highlight"><code>$ kogito install infra kogito-infinispan-infra --kind Infinispan --apiVersion infinispan.org/v1</code></pre>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to the following windows to verify the installed Infinispan infrastructure:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Operators</strong> &#8594; <strong>Installed Operators</strong> &#8594; <strong>{PRODUCT}</strong> &#8594; <strong>{PRODUCT} Infra</strong>: A new <code>kogito-infinispan-infra</code> custom resource is listed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-infra.png" alt="Image of Kogito Infra page in web console">
</div>
<div class="title">Figure 34. {PRODUCT} infrastructure resource for Infinispan</div>
</div>
</li>
<li>
<p><strong>Operators</strong> &#8594; <strong>Installed Operators</strong> &#8594; <strong>Infinispan</strong> &#8594; <strong>Infinispan Cluster</strong>: A new <code>kogito-infinispan</code> custom resource is listed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-infinispan-infra.png" alt="Image of Infinispan Cluster page in web console">
</div>
<div class="title">Figure 35. Infinispan cluster resource</div>
</div>
</li>
<li>
<p><strong>Workloads</strong> &#8594; <strong>Stateful Sets</strong>: A new <code>kogito-infinispan</code> stateful set is deployed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-stateful-sets-infinispan.png" alt="Image of Stateful Sets page in web console">
</div>
<div class="title">Figure 36. Stateful set for Infinispan</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-enable-messaging_kogito-deploying-on-openshift">Installing the Kafka messaging infrastructure for {PRODUCT} services on OpenShift</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} supports the <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> specification for messaging in your services. {PRODUCT} messaging is based on <a href="https://kafka.apache.org/">Apache Kafka</a> and enables you to configure messages as either input or output of business process execution.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the <a href="https://strimzi.io/">Strimzi Operator</a> to deploy and manage the Kafka infrastructure in a {PRODUCT} project. For optimal {PRODUCT} deployment on OpenShift, install the Strimzi Operator and enable Kafka messaging for your {PRODUCT} services. You can install the Kafka infrastructure using the {PRODUCT} Operator page in the OpenShift web console or using the {PRODUCT} CLI.</p>
</div>
<div class="paragraph">
<p>This example uses the {PRODUCT} CLI to install the Kafka infrastructure and the {PRODUCT} Operator page in the web console to verify that the infrastructure is enabled.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <a href="https://strimzi.io/">Strimzi Operator</a> is installed in the same OpenShift namespace as your {PRODUCT} project. You can install the Strimzi Operator using the <strong>Operators</strong> &#8594; <strong>OperatorHub</strong> page in the OpenShift web console or manually as described in the <a href="https://strimzi.io/docs/operators/master/quickstart.html">Strimzi Quick Start guide</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, enter the following command to install the Kafka infrastructure for the {PRODUCT} services:</p>
<div class="listingblock">
<div class="title">Installing Kafka infrastructure</div>
<div class="content">
<pre class="highlight"><code>$ kogito install infra kogito-kafka-infra --kind Kafka --apiVersion kafka.strimzi.io/v1beta1</code></pre>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to the following windows to verify the installed Kafka infrastructure:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Operators</strong> &#8594; <strong>Installed Operators</strong> &#8594; <strong>{PRODUCT}</strong> &#8594; <strong>{PRODUCT} Infra</strong>: A new <code>kogito-kafka-infra</code> custom resource is listed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-infra-kafka.png" alt="Image of Kogito infra details in web console">
</div>
<div class="title">Figure 37. Kafka enabled</div>
</div>
</li>
<li>
<p><strong>Operators</strong> &#8594; <strong>Installed Operators</strong> &#8594; <strong>Strimzi</strong> &#8594; <strong>Kafka</strong>: A new <code>kogito-kafka</code> custom resource is listed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-kafka-infra.png" alt="Image of Kafkas page in web console">
</div>
<div class="title">Figure 38. Kafka custom resource</div>
</div>
</li>
<li>
<p><strong>Workloads</strong> &#8594; <strong>Stateful Sets</strong>: New <code>kogito-kafka-kafka</code> and <code>kogito-kafka-zookeeper</code> stateful sets are deployed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-stateful-sets-kafka.png" alt="Image of Stateful Sets page in web console">
</div>
<div class="title">Figure 39. Stateful sets for Kafka</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-enable-data-index_kogito-deploying-on-openshift">Installing the {PRODUCT} Data Index Service for {PRODUCT} services on OpenShift</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Data Index Service that stores all {PRODUCT} events related to processes, tasks, and domain data. The Data Index Service uses Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all {PRODUCT} search, insight, and management capabilities.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the Data Index Service for data management in a {PRODUCT} project. For optimal {PRODUCT} deployment on OpenShift, enable the Data Index Service for your {PRODUCT} services. You can install the Data Index Service using the {PRODUCT} Operator page in the OpenShift web console (under <strong>{PRODUCT} Supporting Service</strong> with <code>serviceType</code> set to <code>DataIndex</code>) or using the {PRODUCT} CLI.</p>
</div>
<div class="paragraph">
<p>This example uses the {PRODUCT} CLI to install the Data Index Service and the {PRODUCT} Operator page in the web console to verify that the service is enabled.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the following Infinispan persistence and Kafka messaging infrastructure components for your {PRODUCT} services, as shown in the following example commands:</p>
<div class="listingblock">
<div class="title">Installing Infinispan and Kafka infrastructure components</div>
<div class="content">
<pre class="highlight"><code>$ kogito install infra kogito-infinispan-infra --kind Infinispan --apiVersion infinispan.org/v1
$ kogito install infra kogito-kafka-infra --kind Kafka --apiVersion kafka.strimzi.io/v1beta1</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, enter the following command to install the {PRODUCT} Data Index Service for the {PRODUCT} services:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Installing Data Index Service</div>
<div class="content">
<pre class="highlight"><code>$ kogito install data-index --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you enter this command, the {PRODUCT} Operator provisions the Data Index Service to connect to the specified infrastructures.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to the following windows to verify the installed Data Index Service:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Operators</strong> &#8594; <strong>Installed Operators</strong> &#8594; <strong>{PRODUCT}</strong> &#8594; <strong>{PRODUCT} Supporting Service</strong>: A new <code>kogito-data-index</code> custom resource is listed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-data-index.png" alt="Image of Kogito Data Index page in web console">
</div>
<div class="title">Figure 40. Data Index Service resource</div>
</div>
</li>
<li>
<p><strong>Workloads</strong> &#8594; <strong>Deployments</strong>: A new <code>kogito-data-index</code> deployment is listed.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-data-index-deployment.png" alt="Image of Data Index deployment page in web console">
</div>
<div class="title">Figure 41. Data Index Service deployment</div>
</div>
</li>
<li>
<p><strong>Networking</strong> &#8594; <strong>Routes</strong>: A new <code>kogito-data-index</code> route is listed.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-data-index-route.png" alt="Image of Data Index route page in web console">
</div>
<div class="title">Figure 42. Data Index Service route</div>
</div>
<div class="paragraph">
<p>You can click the <strong>Location</strong> URL to view the {PRODUCT} Data Index Service GraphQL interface (GraphiQL) and enter GraphQL queries for stored data.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-data-index-graphql2.png" alt="Image of Data Index GraphiQL interface">
</div>
<div class="title">Figure 43. Example GraphQL query in GraphiQL interface for Data Index Service</div>
</div>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-create-services_kogito-deploying-on-openshift">Creating {PRODUCT} service definitions on OpenShift using the {PRODUCT} CLI</h4>
<div class="paragraph _abstract">
<p>After you set up the required infrastructures for your application, you can create the {PRODUCT} service definitions and provision the OpenShift resources required for deployment with a binary build. You can create the service definitions using the OpenShift web console or using the {PRODUCT} CLI.</p>
</div>
<div class="paragraph">
<p>This example uses the {PRODUCT} CLI to create the service definitions for the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application and uses the {PRODUCT} Operator page in the web console to verify that the services are created.</p>
</div>
<div class="paragraph">
<p>The travel agency example application includes the following key OpenShift resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BuildConfig</code>: Configures the application to support a binary build in addition to a traditional OpenShift build for deployment. In a binary build, you build the application locally and push the built application to the OpenShift build to be packaged into the runtime container image. A binary build enables services to be deployed faster than a traditional OpenShift build and deployment.</p>
</li>
<li>
<p><code>ImageStream</code>: Defines the set of container images identified by tags.</p>
</li>
<li>
<p><code>Deployments</code>: Describes the desired state of the application as a pod template.</p>
</li>
<li>
<p><code>Service</code>: Functions as a Kubernetes-internal load balancer to serve the application pods.</p>
</li>
<li>
<p><code>Route</code>: Exposes the <code>Service</code> at a host name.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the following Infinispan persistence and Kafka messaging infrastructure components for your {PRODUCT} services, and you have installed the {PRODUCT} Data Index Service accordingly, as shown in the following example commands:</p>
<div class="listingblock">
<div class="title">Installing Infinispan, Kafka, and Data Index Service components</div>
<div class="content">
<pre class="highlight"><code>$ kogito install infra kogito-infinispan-infra --kind Infinispan --apiVersion infinispan.org/v1
$ kogito install infra kogito-kafka-infra --kind Kafka --apiVersion kafka.strimzi.io/v1beta1
$ kogito install data-index --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the <code>kogito-travel-agency</code> extended example application and enter the following commands to create {PRODUCT} service definitions for the <code>travels</code> and <code>visas</code> services with Infinispan persistence and Kafka messaging enabled:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Creating the travels service with persistence and messaging enabled</div>
<div class="content">
<pre class="highlight"><code>$ kogito deploy-service travels --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Creating the visas service with persistence and messaging enabled</div>
<div class="content">
<pre class="highlight"><code>$ kogito deploy-service visas --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the deployment configuration of this service is generated, the {PRODUCT} Operator automatically configures the environment variables to point to the location of the Kafka and Infinispan environments that you deployed previously. For Kafka messaging, the operator sets the incoming and outgoing messaging channels and properties as needed. For Infinispan persistence, the operator sets the authorization configuration based on the credentials generated by the Infinispan Operator.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also provide a Git repository location to create your services remotely instead of creating your services from a local source. However, this example uses local applications to demonstrate how to prepare the {PRODUCT} project on a development machine for a direct push to the cloud.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to <strong>Operators</strong> &#8594; <strong>Installed Operators</strong> &#8594; <strong>{PRODUCT}</strong> &#8594; <strong>{PRODUCT} Service</strong> and verify the new <code>travels</code> and <code>visas</code> services:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-create-app-listed-agency.png" alt="Image of travels and visas services listed in web console">
</div>
<div class="title">Figure 44. New travel agency and visas services listed</div>
</div>
<div class="paragraph">
<p>The new services are available but not yet deployed on OpenShift until you build and deploy the service projects from source using a binary build.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-deploy-binary_kogito-deploying-on-openshift">Deploying {PRODUCT} services on OpenShift using a binary build</h4>
<div class="paragraph _abstract">
<p>OpenShift builds can require extensive amounts of time. As a faster alternative for building and deploying your {PRODUCT} services on OpenShift, you can use a binary build. In a binary build, you build the application locally and push the built application to an OpenShift <code>BuildConfig</code> configuration to be packaged into the runtime container image.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application includes a <code>BuildConfig</code> configuration to support a binary build in addition to traditional building for deployment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>{PRODUCT} also supports Source-to-Image (S2I) builds, which build the application in an OpenShift build and then pass the built application to the next OpenShift build to be packaged into the runtime container image. The {PRODUCT} S2I build configuration also enables you to build the project directly from a Git repository on the OpenShift platform.</p>
</div>
<div class="paragraph">
<p>However, this example uses the local applications to demonstrate how to prepare the {PRODUCT} project on a development machine for a direct push to the cloud.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created the {PRODUCT} service definitions and provisioned the OpenShift resources required for deployment with a binary build, as described in <a href="#proc-kogito-travel-agency-create-services_kogito-deploying-on-openshift">Creating {PRODUCT} service definitions on OpenShift using the {PRODUCT} CLI</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the <code>kogito-travel-agency/extended/travels</code> example service and build the project using Maven:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Building the local travels project</div>
<div class="content">
<pre class="highlight"><code>$ cd kogito-travel-agency/extended/travels
$ mvn clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds the project in standard JDK mode to package the application as a runner JAR file and include any dependencies in a <code>lib</code> folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Alternatively, you can also build the project in native mode (requires GraalVM and SubstrateVM) to build and compile the application into a native executable for your system.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>The following resources are generated in the <code>target</code> folder in preparation for deployment from binary build:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>travels-1.0-SNAPSHOT.jar</code>: Standard JAR file with only the classes and resources of the project.</p>
</li>
<li>
<p><code>travels-1.0-SNAPSHOT-runner.jar</code>: Executable JAR file for the project. Note that this is not an uber-JAR file because the dependencies are copied into the <code>target/lib</code> directory.</p>
</li>
<li>
<p><code>lib</code>: Directory with project dependencies.</p>
</li>
</ul>
</div>
</li>
<li>
<p>From the same <code>kogito-travel-agency/extended/travels</code> directory location where you built the project, enter the following command to deploy the travels service to OpenShift using a binary build:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Deploying to OpenShift using binary build</div>
<div class="content">
<pre class="highlight"><code>$ oc start-build travels-binary --from-dir=target/

Uploading directory "target/" as binary input for the build ...
....
Uploading finished
build.build.openshift.io/travels-1 started</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the following command to check the logs of the builder pod if needed:</p>
</div>
<div class="listingblock">
<div class="title">Checking logs of builder pod</div>
<div class="content">
<pre class="highlight"><code>$ oc logs -f build/travels-binary-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the binary build is complete, the result is pushed to the <code>travels</code> Image Stream that was created by the {PRODUCT} Operator and triggers a new deployment.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to the following windows to verify the deployed service:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Workloads</strong> &#8594; <strong>Deployments</strong>: Select the <code>travels</code> deployment to view the application deployment details, pod status, and other details.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-app-deployment-details-agency.png" alt="Image of travels service deployment details page in web console">
</div>
<div class="title">Figure 45. Travels deployment details</div>
</div>
</li>
<li>
<p><strong>Networking</strong> &#8594; <strong>Routes</strong>: Select the <strong>Location</strong> URL for the <code>travels</code> route to view the main page of the {PRODUCT} travel agency application.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-travel-agency-app.png" alt="Image of Travel Agency application main page">
</div>
<div class="title">Figure 46. Travel agency application interface</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you verify that the travel agency application is deployed, repeat the same steps to deploy the visas application.</p>
</div>
</div>
</div>
</li>
<li>
<p>In a command terminal, navigate to the <code>kogito-travel-agency/extended/visas</code> example service and build the project using Maven:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Building the local visas project</div>
<div class="content">
<pre class="highlight"><code>$ cd kogito-travel-agency/extended/visas
$ mvn clean package</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Deploy the visas service to OpenShift using a binary build:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Deploying to OpenShift using binary build</div>
<div class="content">
<pre class="highlight"><code>$ oc start-build visas-binary --from-dir=target/

Uploading directory "target/" as binary input for the build ...
....
Uploading finished
build.build.openshift.io/visas-1 started</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the following command to check the logs of the builder pod if needed:</p>
</div>
<div class="listingblock">
<div class="title">Checking logs of builder pod</div>
<div class="content">
<pre class="highlight"><code>$ oc logs -f build/visas-binary-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the binary build is complete, the result is pushed to the <code>visas</code> Image Stream that was created by the {PRODUCT} Operator and triggers a new deployment.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to the following windows to verify the deployed service:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Workloads</strong> &#8594; <strong>Deployment Configs</strong>: Select the <code>visas</code> deployment to view the application deployment configurations, pod status, and other details.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-app-deployment-details-visas.png" alt="Image of visas service deployment details page in web console">
</div>
<div class="title">Figure 47. Visas deployment details</div>
</div>
</li>
<li>
<p><strong>Networking</strong> &#8594; <strong>Routes</strong>: Select the <strong>Location</strong> URL for the <code>visas</code> route to view the main page of the {PRODUCT} visas application.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-visas-app.png" alt="Image of Visas application main page">
</div>
<div class="title">Figure 48. Visas application interface</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-travel-agency-interacting_kogito-deploying-on-openshift">Interacting with the deployed travel agency services on OpenShift</h4>
<div class="paragraph _abstract">
<p>After you deploy the example travel agency services on {OPENSHIFT}, you can interact with the application interfaces to create a new travel plan.</p>
</div>
<div class="paragraph">
<p>You can also use a REST client or curl utility to send a REST request, such as the following example request body:</p>
</div>
<div class="listingblock">
<div class="title">Example REST request body to add a traveler and trip</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "traveller": {
    "firstName": "Jan",
    "lastName": "Kowalski",
    "email": "jan@email.com",
    "nationality": "Polish",
    "address": {
      "street": "Polna",
      "city": "Krakow",
      "zipCode": "32-000",
      "country": "Poland"
    }
  },
  "trip": {
    "country": "US",
    "city": "New York",
    "begin": "2019-11-04T00:00:00.000+02:00",
    "end": "2019-11-07T00:00:00.000+02:00"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The travels service enables users to book a trip to a certain destination, including flight and hotel. A rule set determines whether a visa is required for the specified destination. The visa approval logic is then implemented as needed by the visas service.</p>
</div>
<div class="paragraph">
<p>For this tutorial, use the application interfaces for the travels and visas services to book a trip from one country to another and approve the required visa.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have deployed your {PRODUCT} services on OpenShift using a binary build, as described in <a href="#proc-kogito-travel-agency-deploy-binary_kogito-deploying-on-openshift">Deploying {PRODUCT} services on OpenShift using a binary build</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the OpenShift web console, use the left menu to navigate to <strong>Networking</strong> &#8594; <strong>Routes</strong> and select the <strong>Location</strong> URL for the <code>travels</code> route to view the main page of the {PRODUCT} travel agency application:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-app-routes-agency.png" alt="Image of Routes page in web console">
</div>
<div class="title">Figure 49. Routes for available services in web console</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-travel-agency-app.png" alt="Image of Travel Agency application main page">
</div>
<div class="title">Figure 50. Travel agency application interface</div>
</div>
</div>
</div>
</li>
<li>
<p>In the travel agency application interface, click <strong>Plan new trip</strong>, enter details for a trip from one country to another, and click <strong>Book your trip</strong> to finish.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Ensure that the <strong>Nationality</strong> is different from the destination country so that a visa is required.</p>
</div>
<div class="paragraph">
<p>This example uses a traveler from Poland who is traveling to the United States:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-plan-new-trip.png" alt="Image of new trip details">
</div>
<div class="title">Figure 51. Book a new trip</div>
</div>
<div class="paragraph">
<p>The new trip is displayed in the main page of the application interface:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-new-trip-created.png" alt="Image of new trip in application main page">
</div>
<div class="title">Figure 52. New trip listed in main page of application interface</div>
</div>
</div>
</div>
</li>
<li>
<p>Next to the new trip, click <strong>Tasks</strong> to view the pending tasks for that trip.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-task-visaapplication.png" alt="Image of new trip tasks">
</div>
<div class="title">Figure 53. Tasks for the new trip</div>
</div>
</li>
<li>
<p>Next to the <strong>VisaApplication</strong> task, click <strong>Apply</strong>, enter random passport details in the application window, and click <strong>Submit application</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-task-visaapplication-form.png" alt="Image of new trip tasks">
</div>
<div class="title">Figure 54. Submit visa application</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to <strong>Networking</strong> &#8594; <strong>Routes</strong> and select the <strong>Location</strong> URL for the <code>visas</code> route to view the main page of the {PRODUCT} visas application.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The traveler visa application is displayed in the visas service interface.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-visas-application.png" alt="Image of new visa application in visas service interface">
</div>
<div class="title">Figure 55. New visa application listed in visas service interface</div>
</div>
</div>
</div>
</li>
<li>
<p>Next to the listed visa application, click <strong>Approval</strong> &#8594; <strong>Approve</strong> to approve the visa application.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-visas-task-approval.png" alt="Image of visa application approval">
</div>
<div class="title">Figure 56. Approve visa application</div>
</div>
</li>
<li>
<p>Return to the travel agency application interface, and next to the approved trip, click <strong>Tasks</strong> and then click <strong>Complete</strong> for the pending <strong>ConfirmTravel</strong> task to complete the trip:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-visa-approved.png" alt="Image of approved trip">
</div>
<div class="title">Figure 57. Trip listed and visa approved</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-task-confirm-travel.png" alt="Image of pending completion task">
</div>
<div class="title">Figure 58. Complete trip confirmation task</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-travel-agency-travel-complete.png" alt="Image of completed trip">
</div>
<div class="title">Figure 59. Trip confirmed and complete</div>
</div>
<div class="paragraph">
<p>Now that the application activity is complete, you can inspect the data that was created and stored by the {PRODUCT} Data Index Service that you configured for your application. In this case, you can search for data from booked trips and visa applications (<code>Travels</code> and <code>VisaApplications</code>) or for data from the underlying processes and tasks (<code>ProcessInstances</code> and <code>UserTaskInstances</code>).</p>
</div>
</div>
</div>
</li>
<li>
<p>In the OpenShift web console, use the left menu to navigate to <strong>Networking</strong> &#8594; <strong>Routes</strong> and select the <strong>Location</strong> URL for the <code>kogito-data-index</code> route to view the {PRODUCT} Data Index Service GraphQL interface (GraphiQL):</p>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-data-index-graphiql.png" alt="Image of Data Index GraphiQL interface">
</div>
<div class="title">Figure 60. GraphiQL interface for Data Index Service</div>
</div>
</li>
<li>
<p>In the GraphiQL interface, enter any of the following GraphQL queries to retrieve stored application data:</p>
<div class="ulist">
<ul>
<li>
<p>Retrieve data from booked trips (<code>Travels</code>):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{ Travels {
  id, traveller {
    email
    firstName
    lastName
    nationality
  }, trip {
    begin
    city
    country
    end
    visaRequired
  }
} }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-data-index-graphiql-travels.png" alt="Image of GraphQL query and response for travels">
</div>
<div class="title">Figure 61. Example response</div>
</div>
</div>
</div>
</li>
<li>
<p>Retrieve data from booked trips by traveler last name (<code>like: "Chop*"</code>):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{ Travels (where: {traveller: {lastName: {like: "Chop*"}}}) {
  id, traveller {
    email
    firstName
    lastName
    nationality
  }, trip {
    begin
    city
    country
    end
    visaRequired
  }
} }</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Retrieve data from visa applications (<code>VisaApplications</code>):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{ VisaApplications {
  visaApplication {
    approved
    city
    country
    duration
    firstName
    lastName
    nationality
    passportNumber
  }
} }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-data-index-graphiql-visaapplications.png" alt="Image of GraphQL query and response for visa applications">
</div>
<div class="title">Figure 62. Example response</div>
</div>
</div>
</div>
</li>
<li>
<p>Retrieve data from process instances (<code>ProcessInstances</code>):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{ ProcessInstances {
  id,
  processId,
  processName,
  state,
  nodes {
    name,
    type,
    enter,
    exit
  }
} }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-data-index-graphiql-process-instances.png" alt="Image of GraphQL query and response for process instances">
</div>
<div class="title">Figure 63. Example response</div>
</div>
</div>
</div>
</li>
<li>
<p>Retrieve data from user task instances (<code>UserTaskInstances</code>):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{ UserTaskInstances {
  name,
  priority,
  processId,
  processInstanceId
} }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-data-index-graphiql-usertask-instances.png" alt="Image of GraphQL query and response for user task instances">
</div>
<div class="title">Figure 64. Example response</div>
</div>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-kogito-operator-and-cli_kogito-deploying-on-openshift">{PRODUCT} Operator and CLI</h3>
<div class="paragraph _abstract">
<p>To help you deploy your {PRODUCT} services on {OPENSHIFT} or Kubernetes for cloud implementation, {PRODUCT} provides an operator and a command-line interface (CLI):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>{PRODUCT} Operator</strong>: An operator that guides you through the deployment process. The {PRODUCT} Operator is based on the <a href="https://sdk.operatorframework.io/">Operator SDK</a> and automates many of the deployment steps for you. For example, when you give the operator a link to the Git repository that contains your application, the operator can automatically configure the components required to build your project from source and deploy the resulting services.</p>
</li>
<li>
<p><strong>{PRODUCT} command-line interface (CLI)</strong>: A CLI tool that enables you to interact with the {PRODUCT} Operator for deployment tasks. The {PRODUCT} CLI also enables you to deploy {PRODUCT} services from source instead of relying on custom resources and YAML files. You can use the {PRODUCT} CLI as a command-line alternative for deploying {PRODUCT} services without the {OPENSHIFT} web console.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about the {PRODUCT} Operator and {PRODUCT} CLI and how to contribute, see the <code>README</code> file in the <a href="https://github.com/kiegroup/kogito-cloud-operator"><code>{PRODUCT_INIT}-cloud-operator</code></a> repository in GitHub.</p>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-architecture_kogito-deploying-on-openshift">{PRODUCT} Operator architecture</h4>
<div class="paragraph _abstract">
<p>The {PRODUCT} Operator is written in <a href="https://golang.org/">Go</a> and is built with the <a href="https://sdk.operatorframework.io/">Operator SDK</a>. The {PRODUCT} Operator uses the <a href="https://kubernetes.io/docs/concepts/overview/kubernetes-api/">Kubernetes API</a> for most of the deployment tasks that the operator facilitates and for other internal operations.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the following custom resources to deploy {PRODUCT} domain-specific services (the services that you develop), {PRODUCT} supporting services, and middleware infrastructure components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>KogitoBuild</code>: Defines the build configurations for {PRODUCT} domain-specific services deployed on OpenShift</p>
</li>
<li>
<p><code>KogitoRuntime</code>: Defines the deployment configurations for {PRODUCT} domain-specific services deployed on Kubernetes or OpenShift from a container image in an image registry</p>
</li>
<li>
<p><code>KogitoSupportingService</code>: Defines the deployment configurations for {PRODUCT} supporting services, such as the {PRODUCT} Data Index Service, Jobs Service, and Management Console</p>
</li>
<li>
<p><code>KogitoInfra</code>: Defines the relevant middleware infrastructure component or third-party operator for the {PRODUCT} service, such as Infinispan for persistence or Apache Kafka for messaging</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-cloud-operator">{PRODUCT} Operator source</a></p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-cloud-operator/tree/master/examples">{PRODUCT} Operator deployment examples</a></p>
</li>
<li>
<p><a href="https://sdk.operatorframework.io/docs/">Operator SDK documentation</a></p>
</li>
<li>
<p><a href="https://github.com/operator-framework/operator-sdk/tree/master/example">Operator SDK examples</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_product_operator_dependencies_on_third_party_operators">{PRODUCT} Operator dependencies on third-party operators</h5>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the following third-party operators to deploy {PRODUCT} service infrastructure components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a></strong>: Used to deploy Infinispan Server instances for process data persistence in {PRODUCT} services</p>
</li>
<li>
<p><strong><a href="https://github.com/strimzi/strimzi-kafka-operator">Strimzi Operator</a></strong>: Used to deploy Apache Kafka clusters with Zookeeper for messaging in {PRODUCT} services</p>
</li>
<li>
<p><strong><a href="https://github.com/keycloak/keycloak-operator">Keycloak Operator</a></strong>: Used to deploy Keycloak server instances for security and single sign-on capabilities in {PRODUCT} services</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you enable an infrastructure mechanism through a <code>KogitoInfra</code> deployment, the {PRODUCT} Operator uses the relevant third-party operator to create the infrastructure.</p>
</div>
<div class="paragraph">
<p>For example, the following <code>kogito-infinispan-infra</code> custom resource uses the <code>spec.resource.apiVersion</code> and <code>spec.resource.kind</code> configurations to enable Infinispan persistence for the {PRODUCT} service:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} infrastructure resource for Infinispan persistence</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoInfra
metadata:
  name: kogito-infinispan-infra
spec:
  resource:
    apiVersion: infinispan.org/v1
    kind: Infinispan</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, if an Infinispan Server instance named <code>kogito-infinispan</code> does not exist, then the {PRODUCT} Operator uses the Infinispan Operator to deploy the Infinispan Server instance for persistence.</p>
</div>
<div class="paragraph">
<p>Similar to the previous example, the following <code>kogito-kafka-infra</code> custom resource uses the <code>spec.resource.apiVersion</code> and <code>spec.resource.kind</code> configurations to enable Kafka messaging for the {PRODUCT} service:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} infrastructure resource for Kafka messaging</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoInfra
metadata:
  name: kogito-kafka-infra
spec:
  resource:
    apiVersion: kafka.strimzi.io/v1beta1
    kind: Kafka</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, if a Kafka cluster named <code>kogito-kafka</code> does not exist, then the {PRODUCT} Operator uses the Strimzi Operator to deploy the Kafka cluster for event messaging.</p>
</div>
<div class="paragraph">
<p>If you have a custom infrastructure resource, you can specify it in the <code>spec.resource.name</code> and <code>spec.resource.namespace</code> configurations:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} infrastructure resource for custom messaging</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoInfra
metadata:
  name: my-kafka-infra
spec:
  resource:
    apiVersion: kafka.strimzi.io/v1beta1
    kind: Kafka
    name: my-kafka-instance
    namespace: my-namespace</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>KogitoInfra</code> custom resource does not deploy a Kafka cluster, but connects to the Kafka cluster named <code>my-kafka-instance</code> from the namespace <code>my-namespace</code> for event messaging.</p>
</div>
<div class="paragraph">
<p>If the required third-party operators are not available to the {PRODUCT} Operator during {PRODUCT} service runtime, then the {PRODUCT} Operator cannot generate the infrastructure components and the user must install these operators in the OpenShift or Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Data Index Service similarly depends on Infinispan and Kafka infrastructure components. Without Infinispan persistence and Kafka messaging, the Data Index Service cannot function properly. However, you can specify whether the Data Index Service uses the general infrastructure components that the {PRODUCT} Operator generates or a custom alternative for that component.</p>
</div>
<div class="paragraph">
<p>For example, by default, the <code>KogitoSupportingService</code> custom resource that contains the <code>DataIndex</code> service type specifies the <code>infra</code> configuration for both Infinispan and Kafka in order to use the corresponding infrastructure components:</p>
</div>
<div class="listingblock">
<div class="title">Default <code>DataIndex</code> resource configuration with persistence and messaging</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoSupportingService
metadata:
  name: data-index
spec:
  serviceType: DataIndex
  replicas: 1
  infra:
     - kogito-infinispan-infra
     - kogito-kafka-infra</code></pre>
</div>
</div>
<div class="paragraph">
<p>You typically create <code>kogito-infinispan-infra</code> and <code>kogito-kafka-infra</code> custom resources before configuring the <code>KogitoSupportingService</code> custom resource that contains the <code>DataIndex</code> service type.</p>
</div>
</div>
<div class="sect4">
<h5 id="_product_operator_core_package_structure">{PRODUCT} Operator core package structure</h5>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the following core packages. Your understanding of the {PRODUCT} Operator package structure can help you use the operator more effectively or contribute to the development of the operator.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-operator-packages.png" alt="Image of Kogito Operator package layout">
</div>
<div class="title">Figure 65. {PRODUCT} Operator core package structure</div>
</div>
<div class="paragraph">
<p>The following list describes the function and interaction of these core packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cmd</code>: Contains the operator entry point and CLI implementation</p>
<div class="ulist">
<ul>
<li>
<p><code>manager</code>: Serves as the entry point for the {PRODUCT} Operator image</p>
</li>
<li>
<p><code>kogito</code>: Provides the implementation for the {PRODUCT} CLI</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>test</code>: Contains the implementation for Behavior Driven Development (BDD) tests based on <a href="https://github.com/cucumber/godog">Godog</a> (by Cucumber for Go)</p>
<div class="ulist">
<ul>
<li>
<p><code>config</code>: Provides the configuration for BDD tests</p>
</li>
<li>
<p><code>features</code>: Defines the features for BDD tests</p>
</li>
<li>
<p><code>framework</code>: Provides the support API framework to interact with other operator components</p>
</li>
<li>
<p><code>steps</code>: Defines BDD test steps</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>pkg</code>: Contains the implementation for the {PRODUCT} Operator</p>
<div class="ulist">
<ul>
<li>
<p><code>apis</code>: Defines the custom resource definition types for the resources that are managed by the {PRODUCT} Operator</p>
</li>
<li>
<p><code>client</code>: Serves as a wrapper for the Kubernetes and OpenShift clients</p>
</li>
<li>
<p><code>controller</code>: Defines the business logic for how the {PRODUCT} Operator responds to changes to the resources that are managed by the operator</p>
</li>
<li>
<p><code>framework</code>: Provides the common code related to any Kubernetes operator for all controllers</p>
</li>
<li>
<p><code>infrastructure</code>: Provides the common code related to the {PRODUCT} Operator infrastructure for all controllers, such as external endpoints among the services that are managed by the operator</p>
</li>
<li>
<p><code>logger</code>: Provides the implementation for the common logger for all other packages, based on <a href="https://github.com/uber-go/zap">Zap</a> (by Uber Go)</p>
</li>
<li>
<p><code>util</code>: Provides the common <a href="https://golang.org/">Go</a> utilities used across the project</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To explore {PRODUCT} Operator packages or contribute to the operator development, see the <a href="https://github.com/kiegroup/kogito-cloud-operator">{PRODUCT} Operator source</a> repository in GitHub.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-operator-and-cli-installing_kogito-deploying-on-openshift">Installing the {PRODUCT} Operator and CLI</h4>
<div class="paragraph _abstract">
<p>The {PRODUCT} command-line interface (CLI) enables you to interact with the {PRODUCT} Operator for deployment tasks. After you install the {PRODUCT} CLI, the first time that you use the CLI to interact with a project or service, the {PRODUCT} Operator is automatically installed and used to execute the relevant tasks.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://github.com/kiegroup/kogito-cloud-operator/releases"><code>{PRODUCT_INIT}-cloud-operator</code></a> releases page in GitHub and download the latest version of the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file that is specific to your operating system.</p>
</li>
<li>
<p>Extract the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file to a local directory:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>On Linux or Mac: In a command terminal, navigate to the directory where you downloaded the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file and enter the following command to extract the contents:</p>
<div class="listingblock">
<div class="title">Extract the {PRODUCT} CLI distribution</div>
<div class="content">
<pre class="highlight"><code>tar -xvf {PRODUCT_INIT}-cli-<em>RELEASE</em>.tar.gz</code></pre>
</div>
</div>
</li>
<li>
<p>On Windows: In your file browser, navigate to the directory where you downloaded the <code>{PRODUCT_INIT}-cli-<em>RELEASE</em></code> binary file and extract the ZIP file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>{PRODUCT_INIT}</code> executable file appears.</p>
</div>
</div>
</div>
</li>
<li>
<p>Move the extracted <code>{PRODUCT_INIT}</code> file to an existing directory in your <code>PATH</code> variable:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>On Linux or Mac: In a command terminal, enter the following command:</p>
<div class="listingblock">
<div class="title">Move the <code>{PRODUCT_INIT}</code> file</div>
<div class="content">
<pre class="highlight"><code>cp /<em>PATH_TO_{PRODUCT_INIT_CAP}</em> /usr/local/bin</code></pre>
</div>
</div>
</li>
<li>
<p>On Windows: Update the relevant <code>PATH</code> environment variables in your system settings to include the path to the {PRODUCT} CLI folder. For example, on Windows 10, go to <strong>Settings</strong> &#8594; <strong>System Info</strong> &#8594; <strong>Advanced System Settings</strong> &#8594; <strong>Advanced</strong> &#8594; <strong>Environment Variables</strong> and in the <strong>User</strong> or <strong>System</strong> variables, add the path for the {PRODUCT} CLI folder to the <code>PATH</code> variable. Close and reopen your Windows command prompt to apply the changes.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you install the {PRODUCT} CLI, the first time that you use the CLI to interact with a project or service, such as <code>{PRODUCT_INIT} use-project <em>PROJECT_NAME</em></code>, the {PRODUCT} Operator is automatically installed and used to execute the relevant tasks.</p>
</div>
<div class="paragraph">
<p>To install the {PRODUCT} Operator manually without using the {PRODUCT} CLI, you can use the OpenShift web console and go to <strong>Operators</strong> &#8594; <strong>OperatorHub</strong> in the left menu, search for and select <strong>Kogito</strong>, and follow the on-screen instructions to install the latest operator version.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} Operator is not available in the <strong>OperatorHub</strong> in the OpenShift web console, in a command terminal, enter the following command to add the operator to the Operator Lifecycle Manager (OLM) and try again to install the operator in the OpenShift web console:</p>
</div>
<div class="listingblock">
<div class="title">Adding the {PRODUCT} Operator to the OLM</div>
<div class="content">
<pre class="highlight"><code>$ oc create -f deploy/olm-catalog/kogito-operator/kogito-operator-operatorsource.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the OLM is not available in the cluster, you can install the {PRODUCT} Operator manually without the OLM by applying the following YAML files from the operator <a href="https://github.com/kiegroup/kogito-cloud-operator/tree/master/deploy"><code>deploy</code> directory</a> to the relevant namespace:</p>
</div>
<div class="listingblock">
<div class="title">Applying the {PRODUCT} Operator YAML resources manually without the OLM</div>
<div class="content">
<pre class="highlight"><code>$ oc apply -f deploy/service_account.yaml
$ oc apply -f deploy/role.yaml
$ oc apply -f deploy/role_binding.yaml
$ oc apply -f deploy/operator.yaml</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-operator-installing-in-ocp-console_kogito-deploying-on-openshift">Installing the {PRODUCT} Operator in the OpenShift web console</h4>
<div class="paragraph _abstract">
<p>As an alternative or a supplement to the {PRODUCT} command-line interface (CLI), you can use the {PRODUCT} Operator page in the {OPENSHIFT} web console to define {PRODUCT} infrastructure components and deploy {PRODUCT} services.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The application with your {PRODUCT} services is in a Git repository that is reachable from your OpenShift environment.</p>
</li>
<li>
<p>You have access to the OpenShift web console with <code>cluster-admin</code> permissions.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the OpenShift web console, go to <strong>Operators</strong> &#8594; <strong>OperatorHub</strong> in the left menu, search for and select <strong>Kogito</strong>, and follow the on-screen instructions to install the latest operator version.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the {PRODUCT} Operator is not available in the <strong>OperatorHub</strong> in the OpenShift web console, in a command terminal, enter the following command to add the operator to the Operator Lifecycle Manager (OLM) and try again to install the operator in the OpenShift web console:</p>
</div>
<div class="listingblock">
<div class="title">Adding the {PRODUCT} Operator to the OLM</div>
<div class="content">
<pre class="highlight"><code>$ oc create -f deploy/olm-catalog/kogito-operator/kogito-operator-operatorsource.yaml</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>After you install the {PRODUCT} Operator, in the OpenShift web console, go to <strong>Operators</strong> &#8594; <strong>Installed Operators</strong> and select <strong>Kogito</strong> to begin defining your {PRODUCT} service components.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Use the upper toolbar options in the {PRODUCT} Operator page as needed to configure <strong>Kogito Infra</strong> components, such as Infinispan persistence and Kafka messaging, to configure <strong>{PRODUCT} Supporting Service</strong> components, such as the {PRODUCT} Data Index Service and Jobs Service, and to create a <strong>{PRODUCT} Service</strong> instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-ocp-create-app-listed-agency.png" alt="Image of travels and visas services listed in web console">
</div>
<div class="title">Figure 66. {PRODUCT} Operator page in OpenShift web console with {PRODUCT} services</div>
</div>
<div class="paragraph">
<p>Any {PRODUCT} services and related components that you define using the {PRODUCT} CLI are automatically updated in the OpenShift web console.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="ref-kogito-cli-operations_kogito-deploying-on-openshift">Supported operations in the {PRODUCT} CLI</h4>
<div class="paragraph _abstract">
<p>The {PRODUCT} command-line interface (CLI) supports the following operations on Linux, Mac, and Windows operating systems. The syntax of some operations might vary for Windows users, such as a backslash (<code>\</code>) instead of a forward slash (<code>/</code>).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Supported operations in the {PRODUCT} CLI</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 35%;">
<col style="width: 35%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operation</th>
<th class="tableblock halign-left valign-top">{PRODUCT} CLI command</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create an OpenShift project for {PRODUCT} services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} new-project <em>PROJECT_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} new-project kogito-travel-agency</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connect the {PRODUCT} Operator to an existing OpenShift project with {PRODUCT} services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} use-project <em>PROJECT_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} use-project kogito-travel-agency</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the Infinispan infrastructure for process data persistence in {PRODUCT} services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install infra <em>INFINISPAN_INFRA_NAME</em> --kind Infinispan --apiVersion infinispan.org/v1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install infra kogito-infinispan-infra --kind Infinispan --apiVersion infinispan.org/v1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the Apache Kafka infrastructure for messaging in {PRODUCT} services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install infra <em>KAFKA_INFRA_NAME</em> --kind Kafka --apiVersion kafka.strimzi.io/v1beta1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install infra kogito-kafka-infra --kind Kafka --apiVersion kafka.strimzi.io/v1beta1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the {PRODUCT} Data Index Service for data management in {PRODUCT} services and provision the Data Index Service to connect to the specified Infinispan and Kafka infrastructures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install data-index --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install data-index --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the {PRODUCT} Jobs Service for job scheduling in {PRODUCT} services and provision the Jobs Service to connect to the specified Infinispan and Kafka infrastructures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install jobs-service --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install jobs-service --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the {PRODUCT} Management Console for managing process instance details in {PRODUCT} services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install mgmt-console</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install mgmt-console</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the {PRODUCT} Trusty Service to store tracing events and provide advanced analytical capabilities in {PRODUCT} services, and provision the Trusty Service to connect to the specified Infinispan and Kafka infrastructures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install trusty --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install trusty --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the {PRODUCT} Explainability Service to analyze decisions made in {PRODUCT} services and provision the Explainability Service to connect to the specified Kafka infrastructure.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install explainability --infra <em>KAFKA_INFRA_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install explainability --infra kogito-kafka-infra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install the {PRODUCT} Task Console for viewing and interacting with user tasks in {PRODUCT} process services.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install task-console</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install task-console</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Install {PRODUCT} supporting services or infrastructure components for a specified {PRODUCT} project. Use this syntax if you did not use the <code>new-project</code> or <code>use-project</code> commands to connect the {PRODUCT} Operator to a specified project.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install <em>KOGITO_SUPPORTING_SERVICE</em> --infra <em>KOGITO_INFRA_NAME</em> -p <em>PROJECT_NAME</em></code></p>
<p class="tableblock"><code>{PRODUCT_INIT} install infra <em>KOGITO_INFRA_NAME</em> <em>KOGITO_INFRA_DETAILS</em> -p <em>PROJECT_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} install data-index --infra kogito-infinispan-infra --infra kogito-kafka-infra -p kogito-travel-agency</code></p>
<p class="tableblock"><code>{PRODUCT_INIT} install infra kogito-infinispan-infra --kind Infinispan --apiVersion infinispan.org/v1 -p kogito-travel-agency</code></p>
<p class="tableblock"><code>{PRODUCT_INIT} install infra kogito-kafka-infra --kind Kafka --apiVersion kafka.strimzi.io/v1beta1 -p kogito-travel-agency</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a {PRODUCT} service definition from a local source or from a Git repository and deploy the service. In a binary build configuration, this command creates the service definition but does not deploy the service.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em></code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> <em>GIT_REPOSITORY_URL</em> --context-dir <em>PROJECT_DIRECTORY</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service travels</code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable Infinispan persistence and Apache Kafka messaging for a {PRODUCT} service during deployment. Use this command if you installed the relevant infrastructures using the {PRODUCT} Operator. In a binary build configuration, this command creates the service definition but does not deploy the service.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em></code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> <em>GIT_REPOSITORY_URL</em> --context-dir <em>PROJECT_DIRECTORY</em> --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service travels --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels --infra kogito-infinispan-infra --infra kogito-kafka-infra</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a {PRODUCT} service definition from a local or Git source and deploy the service using a native build.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> --native</code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> <em>GIT_REPOSITORY_URL</em> --context-dir <em>PROJECT_DIRECTORY</em> --native</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service travels --native</code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels --native</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upload a {PRODUCT} service file, such as a Decision Model and Notation (DMN) or Business Process Model and Notation (BPMN) file, or a file directory with multiple files to an OpenShift Cluster and trigger a new Source-to-Image (S2I) build. For single files, you can specify a local file system path or Git repository URL. For file directories, you can specify a local file system path only.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> <em>PATH_TO_FILE_OR_DIR</em></code></p>
<p class="tableblock"><code>{PRODUCT_INIT} deploy-service <em>SERVICE_NAME</em> <em>GIT_FILE_URL</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito deploy-service travels /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2</code></p>
<p class="tableblock"><code>kogito deploy-service travels /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels</code></p>
<p class="tableblock"><code>kogito deploy-service travels https://github.com/kiegroup/kogito-examples/blob/stable/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete a {PRODUCT} service.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} delete-service <em>SERVICE_NAME</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{PRODUCT_INIT} delete-service travels</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-deployment-options_kogito-deploying-on-openshift">OpenShift deployment options with the {PRODUCT} Operator and CLI</h4>
<div class="paragraph _abstract">
<p>The {PRODUCT} Operator and command-line interface (CLI) support the following options for building and deploying {PRODUCT} services on {OPENSHIFT}:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Git source build and deployment</p>
</li>
<li>
<p>Binary build and deployment</p>
</li>
<li>
<p>File build and deployment</p>
</li>
<li>
<p>Native build and deployment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{PRODUCT} provides the relevant Source-to-Image (S2I) build configuration depending the deployment option that you use.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For all deployment options, you must be logged in to the relevant OpenShift cluster using the <code>oc login</code> command.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_git_source_build_and_deployment">Git source build and deployment</h5>
<div class="paragraph">
<p>In most use cases, you can use the standard runtime build and deployment method to deploy {PRODUCT} services on OpenShift from a Git repository source, as shown in the following examples. These examples are based on the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application.</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from existing namespace</div>
<div class="content">
<pre class="highlight"><code>// Uses the provisioned namespace in your OpenShift cluster
$ {PRODUCT_INIT} use-project <em>PROJECT_NAME</em>

// Deploys a new {PRODUCT} service from a Git source
$ {PRODUCT_INIT} deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the default branch in the specified Git repository, usually <code>master</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can generate a new namespace in your cluster during deployment:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from new namespace</div>
<div class="content">
<pre class="highlight"><code>// Creates a new namespace in your cluster
$ {PRODUCT_INIT} new-project <em>NEW_PROJECT_NAME</em>

// Deploys a new {PRODUCT} service from a Git source
$ {PRODUCT_INIT} deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are developing or testing your {PRODUCT} service locally, you can use the binary build or file build option to build and deploy from a local source instead of from a Git repository.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_binary_build_and_deployment">Binary build and deployment</h5>
<div class="paragraph">
<p>OpenShift builds can require extensive amounts of time. As a faster alternative for building and deploying your {PRODUCT} services on OpenShift, you can use a binary build. In a binary build, you build the application locally and push the built application to an OpenShift <code>BuildConfig</code> configuration to be packaged into the runtime container image.</p>
</div>
<div class="paragraph">
<p>The following example creates a {PRODUCT} service from a local directory, builds the project binaries, and deploys the binary build to OpenShift. This example is based on the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application.</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from binary build</div>
<div class="content">
<pre class="highlight"><code>// Creates the {PRODUCT} service
$ cd ~/kogito-travel-agency/extended/travels
$ kogito deploy-service travels

// Builds the project and generates binary resources in <code>target</code> folder
$ mvn clean package

// Deploys to OpenShift using binary build
$ oc start-build travels-binary --from-dir=target/

Uploading directory "target/" as binary input for the build ...
....
Uploading finished
build.build.openshift.io/travels-1 started</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the following resources were generated in the <code>target</code> folder in preparation for the binary build:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>travels-1.0-SNAPSHOT.jar</code>: Standard JAR file with only the classes and resources of the project.</p>
</li>
<li>
<p><code>travels-1.0-SNAPSHOT-runner.jar</code>: Executable JAR file for the project. Note that this is not an uber-JAR file because the dependencies are copied into the <code>target/lib</code> directory.</p>
</li>
<li>
<p><code>lib</code>: Directory with project dependencies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After the binary build is complete, the result is pushed to the <code>travels</code> Image Stream that was created by the {PRODUCT} Operator and triggers a new deployment.</p>
</div>
</div>
<div class="sect4">
<h5 id="_file_build_and_deployment">File build and deployment</h5>
<div class="paragraph">
<p>You can build and deploy your {PRODUCT} services from a single file, such as a Decision Model and Notation (DMN), Business Process Model and Notation (BPMN or BPMN2), Drools Rule Language (DRL), or properties file, or from a directory with multiple files. You can specify a single file from your local file system path or from a Git repository URL, or specify a file directory from a local file system path only. When you upload the file or directory to an OpenShift cluster, a new Source-to-Image (S2I) build is automatically triggered.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You cannot upload a file directory from a Git repository. The file directory must be in your local file system. However, you can upload single files from either a Git repository or your local file system.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following examples upload a single BPMN file from a local directory or Git repository to an OpenShift cluster for an S2I build. These examples are based on the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application.</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from a local file</div>
<div class="content">
<pre class="highlight"><code>$ kogito deploy-service travels /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2

File found: /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2.
...
The requested file(s) was successfully uploaded to OpenShift, a build with this file(s) should now be running. To see the logs, run 'oc logs -f bc/kogito-travel-agency-builder -n kogito'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from a Git repository file</div>
<div class="content">
<pre class="highlight"><code>$ kogito deploy-service travels https://github.com/kiegroup/kogito-examples/blob/stable/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2

Asset found: travels.bpmn2.
...
The requested file(s) was successfully uploaded to OpenShift, a build with this file(s) should now be running. To see the logs, run 'oc logs -f bc/kogito-travel-agency-builder -n kogito'</code></pre>
</div>
</div>
<div class="paragraph">
<p>As instructed in the terminal output, you can run the following command to see the build logs:</p>
</div>
<div class="listingblock">
<div class="title">Example build log for BPMN file build</div>
<div class="content">
<pre class="highlight"><code>$ oc logs -f bc/kogito-travel-agency-builder -n kogito

Receiving source from STDIN as file travels.bpmn2
Using docker-registry.default.svc:5000/openshift/kogito-quarkus-ubi8-s2i@sha256:729e158710dedba50a49943ba188d8f31d09568634896de9b903838fc4e34e94 as the s2i builder image</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following examples upload multiple files within a local directory to an OpenShift cluster for an S2I build:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment from multiple files in a local directory</div>
<div class="content">
<pre class="highlight"><code>$ kogito deploy-service travels /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels

The provided source is a dir, packing files.
File(s) found: [/tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/flightBooking.bpmn2 /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/hotelBooking.bpmn2 /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2].
...
The requested file(s) was successfully uploaded to OpenShift, a build with this file(s) should now be running. To see the logs, run 'oc logs -f bc/travels-builder -n kogito'</code></pre>
</div>
</div>
<div class="paragraph">
<p>For every valid file type (DMN, BPMN, BPMN2, DRL) in the specified directory, the {PRODUCT} CLI compresses the files and uploads them to the OpenShift cluster. Any other unsupported file types are not uploaded. To ensure that other file types are uploaded, consider using a source build or a binary build.</p>
</div>
<div class="paragraph">
<p>If you need to update an uploaded file or directory after you create the build, you can use the <code>oc start-build</code> command to re-upload the file or directory, as shown in the following example. An S2I build cannot identify only changed files in a directory, so you must re-upload the entire directory of files to update the build.</p>
</div>
<div class="listingblock">
<div class="title">Example command to re-upload a single local file to update the S2I build</div>
<div class="content">
<pre>$ oc start-build kogito-travel-agency-builder --from-file tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels/travels.bpmn2</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example command to re-upload multiple files from a local directory to update the S2I build</div>
<div class="content">
<pre>$ oc start-build kogito-travel-agency-builder --from-dir tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels</pre>
</div>
</div>
<div class="paragraph">
<p>If a build fails, use the OpenShift environment variable <a href="https://docs.openshift.com/container-platform/4.3/builds/basic-build-operations.html#builds-basic-access-build-verbosity_basic-build-operations"><code>BUILD_LOGLEVEL</code></a> with the desired level as part of your deployment command, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example command to troubleshoot failed build from directory</div>
<div class="content">
<pre class="highlight"><code>$ kogito --verbose deploy-service travels /tmp/kogito-examples/kogito-travel-agency/extended/travels/src/main/resources/org/acme/travels --build-env BUILD_LOGLEVEL=5</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_native_build_and_deployment">Native build and deployment</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Native build and deployment is for Quarkus only and requires GraalVM.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the {PRODUCT} Operator and CLI build services with traditional <code>java</code> compilers to save time and resources. The final generated artifact is a JAR file for the relevant runtime (defaults to Quarkus) with dependencies in the image user&#8217;s home directory, such as <code>/home/kogito/bin/lib</code>.</p>
</div>
<div class="paragraph">
<p>However, for {PRODUCT} services on Quarkus with GraalVM (required), the {PRODUCT} Operator and CLI can build the services in native mode for direct binary execution as native code. Building in native mode uses a very low footprint on the runtime, although many resources are consumed during build time.</p>
</div>
<div class="paragraph">
<p>For more information about native build performance, see the GraalVM <a href="https://www.graalvm.org/docs/examples/java-performance-examples/">Performance examples for Java</a>.</p>
</div>
<div class="paragraph">
<p>For more information about ahead-of-time (AOT) compilation, see the <a href="https://www.graalvm.org/docs/reference-manual/aot-compilation/">GraalVM Native Image</a> documentation.</p>
</div>
<div class="paragraph">
<p>The following examples build a {PRODUCT} service on Quarkus in native mode using the <code>--native</code> parameter. These examples are based on the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application.</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service native build from a local source directory</div>
<div class="content">
<pre class="highlight"><code>$ cd ~/kogito-travel-agency/extended/travels
$ {PRODUCT_INIT} deploy-service travels --native</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service native build from a Git repository source directory</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels --native</code></pre>
</div>
</div>
<div class="paragraph">
<p>In {PRODUCT} Operator tests, native builds take approximately 10 minutes and the build pod can consume up to 10GB of RAM and 1.5 CPU cores.</p>
</div>
<div class="paragraph">
<p>By default, a {PRODUCT} project does not contain resource requests or limits. As a result, a native build might be terminated due to insufficient memory. To prevent this behavior, you can create a minimum memory request configuration for the {PRODUCT} application build, ensuring that the build pod is allocated on an OpenShift node with enough free memory. The side effect of this configuration is that OpenShift prioritizes the build pod.</p>
</div>
<div class="paragraph">
<p>For more information about OpenShift pod prioritization based on pod requests and limits, see <a href="https://docs.okd.io/3.11/dev_guide/compute_resources.html#quality-of-service-tiers">Quality of Service Tiers</a> in the OpenShift documentation.</p>
</div>
<div class="paragraph">
<p>The following example is a memory request configuration for the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended"><code>kogito-travel-agency</code></a> extended example application:</p>
</div>
<div class="listingblock">
<div class="title">Example memory request configuration for <code>kogito-travel-agency</code></div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoBuild
metadata:
  name: travels
  namespace: kogito
spec:
  type: RemoteSource
  gitSource:
    contextDir: kogito-travel-agency/extended/travels
    uri: "https://github.com/kiegroup/kogito-examples/"
  resources:
    requests:
        memory: "4Gi"</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Ensure that you have these resources available on your OpenShift nodes when you run native builds. If the resources are not available, the S2I build fails. You can verify currently allocated and total resources of your nodes by using the command <code>oc describe nodes</code> invoked with <code>admin</code> permission.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can limit the maximum heap space for the JVM used for a native build. You can apply the limitation by setting the <code>quarkus.native.native-image-xmx</code> property in the <code>application.properties</code> file of your {PRODUCT} project. In this case, the build pod requires roughly <code>-Xmx</code> plus 2 GB of memory. The <code>-Xmx</code> value depends on the complexity of the application. For example, for the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-quarkus-example"><code>process-quarkus-example</code></a> example application, the <code>-Xmx</code> value <code>2g</code> is sufficient, resulting in the builder pod consuming up to 4.2 GB of memory.</p>
</div>
<div class="paragraph">
<p>You can also set resource limits for a native build pod. In the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-quarkus-example"><code>process-quarkus-example</code></a> application, 80 percent of the memory limit is used for heap space in the JVM responsible for the native build. If the computed heap space limit for the JVM is less than 1024 MB, then all the memory from resource limits is used.</p>
</div>
<div class="paragraph">
<p>The following example is a memory limit configuration for the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-quarkus-example"><code>process-quarkus-example</code></a> example application:</p>
</div>
<div class="listingblock">
<div class="title">Example memory request configuration for <code>process-quarkus-example</code></div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoBuild
metadata:
  name: process-quarkus-example
  namespace: kogito
spec:
  type: RemoteSource
  gitSource:
    contextDir: process-quarkus-example
    uri: "https://github.com/kiegroup/kogito-examples/"
  resources:
    limits:
        memory: "4Gi"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-kogito-operator-deployment-configs_kogito-deploying-on-openshift">{PRODUCT} service properties configuration</h5>
<div class="paragraph _abstract">
<p>When a {PRODUCT} service is deployed, a <code>configMap</code> resource is created for the <code>application.properties</code> configuration of the {PRODUCT} service.</p>
</div>
<div class="paragraph">
<p>The name of the <code>configMap</code> resource consists of the name of the {PRODUCT} service and the suffix <code>-properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>configMap</code> resource generated during {PRODUCT} service deployment</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: kogito-travel-agency-properties
data:
  application.properties : |-
    property1=value1
    property2=value2</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>application.properties</code> data of the <code>configMap</code> resource is mounted in a volume to the container of the {PRODUCT} service. Any runtime properties that you add to the <code>application.properties</code> section override the default application configuration properties of the {PRODUCT} service.</p>
</div>
<div class="paragraph">
<p>When the <code>application.properties</code> data of the <code>configMap</code> is changed, a rolling update modifies the deployment and configuration of the {PRODUCT} service.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-infinispan_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with Infinispan</h4>
<div class="paragraph _abstract">
<p>You can install the Infinispan infrastructure for process data persistence in {PRODUCT} services by using the following {PRODUCT} CLI operation or by providing a <code>KogitoInfra</code> custom resource definition:</p>
</div>
<div class="listingblock">
<div class="title">Enable Infinispan persistence using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>INFINISPAN_INFRA_NAME</em> --kind Infinispan --apiVersion infinispan.org/v1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Enable Infinispan persistence using a custom resource definition</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoInfra
metadata:
  name: INFINISPAN_INFRA_NAME
spec:
  resource:
    apiVersion: infinispan.org/v1
    kind: Infinispan</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you install the Infinispan infrastructure for your {PRODUCT} project using the {PRODUCT} CLI, the {PRODUCT} Operator creates a <code>KogitoInfra</code> custom resource to handle Infinispan deployment for you. This resource is added to your {PRODUCT} project and in the {PRODUCT} Operator page of the <strong>Installed Operators</strong> listed in the OpenShift web console, if applicable.</p>
</div>
<div class="paragraph">
<p>The <code>KogitoInfra</code> resource uses the <a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a> to deploy new Infinispan Server instances when needed. Due to this dependency, the Infinispan Operator must be installed in the same namespace where you deployed the custom {PRODUCT} service. For information about Infinispan Operator installation, see the <a href="https://infinispan.org/infinispan-operator/master/operator.html">Infinispan Operator Guide</a>.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator does not manage Infinispan instances, but you can edit and manage Infinispan instances as needed. For example, if you want to scale the Infinispan cluster, you can edit the <code>replicas</code> field in the <a href="https://github.com/infinispan/infinispan-operator/blob/master/pkg/apis/infinispan/v1/infinispan_types.go"><code>infinispan_types.go</code></a> custom resource to meet your requirements.</p>
</div>
<div class="paragraph">
<p>By default, the <code>KogitoInfra</code> resource creates a secret that holds the user name and password for Infinispan authentication. To view the credentials, enter the following command:</p>
</div>
<div class="listingblock">
<div class="title">View {PRODUCT} Infinispan credentials</div>
<div class="content">
<pre class="highlight"><code>$ oc get secret/kogito-infinispan-credential -o yaml

apiVersion: v1
data:
  password: VzNCcW9DeXdpMVdXdlZJZQ==
  username: ZGV2ZWxvcGVy
kind: Secret
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The key values are masked by a Base64 algorithm. To view the password from the previous example output in your terminal, enter the following command:</p>
</div>
<div class="listingblock">
<div class="title">Reveal {PRODUCT} Infinispan password</div>
<div class="content">
<pre class="highlight"><code>$ echo VzNCcW9DeXdpMVdXdlZJZQ== | base64 -d

W3BqoCywi1WWvVIe</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_infinispan_persistence_in_product_services">Infinispan persistence in {PRODUCT} services</h5>
<div class="paragraph">
<p>After you install the <code>KogitoInfra</code> custom resource to connect with the Infinispan infrastructure, to enable Infinispan persistence for a {PRODUCT} service using the {PRODUCT} Operator, use the <code>--infra <em>INFINISPAN_INFRA_NAME</em></code> flag during deployment in the {PRODUCT} CLI or edit the <code>spec.infra</code> configuration in the <code>KogitoRuntime</code> custom resource:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment with Infinispan persistence enabled using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} deploy-service travels --infra <em>INFINISPAN_INFRA_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service custom resource with Infinispan persistence enabled</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoRuntime
metadata:
  name: travels
spec:
  infra:
    - INFINISPAN_INFRA_NAME</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you set up a custom Infinispan cluster, you can refer to it in the <code>KogitoRuntime</code> custom resource by configuring the following environment variables and application properties:</p>
</div>
<div class="listingblock">
<div class="title">Required environment variables for a custom Infinispan cluster</div>
<div class="content">
<pre class="highlight"><code>ENABLE_PERSISTENCE=true

# On Quarkus
QUARKUS_INFINISPAN_CLIENT_AUTH_USERNAME
QUARKUS_INFINISPAN_CLIENT_AUTH_PASSWORD

# On Spring Boot
INFINISPAN_REMOTE_AUTH_USERNAME
INFINISPAN_REMOTE_AUTH_PASSWORD</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Required application properties for a custom Infinispan cluster</div>
<div class="content">
<pre class="highlight"><code># On Quarkus
quarkus.infinispan-client.server-list=
quarkus.infinispan-client.use-auth=
quarkus.infinispan-client.sasl-mechanism=
quarkus.infinispan-client.auth-realm=

# On Spring Boot
infinispan.remote.server-list=
infinispan.remote.use-auth=
infinispan.remote.sasl-mechanism=
infinispan.remote.auth-realm=</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-persistence_kogito-configuring[Persistence in {PRODUCT}]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[{PRODUCT} Data Index Service]</p>
</li>
<li>
<p><a href="https://github.com/infinispan/infinispan-operator/blob/master/README.md">Infinispan Operator</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-kafka_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with Apache Kafka</h4>
<div class="paragraph _abstract">
<p>You can install the Apache Kafka infrastructure for messaging in {PRODUCT} services by using the following {PRODUCT} CLI operation or by providing a <code>KogitoInfra</code> custom resource definition:</p>
</div>
<div class="listingblock">
<div class="title">Enable Kafka messaging using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>KAFKA_INFRA_NAME</em> --kind Kafka --apiVersion kafka.strimzi.io/v1beta1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Enable Kafka messaging using a custom resource definition</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoInfra
metadata:
  name: KAFKA_INFRA_NAME
spec:
  resource:
    apiVersion: kafka.strimzi.io/v1beta1
    kind: Kafka</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you install the Kafka infrastructure for your {PRODUCT} project using the {PRODUCT} CLI, the {PRODUCT} Operator creates a <code>KogitoInfra</code> custom resource to handle the Kafka cluster deployment for you. This resource is added to your {PRODUCT} project and in the {PRODUCT} Operator page of the <strong>Installed Operators</strong> listed in the OpenShift web console, if applicable.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the <a href="https://strimzi.io/docs/latest/">Strimzi Operator</a> to deploy a Kafka cluster with Zookeeper to support sending and receiving messages within a process. Due to this dependency, the Strimzi Operator must be installed in the Kafka cluster. For information about Strimzi Operator installation, see the <a href="https://strimzi.io/docs/operators/master/quickstart.html">Strimzi Quick Start guide</a>.</p>
</div>
<div class="paragraph">
<p>After the Strimzi Operator deploys Kafka instances, you can edit the instances to meet your requirements.</p>
</div>
<div class="sect4">
<h5 id="_apache_kafka_messaging_in_product_services">Apache Kafka messaging in {PRODUCT} services</h5>
<div class="paragraph">
<p>After you install the <code>KogitoInfra</code> custom resource to connect with the Apache Kafka infrastructure, to enable Kafka messaging for a {PRODUCT} service using the {PRODUCT} Operator, use the <code>--infra <em>KAFKA_INFRA_NAME</em></code> flag during deployment in the {PRODUCT} CLI or edit the <code>spec.infra</code> configuration in the <code>KogitoRuntime</code> custom resource:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment with Kafka messaging enabled using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} deploy-service travels --infra <em>KAFKA_INFRA_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service custom resource with Kafka messaging enabled</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoRuntime
metadata:
  name: travels
spec:
  infra:
    - KAFKA_INFRA_NAME</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you enable Kafka messaging, a variable named <code>KAFKA_BOOTSTRAP_SERVERS</code> is injected into the service container. On Quarkus, this is the default behavior when you use <a href="https://quarkus.io/guides/kafka-streams#topic-configuration">Kafka Client</a> 1.x or later. On Spring Boot, you might need to use a property substitution in the <code>application.properties</code> file, such as the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example application property substitution for Kafka on Spring Boot</div>
<div class="content">
<pre class="highlight"><code>spring.kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the service container has any environment variables with the suffix <code>_BOOTSTRAP_SERVERS</code>, the variables are also injected by the value of the <code>KAFKA_BOOTSTRAP_SERVERS</code> variable.</p>
</div>
<div class="paragraph">
<p>For example, when you deploy the following {PRODUCT} service, the variables <code>MP_MESSAGING_INCOMING_TRAVELLERS_BOOTSTRAP_SERVERS</code> and <code>MP_MESSAGING_OUTGOING_PROCESSEDTRAVELLERS_BOOTSTRAP_SERVERS</code> are injected with the deployed Kafka service URL:</p>
</div>
<div class="listingblock">
<div class="title">Example {PRODUCT} service deployment with injected Kafka variable values</div>
<div class="content">
<pre class="highlight"><code>$ kogito deploy-service travels https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended --context-dir travels --infra kogito-kafka-infra \
--build-env MAVEN_ARGS_APPEND="-Pevents" \
-e MP_MESSAGING_INCOMING_TRAVELLERS_BOOTSTRAP_SERVERS
-e MP_MESSAGING_OUTGOING_PROCESSEDTRAVELLERS_BOOTSTRAP_SERVERS</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you set up a custom Kafka cluster, you can refer to it in the <code>KogitoRuntime</code> custom resource by configuring the following environment variable and application property:</p>
</div>
<div class="listingblock">
<div class="title">Required environment variable for a custom Kafka cluster</div>
<div class="content">
<pre class="highlight"><code>ENABLE_EVENTS=true</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Required application property for a custom Kafka cluster</div>
<div class="content">
<pre class="highlight"><code># On Quarkus
kafka.bootstrap.servers=

# On Spring Boot
spring.kafka.bootstrap-servers=</code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-messaging-enabling_kogito-configuring[Enabling messaging for {PRODUCT} services]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[{PRODUCT} Data Index Service]</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-data-index-service_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with the {PRODUCT} Data Index Service</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Data Index Service that stores all {PRODUCT} events related to processes, tasks, and domain data. The Data Index Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all {PRODUCT} search, insight, and management capabilities.</p>
</div>
<div class="paragraph">
<p>You can use the following {PRODUCT} command-line interface (CLI) operation to install the {PRODUCT} Data Index Service for data management in {PRODUCT} services:</p>
</div>
<div class="listingblock">
<div class="title">Enable Data Index Service</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install data-index --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em> -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of using the default Infinispan-based persistence in the {PRODUCT} Data Index Service, you can use the following command to configure the Data Index Service to use <a href="https://www.mongodb.com/">MongoDB</a> persistence storage if needed. A <a href="https://www.mongodb.com/try/download">MongoDB Server</a> 3.6 or later must already be installed, configured, and running. For information about MongoDB installation and configuration, see the <a href="https://docs.mongodb.com/manual/installation/">MongoDB documentation</a>.</p>
</div>
<div class="listingblock">
<div class="title">Enable Data Index Service with MongoDB connection information</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install data-index --infra <em>KAFKA_INFRA_NAME</em> \
    --image quay.io/kiegroup/kogito-data-index-mongodb:latest \
    --config quarkus.mongodb.connection-string=<em>MONGODB_SERVER_CONNECTION_STRING</em> \
    --config quarkus.mongodb.database=<em>DATABASE_NAME</em> \
    --config quarkus.mongodb.credentials.username=<em>USER_NAME</em> \
    --config quarkus.mongodb.credentials.password=<em>PASSWORD</em> \
    -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you enable the Data Index Service for your {PRODUCT} project, the {PRODUCT} Operator creates a <code>KogitoSupportingService</code> custom resource that contains the <code>DataIndex</code> service type to handle the Data Index Service deployment for you. This resource is added to your {PRODUCT} project and in the {PRODUCT} Operator page of the <strong>Installed Operators</strong> listed in the OpenShift web console, if applicable.</p>
</div>
<div class="paragraph">
<p>If an Infinispan Server instance and an Apache Kafka cluster are not installed in the OpenShift namespace, you must configure these infrastructure components before installing the Data Index Service:</p>
</div>
<div class="listingblock">
<div class="title">Enable Infinispan persistence</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>INFINISPAN_INFRA_NAME</em> --kind Infinispan --apiVersion infinispan.org/v1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Enable Kafka messaging</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>KAFKA_INFRA_NAME</em> --kind Kafka --apiVersion kafka.strimzi.io/v1beta1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[{PRODUCT} Data Index Service]</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_product_data_index_service_properties_configuration">{PRODUCT} Data Index Service properties configuration</h5>
<div class="paragraph">
<p>When the {PRODUCT} Data Index Service is deployed, a <code>configMap</code> resource is created for the <code>application.properties</code> configuration of the Data Index Service.</p>
</div>
<div class="paragraph">
<p>The name of the <code>configMap</code> resource consists of the name of the Data Index Service and the suffix <code>-properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>configMap</code> resource generated during {PRODUCT} Data Index Service deployment</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: data-index-properties
data:
  application.properties : |-
    property1=value1
    property2=value2</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>application.properties</code> data of the <code>configMap</code> resource is mounted in a volume to the container of the Data Index Service. Any runtime properties that you add to the <code>application.properties</code> section override the default application configuration properties of the Data Index Service.</p>
</div>
<div class="paragraph">
<p>When the <code>application.properties</code> data of the <code>configMap</code> is changed, a rolling update modifies the deployment and configuration of the Data Index Service.</p>
</div>
<div class="paragraph">
<p>If your {PRODUCT} project uses the <code>infinispan-persistence-addon</code> add-on to enable Infinispan persistence explicitly, the {PRODUCT} Operator mounts a volume based on a <code>configMap</code> resource created for you during the deployment of the service. This <code>configMap</code> resource has the <code>-protobuf-files</code> suffix and lists the protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) files that your service generated during build time.</p>
</div>
<div class="listingblock">
<div class="title">Example <code>configMap</code> resource with protobuf files listed</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: example-quarkus-protobuf-files
  labels:
    kogito-protobuf: true
data:
  visaApplications.proto: |-
    syntax = "proto2";
    package org.acme.travels.visaApplications;
    import "kogito-index.proto";
    import "kogito-types.proto";
    option kogito_model = "VisaApplications";
    option kogito_id = "visaApplications";
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a new persistent {PRODUCT} service is deployed, a new set of protobuf files is generated and the Data Index Service creates a new <code>pod</code> instance that refers to the new volume.</p>
</div>
<div class="paragraph">
<p>Updated protobuf files are automatically refreshed by Kubernetes volumes, so if you add a new
property in your domain data, this data is reflected automatically in the Data Index Service without restarts.</p>
</div>
<div class="paragraph">
<p>If a {PRODUCT} service is removed, the associated protobuf files are also removed and are no longer visible in the Data Index Service, but the data is still persisted in Infinispan.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-jobs-service_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with the {PRODUCT} Jobs Service</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Jobs Service for scheduling Business Process Model and Notation (BPMN) process events that are configured to be executed at a specified time. These time-based events in a process model are known as <em>jobs</em>.</p>
</div>
<div class="paragraph">
<p>By default, {PRODUCT} services use an in-memory timer service to handle jobs defined in your BPMN process models. This default timer service does not cover long time intervals and is only suitable for short delays defined in the process. For advanced use cases where time intervals can be days or weeks or when additional event handling options are required, you can configure your {PRODUCT} project to use the {PRODUCT} Jobs Service as an external timer service.</p>
</div>
<div class="paragraph">
<p>You can use the following {PRODUCT} command-line interface (CLI) operation to install the {PRODUCT} Jobs Service for job scheduling in {PRODUCT} services:</p>
</div>
<div class="listingblock">
<div class="title">Enable Jobs Service</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install jobs-service -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you enable the Jobs Service for your {PRODUCT} project, the {PRODUCT} Operator creates a <code>KogitoSupportingService</code> custom resource that contains the <code>JobsService</code> service type to handle the Jobs Service deployment for you. This resource is added to your {PRODUCT} project and in the {PRODUCT} Operator page of the <strong>Installed Operators</strong> listed in the OpenShift web console, if applicable.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-jobs-service_kogito-configuring[{PRODUCT} Jobs Service]</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_infinispan_persistence_with_the_product_jobs_service">Infinispan persistence with the {PRODUCT} Jobs Service</h5>
<div class="paragraph">
<p>To enable Infinispan persistence for the {PRODUCT} Jobs Service, you install the Infinispan infrastructure and then you can use the <code>--infra <em>INFINISPAN_INFRA_NAME</em></code> flag during deployment in the {PRODUCT} CLI or edit the <code>spec.infra</code> configuration in the <code>KogitoSupportingService</code> custom resource that contains the <code>JobsService</code> service type:</p>
</div>
<div class="listingblock">
<div class="title">Example Jobs Service deployment with Infinispan persistence enabled</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>INFINISPAN_INFRA_NAME</em> --kind Infinispan --apiVersion infinispan.org/v1 -p <em>PROJECT_NAME</em>
$ {PRODUCT_INIT} install jobs-service --infra <em>INFINISPAN_INFRA_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example <code>JobsService</code> resource with Infinispan persistence enabled</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoSupportingService
metadata:
  name: jobs-service
spec:
  serviceType: JobsService
  infra:
    - kogito-infinispan-infra
  build:
    envs:
    - name: MAVEN_ARGS_APPEND
      value: -Ppersistence</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can refine the Infinispan integration by setting the <code>spec.infra</code> property in the <code>KogitoSupportingService</code> custom resource that contains the <code>JobsService</code> service type. With this property set, the {PRODUCT} Operator ensures that the Jobs Service has access to the persistence infrastructure configurations.</p>
</div>
</div>
<div class="sect4">
<h5 id="_product_jobs_service_properties_configuration">{PRODUCT} Jobs Service properties configuration</h5>
<div class="paragraph">
<p>When the {PRODUCT} Jobs Service is deployed, a <code>configMap</code> resource is created for the <code>application.properties</code> configuration of the Jobs Service.</p>
</div>
<div class="paragraph">
<p>The name of the <code>configMap</code> resource consists of the name of the Jobs Service and the suffix <code>-properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>configMap</code> resource generated during {PRODUCT} Jobs Service deployment</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: jobs-service-properties
data:
  application.properties : |-
    property1=value1
    property2=value2</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>application.properties</code> data of the <code>configMap</code> resource is mounted in a volume to the container of the Jobs Service. Any runtime properties that you add to the <code>application.properties</code> section override the default application configuration properties of the Jobs Service.</p>
</div>
<div class="paragraph">
<p>When the <code>application.properties</code> data of the <code>configMap</code> is changed, a rolling update modifies the deployment and configuration of the Jobs Service.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-trusty-service_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with the {PRODUCT} Trusty Service</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Trusty Service that stores all {PRODUCT} tracing events related to decisions made in {PRODUCT} services. The Trusty Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then processes the tracing events and stores the data in the Infinispan persistence store.</p>
</div>
<div class="paragraph">
<p>You can use the following {PRODUCT} command-line interface (CLI) operation to install the {PRODUCT} Trusty Service for auditing purposes in {PRODUCT} services:</p>
</div>
<div class="listingblock">
<div class="title">Enable Trusty Service</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install trusty --infra <em>INFINISPAN_INFRA_NAME</em> --infra <em>KAFKA_INFRA_NAME</em> -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>To export tracing events from your {PRODUCT} project, you must additionally add the <code>tracing-addon</code> add-on as a dependency to your project.</p>
</div>
<div class="paragraph">
<p>When you enable the Trusty Service for your {PRODUCT} project, the {PRODUCT} Operator creates a <code>KogitoSupportingService</code> custom resource that contains the <code>TrustyAI</code> service type to handle the Trusty Service deployment for you. This resource is added to your {PRODUCT} project and in the {PRODUCT} Operator page of the <strong>Installed Operators</strong> listed in the OpenShift web console, if applicable.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses the <a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a> for persistence infrastructure and the <a href="https://strimzi.io/docs/latest/">Strimzi Operator</a> for Kafka messaging infrastructure.</p>
</div>
<div class="paragraph">
<p>If an Infinispan Server instance and an Apache Kafka cluster are not installed in the OpenShift namespace, you must configure these infrastructure components before installing the Trusty Service:</p>
</div>
<div class="listingblock">
<div class="title">Enable Infinispan persistence</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>INFINISPAN_INFRA_NAME</em> --kind Infinispan --apiVersion infinispan.org/v1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Enable Kafka messaging</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>KAFKA_INFRA_NAME</em> --kind Kafka --apiVersion kafka.strimzi.io/v1beta1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the {PRODUCT} Explainability Service is enabled, then the Trusty Service also stores the explainability results for all the tracing events.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[{PRODUCT} Trusty Service and Explainability Service]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-explainability-service_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with the {PRODUCT} Explainability Service</h4>
<div class="paragraph _abstract">
<p>As an aid to the {PRODUCT} Trusty Service workflow for storing tracing events, {PRODUCT} provides a supplemental Explainability Service that provides an explanation for the decisions made in {PRODUCT} services. The Explainability Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from the Trusty Service, and then applies explainability algorithms. Some algorithms require the Explainability Service to interact with the {PRODUCT} service that evaluated the decision. This communication is performed with HTTP <code>POST</code> requests.</p>
</div>
<div class="paragraph">
<p>You can use the following {PRODUCT} command-line interface (CLI) operation to install the {PRODUCT} Explainability Service for auditing purposes in {PRODUCT} services:</p>
</div>
<div class="listingblock">
<div class="title">Enable Explainability Service</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install explainability --infra <em>KAFKA_INFRA_NAME</em> -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you enable the Explainability Service for your {PRODUCT} project, the {PRODUCT} Operator creates a <code>KogitoSupportingService</code> custom resource that contains the <code>Explainability</code> service type to handle the Explainability Service deployment for you. This resource is added to your {PRODUCT} project and in the {PRODUCT} Operator page of the <strong>Installed Operators</strong> listed in the OpenShift web console, if applicable.</p>
</div>
<div class="paragraph">
<p>If an Apache Kafka cluster is not installed in the OpenShift namespace, you must configure this infrastructure component before installing the Explainability Service:</p>
</div>
<div class="listingblock">
<div class="title">Enable Kafka messaging</div>
<div class="content">
<pre class="highlight"><code>$ {PRODUCT_INIT} install infra <em>KAFKA_INFRA_NAME</em> --kind Kafka --apiVersion kafka.strimzi.io/v1beta1 -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[{PRODUCT} Trusty Service and Explainability Service]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-operator-with-prometheus_kogito-deploying-on-openshift">{PRODUCT} Operator interaction with Prometheus</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a <code>monitoring-prometheus-addon</code> add-on that enables Prometheus metrics monitoring for {PRODUCT} services. The {PRODUCT} Operator uses the  <a href="https://github.com/coreos/prometheus-operator">Prometheus Operator</a> to expose the metrics from your {PRODUCT} project for Prometheus to scrape. Due to this dependency, the Prometheus Operator must be installed in the same namespace as your {PRODUCT} project.</p>
</div>
<div class="paragraph">
<p>When you deploy a {PRODUCT} service that uses the <code>monitoring-prometheus-addon</code> add-on and the  Prometheus Operator is installed, the {PRODUCT} Operator creates a <code>ServiceMonitor</code> custom resource to expose the metrics for Prometheus, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>ServiceMonitor</code> resource for Prometheus</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  labels:
    app: onboarding-service
  name: onboarding-service
  namespace: kogito
spec:
  endpoints:
  - path: /metrics
    targetPort: 8080
    scheme: http
  namespaceSelector:
    matchNames:
    - kogito
  selector:
    matchLabels:
      app: onboarding-service</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must manually configure your <code>Prometheus</code> custom resource that is managed by the Prometheus Operator to select the <code>ServiceMonitor</code> resource:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>Prometheus</code> resource</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: monitoring.coreos.com/v1
kind: Prometheus
metadata:
  name: prometheus
spec:
  serviceAccountName: prometheus
  serviceMonitorSelector:
    matchLabels:
      app: onboarding-service</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you configure your Prometheus resource with the <code>ServiceMonitor</code> resource, you can see the endpoint being scraped by Prometheus in the <strong>Targets</strong> page in the Prometheus web console:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-operator-prometheus-targets.png" alt="Image of Kogito service targets view in Prometheus">
</div>
<div class="title">Figure 67. Targets page in Prometheus web console</div>
</div>
<div class="paragraph">
<p>The metrics exposed by the {PRODUCT} service appear in the <strong>Graph</strong> view:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-operator-prometheus-graph.png" alt="Image of Kogito service graph view in Prometheus">
</div>
<div class="title">Figure 68. Graph view in Prometheus web console</div>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-prometheus-metrics-monitoring_kogito-configuring[Enabling Prometheus metrics monitoring in {PRODUCT}]</p>
</li>
<li>
<p><a href="https://github.com/coreos/prometheus-operator/blob/master/Documentation/user-guides/getting-started.md">Prometheus Operator</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-deploying-on-kubernetes_kogito-deploying-on-openshift">Deploying {PRODUCT} services on Kubernetes</h4>
<div class="paragraph _abstract">
<p>Starting with {PRODUCT} 0.11, the {PRODUCT} Operator supports {PRODUCT} service deployment on Kubernetes. After you create your {PRODUCT} services as part of a business application, you can build a container image for your {PRODUCT} project, push the image to an image registry, and then use the {PRODUCT} Operator to deploy your services on Kubernetes from the registered container image.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Operator uses a <code>KogitoRuntime</code> custom resource that enables Kubernetes or OpenShift deployment from a registered container image. This resource does not require you to build the images in the cluster. Instead, you can pass the {PRODUCT} service image that you want to deploy and the {PRODUCT} Operator handles the building and deployment for you.</p>
</div>
<div class="paragraph">
<p>For example {PRODUCT} service configurations for a Kubernetes deployment, see the <a href="https://github.com/kiegroup/kogito-cloud-operator/tree/master/examples/kubernetes/travel-agency"><code>travel-agency</code></a> example application for Kubernetes.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Kubernetes command-line tool <code>kubectl</code> is installed. For installation instructions, see the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">Kubernetes documentation</a>.</p>
</li>
<li>
<p>Podman container manager is installed. For installation instructions, see the <a href="https://podman.io/getting-started/installation">Podman documentation</a>.</p>
</li>
<li>
<p>The application with your {PRODUCT} services is in a location that is reachable from your Kubernetes environment.</p>
</li>
<li>
<p>You have Kubernetes permissions to create resources in a specified namespace.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://github.com/kiegroup/kogito-cloud-operator/releases"><code>{PRODUCT_INIT}-cloud-operator</code></a> releases page in GitHub, download the latest version of the {PRODUCT} Operator <code>Source code</code> file, and extract the downloaded <code>kogito-cloud-operator-<em>VERSION</em></code> file to a local directory.</p>
<div class="paragraph">
<p>The {PRODUCT} Operator source code contains resources for installing the operator manually for Kubernetes deployments.</p>
</div>
</li>
<li>
<p>In a command terminal, navigate to the root of the extracted <code>kogito-cloud-operator-<em>VERSION</em></code> folder and enter the following commands to create the Kubernetes namespace (if not created already) and to install the {PRODUCT} Operator in that namespace:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Installing the {PRODUCT} Operator in a Kubernetes namespace</div>
<div class="content">
<pre class="highlight"><code>$ cd ~/kogito-cloud-operator-<em>VERSION</em>

// Creates the Kubernetes namespace (if not created already)
$ export NAMESPACE=kogito
$ kubectl create ns $NAMESPACE

// Installs the {PRODUCT} Operator in the namespace
$ ./hack/install.sh</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You must be logged in to the relevant Kubernetes cluster using the <code>kubectl</code> command. For more information about accessing Kubernetes clusters, see the <a href="https://kubernetes.io/docs/tasks/access-application-cluster/access-cluster/">Kubernetes documentation</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>If your {PRODUCT} project requires Infinispan persistence and Apache Kafka messaging, install the required Infinispan and Kafka infrastructure components, including the <a href="https://github.com/infinispan/infinispan-operator">Infinispan Operator</a> and the <a href="https://strimzi.io/docs/latest/">Strimzi Operator</a> (for Kafka cluster deployment with Zookeeper).</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The {PRODUCT} Operator cannot automatically install these operators for Infinispan persistence and Kafka messaging, so you must install the components manually, if needed.</p>
</div>
<div class="paragraph">
<p>For information about Infinispan installation and configuration, see the <a href="https://infinispan.org/documentation/">Infinispan documentation</a>.</p>
</div>
<div class="paragraph">
<p>For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</div>
<div class="paragraph">
<p>For an example script to install these infrastructure components for Kubernetes, see the <a href="https://github.com/kiegroup/kogito-cloud-operator/blob/master/examples/kubernetes/travel-agency/deploy.sh"><code>travel-agency</code></a> example application for Kubernetes.</p>
</div>
</div>
</div>
</li>
<li>
<p>Add the following <code>quarkus-jvm.Dockerfile</code> file or <code>springboot.Dockerfile</code> file, depending on your framework, to the root of your {PRODUCT} project to prepare your project for being built and registered as a container image:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus: <code>quarkus-jvm.Dockerfile</code></div>
<div class="content">
<pre class="highlight"><code>FROM quay.io/kiegroup/kogito-quarkus-jvm-ubi8:latest

COPY target/*-runner.jar $KOGITO_HOME/bin
COPY target/lib $KOGITO_HOME/bin/lib
COPY target/classes/persistence/ $KOGITO_HOME/data/protobufs</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot: <code>springboot.Dockerfile</code></div>
<div class="content">
<pre class="highlight"><code>FROM quay.io/kiegroup/kogito-springboot-ubi8:latest

COPY target/*.jar $KOGITO_HOME/bin
COPY target/classes/persistence/ $KOGITO_HOME/data/protobufs</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Build your {PRODUCT} project with your preferred method, such as <code>mvn clean package</code>.</p>
</li>
<li>
<p>Enter the following commands to build the container image, test the image locally, and push the image to the registry using Podman:</p>
<div class="listingblock">
<div class="title">Build, test, and push the container image using Podman</div>
<div class="content">
<pre class="highlight"><code>// Builds the container image
<code>podman build --tag quay.io/<em>NAMESPACE</em>/<em>PROJECT_NAME</em>:latest -f quarkus-jvm.Dockerfile</code>

// Runs the container image locally for testing
<code>podman run --rm -it -p 8080:8080 quay.io/<em>NAME_SPACE</em>/<em>PROJECT_NAME</em>:latest</code>

// Pushes the container image to the Quay registry
<code>podman push quay.io/<em>NAME_SPACE</em>/<em>PROJECT_NAME</em>:latest</code></code></pre>
</div>
</div>
</li>
<li>
<p>After you build and push the container image for your {PRODUCT} project, create a {PRODUCT} service definition YAML file as a <code>KogitoRuntime</code> custom resource for your {PRODUCT} service, as shown in the following example:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example <code>kogito-travels.yaml</code> resource for the {PRODUCT} service</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoRuntime
metadata:
  name: kogito-travels
spec:
  envs:
    - name: KOGITO_DATAINDEX_HTTP_URL
      value: http://data-index.kogito
    - name: KOGITO_DATAINDEX_WS_URL
      value: ws://data-index.kogito
  replicas: 1
  image:
    domain: quay.io/kiegroup/kogito-travels
  infra:
    - kogito-kafka-infra
    - kogito-infinispan-infra</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example is based on the <a href="https://github.com/kiegroup/kogito-cloud-operator/tree/master/examples/kubernetes/travel-agency"><code>travel-agency</code></a> example application for Kubernetes and includes additional configurations for Infinispan persistence, Kafka messaging, and the {PRODUCT} Data Index Service.</p>
</div>
</div>
</div>
</li>
<li>
<p>Enter the following command to deploy your {PRODUCT} service custom resource to your Kubernetes cluster:</p>
<div class="listingblock">
<div class="title">Deploying the {PRODUCT} service resource to the Kubernetes cluster</div>
<div class="content">
<pre class="highlight"><code>kubectl apply -f kogito-travels.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="ref-kogito-operator-troubleshooting_kogito-deploying-on-openshift">{PRODUCT} service deployment troubleshooting</h4>
<div class="paragraph _abstract">
<p>Use the following list to troubleshoot issues that you might encounter when using the {PRODUCT} Operator to deploy {PRODUCT} services. This list is updated as new issues and workarounds are discovered.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">No builds are running</dt>
<dd>
<p>If you do not see any builds running nor any resources created in the relevant namespace, enter the following commands to retrieve running pods and to view the {PRODUCT} Operator log for the pod:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">View {PRODUCT} Operator log for a specified pod</div>
<div class="content">
<pre class="highlight"><code>// Retrieves running pods
$ oc get pods

NAME                                     READY   STATUS      RESTARTS   AGE
kogito-operator-6d7b6d4466-9ng8t   1/1     Running     0          26m

// Opens {PRODUCT} Operator log for the pod
$ oc logs -f kogito-operator-6d7b6d4466-9ng8t</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="collection-kogito-developing-decision-services">Developing decision services with {PRODUCT}</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a developer of business decisions, you can use {PRODUCT} business automation to develop decision services using Decision Model and Notation (DMN) models, Drools Rule Language (DRL) rules, XLS or XLSX spreadsheet decision tables, or a combination of all three methods.</p>
</div>
<div class="sect2">
<h3 id="chap-kogito-using-dmn-models">Using DMN models in {PRODUCT} services</h3>
<div class="paragraph _abstract">
<p>As a developer of business decisions, you can use Decision Model and Notation (DMN) to model a decision service graphically. The decision requirements of a DMN decision model are determined by a decision requirements graph (DRG) that is depicted in one or more decision requirements diagrams (DRDs). A DRD can represent part or all of the overall DRG for the DMN model. DRDs trace business decisions from start to finish, with each decision node using logic defined in DMN boxed expressions such as decision tables.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} provides design and runtime support for DMN 1.2 models at conformance level 3, and runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. You can design your DMN models with the {PRODUCT} DMN modeler in VSCode or import existing DMN models into your {PRODUCT} projects for deployment and execution. DMN 1.1 and 1.3 models are currently not supported in the {PRODUCT} DMN modeler.</p>
</div>
<div class="paragraph">
<p>For more information about DMN, see the Object Management Group (OMG) <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect3">
<h4 id="ref-decision-authoring-assets_kogito-dmn-models">Decision-authoring assets in {PRODUCT}</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.</p>
</div>
<div class="paragraph">
<p>The following table highlights the main decision-authoring assets supported in {PRODUCT} projects to help you decide or confirm the best method for defining decisions in your decision service.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Decision-authoring assets supported in {PRODUCT}</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Asset</th>
<th class="tableblock halign-left valign-top">Highlights</th>
<th class="tableblock halign-left valign-top">Authoring tools</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision Model and Notation (DMN) models</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are decision models based on a notation standard defined by the Object Management Group (OMG)</p>
</li>
<li>
<p>Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows</p>
</li>
<li>
<p>Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms</p>
</li>
<li>
<p>Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions</p>
</li>
<li>
<p>Can be integrated efficiently with Business Process Model and Notation (BPMN) process models</p>
</li>
<li>
<p>Are optimal for creating comprehensive, illustrative, and stable decision flows</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{PRODUCT} DMN modeler in VSCode or other DMN-compliant editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-dmn_kogito-dmn-models">Decision Model and Notation (DMN)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DRL rules</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are individual rules that you define directly in <code>.drl</code> text files</p>
</li>
<li>
<p>Provide the most flexibility for defining rules and other technicalities of rule behavior</p>
</li>
<li>
<p>Are optimal for creating rules that require advanced DRL options, such as rule units</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any integrated development environment (IDE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-drl_kogito-drl-rules">[con-drl_kogito-drl-rules]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet decision tables</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are tabular sets of rules that you define in <code>.xls</code> or <code>.xlsx</code> spreadsheet files</p>
</li>
<li>
<p>Support template keys and values for creating rule templates</p>
</li>
<li>
<p>Are optimal for business environments that already rely on decision tables for rules</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly when used in {PRODUCT}</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-decision-tables_kogito-decision-tables">[con-decision-tables_kogito-decision-tables]</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="con-dmn_kogito-dmn-models">Decision Model and Notation (DMN)</h4>
<div class="paragraph _abstract">
<p>Decision Model and Notation (DMN) is a standard established by the <a href="https://www.omg.org/">Object Management Group (OMG)</a> for describing and modeling operational decisions. DMN defines an XML schema that enables DMN models to be shared between DMN-compliant platforms and across organizations so that business analysts and business rules developers can collaborate in designing and implementing DMN decision services. The DMN standard is similar to and can be used together with the Business Process Model and Notation (BPMN) standard for designing and modeling business processes.</p>
</div>
<div class="paragraph">
<p>For more information about the background and applications of DMN, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect4">
<h5 id="con-dmn-conformance-levels_kogito-dmn-models">DMN conformance levels</h5>
<div class="paragraph _abstract">
<p>The DMN specification defines three incremental levels of conformance in a software implementation. A product that claims compliance at one level must also be compliant with any preceding levels. For example, a conformance level 3 implementation must also include the supported components in conformance levels 1 and 2. For the formal definitions of each conformance level, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="paragraph">
<p>The following list summarizes the three DMN conformance levels:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Conformance level 1</dt>
<dd>
<p>A DMN conformance level 1 implementation supports decision requirement diagrams (DRDs), decision logic, and decision tables, but decision models are not executable. Any language can be used to define the expressions, including natural, unstructured languages.</p>
</dd>
<dt class="hdlist1">Conformance level 2</dt>
<dd>
<p>A DMN conformance level 2 implementation includes the requirements in conformance level 1, and supports Simplified Friendly Enough Expression Language (S-FEEL) expressions and fully executable decision models.</p>
</dd>
<dt class="hdlist1">Conformance level 3</dt>
<dd>
<p>A DMN conformance level 3 implementation includes the requirements in conformance levels 1 and 2, and supports Friendly Enough Expression Language (FEEL) expressions, the full set of boxed expressions, and fully executable decision models.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>{PRODUCT} provides design and runtime support for DMN 1.2 models at conformance level 3, and runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. You can design your DMN models with the {PRODUCT} DMN modeler in VSCode or import existing DMN models into your {PRODUCT} projects for deployment and execution. DMN 1.1 and 1.3 models are currently not supported in the {PRODUCT} DMN modeler.</p>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-drd-components-ref-kogito-dmn-models">DMN decision requirements diagram (DRD) components</h5>
<div class="paragraph _abstract">
<p>A decision requirements diagram (DRD) is a visual representation of your DMN model. A DRD can represent part or all of the overall decision requirements graph (DRG) for the DMN model. DRDs trace business decisions using decision nodes, business knowledge models, sources of business knowledge, input data, and decision services.</p>
</div>
<div class="paragraph">
<p>The following table summarizes the components in a DRD:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. DRD components</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">Component</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Notation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock">Elements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node where one or more input elements determine an output based on defined decision logic.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-node.png" alt="dmn decision node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable function with one or more decision elements. Decisions that have the same logic but depend on different sub-input data or sub-decisions use business knowledge models to determine which procedure to follow.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-node.png" alt="dmn bkm node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">External authorities, documents, committees, or policies that regulate a decision or business knowledge model. Knowledge sources are references to real-world factors rather than executable business rules.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-knowledge-source-node.png" alt="dmn knowledge source node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information used in a decision node or a business knowledge model. Input data usually includes business-level concepts or objects relevant to the business, such as loan applicant data used in a lending strategy.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-input-data-node.png" alt="dmn input data node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision service</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Top-level decision containing a set of reusable decisions published as a service for invocation. A decision service can be invoked from an external application or a BPMN business process.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-service-node.png" alt="dmn decision service node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Requirement connectors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from an input data node or decision node to another decision node that requires the information.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-info-connector.png" alt="dmn info connector">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from a business knowledge model to a decision node or to another business knowledge model that invokes the decision logic.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-knowledge-connector.png" alt="dmn knowledge connector">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authority requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from an input data node or a decision node to a dependent knowledge source or from a knowledge source to a decision node, business knowledge model, or another knowledge source.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-authority-connector.png" alt="dmn authority connector">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Artifacts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Text annotation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explanatory note associated with an input data node, decision node, business knowledge model, or knowledge source.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-annotation-node.png" alt="dmn annotation node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Association</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from an input data node, decision node, business knowledge model, or knowledge source to a text annotation.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-association-connector.png" alt="dmn association connector">
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following table summarizes the permitted connectors between DRD elements:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. DRD connector rules</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Starts from</th>
<th class="tableblock halign-left valign-top">Connects to</th>
<th class="tableblock halign-left valign-top">Connection type</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-to-decision.png" alt="dmn decision to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Knowledge requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-to-decision.png" alt="dmn bkm to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-to-bkm.png" alt="dmn bkm to bkm">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Decision service</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Knowledge requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-service-to-decision.png" alt="dmn decision service to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-service-to-bkm.png" alt="dmn decision service to bkm">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Input data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-input-to-decision.png" alt="dmn input to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authority requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-input-to-knowledge-source.png" alt="dmn input to knowledge source">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Authority requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-knowledge-source-to-decision.png" alt="dmn knowledge source to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-knowledge-source-to-bkm.png" alt="dmn knowledge source to bkm">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-knowledge-source-to-knowledge-source.png" alt="dmn knowledge source to knowledge source">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="4"><p class="tableblock">Text annotation</p></td>
<td class="tableblock halign-left valign-top" rowspan="4"><p class="tableblock">Association</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-to-annotation.png" alt="dmn decision to annotation">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-to-annotation.png" alt="dmn bkm to annotation">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-knowledge-source-to-annotation.png" alt="dmn knowledge source to annotation">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input data</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-input-to-annotation.png" alt="dmn input to annotation">
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example DRD illustrates some of these DMN components in practice:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-example-drd.png" alt="dmn example drd">
</div>
<div class="title">Figure 69. Example DRD: Loan prequalification</div>
</div>
<div class="paragraph">
<p>The following example DRD illustrates DMN components that are part of a reusable decision service:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-example-drd3.png" alt="dmn example drd3" width="90%">
</div>
<div class="title">Figure 70. Example DRD: Phone call handling as a decision service</div>
</div>
<div class="paragraph">
<p>In a DMN decision service node, the decision nodes in the bottom segment incorporate input data from outside of the decision service to arrive at a final decision in the top segment of the decision service node. The resulting top-level decisions from the decision service are then implemented in any subsequent decisions or business knowledge requirements of the DMN model. You can reuse DMN decision services in other DMN models to apply the same decision logic with different input data and different outgoing connections.</p>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-feel_kogito-dmn-models">Rule expressions in FEEL</h5>
<div class="paragraph _abstract">
<p>Friendly Enough Expression Language (FEEL) is an expression language defined by the Object Management Group (OMG) DMN specification. FEEL expressions define the logic of a decision in a DMN model. FEEL is designed to facilitate both decision modeling and execution by assigning semantics to the decision model constructs. FEEL expressions in decision requirements diagrams (DRDs) occupy table cells in boxed expressions for decision nodes and business knowledge models.</p>
</div>
<div class="paragraph">
<p>For more information about FEEL in DMN, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect5">
<h6 id="ref-dmn-feel-data-types_kogito-dmn-models">Data types in FEEL</h6>
<div class="paragraph _abstract">
<p>Friendly Enough Expression Language (FEEL) supports the following data types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Numbers</p>
</li>
<li>
<p>Strings</p>
</li>
<li>
<p>Boolean values</p>
</li>
<li>
<p>Dates</p>
</li>
<li>
<p>Time</p>
</li>
<li>
<p>Date and time</p>
</li>
<li>
<p>Days and time duration</p>
</li>
<li>
<p>Years and months duration</p>
</li>
<li>
<p>Functions</p>
</li>
<li>
<p>Contexts</p>
</li>
<li>
<p>Ranges (or intervals)</p>
</li>
<li>
<p>Lists</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The DMN specification currently does not provide an explicit way of declaring a variable as a <code>function</code>, <code>context</code>, <code>range</code>, or <code>list</code>, but {PRODUCT} extends the DMN built-in types to support variables of these types.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following list describes each data type:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Numbers</dt>
<dd>
<p>Numbers in FEEL are based on the <a href="http://ieeexplore.ieee.org/document/4610935/">IEEE 754-2008</a> Decimal 128 format, with 34 digits of precision. Internally, numbers are represented in Java as <a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html"><code>BigDecimals</code></a> with <code>MathContext DECIMAL128</code>. FEEL supports only one number data type, so the same type is used to represent both integers and floating
point numbers.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>FEEL numbers use a dot (<code>.</code>) as a decimal separator. FEEL does not support <code>-INF</code>, <code>+INF</code>, or <code>NaN</code>. FEEL uses
<code>null</code> to represent invalid numbers.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} extends the DMN specification and supports additional number notations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Scientific:</strong> You can use scientific notation with the suffix <code>e&lt;exp&gt;</code> or <code>E&lt;exp&gt;</code>. For example, <code>1.2e3</code> is the same as writing the expression <code>1.2*10**3</code>, but is a literal instead of an expression.</p>
</li>
<li>
<p><strong>Hexadecimal:</strong> You can use hexadecimal numbers with the prefix <code>0x</code>. For example, <code>0xff</code> is the same as the decimal number <code>255</code>. Both uppercase and lowercase letters are supported. For example, <code>0XFF</code> is the same as <code>0xff</code>.</p>
</li>
<li>
<p><strong>Type suffixes:</strong> You can use the type suffixes <code>f</code>, <code>F</code>, <code>d</code>, <code>D</code>, <code>l</code>, and <code>L</code>. These suffixes are ignored.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Strings</dt>
<dd>
<p>Strings in FEEL are any sequence of characters delimited by double quotation marks.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>"John Doe"</pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Boolean values</dt>
<dd>
<p>FEEL uses three-valued boolean logic, so a boolean logic expression may have values <code>true</code>, <code>false</code>, or <code>null</code>.</p>
</dd>
<dt class="hdlist1">Dates</dt>
<dd>
<p>Date literals are not supported in FEEL, but you can use the built-in <code>date()</code> function to construct date values. Date strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#date">XML Schema Part 2: Datatypes</a> document. The format is <code>"YYYY-MM-DD"</code> where <code>YYYY</code> is the year with four digits, <code>MM</code> is the number of the month with two digits, and <code>DD</code> is the number of the day.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>date( "2017-06-23" )</pre>
</div>
</div>
<div class="paragraph">
<p>Date objects have time equal to <code>"00:00:00"</code>, which is midnight. The dates are considered to be local, without a timezone.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Time</dt>
<dd>
<p>Time literals are not supported in FEEL, but you can use the built-in <code>time()</code> function to construct time values. Time strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#time">XML Schema Part 2: Datatypes</a> document. The format is <code>"hh:mm:ss[.uuu][(+-)hh:mm]"</code> where <code>hh</code> is the hour of the day (from <code>00</code> to <code>23</code>), <code>mm</code> is the minutes in the hour, and <code>ss</code> is the number of seconds in the minute. Optionally, the string may define the number of milliseconds (<code>uuu</code>) within the second and contain a positive (<code>+</code>) or negative (<code>-</code>) offset from UTC time to define its timezone. Instead of using an offset, you can use the letter <code>z</code> to represent the UTC time, which is the same as an offset of <code>-00:00</code>. If no offset is defined, the time is considered to be local.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>time( "04:25:12" )
time( "14:10:00+02:00" )
time( "22:35:40.345-05:00" )
time( "15:00:30z" )</pre>
</div>
</div>
<div class="paragraph">
<p>Time values that define an offset or a timezone cannot be compared to local times that do not define an offset or a timezone.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Date and time</dt>
<dd>
<p>Date and time literals are not supported in FEEL, but you can use the built-in <code>date and time()</code> function to construct date and time values. Date and time strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#dateTime">XML Schema Part 2: Datatypes</a> document. The format is <code>"&lt;date&gt;T&lt;time&gt;"</code>, where <code>&lt;date&gt;</code> and <code>&lt;time&gt;</code> follow the prescribed XML schema formatting, conjoined by <code>T</code>.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>date and time( "2017-10-22T23:59:00" )
date and time( "2017-06-13T14:10:00+02:00" )
date and time( "2017-02-05T22:35:40.345-05:00" )
date and time( "2017-06-13T15:00:30z" )</pre>
</div>
</div>
<div class="paragraph">
<p>Date and time values that define an offset or a timezone cannot be compared to local date and time values
that do not define an offset or a timezone.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code>dateTime</code> as a synonym of <code>date and time</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Days and time duration</dt>
<dd>
<p>Days and time duration literals are not supported in FEEL, but you can use the built-in <code>duration()</code> function to construct days and time duration values. Days and time duration strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#duration">XML Schema Part 2: Datatypes</a> document, but are restricted to only days, hours, minutes and seconds. Months and years are not supported.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>duration( "P1DT23H12M30S" )
duration( "P23D" )
duration( "PT12H" )
duration( "PT35M" )</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code>dayTimeDuration</code> as a synonym of <code>days and time duration</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Years and months duration</dt>
<dd>
<p>Years and months duration literals are not supported in FEEL, but you can use the built-in <code>duration()</code> function to construct days and time duration values. Years and months duration strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#duration">XML Schema Part 2: Datatypes</a> document, but are restricted to only years and months. Days, hours, minutes, or seconds are not supported.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>duration( "P3Y5M" )
duration( "P2Y" )
duration( "P10M" )
duration( "P25M" )</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code>yearMonthDuration</code> as a synonym of <code>years and months duration</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Functions</dt>
<dd>
<p>FEEL has <code>function</code> literals (or anonymous functions) that you can use to create functions. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>function</code>, but {PRODUCT} extends the DMN built-in types to support variables of functions.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>function(a, b) a + b</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the FEEL expression creates a function that adds the parameters <code>a</code> and <code>b</code> and returns the result.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Contexts</dt>
<dd>
<p>FEEL has <code>context</code> literals that you can use to create contexts. A <code>context</code> in FEEL is a list of key and value pairs, similar to maps in languages like Java. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>context</code>, but {PRODUCT} extends the DMN built-in types to support variables of contexts.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{ x : 5, y : 3 }</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the expression creates a context with two entries, <code>x</code> and <code>y</code>, representing a coordinate in a chart.</p>
</div>
<div class="paragraph">
<p>In DMN 1.2, another way to create contexts is to create an item definition that contains the list of keys as attributes, and then declare the variable as having that item definition type.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} DMN API supports DMN <code>ItemDefinition</code> structural types in a <code>DMNContext</code> represented in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User-defined Java type: Must be a valid JavaBeans object defining properties and getters for each of the components in the DMN <code>ItemDefinition</code>. If necessary, you can also use the <code>@FEELProperty</code> annotation for those getters representing a component name which would result in an invalid Java identifier.</p>
</li>
<li>
<p><code>java.util.Map</code> interface: The map needs to define the appropriate entries, with the keys corresponding to the component name in the DMN <code>ItemDefinition</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Ranges (or intervals)</dt>
<dd>
<p>FEEL has <code>range</code> literals that you can use to create ranges or intervals. A <code>range</code> in FEEL is a value that defines a lower and an upper bound, where either can be open or closed. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>range</code>, but {PRODUCT} extends the DMN built-in types to support variables of ranges.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The syntax of a range is defined in the following formats:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>range          := interval_start endpoint '..' endpoint interval_end
interval_start := open_start | closed_start
open_start     := '(' | ']'
closed_start   := '['
interval_end   := open_end | closed_end
open_end       := ')' | '['
closed_end     := ']'
endpoint       := expression</pre>
</div>
</div>
<div class="paragraph">
<p>The expression for the endpoint must return a comparable value, and the lower bound endpoint must be lower than the upper bound endpoint.</p>
</div>
<div class="paragraph">
<p>For example, the following literal expression defines an interval between <code>1</code> and <code>10</code>, including the boundaries (a closed interval on both endpoints):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ 1 .. 10 ]</pre>
</div>
</div>
<div class="paragraph">
<p>The following literal expression defines an interval between 1 hour and 12 hours, including the lower boundary (a closed interval), but excluding the upper boundary (an open interval):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ duration("PT1H") .. duration("PT12H") )</pre>
</div>
</div>
<div class="paragraph">
<p>You can use ranges in decision tables to test for ranges of values, or use ranges in simple literal expressions. For example, the following literal expression returns <code>true</code> if the value of a variable <code>x</code> is between <code>0</code> and <code>100</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x in [ 1 .. 100 ]</pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Lists</dt>
<dd>
<p>FEEL has <code>list</code> literals that you can use to create lists of items. A <code>list</code> in FEEL is represented by a comma-separated list of values enclosed in square brackets. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>list</code>, but {PRODUCT} extends the DMN built-in types to support variables of lists.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ 2, 3, 4, 5 ]</pre>
</div>
</div>
<div class="paragraph">
<p>All lists in FEEL contain elements of the same type and are immutable. Elements in a list can be accessed by index, where the first element is <code>1</code>. Negative indexes can access elements starting from the end of the list so that <code>-1</code> is the last element.</p>
</div>
<div class="paragraph">
<p>For example, the following expression returns the second element of a list <code>x</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x[2]</pre>
</div>
</div>
<div class="paragraph">
<p>The following expression returns the second-to-last element of a list <code>x</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x[-2]</pre>
</div>
</div>
<div class="paragraph">
<p>Elements in a list can also be counted by the function <code>count</code>, which uses the list of elements as the parameter.</p>
</div>
<div class="paragraph">
<p>For example, the following expression returns <code>4</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>count([ 2, 3, 4, 5 ])</pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="ref-dmn-feel-builtin-functions_kogito-dmn-models">Built-in functions in FEEL</h6>
<div class="paragraph _abstract">
<p>To promote interoperability with other platforms and systems, Friendly Enough Expression Language (FEEL) includes a library of built-in functions. The built-in FEEL functions are implemented in the Drools Decision Model and Notation (DMN) engine so that you can use the functions in your DMN decision services.</p>
</div>
<div class="paragraph">
<p>The following sections describe each built-in FEEL function, listed in the format <code><em>NAME</em>( <em>PARAMETERS</em> )</code>. For more information about FEEL functions in DMN, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect6">
<h7 id="_conversion_functions">Conversion functions</h7>
<div class="paragraph">
<p>The following functions support conversion between values of different types. Some of these functions use specific string formats, such as the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>date string</code>: Follows the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#date">XML Schema Part 2: Datatypes</a> document, such as <code>2020-06-01</code></p>
</li>
<li>
<p><code>time string</code>: Follows one of the following formats:</p>
<div class="ulist">
<ul>
<li>
<p>Format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#time">XML Schema Part 2: Datatypes</a> document, such as <code>23:59:00z</code></p>
</li>
<li>
<p>Format for a local time defined by ISO 8601 followed by <code>@</code> and an IANA Timezone, such as <code>00:01:00@Etc/UTC</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>date time string</code>: Follows the format of a <code>date string</code> followed by <code>T</code> and a <code>time string</code>, such as <code>2012-12-25T11:00:00Z</code></p>
</li>
<li>
<p><code>duration string</code>: Follows the format of <code>days and time duration</code> and <code>years and months duration</code> defined in the <a href="https://www.w3.org/TR/xpath-datamodel/#types">XQuery 1.0 and XPath 2.0 Data Model</a>, such as <code>P1Y2M</code></p>
</li>
</ul>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date( from ) - <em>using date</em></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>date</code> value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date( "2012-12-25" ) - date( "2012-12-24" ) = duration( "P1D" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date( from ) - <em>using date and time</em></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>date</code> value and sets time components to null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date(date and time( "2012-12-25T11:00:00Z" )) = date( "2012-12-25" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date( year, month, day )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>date</code> from the specified year, month, and day values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>year</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>month</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>day</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date( 2012, 12, 25 ) = date( "2012-12-25" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date and time( date, time )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>date and time</code> from the specified date and ignores any time components and the specified time.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date and time ( "2012-12-24T23:59:00" ) = date and time(date( "2012-12-24" ), time( "23:59:00" ))</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date and time( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>date and time</code> from the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date time string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date and time( "2012-12-24T23:59:00" ) + duration( "PT1M" ) = date and time( "2012-12-25T00:00:00" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>time</code> from the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">time( "23:59:00z" ) + duration( "PT2M" ) = time( "00:01:00@Etc/UTC" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>time</code> from the specified parameter and ignores any date components.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">time(date and time( "2012-12-25T11:00:00Z" )) = time( "11:00:00Z" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time( hour, minute, second, offset? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>time</code> from the specified hour, minute, and second component values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>second</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offset</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>days and time duration</code> or null</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">time( "23:59:00z" ) = time(23, 59, 0, duration( "PT0H" ))</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">number( from, grouping separator, decimal separator )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>number</code> using the specified separators.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code> representing a valid number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grouping separator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space ( ), comma (<code>,</code>), period (<code>.</code>), or null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>decimal separator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same types as <code>grouping separator</code>, but the values cannot match</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">number( "1 000,0", " ", "," ) = number( "1,000.0", ",", "." )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">string( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Provides a string representation of the specified parameter.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-null value</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">string( 1.1 ) = "1.1"
string( null ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">duration( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>days and time duration</code> value or <code>years and months duration</code> value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date and time( "2012-12-24T23:59:00" ) - date and time( "2012-12-22T03:45:00" ) = duration( "P2DT20H14M" )
duration( "P2Y2M" ) = duration( "P26M" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">years and months duration( from, to )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the <code>years and months duration</code> between the two specified parameters.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>to</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">years and months duration( date( "2011-12-22" ), date( "2013-08-24" ) ) = duration( "P1Y8M" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_boolean_functions">Boolean functions</h7>
<div class="paragraph">
<p>The following functions support Boolean operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">not( negand )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Performs the logical negation of the <code>negand</code> operand.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>negand</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">not( true ) = false
not( null ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_string_functions">String functions</h7>
<div class="paragraph">
<p>The following functions support string operations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In FEEL, Unicode characters are counted based on their code points.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">substring( string, start position, length? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the substring from the start position for the specified length. The first character is at position value <code>1</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>start position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>length</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">substring( "testing",3 ) = "sting"
substring( "testing",3,3 ) = "sti"
substring( "testing", -2, 1 ) = "n"
substring( "\U01F40Eab", 2 ) = "ab"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In FEEL, the string literal <code>"\U01F40Eab"</code> is the <code>🐎ab</code> string (horse symbol followed by <code>a</code> and <code>b</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">string length( string )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the length of the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">string length( "tes" ) = 3
string length( "\U01F40Eab" ) = 3</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">upper case( string )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces an uppercase version of the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">upper case( "aBc4" ) = "ABC4"</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">lower case( string )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a lowercase version of the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">lower case( "aBc4" ) = "abc4"</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">substring before( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the substring before the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">substring before( "testing", "ing" ) = "test"
substring before( "testing", "xyz" ) = ""</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">substring after( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the substring after the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">substring after( "testing", "test" ) = "ing"
substring after( "", "a" ) = ""</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">replace( input, pattern, replacement, flags? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the regular expression replacement.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>input</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>replacement</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This function uses regular expression parameters as defined in <a href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">replace( "abcd", "(ab)|(a)", "[1=$1][2=$2]" ) = "[1=ab][2=]cd"</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">contains( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the string contains the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">contains( "testing", "to" ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">starts with( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the string starts with the match</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">starts with( "testing", "te" ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ends with( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the string ends with the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">ends with( "testing", "g" ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">matches( input, pattern, flags? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the input matches the regular expression.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>input</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This function uses regular expression parameters as defined in <a href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">matches( "teeesting", "^te*sting" ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">split( string, delimiter )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of the original string and splits it at the delimiter regular expression pattern.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delimiter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code> for a regular expression pattern</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This function uses regular expression parameters as defined in <a href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">split( "John Doe", "\\s" ) = ["John", "Doe"]
split( "a;b;c;;", ";" ) = ["a","b","c","",""]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_list_functions">List functions</h7>
<div class="paragraph">
<p>The following functions support list operations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In FEEL, the index of the first element in a list is <code>1</code>. The index of the last element in a list can be identified as <code>-1</code>.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">list contains( list, element )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the list contains the element.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>element</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type, including null</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">list contains( [1,2,3], 2 ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">count( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Counts the elements in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">count( [1,2,3] ) = 3
count( [] ) = 0
count( [1,[2,3]] ) = 2</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">min( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the minimum comparable element in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>min( e1, e2, ..., eN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">min( [1,2,3] ) = 1
min( 1 ) = 1
min( [1] ) = 1</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">max( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the maximum comparable element in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>max( e1, e2, ..., eN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">max( 1,2,3 ) = 3
max( [] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">sum( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the sum of the numbers in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>sum( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sum( [1,2,3] ) = 6
sum( 1,2,3 ) = 6
sum( 1 ) = 1
sum( [] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">mean( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the average (arithmetic mean) of the elements in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>mean( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">mean( [1,2,3] ) = 2
mean( 1,2,3 ) = 2
mean( 1 ) = 1
mean( [] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">all( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if all elements in the list are true.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>boolean</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>all( b1, b2, ..., bN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">all( [false,null,true] ) = false
all( true ) = true
all( [true] ) = true
all( [] ) = true
all( 0 ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">any( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if any element in the list is true.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>boolean</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>any( b1, b2, ..., bN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">any( [false,null,true] ) = true
any( false ) = false
any( [] ) = false
any( 0 ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">sublist( list, start position, length? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the sublist from the start position, limited to the length elements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>start position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>length</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sublist( [4,5,6], 1, 2 ) = [4,5]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">append( list, item )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list that is appended to the item or items.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>item</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">append( [1], 2, 3 ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">concatenate( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list that is the result of the concatenated lists.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">concatenate( [1,2],[3] ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">insert before( list, position, newItem )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list with the <code>newItem</code> inserted at the specified position.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>newItem</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">insert before( [1,3],1,2 ) = [2,1,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">remove( list, position )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list with the removed element excluded from the specified position.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">remove( [1,2,3], 2 ) = [1,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">reverse( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a reversed list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">reverse( [1,2,3] ) = [3,2,1]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">index of( list, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns indexes matching the element.</p>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><code>list</code> of type <code>list</code></p>
</li>
<li>
<p><code>match</code> of any type</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">index of( [1,2,3,2],2 ) = [2,4]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">union( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of all the elements from multiple lists and excludes duplicates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">union( [1,2],[2,3] ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">distinct values( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of elements from a single list and excludes duplicates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">distinct values( [1,2,3,2,1] ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">flatten( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a flattened list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">flatten( [[1,2],[[3]], 4] ) = [1,2,3,4]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">product( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the product of the numbers in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>product( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">product( [2, 3, 4] ) = 24
product( 2, 3, 4 ) = 24</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">median( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the median of the numbers in the list. If the number of elements is odd, the result is the middle element. If the number of elements is even, the result is the average of the two middle elements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 49. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>median( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">median( 8, 2, 5, 3, 4 ) = 4
median( [6, 1, 2, 3] ) = 2.5
median( [ ] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">stddev( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the standard deviation of the numbers in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 50. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>stddev( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">stddev( 2, 4, 7, 5 ) = 2.081665999466132735282297706979931
stddev( [47] ) = null
stddev( 47 ) = null
stddev( [ ] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">mode( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the mode of the numbers in the list. If multiple elements are returned, the numbers are sorted in ascending order.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 51. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>mode( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">mode( 6, 3, 9, 6, 6 ) = [6]
mode( [6, 1, 9, 6, 1] ) = [1, 6]
mode( [ ] ) = [ ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_numeric_functions">Numeric functions</h7>
<div class="paragraph">
<p>The following functions support number operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">decimal( n, scale )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a number with the specified scale.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 52. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code> in the range <code>[−6111..6176]</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">decimal( 1/3, 2 ) = .33
decimal( 1.5, 0 ) = 2
decimal( 2.5, 0 ) = 2</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">floor( n )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the greatest integer that is less than or equal to the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 53. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">floor( 1.5 ) = 1
floor( -1.5 ) = -2</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">ceiling( n )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the smallest integer that is greater than or equal to the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 54. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">ceiling( 1.5 ) = 2
ceiling( -1.5 ) = -1</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">abs( n )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the absolute value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 55. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code>, <code>days and time duration</code>, or <code>years and months duration</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">abs( 10 ) = 10
abs( -10 ) = 10
abs( @"PT5H" ) = @"PT5H"
abs( @"-PT5H" ) = @"PT5H"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">modulo( dividend, divisor )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the remainder of the division of the dividend by the divisor. If either the dividend or divisor is negative, the result is of the same sign as the divisor.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This function is also expressed as <code>modulo(dividend, divisor) = dividend - divisor*floor(dividen d/divisor)</code>.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 56. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dividend</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divisor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">modulo( 12, 5 ) = 2
modulo( -12,5 )= 3
modulo( 12,-5 )= -3
modulo( -12,-5 )= -2
modulo( 10.1, 4.5 )= 1.1
modulo( -10.1, 4.5 )= 3.4
modulo( 10.1, -4.5 )= -3.4
modulo( -10.1, -4.5 )= -1.1</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">sqrt( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the square root of the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 57. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sqrt( 16 ) = 4</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">log( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the logarithm of the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 58. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">decimal( log( 10 ), 2 ) = 2.30</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">exp( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns Euler’s number <code>e</code> raised to the power of the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 59. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">decimal( exp( 5 ), 2 ) = 148.41</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">odd( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the specified number is odd.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 60. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">odd( 5 ) = true
odd( 2 ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">even( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the specified number is even.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 61. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">even( 5 ) = false
even ( 2 ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_date_and_time_functions">Date and time functions</h7>
<div class="paragraph">
<p>The following functions support date and time operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">is( value1, value2 )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if both values are the same element in the FEEL semantic domain.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 62. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">is( date( "2012-12-25" ), time( "23:00:50" ) ) = false
is( date( "2012-12-25" ), date( "2012-12-25" ) ) = true
is( time( "23:00:50z" ), time( "23:00:50" ) ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_range_functions">Range functions</h7>
<div class="paragraph">
<p>The following functions support temporal ordering operations to establish relationships between single scalar values and ranges of such values. These functions are similar to the components in the Health Level Seven (HL7) International <a href="https://cql.hl7.org/08-a-cqlsyntax.html">Clinical Quality Language (CQL) 1.4 syntax</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">before( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is before an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>before( point1 point2 )</code></p>
</li>
<li>
<p><code>before( point range )</code></p>
</li>
<li>
<p><code>before( range point )</code></p>
</li>
<li>
<p><code>before( range1,range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>point1 &lt; point2</code></p>
</li>
<li>
<p><code>point &lt; range.start or ( point = range.start and not(range.start included) )</code></p>
</li>
<li>
<p><code>range.end &lt; point or ( range.end = point and not(range.end included) )</code></p>
</li>
<li>
<p><code>range1.end &lt; range2.start or (( not(range1.end included) or not(range2.start included) ) and range1.end = range2.start )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">before( 1, 10 ) = true
before( 10, 1 ) = false
before( 1, [1..10] ) = false
before( 1, (1..10] ) = true
before( 1, [5..10] ) = true
before( [1..10], 10 ) = false
before( [1..10), 10 ) = true
before( [1..10], 15 ) = true
before( [1..10], [15..20] ) = true
before( [1..10], [10..20] ) = false
before( [1..10), [10..20] ) = true
before( [1..10], (10..20] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">after( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is after an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>after( point1 point2 )</code></p>
</li>
<li>
<p><code>after( point range )</code></p>
</li>
<li>
<p><code>after( range, point )</code></p>
</li>
<li>
<p><code>after( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>point1 &gt; point2</code></p>
</li>
<li>
<p><code>point &gt; range.end or ( point = range.end and not(range.end included) )</code></p>
</li>
<li>
<p><code>range.start &gt; point or ( range.start = point and not(range.start included) )</code></p>
</li>
<li>
<p><code>range1.start &gt; range2.end or (( not(range1.start included) or not(range2.end included) ) and range1.start = range2.end )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">after( 10, 5 ) = true
after( 5, 10 ) = false
after( 12, [1..10] ) = true
after( 10, [1..10) ) = true
after( 10, [1..10] ) = false
after( [11..20], 12 ) = false
after( [11..20], 10 ) = true
after( (11..20], 11 ) = true
after( [11..20], 11 ) = false
after( [11..20], [1..10] ) = true
after( [1..10], [11..20] ) = false
after( [11..20], [1..11) ) = true
after( (11..20], [1..11] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">meets( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> meets an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>meets( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range1.end included and range2.start included and range1.end = range2.start</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">meets( [1..5], [5..10] ) = true
meets( [1..5), [5..10] ) = false
meets( [1..5], (5..10] ) = false
meets( [1..5], [6..10] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">met by( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is met by an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>met by( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range1.start included and range2.end included and range1.start = range2.end</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">met by( [5..10], [1..5] ) = true
met by( [5..10], [1..5) ) = false
met by( (5..10], [1..5] ) = false
met by( [6..10], [1..5] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">overlaps( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> overlaps an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>overlaps( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>( range1.end &gt; range2.start or (range1.end = range2.start and (range1.end included or range2.end included)) ) and ( range1.start &lt; range2.end or (range1.start = range2.end and range1.start included and range2.end included) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">overlaps( [1..5], [3..8] ) = true
overlaps( [3..8], [1..5] ) = true
overlaps( [1..8], [3..5] ) = true
overlaps( [3..5], [1..8] ) = true
overlaps( [1..5], [6..8] ) = false
overlaps( [6..8], [1..5] ) = false
overlaps( [1..5], [5..8] ) = true
overlaps( [1..5], (5..8] ) = false
overlaps( [1..5), [5..8] ) = false
overlaps( [1..5), (5..8] ) = false
overlaps( [5..8], [1..5] ) = true
overlaps( (5..8], [1..5] ) = false
overlaps( [5..8], [1..5) ) = false
overlaps( (5..8], [1..5) ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">overlaps before( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> overlaps before an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>overlaps before( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>( range1.start &lt; range2.start or (range1.start = range2.start and range1.start included and range2.start included) ) and ( range1.end &gt; range2.start or (range1.end = range2.start and range1.end included and range2.start included) ) and ( range1.end &lt; range2.end or (range1.end = range2.end and (not(range1.end included) or range2.end included )) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">overlaps before( [1..5], [3..8] ) = true
overlaps before( [1..5], [6..8] ) = false
overlaps before( [1..5], [5..8] ) = true
overlaps before( [1..5], (5..8] ) = false
overlaps before( [1..5), [5..8] ) = false
overlaps before( [1..5), (1..5] ) = true
overlaps before( [1..5], (1..5] ) = true
overlaps before( [1..5), [1..5] ) = false
overlaps before( [1..5], [1..5] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">overlaps after( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> overlaps after an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>overlaps after( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>( range2.start &lt; range1.start or (range2.start = range1.start and range2.start included and not( range1.start included)) ) and ( range2.end &gt; range1.start or (range2.end = range1.start  and range2.end included and range1.start included) ) and ( range2.end &lt; range1.end or (range2.end = range1.end and (not(range2.end included) or range1.end included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">overlaps after( [3..8], [1..5] )= true
overlaps after( [6..8], [1..5] )= false
overlaps after( [5..8], [1..5] )= true
overlaps after( (5..8], [1..5] )= false
overlaps after( [5..8], [1..5) )= false
overlaps after( (1..5], [1..5) )= true
overlaps after( (1..5], [1..5] )= true
overlaps after( [1..5], [1..5) )= false
overlaps after( [1..5], [1..5] )= false
overlaps after( (1..5), [1..5] )= false
overlaps after( (1..5], [1..6] )= false
overlaps after( (1..5], (1..5] )= false
overlaps after( (1..5], [2..5] )= false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">finishes( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> finishes an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>finishes( point, range )</code></p>
</li>
<li>
<p><code>finishes( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.end included and range.end = point</code></p>
</li>
<li>
<p><code>range1.end included = range2.end included and range1.end = range2.end and ( range1.start &gt; range2.start or (range1.start = range2.start and (not(range1.start included) or range2.start included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">finishes( 10, [1..10] ) = true
finishes( 10, [1..10) ) = false
finishes( [5..10], [1..10] ) = true
finishes( [5..10), [1..10] ) = false
finishes( [5..10), [1..10) ) = true
finishes( [1..10], [1..10] ) = true
finishes( (1..10], [1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">finished by( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is finished by an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>finished by( range, point )</code></p>
</li>
<li>
<p><code>finished by( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.end included and range.end = point</code></p>
</li>
<li>
<p><code>range1.end included = range2.end included and range1.end = range2.end and ( range1.start &lt; range2.start or (range1.start = range2.start and (range1.start included or not(range2.start included))) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">finished by( [1..10], 10 ) = true
finished by( [1..10), 10 ) = false
finished by( [1..10], [5..10] ) = true
finished by( [1..10], [5..10) ) = false
finished by( [1..10), [5..10) ) = true
finished by( [1..10], [1..10] ) = true
finished by( [1..10], (1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">includes( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> includes an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>includes( range, point )</code></p>
</li>
<li>
<p><code>includes( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>(range.start &lt; point and range.end &gt; point) or (range.start = point and range.start included) or (range.end = point and range.end included)</code></p>
</li>
<li>
<p><code>( range1.start &lt; range2.start or (range1.start = range2.start and (range1.start included or not(range2.start included))) ) and ( range1.end &gt; range2.end or (range1.end = range2.end and (range1.end included or not(range2.end included))) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">includes( [1..10], 5 ) = true
includes( [1..10], 12 ) = false
includes( [1..10], 1 ) = true
includes( [1..10], 10 ) = true
includes( (1..10], 1 ) = false
includes( [1..10), 10 ) = false
includes( [1..10], [4..6] ) = true
includes( [1..10], [1..5] ) = true
includes( (1..10], (1..5] ) = true
includes( [1..10], (1..10) ) = true
includes( [1..10), [5..10) ) = true
includes( [1..10], [1..10) ) = true
includes( [1..10], (1..10] ) = true
includes( [1..10], [1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">during( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is during an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>during( point, range )</code></p>
</li>
<li>
<p><code>during( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>(range.start &lt; point and range.end &gt; point) or (range.start = point and range.start included) or (range.end = point and range.end included)</code></p>
</li>
<li>
<p><code>( range2.start &lt; range1.start or (range2.start = range1.start and (range2.start included or not(range1.start included))) ) and ( range2.end &gt; range1.end or (range2.end = range1.end and (range2.end included or not(range1.end included))) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">during( 5, [1..10] ) = true
during( 12, [1..10] ) = false
during( 1, [1..10] ) = true
during( 10, [1..10] ) = true
during( 1, (1..10] ) = false
during( 10, [1..10) ) = false
during( [4..6], [1..10] ) = true
during( [1..5], [1..10] ) = true
during( (1..5], (1..10] ) = true
during( (1..10), [1..10] ) = true
during( [5..10), [1..10) ) = true
during( [1..10), [1..10] ) = true
during( (1..10], [1..10] ) = true
during( [1..10], [1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">starts( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> starts an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>starts( point, range )</code></p>
</li>
<li>
<p><code>starts( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.start = point and range.start included</code></p>
</li>
<li>
<p><code>range1.start = range2.start and range1.start included = range2.start included and ( range1.end &lt; range2.end or (range1.end = range2.end and (not(range1.end included) or range2.end included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">starts( 1, [1..10] ) = true
starts( 1, (1..10] ) = false
starts( 2, [1..10] ) = false
starts( [1..5], [1..10] ) = true
starts( (1..5], (1..10] ) = true
starts( (1..5], [1..10] ) = false
starts( [1..5], (1..10] ) = false
starts( [1..10], [1..10] ) = true
starts( [1..10), [1..10] ) = true
starts( (1..10), (1..10) ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">started by( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is started by an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>started by( range, point )</code></p>
</li>
<li>
<p><code>started by( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.start = point and range.start included</code></p>
</li>
<li>
<p><code>range1.start = range2.start and range1.start included = range2.start included and ( range2.end &lt; range1.end or (range2.end = range1.end and (not(range2.end included) or range1.end included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">started by( [1..10], 1 ) = true
started by( (1..10], 1 ) = false
started by( [1..10], 2 ) = false
started by( [1..10], [1..5] ) = true
started by( (1..10], (1..5] ) = true
started by( [1..10], (1..5] ) = false
started by( (1..10], [1..5] ) = false
started by( [1..10], [1..10] ) = true
started by( [1..10], [1..10) ) = true
started by( (1..10), (1..10) ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">coincides( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> coincides with an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>coincides( point1, point2 )</code></p>
</li>
<li>
<p><code>coincides( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>point1 = point2</code></p>
</li>
<li>
<p><code>range1.start = range2.start and range1.start included = range2.start included and range1.end = range2.end and range1.end included = range2.end included</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">coincides( 5, 5 ) = true
coincides( 3, 4 ) = false
coincides( [1..5], [1..5] ) = true
coincides( (1..5), [1..5] ) = false
coincides( [1..5], [2..6] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_temporal_functions">Temporal functions</h7>
<div class="paragraph">
<p>The following functions support general temporal operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">day of year( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian number of the day of the year.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 63. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">day of year( date(2019, 9, 17) ) = 260</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">day of week( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian day of the week: <code>"Monday"</code>, <code>"Tuesday"</code>, <code>"Wednesday"</code>, <code>"Thursday"</code>, <code>"Friday"</code>, <code>"Saturday"</code>, or <code>"Sunday"</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 64. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">day of week( date(2019, 9, 17) ) = "Tuesday"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">month of year( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian month of the year: <code>"January"</code>, <code>"February"</code>, <code>"March"</code>, <code>"April"</code>, <code>"May"</code>, <code>"June"</code>, <code>"July"</code>, <code>"August"</code>, <code>"September"</code>, <code>"October"</code>, <code>"November"</code>, or <code>"December"</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 65. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">month of year( date(2019, 9, 17) ) = "September"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">month of year( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian week of the year as defined by ISO 8601.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 66. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">week of year( date(2019, 9, 17) ) = 38
week of year( date(2003, 12, 29) ) = 1
week of year( date(2004, 1, 4) ) = 1
week of year( date(2005, 1, 1) ) = 53
week of year( date(2005, 1, 3) ) = 1
week of year( date(2005, 1, 9) ) = 1</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_sort_functions">Sort functions</h7>
<div class="paragraph">
<p>The following functions support sorting operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">sort( list, precedes )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of the same elements but ordered according to the sorting function.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 67. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>precedes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>function</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sort( list: [3,1,4,5,2], precedes: function(x,y) x &lt; y ) = [1,2,3,4,5]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_context_functions">Context functions</h7>
<div class="paragraph">
<p>The following functions support context operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">get value( m, key )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the value from the context for the specified entry key.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 68. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">get value( {key1 : "value1"}, "key1" ) = "value1"
get value( {key1 : "value1"}, "unexistent-key" ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">get entries( m )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of key-value pairs for the specified context.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 69. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">get entries( {key1 : "value1", key2 : "value2"} ) = [ { key : "key1", value : "value1" }, {key : "key2", value : "value2"} ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-feel-variable-function-names_kogito-dmn-models">Variable and function names in FEEL</h5>
<div class="paragraph _abstract">
<p>Unlike many traditional expression languages, Friendly Enough Expression Language (FEEL) supports spaces and a few special characters as part of variable and function names. A FEEL name must start with a <code>letter</code>, <code>?</code>, or <code>_</code> element. The unicode letter characters are also allowed. Variable names cannot start with a language keyword, such as <code>and</code>, <code>true</code>, or <code>every</code>. The remaining characters in a variable name can be any of the starting characters, as well as <code>digits</code>, white spaces, and special characters such as <code>+</code>, <code>-</code>, <code>/</code>, <code>*</code>, <code>'</code>, and <code>.</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following names are all valid FEEL names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Age</p>
</li>
<li>
<p>Birth Date</p>
</li>
<li>
<p>Flight 234 pre-check procedure</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Several limitations apply to variable and function names in FEEL:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ambiguity</dt>
<dd>
<p>The use of spaces, keywords, and other special characters as part of names can make FEEL ambiguous. The ambiguities are resolved in the context of the expression, matching names from left to right. The parser resolves the variable name as the longest name matched in scope. You can use <code>( )</code> to disambiguate names if necessary.</p>
</dd>
<dt class="hdlist1">Spaces in names</dt>
<dd>
<p>The DMN specification limits the use of spaces in FEEL names. According to the DMN specification, names can contain multiple spaces but not two consecutive spaces.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In order to make the language easier to use and avoid common errors due to spaces, {PRODUCT} removes the limitation on the use of consecutive spaces. {PRODUCT} supports variable names with any number of consecutive spaces, but normalizes them into a single space. For example, the variable references <code>First Name</code> with one space and <code>First  Name</code> with two spaces are both acceptable in {PRODUCT}.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} also normalizes the use of other white spaces, like the non-breakable white space that is common in web pages, tabs, and line breaks. From a {PRODUCT} FEEL engine perspective, all of these characters are normalized into a single white space before processing.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">The keyword <code>in</code></dt>
<dd>
<p>The keyword <code>in</code> is the only keyword in the language that cannot be used as part of a variable name. Although the specifications allow the use of keywords in the middle of variable names, the use of <code>in</code> in variable names conflicts with the grammar definition of <code>for</code>, <code>every</code> and <code>some</code> expression constructs.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-boxed-expressions_kogito-dmn-models">DMN decision logic in boxed expressions</h5>
<div class="paragraph _abstract">
<p>Boxed expressions in DMN are tables that you use to define the underlying logic of decision nodes and business knowledge models in a decision requirements diagram (DRD). Some boxed expressions can contain other boxed expressions, but the top-level boxed expression corresponds to the decision logic of a single DRD artifact. While DRDs represent the flow of a DMN decision model, boxed expressions define the actual decision logic of individual nodes. DRDs and boxed expressions together form a complete and functional DMN decision model.</p>
</div>
<div class="paragraph">
<p>The following are the types of DMN boxed expressions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Decision tables</p>
</li>
<li>
<p>Literal expressions</p>
</li>
<li>
<p>Contexts</p>
</li>
<li>
<p>Relations</p>
</li>
<li>
<p>Functions</p>
</li>
<li>
<p>Invocations</p>
</li>
<li>
<p>Lists</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All Friendly Enough Expression Language (FEEL) expressions that you use in your boxed expressions must conform to the FEEL syntax requirements in the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect5">
<h6 id="con-dmn-decision-tables_kogito-dmn-models">DMN decision tables</h6>
<div class="paragraph _abstract">
<p>A decision table in DMN is a visual representation of one or more business rules in a tabular format. You use decision tables to define rules for a decision node that applies those rules at a given point in the decision model. Each rule consists of a single row in the table, and includes columns that define the conditions (input) and outcome (output) for that particular row. The definition of each row is precise enough to derive the outcome using the values of the conditions. Input and output values can be FEEL expressions or defined data type values.</p>
</div>
<div class="paragraph">
<p>For example, the following decision table determines credit score ratings based on a defined range of a loan applicant&#8217;s credit score:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example.png" alt="dmn decision table example">
</div>
<div class="title">Figure 71. Decision table for credit score rating</div>
</div>
<div class="paragraph">
<p>The following decision table determines the next step in a lending strategy for applicants depending on applicant loan eligibility and the bureau call type:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example2.png" alt="dmn decision table example2">
</div>
<div class="title">Figure 72. Decision table for lending strategy</div>
</div>
<div class="paragraph">
<p>The following decision table determines applicant qualification for a loan as the concluding decision node in a loan prequalification decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3">
</div>
<div class="title">Figure 73. Decision table for loan prequalification</div>
</div>
<div class="paragraph">
<p>Decision tables are a popular way of modeling rules and decision logic, and are used in many methodologies (such as DMN) and implementation frameworks (such as Drools).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
{PRODUCT} supports both DMN decision tables and Drools-native decision tables, but they are different types of assets with different syntax requirements and are not interchangeable. For more information about Drools-native decision tables in {PRODUCT}, see <a href="#con-decision-tables_kogito-decision-tables">[con-decision-tables_kogito-decision-tables]</a>.
</td>
</tr>
</table>
</div>
<div class="sect6">
<h7 id="con-dmn-decision-tables-hit-policies_kogito-dmn-models">Hit policies in DMN decision tables</h7>
<div class="paragraph _abstract">
<p>Hit policies determine how to reach an outcome when multiple rules in a decision table match the provided input values. For example, if one rule in a decision table applies a sales discount to military personnel and another rule applies a discount to students, then when a customer is both a student and in the military, the decision table hit policy must indicate whether to apply one discount or the other (<strong>Unique</strong>, <strong>First</strong>) or both discounts (<strong>Collect Sum</strong>). You specify the single character of the hit policy (<strong>U</strong>, <strong>F</strong>, <strong>C+</strong>) in the upper-left corner of the decision table.</p>
</div>
<div class="paragraph">
<p>The following decision table hit policies are supported in DMN:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unique (U):</strong> Permits only one rule to match. Any overlap raises an error.</p>
</li>
<li>
<p><strong>Any (A):</strong> Permits multiple rules to match, but they must all have the same output. If multiple matching rules do not have the same output, an error is raised.</p>
</li>
<li>
<p><strong>Priority (P):</strong> Permits multiple rules to match, with different outputs. The output that comes first in the output values list is selected.</p>
</li>
<li>
<p><strong>First (F):</strong> Uses the first match in rule order.</p>
</li>
<li>
<p><strong>Collect (C+, C&gt;, C&lt;, C#):</strong> Aggregates output from multiple rules based on an aggregation function.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Collect ( C ):</strong> Aggregates values in an arbitrary list.</p>
</li>
<li>
<p><strong>Collect Sum (C+):</strong> Outputs the sum of all collected values. Values must be numeric.</p>
</li>
<li>
<p><strong>Collect Min (C&lt;):</strong> Outputs the minimum value among the matches. The resulting values must be comparable, such as numbers, dates, or text (lexicographic order).</p>
</li>
<li>
<p><strong>Collect Max (C&gt;):</strong> Outputs the maximum value among the matches. The resulting values must be comparable, such as numbers, dates or text (lexicographic order).</p>
</li>
<li>
<p><strong>Collect Count (C#):</strong> Outputs the number of matching rules.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-literal-expressions_kogito-dmn-models">Boxed literal expressions</h6>
<div class="paragraph _abstract">
<p>A boxed literal expression in DMN is a literal FEEL expression as text in a table cell, typically with a labeled column and an assigned data type. You use boxed literal expressions to define simple or complex node logic or decision data directly in FEEL for a particular node in a decision. Literal FEEL expressions must conform to FEEL syntax requirements in the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed literal expression defines the minimum acceptable PITI calculation (principal, interest, taxes, and insurance) in a lending decision, where <code>acceptable rate</code> is a variable defined in the DMN model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-literal-expression-example2.png" alt="dmn literal expression example2">
</div>
<div class="title">Figure 74. Boxed literal expression for minimum PITI value</div>
</div>
<div class="paragraph">
<p>The following boxed literal expression sorts a list of possible dating candidates (soul mates) in an online dating application based on their score on criteria such as age, location, and interests:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-literal-expression-example3b.png" alt="dmn literal expression example3b">
</div>
<div class="title">Figure 75. Boxed literal expression for matching online dating candidates</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-context-expressions_kogito-dmn-models">Boxed context expressions</h6>
<div class="paragraph _abstract">
<p>A boxed context expression in DMN is a set of variable names and values with a result value. Each name-value pair is a context entry. You use context expressions to represent data definitions in decision logic and set a value for a desired decision element within the DMN decision model. A value in a boxed context expression can be a data type value or FEEL expression, or can contain a nested sub-expression of any type, such as a decision table, a literal expression, or another context expression.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed context expression defines the factors for sorting delayed passengers in a flight-rebooking decision model, based on defined data types (<code>tPassengerTable</code>, <code>tFlightNumberList</code>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-context-expression-example.png" alt="dmn context expression example">
</div>
<div class="title">Figure 76. Boxed context expression for flight passenger waiting list</div>
</div>
<div class="paragraph">
<p>The following boxed context expression defines the factors that determine whether a loan applicant can meet minimum mortgage payments based on principal, interest, taxes, and insurance (PITI), represented as a front-end ratio calculation with a sub-context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-context-expression-example2.png" alt="dmn context expression example2">
</div>
<div class="title">Figure 77. Boxed context expression for front-end client PITI ratio</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-relation-expressions_kogito-dmn-models">Boxed relation expressions</h6>
<div class="paragraph _abstract">
<p>A boxed relation expression in DMN is a traditional data table with information about given entities, listed as rows. You use boxed relation tables to define decision data for relevant entities in a decision at a particular node. Boxed relation expressions are similar to context expressions in that they set variable names and values, but relation expressions contain no result value and list all variable values based on a single defined variable in each column.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed relation expression provides information about employees in an employee rostering decision:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-relation-expression-example.png" alt="dmn relation expression example">
</div>
<div class="title">Figure 78. Boxed relation expression with employee information</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-function-expressions_kogito-dmn-models">Boxed function expressions</h6>
<div class="paragraph _abstract">
<p>A boxed function expression in DMN is a parameterized boxed expression containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type. By default, all business knowledge models are defined as boxed function expressions. You use boxed function expressions to call functions on your decision logic and to define all business knowledge models.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed function expression determines airline flight capacity in a flight-rebooking decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-function-expression-example.png" alt="dmn function expression example">
</div>
<div class="title">Figure 79. Boxed function expression for flight capacity</div>
</div>
<div class="paragraph">
<p>The following boxed function expression contains a basic Java function as a context expression for determining absolute value in a decision model calculation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-function-expression-example2.png" alt="dmn function expression example2">
</div>
<div class="title">Figure 80. Boxed function expression for absolute value</div>
</div>
<div class="paragraph">
<p>The following boxed function expression determines a monthly mortgage installment as a business knowledge model in a lending decision, with the function value defined as a nested context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-function-expression-example3.png" alt="dmn function expression example3">
</div>
<div class="title">Figure 81. Boxed function expression for installment calculation in business knowledge model</div>
</div>
<div class="paragraph">
<p>The following boxed function expression uses a PMML model included in the DMN file to define the minimum acceptable PITI calculation (principal, interest, taxes, and insurance) in a lending decision:</p>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-invocation-expressions_kogito-dmn-models">Boxed invocation expressions</h6>
<div class="paragraph _abstract">
<p>A boxed invocation expression in DMN is a boxed expression that invokes a business knowledge model. A boxed invocation expression contains the name of the business knowledge model to be invoked and a list of parameter bindings. Each binding is represented by two boxed expressions on a row: The box on the left contains the name of a parameter and the box on the right contains the binding expression whose value is assigned to the parameter to evaluate the invoked business knowledge model. You use boxed invocations to invoke at a particular decision node a business knowledge model defined in the decision model.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed invocation expression invokes a <code>Reassign Next Passenger</code> business knowledge model as the concluding decision node in a flight-rebooking decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-invocation-example.png" alt="dmn invocation example">
</div>
<div class="title">Figure 82. Boxed invocation expression to reassign flight passengers</div>
</div>
<div class="paragraph">
<p>The following boxed invocation expression invokes an <code>InstallmentCalculation</code> business knowledge model to calculate a monthly installment amount for a loan before proceeding to affordability decisions:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-invocation-example2.png" alt="dmn invocation example2">
</div>
<div class="title">Figure 83. Boxed invocation expression for required monthly installment</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-list-expressions_kogito-dmn-models">Boxed list expressions</h6>
<div class="paragraph _abstract">
<p>A boxed list expression in DMN represents a FEEL list of items. You use boxed lists to define lists of relevant items for a particular node in a decision. You can also use literal FEEL expressions for list items in cells to create more complex lists.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed list expression identifies approved credit score agencies in a loan application decision service:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-list-expression-example.png" alt="dmn list expression example">
</div>
<div class="title">Figure 84. Boxed list expression for approved credit score agencies</div>
</div>
<div class="paragraph">
<p>The following boxed list expression also identifies approved credit score agencies but uses FEEL logic to define the agency status (Inc., LLC, SA, GA) based on a DMN input node:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-list-expression-example2.png" alt="dmn list expression example2">
</div>
<div class="title">Figure 85. Boxed list expression using FEEL logic for approved credit score agency status</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-list-expression-example2a.png" alt="dmn list expression example2a">
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-model-example_kogito-dmn-models">DMN model example</h5>
<div class="paragraph _abstract">
<p>The following is a real-world DMN model example that demonstrates how you can use decision modeling to reach a decision based on input data, circumstances, and company guidelines. In this scenario, a flight from San Diego to New York is canceled, requiring the affected airline to find alternate arrangements for its inconvenienced passengers.</p>
</div>
<div class="paragraph">
<p>First, the airline collects the information necessary to determine how best to get the travelers to their destinations:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Input data</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>List of flights</p>
</li>
<li>
<p>List of passengers</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Decisions</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Prioritize the passengers who will get seats on a new flight</p>
</li>
<li>
<p>Determine which flights those passengers will be offered</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Business knowledge models</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The company process for determining passenger priority</p>
</li>
<li>
<p>Any flights that have space available</p>
</li>
<li>
<p>Company rules for determining how best to reassign inconvenienced passengers</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The airline then uses the DMN standard to model its decision process in the following decision requirements diagram (DRD) for determining the best rebooking solution:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-passenger-rebooking-drd.png" alt="dmn passenger rebooking drd">
</div>
<div class="title">Figure 86. DRD for flight rebooking</div>
</div>
<div class="paragraph">
<p>Similar to flowcharts, DRDs use shapes to represent the different elements in a process. Ovals contain the two necessary input data, rectangles contain the decision points in the model, and rectangles with clipped corners (business knowledge models) contain reusable logic that can be repeatedly invoked.</p>
</div>
<div class="paragraph">
<p>The DRD draws logic for each element from boxed expressions that provide variable definitions using FEEL expressions or data type values.</p>
</div>
<div class="paragraph">
<p>Some boxed expressions are basic, such as the following decision for establishing a prioritized waiting list:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-context-expression-example.png" alt="dmn context expression example">
</div>
<div class="title">Figure 87. Boxed context expression example for prioritized wait list</div>
</div>
<div class="paragraph">
<p>Some boxed expressions are more complex with greater detail and calculation, such as the following business knowledge model for reassigning the next delayed passenger:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-reassign-passenger.png" alt="dmn reassign passenger">
</div>
<div class="title">Figure 88. Boxed function expression for passenger reassignment</div>
</div>
<div class="paragraph">
<p>The following is the DMN source file for this decision model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dmn:definitions xmlns="https://www.drools.org/kie-dmn/Flight-rebooking" xmlns:dmn="http://www.omg.org/spec/DMN/20151101/dmn.xsd" xmlns:feel="http://www.omg.org/spec/FEEL/20140401" id="_0019_flight_rebooking" name="0019-flight-rebooking" namespace="https://www.drools.org/kie-dmn/Flight-rebooking"&gt;
  &lt;dmn:itemDefinition id="_tFlight" name="tFlight"&gt;
    &lt;dmn:itemComponent id="_tFlight_Flight" name="Flight Number"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_From" name="From"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_To" name="To"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Dep" name="Departure"&gt;
      &lt;dmn:typeRef&gt;feel:dateTime&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Arr" name="Arrival"&gt;
      &lt;dmn:typeRef&gt;feel:dateTime&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Capacity" name="Capacity"&gt;
      &lt;dmn:typeRef&gt;feel:number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Status" name="Status"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tFlightTable" isCollection="true" name="tFlightTable"&gt;
    &lt;dmn:typeRef&gt;tFlight&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tPassenger" name="tPassenger"&gt;
    &lt;dmn:itemComponent id="_tPassenger_Name" name="Name"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Status" name="Status"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Miles" name="Miles"&gt;
      &lt;dmn:typeRef&gt;feel:number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Flight" name="Flight Number"&gt;
      &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tPassengerTable" isCollection="true" name="tPassengerTable"&gt;
    &lt;dmn:typeRef&gt;tPassenger&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tFlightNumberList" isCollection="true" name="tFlightNumberList"&gt;
    &lt;dmn:typeRef&gt;feel:string&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:inputData id="i_Flight_List" name="Flight List"&gt;
    &lt;dmn:variable name="Flight List" typeRef="tFlightTable"/&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:inputData id="i_Passenger_List" name="Passenger List"&gt;
    &lt;dmn:variable name="Passenger List" typeRef="tPassengerTable"/&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:decision name="Prioritized Waiting List" id="d_PrioritizedWaitingList"&gt;
    &lt;dmn:variable name="Prioritized Waiting List" typeRef="tPassengerTable"/&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredInput href="#i_Passenger_List"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredInput href="#i_Flight_List"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:knowledgeRequirement&gt;
      &lt;dmn:requiredKnowledge href="#b_PassengerPriority"/&gt;
    &lt;/dmn:knowledgeRequirement&gt;
    &lt;dmn:context&gt;
      &lt;dmn:contextEntry&gt;
        &lt;dmn:variable name="Cancelled Flights" typeRef="tFlightNumberList"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Flight List[ Status = "cancelled" ].Flight Number&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
      &lt;dmn:contextEntry&gt;
        &lt;dmn:variable name="Waiting List" typeRef="tPassengerTable"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Passenger List[ list contains( Cancelled Flights, Flight Number ) ]&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
      &lt;dmn:contextEntry&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;sort( Waiting List, passenger priority )&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
    &lt;/dmn:context&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:decision name="Rebooked Passengers" id="d_RebookedPassengers"&gt;
    &lt;dmn:variable name="Rebooked Passengers" typeRef="tPassengerTable"/&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredDecision href="#d_PrioritizedWaitingList"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement&gt;
      &lt;dmn:requiredInput href="#i_Flight_List"/&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:knowledgeRequirement&gt;
      &lt;dmn:requiredKnowledge href="#b_ReassignNextPassenger"/&gt;
    &lt;/dmn:knowledgeRequirement&gt;
    &lt;dmn:invocation&gt;
      &lt;dmn:literalExpression&gt;
        &lt;dmn:text&gt;reassign next passenger&lt;/dmn:text&gt;
      &lt;/dmn:literalExpression&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter name="Waiting List"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Prioritized Waiting List&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter name="Reassigned Passengers List"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;[]&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter name="Flights"/&gt;
        &lt;dmn:literalExpression&gt;
          &lt;dmn:text&gt;Flight List&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
    &lt;/dmn:invocation&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:businessKnowledgeModel id="b_PassengerPriority" name="passenger priority"&gt;
    &lt;dmn:encapsulatedLogic&gt;
      &lt;dmn:formalParameter name="Passenger1" typeRef="tPassenger"/&gt;
      &lt;dmn:formalParameter name="Passenger2" typeRef="tPassenger"/&gt;
      &lt;dmn:decisionTable hitPolicy="UNIQUE"&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P1_Status" label="Passenger1.Status"&gt;
          &lt;dmn:inputExpression typeRef="feel:string"&gt;
            &lt;dmn:text&gt;Passenger1.Status&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
          &lt;dmn:inputValues&gt;
            &lt;dmn:text&gt;"gold", "silver", "bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputValues&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P2_Status" label="Passenger2.Status"&gt;
          &lt;dmn:inputExpression typeRef="feel:string"&gt;
            &lt;dmn:text&gt;Passenger2.Status&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
          &lt;dmn:inputValues&gt;
            &lt;dmn:text&gt;"gold", "silver", "bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputValues&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P1_Miles" label="Passenger1.Miles"&gt;
          &lt;dmn:inputExpression typeRef="feel:string"&gt;
            &lt;dmn:text&gt;Passenger1.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:output id="b_Status_Priority_dt_o" label="Passenger1 has priority"&gt;
          &lt;dmn:outputValues&gt;
            &lt;dmn:text&gt;true, false&lt;/dmn:text&gt;
          &lt;/dmn:outputValues&gt;
          &lt;dmn:defaultOutputEntry&gt;
            &lt;dmn:text&gt;false&lt;/dmn:text&gt;
          &lt;/dmn:defaultOutputEntry&gt;
        &lt;/dmn:output&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r1"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i1"&gt;
            &lt;dmn:text&gt;"gold"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i2"&gt;
            &lt;dmn:text&gt;"gold"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i3"&gt;
            &lt;dmn:text&gt;&gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r1_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r2"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i1"&gt;
            &lt;dmn:text&gt;"gold"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i2"&gt;
            &lt;dmn:text&gt;"silver","bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i3"&gt;
            &lt;dmn:text&gt;-&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r2_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r3"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i1"&gt;
            &lt;dmn:text&gt;"silver"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i2"&gt;
            &lt;dmn:text&gt;"silver"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i3"&gt;
            &lt;dmn:text&gt;&gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r3_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r4"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i1"&gt;
            &lt;dmn:text&gt;"silver"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i2"&gt;
            &lt;dmn:text&gt;"bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i3"&gt;
            &lt;dmn:text&gt;-&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r4_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r5"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i1"&gt;
            &lt;dmn:text&gt;"bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i2"&gt;
            &lt;dmn:text&gt;"bronze"&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i3"&gt;
            &lt;dmn:text&gt;&gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r5_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
        &lt;/dmn:rule&gt;
      &lt;/dmn:decisionTable&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:variable name="passenger priority" typeRef="feel:boolean"/&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
  &lt;dmn:businessKnowledgeModel id="b_ReassignNextPassenger" name="reassign next passenger"&gt;
    &lt;dmn:encapsulatedLogic&gt;
      &lt;dmn:formalParameter name="Waiting List" typeRef="tPassengerTable"/&gt;
      &lt;dmn:formalParameter name="Reassigned Passengers List" typeRef="tPassengerTable"/&gt;
      &lt;dmn:formalParameter name="Flights" typeRef="tFlightTable"/&gt;
      &lt;dmn:context&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Next Passenger" typeRef="tPassenger"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;Waiting List[1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Original Flight" typeRef="tFlight"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;Flights[ Flight Number = Next Passenger.Flight Number ][1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Best Alternate Flight" typeRef="tFlight"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;Flights[ From = Original Flight.From and To = Original Flight.To and Departure &gt; Original Flight.Departure and Status = "scheduled" and has capacity( item, Reassigned Passengers List ) ][1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Reassigned Passenger" typeRef="tPassenger"/&gt;
          &lt;dmn:context&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Name" typeRef="feel:string"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Next Passenger.Name&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Status" typeRef="feel:string"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Next Passenger.Status&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Miles" typeRef="feel:number"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Next Passenger.Miles&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry&gt;
              &lt;dmn:variable name="Flight Number" typeRef="feel:string"/&gt;
              &lt;dmn:literalExpression&gt;
                &lt;dmn:text&gt;Best Alternate Flight.Flight Number&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
          &lt;/dmn:context&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Remaining Waiting List" typeRef="tPassengerTable"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;remove( Waiting List, 1 )&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:variable name="Updated Reassigned Passengers List" typeRef="tPassengerTable"/&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;append( Reassigned Passengers List, Reassigned Passenger )&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry&gt;
          &lt;dmn:literalExpression&gt;
            &lt;dmn:text&gt;if count( Remaining Waiting List ) &gt; 0 then reassign next passenger( Remaining Waiting List, Updated Reassigned Passengers List, Flights ) else Updated Reassigned Passengers List&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
      &lt;/dmn:context&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:variable name="reassign next passenger" typeRef="tPassengerTable"/&gt;
    &lt;dmn:knowledgeRequirement&gt;
      &lt;dmn:requiredKnowledge href="#b_HasCapacity"/&gt;
    &lt;/dmn:knowledgeRequirement&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
  &lt;dmn:businessKnowledgeModel id="b_HasCapacity" name="has capacity"&gt;
    &lt;dmn:encapsulatedLogic&gt;
      &lt;dmn:formalParameter name="flight" typeRef="tFlight"/&gt;
      &lt;dmn:formalParameter name="rebooked list" typeRef="tPassengerTable"/&gt;
      &lt;dmn:literalExpression&gt;
        &lt;dmn:text&gt;flight.Capacity &gt; count( rebooked list[ Flight Number = flight.Flight Number ] )&lt;/dmn:text&gt;
      &lt;/dmn:literalExpression&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:variable name="has capacity" typeRef="feel:boolean"/&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
&lt;/dmn:definitions&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-dmn-support_kogito-dmn-models">DMN support in {PRODUCT}</h4>
<div class="paragraph _abstract">
<p>{PRODUCT} provides design and runtime support for DMN 1.2 models at conformance level 3, and runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. You can design your DMN models with the {PRODUCT} DMN modeler in VSCode or import existing DMN models into your {PRODUCT} projects for deployment and execution. DMN 1.1 and 1.3 models are currently not supported in the {PRODUCT} DMN modeler.</p>
</div>
<div class="paragraph">
<p>In addition to all DMN conformance level 3 requirements, {PRODUCT} also includes enhancements and fixes to FEEL and DMN model components to optimize the experience of implementing DMN decision services with {PRODUCT}. From a platform perspective, DMN models are like any other business asset in {PRODUCT}, such as DRL files or spreadsheet decision tables, that you can include in your {PRODUCT} project and execute to start your DMN decision services.</p>
</div>
<div class="sect4">
<h5 id="con-dmn-validation_kogito-dmn-models">Configurable DMN validation in {PRODUCT}</h5>
<div class="paragraph _abstract">
<p>By default, the {PRODUCT} CodeGen component uses the <code>kogito.decisions.validation=ENABLED</code> configuration to perform pre-compilation validation of DMN model assets and to perform DMN decision table static analysis.</p>
</div>
<div class="paragraph">
<p>When this configuration is enabled, {PRODUCT} performs the following DMN validations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DMN model files are verified against the DMN specification XSD schema to ensure that the files are valid XML and compliant with the specification.</p>
</li>
<li>
<p>The pre-compilation analysis is performed for the DMN model to ensure that the basic semantic is aligned with the DMN specification.</p>
</li>
<li>
<p>DMN decision tables are statically analyzed for gaps or overlaps and to ensure that the semantic of the decision table follows best practices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any DMN validation error causes the {PRODUCT} CodeGen build to fail and errors are reported accordingly, as shown in the following example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-dmn-validation-con-error.png" alt="Image of DMN validation errors">
</div>
<div class="title">Figure 89. DMN validation errors</div>
</div>
<div class="paragraph">
<p>You can modify the default DMN validation and DMN decision table analysis behavior to ignore errors during the project build, or you can disable this default behavior completely, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="title">Default configuration for DMN validation and decision table analysis</div>
<div class="content">
<pre class="highlight"><code>kogito.decisions.validation=ENABLED</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Configuration to validate DMN models and DMN decision tables but ignore errors</div>
<div class="content">
<pre class="highlight"><code>kogito.decisions.validation=IGNORE</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Configuration to disable all DMN validation</div>
<div class="content">
<pre class="highlight"><code>kogito.decisions.validation=DISABLED</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you enter an unrecognized <code>kogito.decisions.validation</code> configuration flag, all pre-compilation validation features are disabled and the {PRODUCT} CodeGen emits related log messages.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-feel-enhancements_kogito-dmn-models">FEEL enhancements in {PRODUCT}</h5>
<div class="paragraph _abstract">
<p>{PRODUCT} includes the following enhancements and other changes to FEEL in the current DMN implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Space Sensitivity</em>: This DMN implementation of the FEEL language is space insensitive. The goal is to avoid non-deterministic behavior based on the context and differences in behavior based on invisible characters, such as white spaces. This means that for this implementation, a variable named <code>first name</code> with one space is exactly the same as <code>first  name</code> with two spaces in it.</p>
</li>
<li>
<p><em>List functions <code>or()</code> and <code>and()</code> </em>: The specification defines two list functions named <code>or()</code> and <code>and()</code>. However,
according to the FEEL grammar, these are not valid function names, as <code>and</code> and <code>or</code> are reserved keywords.
 This implementation renames these functions to <code>any()</code> and <code>all()</code> respectively, in anticipation for DMN 1.2.</p>
</li>
<li>
<p><em>Keyword <code>in</code> cannot be used in variable names</em>: The specification defines that any keyword can be reused as part
of a variable name, but the ambiguities caused with the <code>for &#8230;&#8203; in &#8230;&#8203; return</code> loop prevent the reuse of the <code>in</code>
keyword. All other keywords are supported as part of variable names.</p>
</li>
<li>
<p><em>Keywords are not supported in attributes of anonymous types</em>: FEEL is not a strongly typed language and the parser must resolve ambiguity in name parts of an attribute of an anonymous type. The parser supports reusable keywords as part of a variable name defined in the scope, but the parser does not support keywords in attributes of an anonymous type. For example, <code>for item in Order.items return Federal Tax for Item( item )</code> is a valid and supported FEEL expression, where a function named <code>Federal Tax for Item(&#8230;&#8203;)</code> can be defined and invoked correctly in the scope. However, the expression <code>for i in [ {x and y : true, n : 1}, {x and y : false, n: 2} ] return i.x and y</code> is not supported because anonymous types are defined in the iteration context of the <code>for</code> expression and the parser cannot resolve the ambiguity.</p>
</li>
<li>
<p><em>Support for date and time literals on ranges</em>: According to the grammar rules #8, #18, #19, #34 and #62, <code>date
and time</code> literals are supported in ranges (pages 110-111). Chapter 10.3.2.7 on page 114, on the other hand, contradicts
the grammar and says they are not supported. This implementation chose to follow the grammar and support <code>date and
time</code> literals on ranges, as well as extend the specification to support any arbitrary expression (see extensions below).</p>
</li>
<li>
<p><em>Invalid time syntax</em>: Chapter 10.3.2.3.4 on page 112 and bullet point about <code>time</code> on page 131 both state that
the <code>time</code> string lexical representation follows the XML Schema Datatypes specification as well as ISO 8601. According
to the XML Schema specification (<a href="https://www.w3.org/TR/xmlschema-2/#time" class="bare">https://www.w3.org/TR/xmlschema-2/#time</a>), the lexical representation of a time follows
the pattern <code>hh:mm:ss.sss</code> without any leading character. The DMN specification uses a leading "T" in several examples,
that we understand is a typo and not in accordance with the standard.</p>
</li>
<li>
<p><em>Support for scientific and hexadecimal notations</em>: This implementation supports scientific and hexadecimal
notation for numbers. For example, <code>1.2e5</code> (scientific notation), <code>0xD5</code> (hexadecimal notation).</p>
</li>
<li>
<p><em>Support for expressions as end points in ranges</em>: This implementation supports expressions as endpoints
for ranges. For example, <code>[date("2016-11-24")..date("2016-11-27")]</code></p>
</li>
<li>
<p><em>Support for additional types</em>: The specification only defines the following as basic types of the language:</p>
<div class="ulist">
<ul>
<li>
<p>number</p>
</li>
<li>
<p>string</p>
</li>
<li>
<p>boolean</p>
</li>
<li>
<p>days and time duration</p>
</li>
<li>
<p>years and month duration</p>
</li>
<li>
<p>time</p>
</li>
<li>
<p>date and time</p>
<div class="paragraph">
<p>For completeness and orthogonality, this implementation also supports the following types:</p>
</div>
</li>
<li>
<p>context</p>
</li>
<li>
<p>list</p>
</li>
<li>
<p>range</p>
</li>
<li>
<p>function</p>
</li>
<li>
<p>unary test</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Support for unary tests</em>: For completeness and orthogonality, unary tests are supported
as first class citizens in the language. They are functions with an implicit single
parameter and can be invoked in the same way as functions. For example,</p>
<div class="listingblock">
<div class="title">UnaryTestAsFunction.feel</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  {
      is minor : &lt; 18,
      Bob is minor : is minor( bob.age )
  }</code></pre>
</div>
</div>
</li>
<li>
<p><em>Support for additional built-in functions</em>: The following additional functions are supported:</p>
<div class="ulist">
<ul>
<li>
<p><code>now()</code> : Returns the current local date and time.</p>
</li>
<li>
<p><code>today()</code> : Returns the current local date.</p>
</li>
<li>
<p><code>decision table()</code> : Returns a decision table function, although the specification mentions a decision table.
The function on page 114 is not implementable as defined.</p>
</li>
<li>
<p><code>string( mask, p&#8230;&#8203; )</code> : Returns a string formatted as per the mask. See Java String.format() for
details on the mask syntax. For example, <code>string( "%4.2f", 7.1298 )</code> returns the string <code>"7.12"</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Support for additional date and time arithmetics</em>: Subtracting two dates returns a day and time duration with the number of days between the two
dates, ignoring daylight savings. For example,</p>
<div class="listingblock">
<div class="title">DateArithmetic.feel</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">date( "2017-05-12" ) - date( "2017-04-25" ) = duration( "P17D" )</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-model-enhancements_kogito-dmn-models">DMN model enhancements in {PRODUCT}</h5>
<div class="paragraph _abstract">
<p>{PRODUCT} includes the following enhancements to DMN model support in the current DMN implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Support for types with spaces on names</em>: The DMN XML schema defines type refs such as QNames. The QNames do not allow spaces. Therefore, it is not possible to use types like FEEL <code>date and time</code>,   <code>days and time duration</code> or <code>years and months duration</code>. This implementation does parse such typerefs as strings and allows type names with spaces. However, in order to comply with the XML schema, it also adds the following aliases to such types that can be used instead:</p>
<div class="ulist">
<ul>
<li>
<p><code>date and time</code> = <code>dateTime</code></p>
</li>
<li>
<p><code>days and time duration</code> = <code>duration</code> or <code>dayTimeDuration</code></p>
</li>
<li>
<p><code>years and months duration</code> = <code>duration</code> or <code>yearMonthDuration</code></p>
<div class="paragraph">
<p>Note that, for the "duration" types, the user can simply use <code>duration</code> and the {DECISION_ENGINE} will infer the proper duration, either <code>days and time duration</code> or <code>years and months duration</code>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>Lists support heterogeneous element types</em>: Currently this implementation supports lists with heterogeneous element types. This is an experimental extension and does limit the functionality of some functions and filters. This decision will be re-evaluated in the future.</p>
</li>
<li>
<p><em>TypeRef link between Decision Tables and Item Definitions</em>: On decision tables/input clause, if no values list is defined, the {DECISION_ENGINE} automatically checks the type reference and applies the allowed values check if it is defined.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-dmn-model-creating_kogito-dmn-models">Creating and editing DMN models in the {PRODUCT} DMN modeler</h4>
<div class="paragraph _abstract">
<p>You can use the {PRODUCT} DMN modeler in VSCode to design DMN decision requirements diagrams (DRDs) and define decision logic for a complete and functional DMN decision model. {PRODUCT} provides design and runtime support for DMN 1.2 models at conformance level 3, and includes enhancements and fixes to FEEL and DMN model components to optimize the experience of implementing DMN decision services with {PRODUCT}. {PRODUCT} also provides runtime-only support for DMN 1.1 and 1.3 models at conformance level 3. DMN 1.1 and 1.3 models are currently not supported in the {PRODUCT} DMN modeler.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a> 1.46.0 or later is installed.</p>
</li>
<li>
<p>The <strong>{PRODUCT} Bundle</strong> VSCode extension is installed and enabled in your VSCode IDE. For information about enabling the VSCode extension, see {URL_CREATING_RUNNING}#proc-kogito-vscode-extension_kogito-creating-running[<em>{CREATING_RUNNING}</em>].</p>
</li>
<li>
<p>You have created a {PRODUCT} project and have included any Java objects required for your {PRODUCT} service. For information about creating a project, see {URL_CREATING_RUNNING}[<em>{CREATING_RUNNING}</em>].</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, create or import a DMN file in the relevant folder of your {PRODUCT} project, typically in <code>src/main/resources</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For a new DMN file, you can also enter <code>dmn.new</code> in a web browser to design your decision model in the {PRODUCT} online DMN modeler. When you finish creating your decision model, you can click <strong>Download</strong> in the online modeler page to import your DMN file into your {PRODUCT} project.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Open the new or imported DMN file to view the decision requirements diagram (DRD) in the {PRODUCT} DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the {PRODUCT} DMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>Begin adding components to your new or imported DRD by clicking and dragging one of the DMN nodes from the left toolbar:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drag-decision-node.png" alt="dmn drag decision node">
</div>
<div class="title">Figure 90. Adding DRD components</div>
</div>
<div class="paragraph">
<p>The following DRD components are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Decision</strong>: Use this node for a DMN decision, where one or more input elements determine an output based on defined decision logic.</p>
</li>
<li>
<p><strong>Business knowledge model</strong>: Use this node for reusable functions with one or more decision elements. Decisions that have the same logic but depend on different sub-input data or sub-decisions use business knowledge models to determine which procedure to follow.</p>
</li>
<li>
<p><strong>Knowledge source</strong>: Use this node for external authorities, documents, committees, or policies that regulate a decision or business knowledge model. Knowledge sources are references to real-world factors rather than executable business rules.</p>
</li>
<li>
<p><strong>Input data</strong>: Use this node for information used in a decision node or a business knowledge model. Input data usually includes business-level concepts or objects relevant to the business, such as loan applicant data used in a lending strategy.</p>
</li>
<li>
<p><strong>Text annotation</strong>: Use this node for explanatory notes associated with an input data node, decision node, business knowledge model, or knowledge source.</p>
</li>
<li>
<p><strong>Decision service</strong>: Use this node to enclose a set of reusable decisions implemented as a decision service for invocation. A decision service can be used in other DMN models and can be invoked from an external application or a BPMN business process.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler canvas, double-click the new DRD node to enter an informative node name.</p>
</li>
<li>
<p>If the node is a decision or business knowledge model, select the node to display the node options and click the <strong>Edit</strong> icon to open the DMN boxed expression editor to define the decision logic for the node:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-edit.png" alt="dmn decision edit">
</div>
<div class="title">Figure 91. Opening a new decision node boxed expression</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-edit.png" alt="dmn bkm edit">
</div>
<div class="title">Figure 92. Opening a new business knowledge model boxed expression</div>
</div>
<div class="paragraph">
<p>By default, all business knowledge models are defined as boxed function expressions containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type.</p>
</div>
<div class="paragraph">
<p>For decision nodes, you click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options">
</div>
<div class="title">Figure 93. Selecting the logic type for a decision node</div>
</div>
<div class="paragraph">
<p>For business knowledge models, you click the upper-left function cell to select the function type, or right-click the function value cell, select <strong>Clear</strong>, and select a boxed expression of another type.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-define.png" alt="dmn bkm define">
</div>
<div class="title">Figure 94. Selecting the function or other logic type for a business knowledge model</div>
</div>
</div>
</div>
</li>
<li>
<p>In the selected boxed expression editor for either a decision node (any expression type) or business knowledge model (function expression), click the applicable table cells to define the table name, variable data types, variable names and values, function parameters and bindings, or FEEL expressions to include in the decision logic.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can right-click cells for additional actions where applicable, such as inserting or removing table rows and columns or clearing table contents.</p>
</div>
<div class="paragraph">
<p>The following is an example decision table for a decision node that determines credit score ratings based on a defined range of a loan applicant&#8217;s credit score:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a">
</div>
<div class="title">Figure 95. Decision node decision table for credit score rating</div>
</div>
<div class="paragraph">
<p>The following is an example boxed function expression for a business knowledge model that calculates mortgage payments based on principal, interest, taxes, and insurance (PITI) as a literal expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-function-expression-example4.png" alt="dmn function expression example4">
</div>
<div class="title">Figure 96. Business knowledge model function for PITI calculation</div>
</div>
</div>
</div>
</li>
<li>
<p>After you define the decision logic for the selected node, click <strong>Back to <em>MODEL_NAME</em></strong> to return to the DRD view.</p>
</li>
<li>
<p>For the selected DRD node, use the available connection options to create and connect to the next node in the DRD, or click and drag a new node onto the DRD canvas from the left toolbar.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The node type determines which connection options are supported. For example, an <strong>Input data</strong> node can connect to a decision node, knowledge source, or text annotation using the applicable connection type, whereas a <strong>Knowledge source</strong> node can connect to any DRD element. A <strong>Decision</strong> node can connect only to another decision or a text annotation.</p>
</div>
<div class="paragraph">
<p>The following connection types are available, depending on the node type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Information requirement</strong>: Use this connection from an input data node or decision node to another decision node that requires the information.</p>
</li>
<li>
<p><strong>Knowledge requirement</strong>: Use this connection from a business knowledge model to a decision node or to another business knowledge model that invokes the decision logic.</p>
</li>
<li>
<p><strong>Authority requirement</strong>: Use this connection from an input data node or a decision node to a dependent knowledge source or from a knowledge source to a decision node, business knowledge model, or another knowledge source.</p>
</li>
<li>
<p><strong>Association</strong>: Use this connection from an input data node, decision node, business knowledge model, or knowledge source to a text annotation.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-input-connection-example.png" alt="dmn input connection example">
</div>
<div class="title">Figure 97. Connecting credit score input to the credit score rating decision</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-input-connection-example2.png" alt="dmn input connection example2">
</div>
</div>
</div>
</div>
</li>
<li>
<p>Continue adding and defining the remaining DRD components of your decision model and save the completed DRD.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following is an example DRD for a loan prequalification decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-example-drd.png" alt="dmn example drd">
</div>
<div class="title">Figure 98. Completed DRD for loan prequalification</div>
</div>
<div class="paragraph">
<p>The following is an example DRD for a phone call handling decision model using a reusable decision service:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-example-drd3.png" alt="dmn example drd3" width="90%">
</div>
<div class="title">Figure 99. Completed DRD for phone call handling with a decision service</div>
</div>
<div class="paragraph">
<p>In a DMN decision service node, the decision nodes in the bottom segment incorporate input data from outside of the decision service to arrive at a final decision in the top segment of the decision service node. The resulting top-level decisions from the decision service are then implemented in any subsequent decisions or business knowledge requirements of the DMN model. You can reuse DMN decision services in other DMN models to apply the same decision logic with different input data and different outgoing connections.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="proc-dmn-logic-defining_kogito-dmn-models">Defining DMN decision logic in boxed expressions in the {PRODUCT} DMN modeler</h5>
<div class="paragraph _abstract">
<p>Boxed expressions in DMN are tables that you use to define the underlying logic of decision nodes and business knowledge models in a decision requirements diagram (DRD). Some boxed expressions can contain other boxed expressions, but the top-level boxed expression corresponds to the decision logic of a single DRD artifact. While DRDs represent the flow of a DMN decision model, boxed expressions define the actual decision logic of individual nodes. DRDs and boxed expressions together form a complete and functional DMN decision model.</p>
</div>
<div class="paragraph">
<p>You can use the {PRODUCT} DMN modeler in VSCode to define decision logic for your DRD components using built-in boxed expressions.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A DMN file is created or imported in your {PRODUCT} project in VSCode.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the {PRODUCT} DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the {PRODUCT} DMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler canvas, select a decision node or business knowledge model node that you want to define and click the <strong>Edit</strong> icon to open the DMN boxed expression editor:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-edit.png" alt="dmn decision edit">
</div>
<div class="title">Figure 100. Opening a new decision node boxed expression</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-edit.png" alt="dmn bkm edit">
</div>
<div class="title">Figure 101. Opening a new business knowledge model boxed expression</div>
</div>
<div class="paragraph">
<p>By default, all business knowledge models are defined as boxed function expressions containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type.</p>
</div>
<div class="paragraph">
<p>For decision nodes, you click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options">
</div>
<div class="title">Figure 102. Selecting the logic type for a decision node</div>
</div>
<div class="paragraph">
<p>For business knowledge model nodes, you click the upper-left function cell to select the function type, or right-click the function value cell, select <strong>Clear</strong>, and select a boxed expression of another type.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-define.png" alt="dmn bkm define">
</div>
<div class="title">Figure 103. Selecting the function or other logic type for a business knowledge model</div>
</div>
</div>
</div>
</li>
<li>
<p>For this example, use a decision node and select <strong>Decision Table</strong> as the boxed expression type.</p>
<div class="paragraph">
<p>A decision table in DMN is a visual representation of one or more rules in a tabular format. Each rule consists of a single row in the table, and includes columns that define the conditions (input) and outcome (output) for that particular row.</p>
</div>
</li>
<li>
<p>Click the input column header to define the name and data type for the input condition. For example, name the input column <strong>Credit Score.FICO</strong> with a <code>number</code> data type. This column specifies numeric credit score values or ranges of loan applicants.</p>
</li>
<li>
<p>Click the output column header to define the name and data type for the output values. For example, name the output column <strong>Credit Score Rating</strong> and next to the <strong>Data Type</strong> option, click <strong>Manage</strong> to go to the <strong>Data Types</strong> page where you can create a custom data type with score ratings as constraints.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types.png" alt="dmn manage data types">
</div>
<div class="title">Figure 104. Managing data types for a column header value</div>
</div>
</li>
<li>
<p>On the <strong>Data Types</strong> page, click <strong>New Data Type</strong> to add a new data type.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For this example, click <strong>New Data Type</strong> and create a <strong>Credit_Score_Rating</strong> data type as a <code>string</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-custom-data-type-add.png" alt="dmn custom data type add">
</div>
<div class="title">Figure 105. Adding a new data type</div>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>Add Constraints</strong>, select <strong>Enumeration</strong> from the drop-down options, and add the following constraints:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>"Excellent"</code></p>
</li>
<li>
<p><code>"Good"</code></p>
</li>
<li>
<p><code>"Fair"</code></p>
</li>
<li>
<p><code>"Poor"</code></p>
</li>
<li>
<p><code>"Bad"</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-custom-data-type-constraints.png" alt="dmn custom data type constraints">
</div>
<div class="title">Figure 106. Adding constraints to the new data type</div>
</div>
<div class="paragraph">
<p>To change the order of data type constraints, you can click the left end of the constraint row and drag the row as needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-custom-data-type-constraints-drag.png" alt="dmn custom data type constraints drag">
</div>
<div class="title">Figure 107. Dragging constraints to change constraint order</div>
</div>
<div class="paragraph">
<p>For information about constraint types and syntax requirements for the specified data type, see the <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the constraints and click the check mark to the right of the data type to save the data type.</p>
</li>
<li>
<p>Return to the <strong>Credit Score Rating</strong> decision table, click the <strong>Credit Score Rating</strong> column header, and set the data type to this new custom data type.</p>
</li>
<li>
<p>Use the <strong>Credit Score.FICO</strong> input column to define credit score values or ranges of values, and use the <strong>Credit Score Rating</strong> column to specify one of the corresponding ratings you defined in the <strong>Credit_Score_Rating</strong> data type.</p>
<div class="paragraph">
<p>Right-click any value cell to insert or delete rows (rules) or columns (clauses).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a">
</div>
<div class="title">Figure 108. Decision node decision table for credit score rating</div>
</div>
</li>
<li>
<p>After you define all rules, click the upper-left corner of the decision table to define the rule <strong>Hit Policy</strong> and <strong>Builtin Aggregator</strong> (for <strong>COLLECT</strong> hit policy only).</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The hit policy determines how to reach an outcome when multiple rules in a decision table match the provided input values. The built-in aggregator determines how to aggregate rule values when you use the <strong>COLLECT</strong> hit policy.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-hit-policies.png" alt="dmn hit policies">
</div>
<div class="title">Figure 109. Defining the decision table hit policy</div>
</div>
<div class="paragraph">
<p>The following example is a more complex decision table that determines applicant qualification for a loan as the concluding decision node in the same loan prequalification decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3">
</div>
<div class="title">Figure 110. Decision table for loan prequalification</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For boxed expression types other than decision tables, you follow these guidelines similarly to navigate the boxed expression tables and define variables and parameters for decision logic, but according to the requirements of the boxed expression type. Some boxed expressions, such as boxed literal expressions, can be single-column tables, while other boxed expressions, such as function, context, and invocation expressions, can be multi-column tables with nested boxed expressions of other types.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed context expression defines the parameters that determine whether a loan applicant can meet minimum mortgage payments based on principal, interest, taxes, and insurance (PITI), represented as a front-end ratio calculation with a sub-context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-context-expression-example2.png" alt="dmn context expression example2">
</div>
<div class="title">Figure 111. Boxed context expression for front-end client PITI ratio</div>
</div>
<div class="paragraph">
<p>The following boxed function expression determines a monthly mortgage installment as a business knowledge model in a lending decision, with the function value defined as a nested context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-function-expression-example3.png" alt="dmn function expression example3">
</div>
<div class="title">Figure 112. Boxed function expression for installment calculation in business knowledge model</div>
</div>
<div class="paragraph">
<p>For more information and examples of each boxed expression type, see <a href="#con-dmn-boxed-expressions_kogito-dmn-models">DMN decision logic in boxed expressions</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="proc-dmn-data-types-defining_kogito-dmn-models">Creating custom data types for DMN boxed expressions in the {PRODUCT} DMN modeler</h5>
<div class="paragraph _abstract">
<p>In DMN boxed expressions in the {PRODUCT} DMN modeler, data types determine the structure of the data that you use within an associated table, column, or field in the boxed expression. You can use default DMN data types (such as String, Number, Boolean) or you can create custom data types to specify additional fields and constraints that you want to implement for the boxed expression values.</p>
</div>
<div class="paragraph">
<p>Custom data types that you create for a boxed expression can be simple or structured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Simple</strong> data types have only a name and a type assignment. Example: <code>Age (number)</code>.</p>
</li>
<li>
<p><strong>Structured</strong> data types contain multiple fields associated with a parent data type. Example: A single type <code>Person</code> containing the fields <code>Name (string)</code>, <code>Age (number)</code>, <code>Email (string)</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A DMN file is created or imported in your {PRODUCT} project in VSCode.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the {PRODUCT} DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the {PRODUCT} DMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler canvas, select a decision node or business knowledge model for which you want to define the data types and click the <strong>Edit</strong> icon to open the DMN boxed expression editor.</p>
</li>
<li>
<p>If the boxed expression is for a decision node that is not yet defined, click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options">
</div>
<div class="title">Figure 113. Selecting the logic type for a decision node</div>
</div>
</li>
<li>
<p>Click the cell for the table header, column header, or parameter field (depending on the boxed expression type) for which you want to define the data type and click <strong>Manage</strong> to go to the <strong>Data Types</strong> page where you can create a custom data type.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types.png" alt="dmn manage data types">
</div>
<div class="title">Figure 114. Managing data types for a column header value</div>
</div>
<div class="paragraph">
<p>You can also set and manage custom data types for a specified decision node or business knowledge model node by selecting the <strong>Properties</strong> icon in the upper-right corner of the DMN modeler:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types1a.png" alt="dmn manage data types1a">
</div>
<div class="title">Figure 115. Managing data types in decision requirements diagram (DRD) properties</div>
</div>
<div class="paragraph">
<p>The data type that you define for a specified cell in a boxed expression determines the structure of the data that you use within that associated table, column, or field in the boxed expression.</p>
</div>
<div class="paragraph">
<p>In this example, an output column <strong>Credit Score Rating</strong> for a DMN decision table defines a set of custom credit score ratings based on an applicant&#8217;s credit score.</p>
</div>
</div>
</div>
</li>
<li>
<p>On the <strong>Data Types</strong> page, click <strong>New Data Type</strong> to add a new data type.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For this example, click <strong>New Data Type</strong> and create a <strong>Credit_Score_Rating</strong> data type as a <code>string</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-custom-data-type-add.png" alt="dmn custom data type add">
</div>
<div class="title">Figure 116. Adding a new data type</div>
</div>
<div class="paragraph">
<p>If the data type requires a list of items, enable the <strong>List</strong> setting.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>Add Constraints</strong>, select <strong>Enumeration</strong> from the drop-down options, and add the following constraints:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>"Excellent"</code></p>
</li>
<li>
<p><code>"Good"</code></p>
</li>
<li>
<p><code>"Fair"</code></p>
</li>
<li>
<p><code>"Poor"</code></p>
</li>
<li>
<p><code>"Bad"</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-custom-data-type-constraints.png" alt="dmn custom data type constraints">
</div>
<div class="title">Figure 117. Adding constraints to the new data type</div>
</div>
<div class="paragraph">
<p>To change the order of data type constraints, you can click the left end of the constraint row and drag the row as needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-custom-data-type-constraints-drag.png" alt="dmn custom data type constraints drag">
</div>
<div class="title">Figure 118. Dragging constraints to change constraint order</div>
</div>
<div class="paragraph">
<p>For information about constraint types and syntax requirements for the specified data type, see the <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the constraints and click the check mark to the right of the data type to save the data type.</p>
</li>
<li>
<p>Return to the <strong>Credit Score Rating</strong> decision table, click the <strong>Credit Score Rating</strong> column header, set the data type to this new custom data type, and define the rule values for that column with the rating constraints that you specified.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a">
</div>
<div class="title">Figure 119. Decision table for credit score rating</div>
</div>
<div class="paragraph">
<p>In the DMN decision model for this scenario, the <strong>Credit Score Rating</strong> decision flows into the following <strong>Loan Prequalification</strong> decision that also requires custom data types:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-blank.png" alt="dmn manage data types blank">
</div>
<div class="title">Figure 120. Decision table for loan prequalification</div>
</div>
</div>
</div>
</li>
<li>
<p>Continuing with this example, return to the <strong>Data Types</strong> window, click <strong>New Data Type</strong>, and create a <strong>Loan_Qualification</strong> data type as a <code>Structure</code> with no constraints.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When you save the new structured data type, the first sub-field appears so that you can begin defining nested data fields in this parent data type. You can use these sub-fields in association with the parent structured data type in boxed expressions, such as nested column headers in decision tables or nested table parameters in context or function expressions.</p>
</div>
<div class="paragraph">
<p>For additional sub-fields, select the addition icon next to the <strong>Loan_Qualification</strong> data type:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-structured.png" alt="dmn manage data types structured">
</div>
<div class="title">Figure 121. Adding a new structured data type with nested fields</div>
</div>
</div>
</div>
</li>
<li>
<p>For this example, under the structured <strong>Loan_Qualification</strong> data type, add a <strong>Qualification</strong> field with <code>"Qualified"</code> and <code>"Not Qualified"</code> enumeration constraints, and a <strong>Reason</strong> field with no constraints. Add also a simple <strong>Back_End_Ratio</strong> and a <strong>Front_End_Ratio</strong> data type, both with <code>"Sufficient"</code> and <code>"Insufficient"</code> enumeration constraints.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Click the check mark to the right of each data type that you create to save your changes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-structured2.png" alt="dmn manage data types structured2">
</div>
<div class="title">Figure 122. Adding nested data types with constraints</div>
</div>
<div class="paragraph">
<p>To change the order or nesting of data types, you can click the left end of the data type row and drag the row as needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-structured2-drag.png" alt="dmn manage data types structured2 drag">
</div>
<div class="title">Figure 123. Dragging data types to change data type order or nesting</div>
</div>
</div>
</div>
</li>
<li>
<p>Return to the decision table and, for each column, click the column header cell, set the data type to the new corresponding custom data type, and define the rule values as needed for the column with the constraints that you specified, if applicable.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3">
</div>
<div class="title">Figure 124. Decision table for loan prequalification</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For boxed expression types other than decision tables, you follow these guidelines similarly to navigate the boxed expression tables and define custom data types as needed.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed function expression uses custom <code>tCandidate</code> and <code>tProfile</code> structured data types to associate data for online dating compatibility:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-structured3.png" alt="dmn manage data types structured3">
</div>
<div class="title">Figure 125. Boxed function expression for online dating compatibility</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-structured3a.png" alt="dmn manage data types structured3a">
</div>
<div class="title">Figure 126. Custom data type definitions for online dating compatibility</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-manage-data-types-structured3b.png" alt="dmn manage data types structured3b">
</div>
<div class="title">Figure 127. Parameter definitions with custom data types for online dating compatibility</div>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-included-models_kogito-dmn-models">Included models in DMN files in the {PRODUCT} VSCode DMN modeler</h5>
<div class="paragraph _abstract">
<p>In the {PRODUCT} DMN modeler in VSCode, you can use the <strong>Included Models</strong> tab to include other DMN models and Predictive Model Markup Language (PMML) models from your project in a specified DMN file. When you include a DMN model within another DMN file, you can use all of the nodes and logic from both models in the same decision requirements diagram (DRD). When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node.</p>
</div>
<div class="paragraph">
<p>You cannot include DMN or PMML models from different directories within your {PRODUCT} project or from other {PRODUCT} projects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Included models are supported in the {PRODUCT} DMN modeler in VSCode only. In other {PRODUCT} modeling tools, such as the Business Modeler desktop application or Business Modeler online viewer, the {PRODUCT} DMN modeler does not support DMN or PMML included models.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="proc-dmn-included-models-dmn_kogito-dmn-models">Including other DMN models within a DMN file in the {PRODUCT} VSCode DMN modeler</h6>
<div class="paragraph _abstract">
<p>In the {PRODUCT} DMN modeler in VSCode, you can include other DMN models from the same directory of your {PRODUCT} project in a specified DMN file. When you include a DMN model within another DMN file, you can use all of the nodes and logic from both models in the same decision requirements diagram (DRD), but you cannot edit the nodes from the included model. To edit nodes from included models, you must update the source file for the included model directly. If you update the source file for an included DMN model, open the DMN file where the DMN model is included (or close and re-open) to verify the changes.</p>
</div>
<div class="paragraph">
<p>You cannot include DMN models from different directories within your {PRODUCT} project or from other {PRODUCT} projects.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The DMN models are created or imported (as <code>.dmn</code> files) in the same directory of your {PRODUCT} project as the DMN file in which you want to include the models, such as in <code>src/main/resources</code>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the {PRODUCT} DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the {PRODUCT} DMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler, click the <strong>Included Models</strong> tab.</p>
</li>
<li>
<p>Click <strong>Include Model</strong>, select a DMN model from your directory in the <strong>Models</strong> list, enter a unique name for the included model, and click <strong>Include</strong>:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model.png" alt="dmn include model">
</div>
<div class="title">Figure 128. Including a DMN model</div>
</div>
<div class="paragraph">
<p>The DMN model is added to this DMN file, and all DRD nodes from the included model are listed under <strong>Decision Components</strong> in the <strong>Decision Navigator</strong> view:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model-list.png" alt="dmn include model list">
</div>
<div class="title">Figure 129. DMN file with decision components from the included DMN model</div>
</div>
<div class="paragraph">
<p>All data types from the included model are also listed in read-only mode in the <strong>Data Types</strong> tab for the DMN file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model-data-types.png" alt="dmn include model data types">
</div>
<div class="title">Figure 130. DMN file with data types from the included DMN model</div>
</div>
</div>
</div>
</li>
<li>
<p>In the <strong>Editor</strong> tab of the DMN modeler, click and drag the included DRD components onto the canvas to begin implementing them in your DRD:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model-drd.png" alt="dmn include model drd">
</div>
<div class="title">Figure 131. Adding DRD components from the included DMN model</div>
</div>
<div class="paragraph">
<p>To edit DRD nodes or data types from included models, you must update the source file for the included model directly. If you update the source file for an included DMN model, open the DMN file where the DMN model is included (or close and re-open) to verify the changes.</p>
</div>
<div class="paragraph">
<p>To edit the included model name or to remove the included model from the DMN file, use the <strong>Included Models</strong> tab in the DMN modeler.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
When you remove an included model, any nodes from that included model that are currently used in the DRD are also removed.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="proc-dmn-included-models-pmml_kogito-dmn-models">Including PMML models within a DMN file in the {PRODUCT} VSCode DMN modeler</h6>
<div class="paragraph _abstract">
<p>In the {PRODUCT} DMN modeler in VSCode, you can include Predictive Model Markup Language (PMML) models from your project in a specified DMN file. When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node. If you update the source file for an included PMML model, you must remove and re-include the PMML model in the DMN file to apply the source changes.</p>
</div>
<div class="paragraph">
<p>You cannot include PMML models from different directories within your {PRODUCT} project or from other {PRODUCT} projects.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The PMML models are created or imported (as <code>.pmml</code> files) in the same directory of your {PRODUCT} project as the DMN file in which you want to include the models, such as in <code>src/main/resources</code>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the {PRODUCT} DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the {PRODUCT} DMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler, click the <strong>Included Models</strong> tab.</p>
</li>
<li>
<p>Click <strong>Include Model</strong>, select a PMML model from your directory in the <strong>Models</strong> list, enter a unique name for the included model, and click <strong>Include</strong>:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model-pmml.png" alt="dmn include model pmml">
</div>
<div class="title">Figure 132. Including a PMML model</div>
</div>
<div class="paragraph">
<p>The PMML model is added to this DMN file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model-list-pmml.png" alt="dmn include model list pmml">
</div>
<div class="title">Figure 133. DMN file with included PMML model</div>
</div>
</div>
</div>
</li>
<li>
<p>In the <strong>Editor</strong> tab of the DMN modeler, select or create the decision node or business knowledge model node in which you want to invoke the PMML model and click the <strong>Edit</strong> icon to open the DMN boxed expression editor:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-decision-edit.png" alt="dmn decision edit">
</div>
<div class="title">Figure 134. Opening a new decision node boxed expression</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-bkm-edit.png" alt="dmn bkm edit">
</div>
<div class="title">Figure 135. Opening a new business knowledge model boxed expression</div>
</div>
</div>
</div>
</li>
<li>
<p>Set the expression type to <strong>Function</strong> (default for business knowledge model nodes), click the upper-left function cell, and select <strong>PMML</strong>.</p>
</li>
<li>
<p>In the <strong>document</strong> and <strong>model</strong> rows in the table, double-click the undefined cells to specify the included PMML document and the relevant PMML model within that document:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-include-model-expression-pmml.png" alt="dmn include model expression pmml">
</div>
<div class="title">Figure 136. Adding a PMML model in a DMN business knowledge model</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-function-expression-example5.png" alt="dmn function expression example5">
</div>
<div class="title">Figure 137. Example PMML definition in a DMN business knowledge model</div>
</div>
<div class="paragraph">
<p>If you update the source file for an included PMML model, you must remove and re-include the PMML model in the DMN file to apply the source changes.</p>
</div>
<div class="paragraph">
<p>To edit the included model name or to remove the included model from the DMN file, use the <strong>Included Models</strong> tab in the DMN modeler.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="proc-dmn-model-creating-multiples_kogito-dmn-models">Creating DMN models with multiple diagrams in the {PRODUCT} DMN modeler</h5>
<div class="paragraph _abstract">
<p>For complex DMN models, you can use the {PRODUCT} DMN modeler in VSCode to design multiple DMN decision requirements diagrams (DRDs) that represent parts of the overall decision requirements graph (DRG) for the DMN decision model. In simple cases, you can use a single DRD to represent all of the overall DRG for the decision model, but in complex cases, a single DRD can become large and difficult to follow. Therefore, to better organize DMN decision models with many decision requirements, you can divide the model into smaller nested DRDs that constitute the larger central DRD representation of the overall DRG.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You understand how to design DRDs in the {PRODUCT} DMN modeler. For information about creating DRDs, see <a href="#proc-dmn-model-creating_kogito-dmn-models">Creating and editing DMN models in the {PRODUCT} DMN modeler</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, create or import a DMN file in the relevant folder of your {PRODUCT} project, typically in <code>src/main/resources</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For a new DMN file, you can also enter <code>dmn.new</code> in a web browser to design your decision model in the {PRODUCT} online DMN modeler. When you finish creating your decision model, you can click <strong>Download</strong> in the online modeler page to import your DMN file into your {PRODUCT} project.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Open the new or imported DMN file to view the DRD in the {PRODUCT} DMN modeler, and begin designing or modifying the DRD using the DMN nodes in the left toolbar.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the {PRODUCT} DMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>For any DMN nodes that you want to define in a separate nested DRD, select the node, click the <strong>DRD Actions</strong> icon, and select from the available options.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-actions.png" alt="dmn drd actions">
</div>
<div class="title">Figure 138. DRD actions icon for subdividing a DRD</div>
</div>
<div class="paragraph">
<p>The following options are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Create</strong>: Use this option to create a nested DRD where you can separately define the DMN components and diagram for the selected node.</p>
</li>
<li>
<p><strong>Add to</strong>: If you already created a nested DRD, use this option to add the selected node to an existing DRD.</p>
</li>
<li>
<p><strong>Remove</strong>: If the node that you selected is already within a nested DRD, use this option to remove the node from that nested DRD.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you create a nested DRD within your DMN decision model, the new DRD opens in a separate DRD canvas and the available DRD and components are listed in the <strong>Decision Navigator</strong> right menu. You can use the <strong>Decision Navigator</strong> menu to rename or remove a nested DRD.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-actions-rename.png" alt="dmn drd actions rename">
</div>
<div class="title">Figure 139. Rename new nested DRD in the Decision Navigator menu</div>
</div>
</div>
</div>
</li>
<li>
<p>In the separate canvas for the new nested DRD, design the flow and logic for all required components in this portion of the DMN model, as usual.</p>
</li>
<li>
<p>Continue adding and defining any other nested DRDs for your decision model and save the completed DMN file.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example, the following DRD for a loan prequalification decision model contains all DMN components for the model without any nested DRDs. This example relies on the single DRD for all components and logic, resulting in a large and complex diagram.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-example-drd.png" alt="dmn example drd">
</div>
<div class="title">Figure 140. Single DRD for loan prequalification</div>
</div>
<div class="paragraph">
<p>Alternatively, by following the steps in this procedure, you can divide this example DRD into multiple nested DRDs to better organize the decision requirements, as shown in the following example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple.png" alt="dmn drd multiple">
</div>
<div class="title">Figure 141. Multiple nested DRDs for loan prequalification</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple-front-end.png" alt="dmn drd multiple front end">
</div>
<div class="title">Figure 142. Overview of front end ratio DRD</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple-front-end-details.png" alt="dmn drd multiple front end details">
</div>
<div class="title">Figure 143. DRD for front end ratio</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple-credit-score.png" alt="dmn drd multiple credit score">
</div>
<div class="title">Figure 144. Overview of credit score rating DRD</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple-credit-score-details.png" alt="dmn drd multiple credit score details">
</div>
<div class="title">Figure 145. DRD for credit score rating</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple-back-end.png" alt="dmn drd multiple back end">
</div>
<div class="title">Figure 146. Overview of back end ratio DRD</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-drd-multiple-back-end-details.png" alt="dmn drd multiple back end details">
</div>
<div class="title">Figure 147. DRD for back end ratio</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-documentation_kogito-dmn-models">DMN model documentation in the {PRODUCT} DMN modeler</h5>
<div class="paragraph _abstract">
<p>In the {PRODUCT} DMN modeler, you can use the <strong>Documentation</strong> tab to generate a report of your DMN model. The DMN model report contains all decision requirements diagrams (DRDs), data types, and boxed expressions in your DMN model. You can use this report to share your DMN model details or as part of your internal reporting workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-documentation.png" alt="dmn documentation">
</div>
<div class="title">Figure 148. Example DMN model report</div>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-designer-nav_kogito-dmn-models">{PRODUCT} DMN modeler navigation and properties</h5>
<div class="paragraph _abstract">
<p>The {PRODUCT} DMN modeler provides the following additional features to help you navigate through the components and properties of decision requirements diagrams (DRDs).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">DMN decision and diagram views</dt>
<dd>
<p>In the upper-right corner of the DMN modeler, select the <strong>Decision Navigator</strong> view to navigate between the decision components, graphs, and boxed expressions of a selected DRD:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-designer-nav-view.png" alt="dmn designer nav view">
</div>
<div class="title">Figure 149. Decision Navigator view</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-designer-nav-view2.png" alt="dmn designer nav view2">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The DRD components from any DMN models included in the DMN file (in the <strong>Included Models</strong> tab) are also listed in the <strong>Decision Components</strong> panel for the DMN file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the upper-right corner of the DMN modeler, select the <strong>Preview</strong> icon to view an elevated preview of the DRD:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-designer-preview.png" alt="dmn designer preview">
</div>
<div class="title">Figure 150. Diagram preview</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">DRD properties and design</dt>
<dd>
<p>In the upper-right corner of the DMN modeler, select the <strong>Properties</strong> icon to modify the identifying information, data types, and appearance of a selected DRD, DRD node, or boxed expression cell:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-designer-properties.png" alt="dmn designer properties">
</div>
<div class="title">Figure 151. DRD node properties</div>
</div>
<div class="paragraph">
<p>To view the properties of the entire DRD, click the DRD canvas background instead of a specific node.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">DRD search</dt>
<dd>
<p>In the upper-right corner of the DMN modeler, use the search bar to search for text that appears in your DRD. The search feature is especially helpful in complex DRDs with many nodes:</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-designer-search.png" alt="dmn designer search">
</div>
<div class="title">Figure 152. DRD search</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-service-execution_kogito-dmn-models">{PRODUCT} service execution</h4>
<div class="paragraph _abstract">
<p>After you design your {PRODUCT} service, you can build and run your application and then send REST API requests to the application to execute your services. The exact REST API requests that you can use depend on how you set up the application.</p>
</div>
<div class="paragraph">
<p>For example, consider a {PRODUCT} service that is set up to generate a <code>/persons</code> REST API endpoint and determines whether a specified customer is an adult or is underage. In this example, you can send the following <code>POST</code> request using a REST client or curl utility to add an adult and execute the service:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For information about creating, running, and testing an example application with {PRODUCT} services, see {URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>].</p>
</div>
<div class="paragraph">
<p>For information about deploying your {PRODUCT} service to {OPENSHIFT}, see {URL_DEPLOYING_ON_OPENSHIFT}#chap-kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>].</p>
</div>
<div class="sect4">
<h5 id="ref-rest-dmn-endpoints_kogito-dmn-models">REST endpoints for DMN models in {PRODUCT}</h5>
<div class="paragraph _abstract">
<p>For each DMN model in a {PRODUCT} application, the following REST endpoints are automatically generated based on the content of the model:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[POST] /{modelName}</code>: A business-domain endpoint for evaluating the entire DMN model</p>
</li>
<li>
<p><code>[POST] /{modelName}/{decisionServiceName}</code>: A business-domain endpoint for evaluating a specified decision service component in the DMN model</p>
</li>
<li>
<p><code>[POST] /{modelName}/dmnresult</code>: An endpoint for evaluating the entire DMN model and returning a <code>DMNResult</code> response, including the business-domain context, helper messages, and helper decision pointers for the DMN model</p>
</li>
<li>
<p><code>[POST] /{modelName}/{decisionServiceName}/dmnresult</code>: An endpoint for evaluating a specified decision service component in the DMN model and returning a <code>DMNResult</code> response, including the business-domain context, helper messages, and helper decision pointers for the decision service</p>
</li>
<li>
<p><code>[GET] /{modelName}</code>: An endpoint for returning the DMN XML without decision logic, typically for DMN model introspection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use these endpoints to interact with a DMN model or a specific decision service within a model. As you decide between using business-domain and <code>dmnresult</code> variants of these REST endpoints, review the following considerations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>REST business-domain endpoints</strong>: Use this endpoint type if a client application is only concerned with a positive evaluation outcome, is not interested in parsing <code>Info</code> or <code>Warn</code> messages, and only needs an HTTP 5xx response for any errors. This type of endpoint is also helpful for single-page application-like clients, due to singleton coercion of decision service results that resemble the DMN modeling behavior.</p>
</li>
<li>
<p><strong>REST <code>dmnresult</code> endpoints</strong>: Use this endpoint type if a client needs to parse <code>Info</code>, <code>Warn</code>, or <code>Error</code> messages in all cases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each endpoint, use a REST client, curl utility, or Swagger UI (if configured for the application) to send requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base URL</strong>: <code>http://<em>HOST</em>:<em>PORT</em>/{modelName}</code></p>
</li>
<li>
<p><strong>Path parameters</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>{modelName}</code>: The string identifier of the DMN model, such as <code>Traffic Violation</code></p>
</li>
<li>
<p><code>{decisionServiceName}</code>: The string identifier of the decision service component in the DMN DRG, such as <code>TrafficViolationDecisionService</code></p>
</li>
<li>
<p><code>dmnresult</code>: The string identifier that enables the endpoint to return a full <code>DMNResult</code> response with more detailed <code>Info</code>, <code>Warn</code>, and <code>Error</code> messaging</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code> or <code>POST</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The examples in the following endpoints are based on a <code>Traffic Violation</code> DMN model that contains a <code>TrafficViolationDecisionService</code> decision service component.</p>
</div>
<div class="paragraph">
<p>For all of these endpoints, if a DMN evaluation <code>Error</code> message occurs, a <code>DMNResult</code> response is returned along with an HTTP 5xx error. If a DMN <code>Info</code> or <code>Warn</code> message occurs, the relevant response is returned along with the business-domain REST body, in the <code>X-{PRODUCT}-decision-messages</code> extended HTTP header, to be used for client-side business logic. When more refined client-side business logic is required, the client can use the <code>dmnresult</code> variant of the endpoints.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return the DMN XML without decision logic</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /{modelName}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/Traffic Violation</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (XML)</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;dmn:definitions xmlns:dmn="http://www.omg.org/spec/DMN/20180521/MODEL/" xmlns="https://github.com/kiegroup/drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:kie="http://www.drools.org/kie/dmn/1.2" xmlns:feel="http://www.omg.org/spec/DMN/20180521/FEEL/" xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" id="_1C792953-80DB-4B32-99EB-25FBE32BAF9E" name="Traffic Violation" expressionLanguage="http://www.omg.org/spec/DMN/20180521/FEEL/" typeLanguage="http://www.omg.org/spec/DMN/20180521/FEEL/" namespace="https://github.com/kiegroup/drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF"&gt;
  &lt;dmn:itemDefinition id="_63824D3F-9173-446D-A940-6A7F0FA056BB" name="tDriver" isCollection="false"&gt;
    ...
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_2D4F30EE-21A6-4A78-A524-A5C238D433AE" name="tFine" isCollection="false"&gt;
    ...
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:decision id="_4055D956-1C47-479C-B3F4-BAEB61F1C929" name="Fine"&gt;
    &lt;dmn:variable id="_8C1EAC83-F251-4D94-8A9E-B03ACF6849CD" name="Fine" typeRef="tFine"&gt;
    &lt;/dmn:variable&gt;
    &lt;dmn:informationRequirement id="_800A3BBB-90A3-4D9D-BA5E-A311DED0134F"&gt;
      &lt;dmn:requiredInput href="#_1929CBD5-40E0-442D-B909-49CEDE0101DC"&gt;
      &lt;/dmn:requiredInput&gt;
    &lt;/dmn:informationRequirement&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:decision id="_8A408366-D8E9-4626-ABF3-5F69AA01F880" name="Should the driver be suspended?"&gt;
    &lt;dmn:question&gt;Should the driver be suspended due to points on his license?&lt;/dmn:question&gt;
    &lt;dmn:allowedAnswers&gt;"Yes", "No"&lt;/dmn:allowedAnswers&gt;
    &lt;dmn:variable id="_40387B66-5D00-48C8-BB90-E83EE3332C72" name="Should the driver be suspended?" typeRef="string"&gt;
    &lt;/dmn:variable&gt;
    &lt;dmn:informationRequirement id="_982211B1-5246-49CD-BE85-3211F71253CF"&gt;
      &lt;dmn:requiredInput href="#_1F9350D7-146D-46F1-85D8-15B5B68AF22A"&gt;
      &lt;/dmn:requiredInput&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement id="_AEC4AA5F-50C3-4FED-A0C2-261F90290731"&gt;
      &lt;dmn:requiredDecision href="#_4055D956-1C47-479C-B3F4-BAEB61F1C929"&gt;
      &lt;/dmn:requiredDecision&gt;
    &lt;/dmn:informationRequirement&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:inputData id="_1929CBD5-40E0-442D-B909-49CEDE0101DC" name="Violation"&gt;
    &lt;dmn:variable id="_C16CF9B1-5FAB-48A0-95E0-5FCD661E0406" name="Violation" typeRef="tViolation"&gt;
    &lt;/dmn:variable&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:inputData id="_1F9350D7-146D-46F1-85D8-15B5B68AF22A" name="Driver"&gt;
    &lt;dmn:variable id="_A80F16DF-0DB4-43A2-B041-32900B1A3F3D" name="Driver" typeRef="tDriver"&gt;
    &lt;/dmn:variable&gt;
  &lt;/dmn:inputData&gt;
&lt;/dmn:definitions&gt;</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified DMN model</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}</code></p>
</div>
<div class="paragraph">
<p>For this endpoint, the request body must contain all input data of the DMN model. The response is the resulting DMN context of the model, including the decision values, the original input values, and all other parametric DRG components in serialized form. For example, a business knowledge model is available in string-serialized form in its signature.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-model-traffic-violation.png" alt="Image of Traffic Violation DMN model">
</div>
<div class="title">Figure 153. Example <code>Traffic Violation</code> DMN model</div>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Violation": {
    "Type": "speed",
    "Speed Limit": 100,
    "Actual Speed": 120
  },
  "Driver": {
    "Points": 2
  },
  "Fine": {
    "Points": 3,
    "Amount": 500
  },
  "Should the driver be suspended?": "No"
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified decision service within a DMN model</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}/{decisionServiceName}</code></p>
</div>
<div class="paragraph">
<p>For this endpoint, the request body must contain all the requirements of the decision service. The response is the resulting DMN context of the decision service, including the decision values, the original input values, and all other parametric DRG components in serialized form. For example, a business knowledge model is available in string-serialized form in its signature.</p>
</div>
<div class="paragraph">
<p>If the decision service is composed of a single-output decision, the response is the resulting value of that specific decision. This behavior provides an equivalent value at the API level of a specification feature when invoking the decision service in the model itself. As a result, you can, for example, interact with a DMN decision service from single-page web applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-model-traffic-violation-single-output.png" alt="Image of decision service in Traffic Violation DMN model">
</div>
<div class="title">Figure 154. Example <code>TrafficViolationDecisionService</code> decision service with single-output decision</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/dmn-model-traffic-violation-multi-output.png" alt="Image of decision service in Traffic Violation DMN model">
</div>
<div class="title">Figure 155. Example <code>TrafficViolationDecisionService</code> decision service with multiple-output decision</div>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation/TrafficViolationDecisionService</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation/TrafficViolationDecisionService -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response for single-output decision (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"No"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response for multiple-output decision (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Violation": {
    "Type": "speed",
    "Speed Limit": 100,
    "Actual Speed": 120
  },
  "Driver": {
    "Points": 2
  },
  "Fine": {
    "Points": 3,
    "Amount": 500
  },
  "Should the driver be suspended?": "No"
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified DMN model and return a <code>DMNResult</code> response</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}/dmnresult</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "namespace": "https://github.com/kiegroup/drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF",
  "modelName": "Traffic Violation",
  "dmnContext": {
    "Violation": {
      "Type": "speed",
      "Speed Limit": 100,
      "Actual Speed": 120,
      "Code": null,
      "Date": null
    },
    "Driver": {
      "Points": 2,
      "State": null,
      "City": null,
      "Age": null,
      "Name": null
    },
    "Fine": {
      "Points": 3,
      "Amount": 500
    },
    "Should the driver be suspended?": "No"
  },
  "messages": [],
  "decisionResults": [
    {
      "decisionId": "_4055D956-1C47-479C-B3F4-BAEB61F1C929",
      "decisionName": "Fine",
      "result": {
        "Points": 3,
        "Amount": 500
      },
      "messages": [],
      "evaluationStatus": "SUCCEEDED"
    },
    {
      "decisionId": "_8A408366-D8E9-4626-ABF3-5F69AA01F880",
      "decisionName": "Should the driver be suspended?",
      "result": "No",
      "messages": [],
      "evaluationStatus": "SUCCEEDED"
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified decision service within a DMN model and return a <code>DMNResult</code> response</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}/{decisionServiceName}/dmnresult</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation/TrafficViolationDecisionService</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation/TrafficViolationDecisionService -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "namespace": "https://github.com/kiegroup/drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF",
  "modelName": "Traffic Violation",
  "dmnContext": {
    "Violation": {
      "Type": "speed",
      "Speed Limit": 100,
      "Actual Speed": 120,
      "Code": null,
      "Date": null
    },
    "Driver": {
      "Points": 2,
      "State": null,
      "City": null,
      "Age": null,
      "Name": null
    },
    "Should the driver be suspended?": "No"
  },
  "messages": [],
  "decisionResults": [
    {
      "decisionId": "_8A408366-D8E9-4626-ABF3-5F69AA01F880",
      "decisionName": "Should the driver be suspended?",
      "result": "No",
      "messages": [],
      "evaluationStatus": "SUCCEEDED"
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-audit-console_kogito-dmn-models">{PRODUCT} Audit Investigation Console</h4>
<div class="paragraph _abstract">
<p>The {PRODUCT} Audit Investigation Console is a user interface for monitoring and investigating Decision Model and Notation (DMN) model executions in {PRODUCT}.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-home.png" alt="Image of Kogito Audit Investigation Console">
</div>
<div class="title">Figure 156. {PRODUCT} Audit Investigation Console</div>
</div>
<div class="paragraph">
<p>You can use the Audit Investigation Console to browse DMN model executions, verify execution status, retrieve execution details, such as decision outcomes, input data, and model preview, and obtain explanation information about how the processed decisions were made.</p>
</div>
<div class="paragraph">
<p>The Audit Investigation Console requires your {PRODUCT} services to use the following {PRODUCT} components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>{PRODUCT} Trusty Service</strong>: Enables the Audit Investigation Console to access stored events related to decision tracing from your {PRODUCT} services. The {PRODUCT} Trusty Service requires Infinispan persistence and Apache Kafka messaging for your {PRODUCT} service. For more information about the Trusty Service, see {URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[<em>{CONFIGURING_KOGITO}</em>].</p>
</li>
<li>
<p><strong>{PRODUCT} Explainability Service</strong>: Generates explainability data that is stored in the {PRODUCT} Trusty Service. The Audit Investigation Console accesses the explainbility information from tracing-event data for decisions in your {PRODUCT} services. The {PRODUCT} Explainbility Service requires Apache Kafka messaging for your {PRODUCT} service.</p>
</li>
<li>
<p><strong>{PRODUCT} Tracing decision add-on</strong>: Enables the {PRODUCT} service to produce tracing events and publish the events to Apache Kafka. The add-on also exposes the REST endpoint <code>/predict</code> for the {PRODUCT} Explainbility Service.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="proc-audit-console-using_kogito-dmn-models">Using the {PRODUCT} Audit Investigation Console to view DMN model execution details</h5>
<div class="paragraph _abstract">
<p>You can use the {PRODUCT} Audit Investigation Console to view DMN model execution details for your {PRODUCT} services. You can run the Audit Investigation Console for local {PRODUCT} services or add it to your {PRODUCT} infrastructure on {OPENSHIFT}.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A {PRODUCT} Trusty Service instance and Explainbility Service instance are configured and running for your {PRODUCT} service. The Trusty Service enables the Audit Investigation Console to access stored DMN model execution data. The Trusty Service requires Infinispan persistence and Apache Kafka messaging for your {PRODUCT} service. For information about the Trusty Service, see {URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[<em>{CONFIGURING_KOGITO}</em>].</p>
</li>
<li>
<p>The <code>pom.xml</code> file of your {PRODUCT} project contains the following dependency for the tracing add-on. This add-on enables the Trusty Service to interact with the decision-tracing data through the CloudEvents messages.</p>
<div class="listingblock">
<div class="title">Project dependency to enable tracing capability on Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;tracing-decision-quarkus-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable tracing capability on SpringBoot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;tracing-decision-springboot-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>The <code>application.properties</code> file of your {PRODUCT} project contains the following system property for the location where the {PRODUCT} service is deployed, such as <code>http://localhost:8080</code>. This property enables the Explainability Service to generate the URLs to interact with {PRODUCT} and enrich tracing data with explainbility.</p>
<div class="listingblock">
<div class="title">Application property for REST URLs</div>
<div class="content">
<pre class="highlight"><code>kogito.service.url=http://<em>HOST</em>:<em>PORT</em></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In a Kubernetes or OpenShift environment, if you specified the <code>KOGITO_SERVICE_URL</code> environment variable in the relevant container, this application property in your {PRODUCT} project is not required for the Explainability Service.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/trusty-ui/"><code>trusty-ui</code></a> artifacts page, select the latest release of the {PRODUCT} Audit Investigation Console, and download the <code>trusty-ui-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>trusty-ui-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Audit Investigation Console:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Running the Audit Investigation Console</div>
<div class="content">
<pre class="highlight"><code>$ java -Dquarkus.http.port=9000 -jar trusty-ui-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The default port for the Audit Investigation Console is 8080, but this example specifies port 9000 to avoid conflicts with the example {PRODUCT} service running at port 8080.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In an OpenShift environment, you can use the {PRODUCT} command-line interface (CLI) or the OpenShift web console to add the Audit Investigation Console to your {PRODUCT} infrastructure.</p>
</div>
<div class="paragraph">
<p>In the <code>trusty-ui</code> CLI command, replace the Trusty Service host and port values with the host and port of your running Trusty Service instance. This command includes a <code>KOGITO_TRUSTY_ENDPOINT</code> environment variable that injects the specified Trusty Service endpoint into the Audit Investigation Console service container.</p>
</div>
<div class="listingblock">
<div class="title">Adding the Audit Investigation Console to your OpenShift infrastructure using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ kogito install trusty-ui --env KOGITO_TRUSTY_ENDPOINT=http://trusty:8080</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-instance.png" alt="Image of Kogito Audit Investigation Console instance on OpenShift">
</div>
<div class="title">Figure 157. {PRODUCT} Audit Investigation Console instance on OpenShift web console</div>
</div>
<div class="paragraph">
<p>If you did not already install the required Trusty Service and Explainability Service, you can likewise use the OpenShift web console to add these instances under the <strong>{PRODUCT} Supporting Service</strong> tab and try again to add the Audit Investigation Console instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-trusty-explainability-instances.png" alt="Image of Kogito Trusty Service and Explainability Service instances on OpenShift">
</div>
<div class="title">Figure 158. {PRODUCT} Trusty Service and Explainability Service instances on OpenShift web console</div>
</div>
</div>
</div>
</li>
<li>
<p>In a web browser, navigate to <code><a href="http://localhost:9000" class="bare">http://localhost:9000</a></code> to open the Audit Investigation Console. If you modified the configured Trusty UI port, use the modified location.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>On OpenShift, navigate to the route URL for the Audit Investigation Console instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-home.png" alt="Image of Kogito Audit Investigation Console">
</div>
<div class="title">Figure 159. {PRODUCT} Audit Investigation Console</div>
</div>
<div class="paragraph">
<p>The Audit Investigation Console displays data for all available DMN model executions. By default, executions are filtered to display results from the last month. To modify the list view, you can use the search or sort fields at the top of the screen.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN model executions list, select an execution ID to view and navigate through the details for the selected execution.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-execution-detail.png" alt="Image of execution details page">
</div>
<div class="title">Figure 160. Execution details page</div>
</div>
<div class="paragraph">
<p>At the top of the execution details page, you can hover your cursor over the execution status to view information about execution date, time, and executor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-execution-status-tooltip.png" alt="Image of Execution Status Tooltip" width="303">
</div>
<div class="title">Figure 161. Execution status tooltip</div>
</div>
</div>
</div>
</li>
<li>
<p>In the execution details page, use the following tabs in the top menu to view different aspects of the DMN model execution:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Outcomes</strong>: Use this page to view a list of the decision outcomes in the current execution. Each outcome is a card containing the output of the decision. You can click <strong>View Details</strong> for each card to open the <strong>Outcome Details</strong> section for that specific outcome.</p>
</li>
<li>
<p><strong>Outcome Details</strong>: Use this page to view information about decision outcomes of the execution.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-outcomes-details.png" alt="Image of Outcome Details page">
</div>
<div class="title">Figure 162. Outcome Details page</div>
</div>
<div class="paragraph">
<p>You can change which outcome to view by selecting from the drop-down options in the top menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-outcomes-switch.png" alt="Image of Outcomes selection">
</div>
<div class="title">Figure 163. Outcomes selection</div>
</div>
<div class="paragraph">
<p>The <strong>Explanation</strong> section provides insight about how the inputs of the model influenced the decision outcome. A score from <code>-1</code> to <code>1</code> is assigned to each input, representing its positive or negative effect on the decision result. Score values are rounded to the second decimal digit. If you hover your cursor over the graph bars, you can also see the full score value. Next to the <strong>Features Score Chart</strong> panel, the <strong>Features Weight</strong> panel contains the same scores in a tabular view, grouped by positive and negative weight.</p>
</div>
<div class="paragraph">
<p>The <strong>Outcome Influencing Inputs</strong> section provides a list of the inputs that were considered during the elaboration of the current decision outcome. The inputs typically consist of a sub-set of the inputs provided to the DMN model, or may consist of all provided inputs. For complex input structures, you can select from the <strong>Browse Sections</strong> options to view different input sections.</p>
</div>
</li>
<li>
<p><strong>Input Data</strong>: Use this page to view all inputs submitted to the DMN model for the current execution, including all inputs that were not incorporated in the outcomes processing. For complex input structures, you can select from the <strong>Browse Sections</strong> options to view different input sections.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-input-data.png" alt="Image of Input Data page">
</div>
<div class="title">Figure 164. Input Data page</div>
</div>
</li>
<li>
<p><strong>Model Lookup</strong>: Use this page to view the decision requirements diagram (DRD) of the executed DMN model.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/dmn/kogito-audit-console-model-lookup.png" alt="Image of Model Lookup page">
</div>
<div class="title">Figure 165. Model Lookup page</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>Model Lookup</strong> viewer currently does not support DMN models that include other DMN models or PMML models.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="proc-audit-console-using-security_kogito-dmn-models">Enabling {PRODUCT} Audit Console security with OpenID Connect</h5>
<div class="paragraph _abstract">
<p>For Quarkus-based {PRODUCT} services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the {PRODUCT} Audit Console to enable the console to interact with the {PRODUCT} Data Index Service using bearer token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/kiegroup/kogito-apps/tree/master/trusty-ui">{PRODUCT} Audit Console</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/kiegroup/kogito-apps/tree/master/trusty-ui">{PRODUCT} Audit Console</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the {PRODUCT} Audit Console repository and enter the following command to run the application with security enabled:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Run the Audit Console with security enabled</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Ensure that the service is not started at the same port as the security server. You can change the port by adding <code>-Dquarkus.http.port=<em>PORT_NUMBER</em></code> to the start-up properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The {PRODUCT} Audit Console contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Audit Console project and add the following properties:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-console-quarkus
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=web-app
%keycloak.quarkus.oidc.logout.path=/logout
%keycloak.quarkus.oidc.logout.post-logout-path=/

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example {PRODUCT} services that use the Trusty Service and Explainability Service, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/dmn-tracing-quarkus"><code>dmn-tracing-quarkus</code></a>: A DMN decision service on Quarkus that uses the <code>tracing-decision-quarkus-addon</code> add-on to generate tracing events that the {PRODUCT} Trusty Service and Explainability Service can consume and expose.</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/trusty-demonstration"><code>trusty-demonstration</code></a>: A tutorial for deploying the <code>dmn-tracing-quarkus</code> example application on Kubernetes as a demonstration of {PRODUCT} Trusty Service and Explainability Service capabilities in a cloud environment.</p>
</li>
</ul>
</div>
<div id="chap-kogito-using-drl-rules" class="paragraph">
<p>= Using DRL rules in {PRODUCT} services
:parent-context: kogito-developing-decision-services
:context: kogito-drl-rules</p>
</div>
<div class="paragraph _abstract">
<p>As a developer of business decisions, you can define business rules using Drools Rule Language (DRL) directly in free-form <code>.drl</code> text files. A DRL file can contain one or more rules that define at a minimum the rule conditions (<code>when</code>) and actions (<code>then</code>).</p>
</div>
<div class="paragraph">
<p>Unresolved directive in drl/chap-kogito-using-drl-rules.adoc - include::{asciidoc-dir}/dmn/chap-kogito-using-dmn-models.adoc[tags=ref-decision-authoring-assets]</p>
</div>
<div id="con-drl_kogito-developing-decision-services" class="paragraph">
<p>== Drools Rule Language (DRL)</p>
</div>
<div class="paragraph _abstract">
<p>Drools Rule Language (DRL) is a notation established by the <a href="https://www.drools.org/">Drools</a> open source business automation project for defining and describing business rules. You define DRL rules in <code>.drl</code> text files. A DRL file can contain one or more rules that define at a minimum the rule conditions (<code>when</code>) and actions (<code>then</code>).</p>
</div>
<div class="paragraph">
<p>DRL files consist of the following components:</p>
</div>
<div class="listingblock">
<div class="title">Components in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package
unit

import

declare   // Optional

query  // Optional

rule "rule name"
    // Attributes
    when
        // Conditions
    then
        // Actions
end

rule "rule2 name"

...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example DRL rule determines the age limit in a loan application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example rule for loan application age limit</div>
<div class="content">
<pre class="highlight"><code>rule "Underage"
  when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>A DRL file can contain single or multiple rules and queries, and can define resource declarations and attributes that are assigned and used by your rules and queries. The components in a DRL file are grouped in a defined rule unit that serves as a unique namespace for each group of rules. The DRL package followed by the rule unit definition must be listed at the top of a DRL file, and the rules are typically listed last. All other DRL components can follow any order.</p>
</div>
<div class="paragraph">
<p>Each rule must have a unique name within the rule unit. If you use the same rule name more than once in any DRL file in the unit, the rules fail to compile. Rule names generally must follow standard Java identifier conventions. However, you can enclose rule names with double quotation marks (<code>rule "rule name"</code>) to  prevent possible compilation errors, especially if you use spaces in rule names.</p>
</div>
<div id="con-drl-packages_kogito-developing-decision-services" class="paragraph">
<p>=== Packages in DRL</p>
</div>
<div class="paragraph _abstract">
<p>A package is a folder of related assets in {PRODUCT}, such as data objects, DRL files, decision tables, and other asset types. A package also serves as a unique namespace for each group of rules. A single rule base can contain multiple packages. You typically store all the rules for a package in the same file as the package declaration so that the package is self-contained. However, you can import objects from other packages that you want to use in the rules.</p>
</div>
<div class="paragraph">
<p>The following example is a package name and namespace for a DRL file in a mortgage application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example package definition in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following railroad diagram shows all the components that may make up a package:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/package.png" alt="package">
</div>
<div class="title">Figure 166. Package</div>
</div>
<div class="paragraph">
<p>Note that a package <em>must</em> have a namespace and be declared using standard Java conventions for package names; i.e., no spaces, unlike rule names which allow spaces.
In terms of the order of elements, they can appear in any order in the rule file, with the exception of the <code>package</code> and <code>unit</code> statements, which must be at the top of the file.
In all cases, the semicolons are optional.</p>
</div>
<div class="paragraph">
<p>Notice that any rule attribute (as described in the section <a href="#rules-attributes-ref-drl-rules">[rules-attributes-ref-drl-rules]</a>) may also be written at package level, superseding the attribute&#8217;s default value.
The modified default may still be replaced by an attribute setting within a rule.</p>
</div>
<div id="con-drl-rule-units_kogito-developing-decision-services" class="paragraph">
<p>=== Rule units in DRL</p>
</div>
<div class="paragraph _abstract">
<p>A DRL rule unit is a module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained.</p>
</div>
<div class="paragraph">
<p>The following example is a rule unit designated in a DRL file in a mortgage application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example package definition and rule unit designation in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define a rule unit, you declare the relevant fact types and declare the data sources for the types by implementing the <code>RuleUnitData</code> interface, and then define the rules in the unit:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end

declare MortgageRules extends RuleUnitData
  person: DataStream&lt;Person&gt; = DataSource.createStream()
end

rule "Using a rule unit with a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>To separate the fact types from the rule unit for use with other DRL rules, you can declare the types in a separate DRL file and then use the DRL rule file to declare the data sources by using the <code>RuleUnitData</code> interface implementation:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL type declaration as a separate file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file without explicitly defined types</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MortgageRules extends RuleUnitData
  person: DataStream&lt;Person&gt; = DataSource.createStream()
end

rule "Using a rule unit with a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>persons</code> is a <code>DataStream</code> data source for facts of type <code>Person</code>. Data sources are typed sources of data that rule units can subscribe to for updates. You interact with the rule unit through the data sources it exposes. A data source can be a <code>DataStream</code> source for append-only storage, a <code>DataStore</code> source for writable storage to add or remove data, or a <code>SingletonStore</code> source for writable storage to set and clear a single element.</p>
</div>
<div class="paragraph">
<p>As part of your data source declaration, you also import <code>org.kie.kogito.rules.DataSource</code> and the relevant data source support, such as <code>import org.kie.kogito.rules.DataStream</code> in this example.</p>
</div>
<div class="paragraph">
<p>You can add several rules to the same DRL file, or further break down the rule set and type declarations by creating more files. However you construct your rule sets, ensure that all DRL rule files exist in the same directory and start with the correct <code>package</code> and <code>unit</code> declarations.</p>
</div>
<div class="paragraph">
<p>==== Rule unit use case</p>
</div>
<div class="paragraph">
<p>As an additional rule unit use case, consider the following example decision service that evaluates incoming data from a heat sensor for temperature measurements and produces alerts when the temperature is above a specified threshold.</p>
</div>
<div class="paragraph">
<p>This example service uses the following <code>types.drl</code> file in the <code>src/main/resources/org/acme</code> folder of the {PRODUCT} project to declare the <code>Temperature</code> and the <code>Alert</code> fact types:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL type declarations</div>
<div class="content">
<pre class="highlight"><code>package com.acme;

declare Temperature
  value: double
end

declare Alert
    severity: String
    message: String
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define DRL rules that pattern-match against <code>Temperature</code> values, the example service must expose an entry point for the incoming data to the {DECISION_ENGINE} and publish alerts on a separate channel. To establish this data source for decision data, the example service uses a rule unit with <code>DataStream</code> data sources for <code>Temperature</code> objects and for <code>Alert</code> objects.</p>
</div>
<div class="paragraph">
<p>The <code>DataStream</code> data source is an append-only store for incoming data, similar to a queue. This type of data source is logical for both sources in this example because the temperature data is coming from an external source (the sensor) and the service publishes the alerts externally as they are produced.</p>
</div>
<div class="paragraph">
<p>The example service uses the following <code>MonitoringService.drl</code> file in the same <code>src/main/resources/com/acme</code> folder of the {PRODUCT} project to declare the data sources for the fact types and defines the rules for the rule unit:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MonitoringService extends RuleUnitData
  temperature: DataStream&lt;Temperature&gt; = DataSource.createStream()
  alertData: DataStream&lt;Alert&gt; = DataSource.createStream()
end

rule "tooHot"
when
    $temp : /temperature[value &gt;= 80]
then
    alertData.append(new Alert("HIGH", "Temperature exceeds threshold: " + temp.value));
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rule unit implements the required <code>RuleUnitData</code> interface and declares the data sources for the previously defined types. The sample rule raises an alert when the temperature reaches or exceeds 80 degrees.</p>
</div>
<div class="paragraph">
<p>==== Data sources for DRL rule units</p>
</div>
<div class="paragraph">
<p>Data sources are typed sources of data that rule units can subscribe to for updates. You interact with the rule unit through the data sources it exposes.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} supports the following types of data sources. When you declare data sources in DRL rule files, the sources are internally rendered as shown in these examples.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DataStream</code>: An append-only storage option. Use this storage option when you want to publish or share data values. You can use the notation <code>DataSource.createStream()</code> to return a <code>DataStream&lt;T&gt;</code> object and use the method <code>append(T)</code> to add more data.</p>
<div class="listingblock">
<div class="title">Example DataStream data source definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataStream&lt;Temperature&gt; temperature = DataSource.createStream();
// Append value and notify all subscribers
temperature.append(new Temperature(100));</code></pre>
</div>
</div>
</li>
<li>
<p><code>DataStore</code>: A writable storage option for adding or removing data and then notifying all subscribers that mutable data has been modified. Rules can pattern-match against incoming values and update or remove available values.
For users familiar with {PRODUCT_DROOLS}, this option is equivalent to a typed version of an entry point. In fact, a <code>DataStore&lt;Object&gt;</code> is equivalent to an old-style entry point.</p>
<div class="listingblock">
<div class="title">Example DataStore data source definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataStore&lt;Temperature&gt; temperature = DataSource.createStore();
Temperature temp = new Temperature(100);
// Add value `t` and notify all subscribers
DataHandle t = temperature.add(temp);
temp.setValue(50);
// Notify all subscribers that the value referenced by `t` has changed
temperature.update(t, temp);
// Remove value referenced by `t` and notify all subscribers
temperature.remove(t);</code></pre>
</div>
</div>
</li>
<li>
<p><code>SingletonStore</code>: A writable storage option for setting or clearing a single element and then notifying all subscribers that the element has been modified. Rules can pattern-match against the value and update or clear available values.
For users familiar with {PRODUCT_DROOLS}, this option is equivalent to a global. In fact, a <code>Singleton&lt;Object&gt;</code> is similar to an old-style global, except that when used in conjuction with rules, you can pattern-match against it.</p>
<div class="listingblock">
<div class="title">Example SingletonStore data source definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">SingletonStore&lt;Temperature&gt; temperature = DataSource.createSingleton();
Temperature temp = new Temperature(100);
// Add value `temp` and notify all subscribers
temperature.set(temp);
temp.setValue(50);
// Notify all subscribers that the value has changed
temperature.update();

Temperature temp2 = new Temperature(200);
// Overwrite contained value with `temp2` and notify all subscribers
temperature.set(temp2);
temp2.setValue(150);
// Notify all subscribers that the value has changed
temperature.update();

// Clear store and notify all subscribers
temperature.clear();</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Subscribers to a data source are known as <em>data processors</em>. A data processor implements the <code>DataProcessor&lt;T&gt;</code> interface. This interface contains callbacks to all the events that a subscribed data source can trigger.</p>
</div>
<div class="listingblock">
<div class="title">Example DataStream data processor</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface DataProcessor&lt;T&gt; {
    void insert(DataHandle handle, T object);
    void update(DataHandle handle, T object);
    void delete(DataHandle handle);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DataHandle</code> method is an internal reference to an object of a data source. Each callaback method might or might not be invoked, depending on whether the corresponding data source implements the capability. For example, a <code>DataStream</code> source invokes only the <code>insert</code> callback, whereas a <code>SingletonStore</code> source invokes the <code>insert</code> callback on <code>set</code> and the <code>delete</code> callback on <code>clear</code> or before an overwriting <code>set</code>.</p>
</div>
<div class="paragraph">
<p>==== DRL rule unit declaration using Java</p>
</div>
<div class="paragraph">
<p>As an alternative to declaring fact types and rule units in DRL files, you can also declare types and units using Java classes. In this case, you add the source code to the <code>src/main/java</code> folder of your {PRODUCT} project instead of <code>src/main/resources</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following Java classes define the type and rule unit declarations for the example temperature monitoring service:</p>
</div>
<div class="listingblock">
<div class="title">Example Temperature class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

public class Temperature {
    private final double value;
    public Temperature(double value) { this.value = value; }
    public double getValue() { return value; }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Alert class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

public class Alert {
    private final String severity
    private final String message;
    public Temperature(String severity, String message) {
        this.severity = severity;
        this.message = message;
    }
    public String getSeverity() { return severity; }
    public String getMessage() { return message; }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule unit class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

public class MonitoringService implements RuleUnitData {
    private DataStream&lt;Temperature&gt; temperature = DataSource.createStream();
    private DataStream&lt;Alert&gt; alertData = DataSource.createStream();
    public DataStream&lt;Temperature&gt; getTemperature() { return temperature; }
    public DataStream&lt;Alert&gt; getAlertData() { return alertData; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this scenario, the DRL rule files then stand alone in the <code>src/main/resources</code> folder and consist of the <code>unit</code> and the rules, with no direct declarations, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file without declarations</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

rule "tooHot"
  when
    $temp : /temperature[value &gt;= 80]
  then
    alertData.append(new Alert("HIGH", "Temperature exceeds threshold: " + temp.value));
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== DRL rule units with BPMN processes</p>
</div>
<div class="paragraph">
<p>If you use a DRL rule unit as part of a business rule task in a Business Process Model and Notation (BPMN) process in your {PRODUCT} project, you do not need to create an explicit data type declaration or a rule unit class that implements the <code>RuleUnitData</code> interface. Instead, you designate the rule unit in the DRL file as usual and specify the rule unit in the format <code>unit:<em>PACKAGE_NAME</em>.<em>UNIT_NAME</em></code> in the implementation details for the business rule task in the BPMN process. When you build the project, the business process implicitly declares the rule unit as part of the business rule task to execute the DRL file.</p>
</div>
<div class="paragraph">
<p>For example, the following is a DRL file with a rule unit designation:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

rule "tooHot"
  when
    $temp : Temperature( value &gt;= 80 ) from temperature
  then
    alertData.add(new Alert("HIGH", "Temperature exceeds threshold: " + temp.value));
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the relevant business process in a BPMN 2.0 process modeler, you select the business rule task and for the <strong>Implementation/Execution</strong> property, you set the rule language to <code>DRL</code> and the rule flow group to <code>unit:com.acme.MonitoringService</code>.</p>
</div>
<div class="paragraph">
<p>This rule unit syntax specifies that you are using the <code>com.acme.MonitoringService</code> rule unit instead of a traditional rule flow group. This is the rule unit that you referenced in the example DRL file. When you build the project, the business process implicitly declares the rule unit as part of the business rule task to execute the DRL file.</p>
</div>
<div id="con-drl-imports_kogito-developing-decision-services" class="paragraph">
<p>=== Import statements in DRL</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/import.png" alt="import">
</div>
<div class="title">Figure 167. Import</div>
</div>
<div class="paragraph _abstract">
<p>Similar to import statements in Java, imports in DRL files identify the fully qualified paths and type names for any objects that you want to use in the rules. You specify the package and data object in the format <code>packageName.objectName</code>, with multiple imports on separate lines. The {DECISION_ENGINE} automatically imports classes from the Java package with the same name as the DRL package and from the package <code>java.lang</code>.</p>
</div>
<div class="paragraph">
<p>The following example is an import statement for a loan application object in a mortgage application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example import statement in a DRL file</div>
<div class="content">
<pre class="highlight"><code>import org.mortgages.LoanApplication;</code></pre>
</div>
</div>
<div id="con-drl-declarations_kogito-developing-decision-services" class="paragraph">
<p>=== Type declarations and metadata in DRL</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/type_declaration.png" alt="type declaration">
</div>
<div class="title">Figure 168. Type declaration</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/meta_data.png" alt="meta data">
</div>
<div class="title">Figure 169. Metadata</div>
</div>
<div class="paragraph _abstract">
<p>Declarations in DRL files define new fact types or metadata for fact types to be used by rules in the DRL file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>New fact types:</strong> The default fact type in the <code>java.lang</code> package of {PRODUCT} is <code>Object</code>, but you can declare other types in DRL files as needed. Declaring fact types in DRL files enables you to define a new fact model directly in the {DECISION_ENGINE}, without creating models in a lower-level language like Java. You can also declare a new type when a domain model is already built and you want to complement this model with additional entities that are used mainly during the reasoning process.</p>
</li>
<li>
<p><strong>Metadata for fact types:</strong> You can associate metadata in the format <code>@<em>KEY</em>( <em>VALUE</em> )</code> with new or existing facts. Metadata can be any kind of data that is not represented by the fact attributes and is consistent among all instances of that fact type. The metadata can be queried at run time by the {DECISION_ENGINE} and used in the reasoning process.</p>
</li>
</ul>
</div>
<div id="con-drl-declarations-without-metadata_kogito-developing-decision-services" class="paragraph">
<p>==== Type declarations without metadata in DRL</p>
</div>
<div class="paragraph _abstract">
<p>A declaration of a new fact does not require any metadata, but must include a list of attributes or fields. If a type declaration does not include identifying attributes, the {DECISION_ENGINE} searches for an existing fact class in the classpath and raises an error if the class is missing.</p>
</div>
<div class="paragraph">
<p>For example, the following DRL file contains a declaration of a new fact type <code>Person</code> from a <code>person</code> data source and uses no metadata:</p>
</div>
<div class="listingblock">
<div class="title">Example declaration of a new fact type with a rule</div>
<div class="content">
<pre class="highlight"><code>declare Person
  name : String
  dateOfBirth : java.util.Date
  address : Address
end

rule "Using a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the new fact type <code>Person</code> has the three attributes <code>name</code>, <code>dateOfBirth</code>, and <code>address</code>. Each attribute has a type that can be any valid Java type, including another class that you create or a fact type that you previously declared. The <code>dateOfBirth</code> attribute has the type <code>java.util.Date</code>, from the Java API, and the <code>address</code> attribute has the previously defined fact type <code>Address</code>.</p>
</div>
<div class="paragraph">
<p>To avoid writing the fully qualified name of a class every time you declare it, you can define the full class name as part of the <code>import</code> clause:</p>
</div>
<div class="listingblock">
<div class="title">Example type declaration with the fully qualified class name in the import</div>
<div class="content">
<pre class="highlight"><code>import java.util.Date

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you declare a new fact type, the {DECISION_ENGINE} generates at compile time a Java class representing the fact type. The generated Java class is a one-to-one JavaBeans mapping of the type definition.</p>
</div>
<div class="paragraph">
<p>For example, the following Java class is generated from the example <code>Person</code> type declaration:</p>
</div>
<div class="listingblock">
<div class="title">Generated Java class for the Person fact type declaration</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Person implements Serializable {
    private String name;
    private java.util.Date dateOfBirth;
    private Address address;

    // Empty constructor
    public Person() {...}

    // Constructor with all fields
    public Person( String name, Date dateOfBirth, Address address ) {...}

    // If keys are defined, constructor with keys
    public Person( ...keys... ) {...}

    // Getters and setters
    // `equals` and `hashCode`
    // `toString`
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then use the generated class in your rules like any other fact, as illustrated in the previous rule example with the <code>Person</code> type declaration from a <code>person</code> data source:</p>
</div>
<div class="listingblock">
<div class="title">Example rule that uses the declared Person fact type</div>
<div class="content">
<pre class="highlight"><code>rule "Using a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div id="con-drl-declarations-enumerative_kogito-developing-decision-services" class="paragraph">
<p>==== Enumerative type declarations in DRL</p>
</div>
<div class="paragraph _abstract">
<p>DRL supports the declaration of enumerative types in the format <code>declare enum <em>FACT_TYPE</em></code>, followed by a comma-separated list of values ending with a semicolon. You can then use the enumerative list in the rules in the DRL file.</p>
</div>
<div class="paragraph">
<p>For example, the following enumerative type declaration defines days of the week for an employee scheduling rule:</p>
</div>
<div class="listingblock">
<div class="title">Example enumerative type declaration with a scheduling rule</div>
<div class="content">
<pre class="highlight"><code>declare enum DaysOfWeek
   SUN("Sunday"),MON("Monday"),TUE("Tuesday"),WED("Wednesday"),THU("Thursday"),FRI("Friday"),SAT("Saturday");

   fullName : String
end

rule "Using a declared Enum"
  when
    $emp : /employee[ dayOff == DaysOfWeek.MONDAY ]
  then
    ...
end</code></pre>
</div>
</div>
<div id="con-drl-declarations-extended_kogito-developing-decision-services" class="paragraph">
<p>==== Extended type declarations in DRL</p>
</div>
<div class="paragraph _abstract">
<p>DRL supports type declaration inheritance in the format <code>declare <em>FACT_TYPE_1</em> extends <em>FACT_TYPE_2</em></code>. To extend a type declared in Java by a subtype declared in DRL, you repeat the parent type in a declaration statement without any fields.</p>
</div>
<div class="paragraph">
<p>For example, the following type declarations extend a <code>Student</code> type from a top-level <code>Person</code> type, and a <code>LongTermStudent</code> type from the <code>Student</code> subtype:</p>
</div>
<div class="listingblock">
<div class="title">Example extended type declarations</div>
<div class="content">
<pre class="highlight"><code>import org.people.Person

declare Person end

declare Student extends Person
    school : String
end

declare LongTermStudent extends Student
    years : int
    course : String
end</code></pre>
</div>
</div>
<div id="con-drl-declarations-with-metadata_kogito-developing-decision-services" class="paragraph">
<p>==== Type declarations with metadata in DRL</p>
</div>
<div class="paragraph _abstract">
<p>You can associate metadata in the format <code>@<em>KEY</em>( <em>VALUE</em> )</code> (the value is optional) with fact types or fact attributes. Metadata can be any kind of data that is not represented by the fact attributes and is consistent among all instances of that fact type. The metadata can be queried at run time by the {DECISION_ENGINE} and used in the reasoning process. Any metadata that you declare before the attributes of a fact type are assigned to the fact type, while metadata that you declare after an attribute are assigned to that particular attribute.</p>
</div>
<div class="paragraph">
<p>In the following example, the two metadata attributes <code>@author</code> and <code>@dateOfCreation</code> are declared for the <code>Person</code> fact type, and the two metadata items <code>@key</code> (literal) and <code>@maxLength</code> are declared for the <code>name</code> attribute. The <code>@key</code> literal metadata attribute has no required value, so the parentheses and the value are omitted.</p>
</div>
<div class="listingblock">
<div class="title">Example metadata declaration for fact types and attributes</div>
<div class="content">
<pre class="highlight"><code>import java.util.Date

declare Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )

    name : String @key @maxLength( 30 )
    dateOfBirth : Date
    address : Address
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For declarations of metadata attributes for existing types, you can identify the fully qualified class name as part of the <code>import</code> clause for all declarations or as part of the individual <code>declare</code> clause:</p>
</div>
<div class="listingblock">
<div class="title">Example metadata declaration for an imported type</div>
<div class="content">
<pre class="highlight"><code>import org.drools.examples.Person

declare Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example metadata declaration for a declared type</div>
<div class="content">
<pre class="highlight"><code>declare org.drools.examples.Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )
end</code></pre>
</div>
</div>
<div id="ref-drl-declarations-metadata-tags_kogito-developing-decision-services" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The examples in this section that refer to the <code>VoiceCall</code> class assume that the sample application domain model includes the following class details:</p>
</div>
<div class="listingblock">
<div class="title">VoiceCall fact class in an example Telecom domain model</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class VoiceCall {
  private String  originNumber;
  private String  destinationNumber;
  private Date    callDateTime;
  private long    callDuration;  // in milliseconds

  // Constructors, getters, and setters
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@role</dt>
<dd>
<p>This tag determines whether a given fact type is handled as a regular fact or an event in the {DECISION_ENGINE} during complex event processing.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default parameter: <code>fact</code></p>
</div>
<div class="paragraph">
<p>Supported parameters: <code>fact</code>, <code>event</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@role( fact | event )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall as event type</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">@timestamp</dt>
<dd>
<p>This tag is automatically assigned to every event in the {DECISION_ENGINE}. By default, the time is provided by the session clock and assigned to the event when it is inserted into the working memory of the {DECISION_ENGINE}. You can specify a custom time stamp attribute instead of the default time stamp added by the session clock.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default parameter: The time added by the {DECISION_ENGINE} session clock</p>
</div>
<div class="paragraph">
<p>Supported parameters: Session clock time or custom time stamp attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@timestamp( <em>ATTRIBUTE_NAME</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall timestamp attribute</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">@duration</dt>
<dd>
<p>This tag determines the duration time for events in the {DECISION_ENGINE}. Events can be interval-based events or point-in-time events. Interval-based events have a duration time and persist in the working memory of the {DECISION_ENGINE} until their duration time has lapsed. Point-in-time events have no duration and are essentially interval-based events with a duration of zero. By default, every event in the {DECISION_ENGINE} has a duration of zero. You can specify a custom duration attribute instead of the default.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default parameter: Null (zero)</p>
</div>
<div class="paragraph">
<p>Supported parameters: Custom duration attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@duration( <em>ATTRIBUTE_NAME</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall duration attribute</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">@expires</dt>
<dd>
<p>This tag determines the time duration before an event expires in the working memory of the {DECISION_ENGINE}. By default, an event expires when the event can no longer match and activate any of the current rules. You can define an amount of time after which an event should expire. This tag definition also overrides the implicit expiration offset calculated from temporal constraints and sliding windows in the KIE base. This tag is available only when the {DECISION_ENGINE} is running in stream mode.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default parameter: Null (event expires after event can no longer match and activate rules)</p>
</div>
<div class="paragraph">
<p>Supported parameters: Custom <code>timeOffset</code> attribute in the format <code>[<mark>#d][#h][#m][#s][</mark>[ms]]</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@expires( <em>TIME_OFFSET</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare expiration offset for VoiceCall events</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
  @expires( 1h35m )
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-drl-queries_kogito-developing-decision-services" class="paragraph">
<p>=== Queries in DRL</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/query.png" alt="query">
</div>
<div class="title">Figure 170. Query</div>
</div>
<div class="paragraph _abstract">
<p>Queries in DRL files search the working memory of the {DECISION_ENGINE} for facts related to the rules in the DRL file. You add the query definitions in DRL files and then obtain the matching results in your application code. Queries search for a set of defined conditions and do not require <code>when</code> or <code>then</code> specifications. Query names are scoped to the rule unit, so each query name must be unique within the same rule unit. In {PRODUCT}, queries are automatically exposed as REST endpoints.</p>
</div>
<div class="paragraph">
<p>The following example is a query definition for an <code>Alert</code> object with a <code>severity</code> field set to <code>HIGH</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example query definition in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

query highSeverity
    alerts : /alertData[ severity == "HIGH" ]
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>{PRODUCT} automatically exposes this query through an endpoint <code>/high-severity</code>.</p>
</div>
<div class="paragraph">
<p>For this example, assume that the <code>MonitoringService</code> rule unit class has the following form:</p>
</div>
<div class="listingblock">
<div class="title">Example Java rule unit class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

public class MonitoringService implements RuleUnitData {
    private DataStream&lt;Temperature&gt; temperature = DataSource.createStream();
    private DataStream&lt;Alert&gt; alertData = DataSource.createStream();
    public DataStream&lt;Temperature&gt; getTemperature() { return temperature; }
    public DataStream&lt;Alert&gt; getAlertData() { return alertData; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, you can invoke the query using the following command:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request to the <code>/high-severity</code> endpoint</div>
<div class="content">
<pre class="highlight"><code>$ curl -X POST \
        -H 'Accept: application/json' \
        -H 'Content-Type: application/json' \
        -d '{ "eventData": [ { "type": "temperature", "value" : 20 }, { "type": "temperature", "value" : 100 } ] }' \
        http://localhost:8080/high-severity</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "alerts" : [
        {
            "severity" : "HIGH",
            "message" : "Temperature exceeds threshold: 100"
        }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example submits the data to the <code>eventData</code> data source and returns the result of the <code>highSeverity</code> query as a response.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in drl/chap-kogito-using-drl-rules.adoc - include::{asciidoc-dir}/decision-engine/chap-kogito-decision-engine.adoc[tags=con-property-change-listeners]</p>
</div>
<div id="ref-rules-attributes_kogito-developing-decision-services" class="paragraph">
<p>=== Rule attributes</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/rule_attributes.png" alt="rule attributes">
</div>
<div class="title">Figure 171. Rule attributes</div>
</div>
<div class="paragraph _abstract">
<p>Rule attributes are additional specifications that you can add to business rules to modify rule behavior.</p>
</div>
<div class="paragraph">
<p>The following table lists the names and supported values of the attributes that you can assign to rules:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 70. Rule attributes</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>salience</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer defining the priority of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue.</p>
<p class="tableblock">Example: <code>salience 10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value. When the option is selected, the rule is enabled. When the option is not selected, the rule is disabled.</p>
<p class="tableblock">Example: <code>enabled true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date-effective</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code>date-effective</code> attribute.</p>
<p class="tableblock">Example: <code>date-effective "4-Sep-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date-expires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code>date-expires</code> attribute.</p>
<p class="tableblock">Example: <code>date-expires "4-Oct-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-loop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value. When the option is selected, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition. When the condition is not selected, the rule can be looped in these circumstances.</p>
<p class="tableblock">Example: <code>no-loop true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>activation-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.</p>
<p class="tableblock">Example: <code>activation-group "GroupName"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.</p>
<p class="tableblock">Example: <code>duration 10000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying either <code>int</code> (interval) or <code>cron</code> timer definitions for scheduling the rule.</p>
<p class="tableblock">Example: <code>timer ( cron:* 0/15 * * * ? )</code>  (every 15 minutes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>calendar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="http://www.quartz-scheduler.org/">Quartz</a> calendar definition for scheduling the rule.</p>
<p class="tableblock">Example: <code>calendars "* * 0-7,18-23 ? * *"</code>  (exclude non-business hours)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auto-focus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within agenda groups. When the option is selected, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.</p>
<p class="tableblock">Example: <code>auto-focus true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lock-on-active</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within rule flow groups or agenda groups. When the option is selected, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code>no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.</p>
<p class="tableblock">Example: <code>lock-on-active true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dialect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying either <code>JAVA</code> or <code>MVEL</code> as the language to be used for code expressions in the rule. By default, the rule uses the dialect specified at the package level. Any dialect specified here overrides the package dialect setting for the rule.</p>
<p class="tableblock">Example: <code>dialect "JAVA"</code></p></td>
</tr>
</tbody>
</table>
<div id="con-drl-rules-conditions_kogito-developing-decision-services" class="paragraph">
<p>=== Rule conditions in DRL</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/rule.png" alt="rule">
</div>
<div class="title">Figure 172. Rule</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/lhs.png" alt="lhs">
</div>
<div class="title">Figure 173. Conditional element in a rule</div>
</div>
<div class="paragraph _abstract">
<p>The <code>when</code> part of a DRL rule (also known as the <em>Left Hand Side (LHS)</em> of the rule) contains the conditions that must be met to execute an action. Conditions consist of a series of stated OOPath expressions of patterns and constraints, with optional bindings and supported rule condition elements (keywords), based on the available data objects in the package. OOPath is an object-oriented syntax extension to XPath for navigating through related elements while handling collections and filtering constraints.</p>
</div>
<div class="paragraph">
<p>For example, in a decision service that raises alerts when the temperature reaches or exceeds 80 degrees, a rule <code>tooHot</code> contains the <code>when</code> condition <code>/temperature[value &gt;= 80]</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
DRL uses <code>when</code> instead of <code>if</code> because <code>if</code> is typically part of a procedural execution flow during which a condition is checked at a specific point in time. In contrast, <code>when</code> indicates that the condition evaluation is not limited to a specific evaluation sequence or point in time, but instead occurs continually at any time. Whenever the condition is met, the actions are executed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>when</code> section is empty, then the conditions are considered to be true and the actions in the <code>then</code> section are executed the first time the rules are fired. This is useful if you want to use rules to set up the {DECISION_ENGINE} state.</p>
</div>
<div class="paragraph">
<p>The following example rule uses empty conditions to insert a fact every time the rule is executed:</p>
</div>
<div class="listingblock">
<div class="title">Example rule without conditions</div>
<div class="content">
<pre class="highlight"><code>rule "start-up"
  when
    // Empty
  then   // Actions to be executed once
    alerts.add( new Alert("INFO", "System started") );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Formally, the core grammar of an OOPath expression is defined in extended Backus-Naur form (EBNF) notation in the following way:</p>
</div>
<div class="listingblock">
<div class="title">EBNF notation for OOPath expressions</div>
<div class="content">
<pre class="highlight"><code>OOPExpr = [ID ( ":" | ":=" )] ( "/" | "?/" ) OOPSegment { ( "/" | "?/" | "." ) OOPSegment } ;
OOPSegment = ID ["#" ID] ["[" ( Number | Constraints ) "]"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== OOPath expressions and constraints</p>
</div>
<div class="paragraph">
<p>An <em>OOPath expression</em> of a pattern in a DRL rule condition is the segment to be matched by the {DECISION_ENGINE}. An OOPath expression can potentially match each fact that is inserted into the working memory of the {DECISION_ENGINE}. It can also contain constraints to further define the facts to be matched.</p>
</div>
<div class="paragraph">
<p>In the simplest form, with no constraints, an OOPath expression matches a fact in the given data source. In the following example with a <code>DataSource&lt;Person&gt;</code> named <code>person</code>, the expression matches against all <code>Person</code> objects in the data source of the {DECISION_ENGINE}:</p>
</div>
<div class="listingblock">
<div class="title">Example expression for a single fact type</div>
<div class="content">
<pre class="highlight"><code>/person</code></pre>
</div>
</div>
<div class="paragraph">
<p>Patterns can also refer to superclasses or even interfaces, potentially matching facts from many different classes. For example, the following pattern matches all <code>Student</code> subtypes of the <code>Person</code> object:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern for subtypes</div>
<div class="content">
<pre class="highlight"><code>/person # Student</code></pre>
</div>
</div>
<div class="paragraph">
<p>Square brackets in a pattern enclose the constraints, such as the following constraint on the person&#8217;s age:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with a constraint</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <em>constraint</em> is an expression that returns <code>true</code> or <code>false</code>. Constraints in DRL are essentially Java expressions with some enhancements, such as property access, and some differences, such as <code>equals()</code> and <code>!equals()</code> semantics for <code>==</code> and <code>!=</code> (instead of the usual <code>same</code> and <code>not same</code> semantics).</p>
</div>
<div class="paragraph">
<p>Any JavaBeans property can be accessed directly from pattern constraints. A JavaBeans property is exposed internally using a standard JavaBeans getter that takes no arguments and returns something. For example, the <code>age</code> property is written as <code>age</code> in DRL instead of the getter <code>getAge()</code>:</p>
</div>
<div class="listingblock">
<div class="title">DRL constraint syntax with JavaBeans properties</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]

// This is equivalent to the following getter format:

/person[ getAge() == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>{PRODUCT} uses the standard JDK <code>Introspector</code> class to achieve this mapping and follows the standard JavaBeans specification. For optimal {DECISION_ENGINE} performance, use the property access format, such as <code>age</code>, instead of using getters explicitly, such as <code>getAge()</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use property accessors to change the state of the object in a way that might affect the rules because the {DECISION_ENGINE} caches the results of the match between invocations for higher efficiency.</p>
</div>
<div class="paragraph">
<p>For example, do not use property accessors in the following ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public int getAge() {
    age++; // Do not do this.
    return age;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public int getAge() {
    Date now = DateUtil.now(); // Do not do this.
    return DateUtil.differenceInYears(now, birthday);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of following the second example, insert a fact that wraps the current date in the working memory and update that fact between rule executions as needed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, if the getter of a property cannot be found, the compiler uses the property name as a fallback method name, without arguments:</p>
</div>
<div class="listingblock">
<div class="title">Fallback method if object is not found</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]

// If `Person.getAge()` does not exist, the compiler uses the following syntax:

/person[ age() == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also nest access properties in patterns, as shown in the following example. Nested properties are indexed by the {DECISION_ENGINE}.</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with nested property access</div>
<div class="content">
<pre class="highlight"><code>/person[ address.houseNumber == 50 ]

// This is equivalent to the following expression:

/person[ getAddress().getHouseNumber() == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use any Java expression that returns a <code>boolean</code> value as a constraint inside the parentheses of a pattern. Java expressions can be mixed with other expression enhancements, such as property access:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with a constraint using property access and Java expression</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can change the evaluation priority by using parentheses, as in any logical or mathematical expression:</p>
</div>
<div class="listingblock">
<div class="title">Example evaluation order of constraints</div>
<div class="content">
<pre class="highlight"><code>/person[ age &gt; 100 &amp;&amp; ( age % 10 == 0 ) ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also reuse Java methods in constraints, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example constraints with reused Java methods</div>
<div class="content">
<pre class="highlight"><code>/person[ Math.round( weight / ( height * height ) ) &lt; 25.0 ]</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use constraints to change the state of the object in a way that might affect the rules because the {DECISION_ENGINE} caches the results of the match between invocations for higher efficiency. Any method that is executed on a fact in the rule conditions must be a read-only method. Also, the state of a fact should not change between rule invocations unless those facts are marked as updated in the working memory on every change.</p>
</div>
<div class="paragraph">
<p>For example, do not use a pattern constraint in the following ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/person[ incrementAndGetAge() == 10 ] // Do not do this.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/person[ System.currentTimeMillis() % 1000 == 0 ] // Do not do this.</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Standard Java operator precedence applies to constraint operators in DRL, and DRL operators follow standard Java semantics except for the <code>==</code> and <code>!=</code> operators.</p>
</div>
<div class="paragraph">
<p>The <code>==</code> operator uses null-safe <code>equals()</code> semantics instead of the usual <code>same</code> semantics. For example, the pattern <code>/person[ firstName == "John" ]</code> is similar to <code>java.util.Objects.equals(person.getFirstName(), "John")</code>, and because <code>"John"</code> is not null, the pattern is also similar to <code>"John".equals(person.getFirstName())</code>.</p>
</div>
<div class="paragraph">
<p>The <code>!=</code> operator uses null-safe <code>!equals()</code> semantics instead of the usual <code>not same</code> semantics. For example, the pattern <code>/person[ firstName != "John" ]</code> is similar to <code>!java.util.Objects.equals(person.getFirstName(), "John")</code>.</p>
</div>
<div class="paragraph">
<p>If the field and the value of a constraint are of different types, the {DECISION_ENGINE} uses type coercion to resolve the conflict and reduce compilation errors. For instance, if <code>"ten"</code> is provided as a string in a numeric evaluator, a compilation error occurs, whereas <code>"10"</code> is coerced to a numeric 10. In coercion, the field type always takes precedence over the value type:</p>
</div>
<div class="listingblock">
<div class="title">Example constraint with a value that is coerced</div>
<div class="content">
<pre class="highlight"><code>/person[ age == "10" ] // "10" is coerced to 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>For groups of constraints, you can use a delimiting comma <code>,</code> to use implicit <code>and</code> connective semantics:</p>
</div>
<div class="listingblock">
<div class="title">Example patterns with multiple constraints</div>
<div class="content">
<pre class="highlight"><code>// Person is at least 50 years old and weighs at least 80 kilograms:
/person[ age &gt; 50, weight &gt; 80 ]

// Person is at least 50 years old, weighs at least 80 kilograms, and is taller than 2 meters:
/person[ age &gt; 50, weight &gt; 80, height &gt; 2 ]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although the <code>&amp;&amp;</code> and <code>,</code> operators have the same semantics, they are resolved with different priorities. The <code>&amp;&amp;</code> operator precedes the <code>||</code> operator, and both the <code>&amp;&amp;</code> and <code>||</code> operators together precede the <code>,</code> operator. Use the comma operator at the top-level constraint for optimal {DECISION_ENGINE} performance and human readability.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You cannot embed a comma operator in a composite constraint expression, such as in parentheses:</p>
</div>
<div class="listingblock">
<div class="title">Example of misused comma in composite constraint expression</div>
<div class="content">
<pre class="highlight"><code>// Do not use the following format:
/person[ ( age &gt; 50, weight &gt; 80 ) || height &gt; 2 ]

// Use the following format instead:
/person[ ( age &gt; 50 &amp;&amp; weight &gt; 80 ) || height &gt; 2 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== Bound variables in patterns and constraints</p>
</div>
<div class="paragraph">
<p>You can bind variables to OOPath expressions of patterns and constraints to refer to matched objects in other portions of a rule. Bound variables can help you define rules more efficiently or more consistently with how you annotate facts in your data model.</p>
</div>
<div class="paragraph">
<p>For example, the following DRL rule uses the variable <code>$p</code> for an OOPath expression with the <code>Person</code> fact:</p>
</div>
<div class="listingblock">
<div class="title">Pattern with a bound variable</div>
<div class="content">
<pre class="highlight"><code>rule "simple rule"
  when
    $p : /person
  then
    System.out.println( "Person " + p );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, you can also bind variables to nested properties, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>// Two persons of the same age:
/person[ firstAge : age ]  // Binding
and
/person[ age == firstAge ] // Constraint expression</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that you separate constraint bindings and constraint expressions for clearer and more efficient rule definitions. Although mixed bindings and expressions are supported, they can complicate patterns and affect evaluation efficiency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>// Do not use the following format:
/person[ age : age * 2 &lt; 100 ]

// Use the following format instead:
/person[ age * 2 &lt; 100, $age : age ]</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>==== Nested constraints and inline casts</p>
</div>
<div class="paragraph">
<p>In some cases, you might need to access multiple properties of a nested object, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern to access multiple properties</div>
<div class="content">
<pre class="highlight"><code>/person[ name == "mark", address.city == "london", address.country == "uk" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can group these property accessors to nested objects for more readable rules, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with grouped constraints</div>
<div class="content">
<pre class="highlight"><code>/person[ name == "mark"]/address[ city == "london", country == "uk" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you work with nested objects, you can use the syntax <code><em>TYPE</em>#<em>SUB_TYPE</em></code> to cast to a subtype and make the getters from the parent type available to the subtype. You can use either the object name or fully qualified class name, and you can cast to one or multiple subtypes, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="title">Example patterns with inline casting to a subtype</div>
<div class="content">
<pre class="highlight"><code>// Inline casting with subtype name:
/person[ name == "mark"]/address#LongAddress[ country == "uk" ]

// Inline casting with fully qualified class name:
/person[ name == "mark"]/address#org.domain.LongAddress[ country == "uk" ]

// Multiple inline casts:
/person[ name == "mark" ]/address#LongAddress/country#DetailedCountry[ population &gt; 10000000 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>These example patterns cast <code>Address</code> to <code>LongAddress</code>, and additionally to <code>DetailedCountry</code> in the last example, making the parent getters available to the subtypes in each case.</p>
</div>
<div class="paragraph">
<p>==== Date literal in constraints</p>
</div>
<div class="paragraph">
<p>By default, the {DECISION_ENGINE} supports the date format <code>dd-mmm-yyyy</code>. You can customize the date format, including a time format mask if needed, by providing an alternative format mask with the system property <code>drools.dateformat="dd-mmm-yyyy hh:mm"</code>. You can also customize the date format by changing the language locale with the <code>drools.defaultlanguage</code> and <code>drools.defaultcountry</code> system properties. For example, the locale of Thailand is set as <code>drools.defaultlanguage=th</code> and <code>drools.defaultcountry=TH</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with a date literal restriction</div>
<div class="content">
<pre class="highlight"><code>/person[ bornBefore &lt; "27-Oct-2009" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== Auto-boxing and primitive types</p>
</div>
<div class="paragraph">
<p>Drools attempts to preserve numbers in their primitive or object wrapper form, so a variable bound to an int primitive when used in a code block or expression will no longer need manual unboxing; unlike early Drools versions where all primitives were autoboxed, requiring manual unboxing.
A variable bound to an object wrapper will remain as an object; the existing JDK 1.5 and JDK 5 rules to handle auto-boxing and unboxing apply in this case.
When evaluating field constraints, the system attempts to coerce one of the values into a comparable format; so a primitive is comparable to an object wrapper.</p>
</div>
<div id="ref-drl-operators_kogito-developing-decision-services" class="paragraph">
<p>==== Supported operators in DRL constraints</p>
</div>
<div class="paragraph _abstract">
<p>DRL supports standard Java semantics for operators in constraints, with some exceptions and with some additional operators that are unique in DRL. The following list summarizes the operators that are handled differently in DRL constraints than in standard Java semantics or that are unique in DRL constraints.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>/</code>, <code>#</code></dt>
<dd>
<p>Use the <code>/</code> operator to group property accessors to nested objects, and use the <code>#</code> operator to cast to a subtype in nested objects. Casting to a subtype makes the getters from the parent type available to the subtype. You can use either the object name or fully qualified class name, and you can cast to one or multiple subtypes.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with nested objects</div>
<div class="content">
<pre class="highlight"><code>// Ungrouped property accessors:
/person[ name == "mark", address.city == "london", address.country == "uk" ]

// Grouped property accessors:
/person[ name == "mark"]/address[ city == "london", country == "uk" ]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with inline casting to a subtype</div>
<div class="content">
<pre class="highlight"><code>// Inline casting with subtype name:
/person[ name == "mark", address#LongAddress.country == "uk" ]

// Inline casting with fully qualified class name:
/person[ name == "mark", address#org.domain.LongAddress.country == "uk" ]

// Multiple inline casts:
/person[ name == "mark", address#LongAddress.country#DetailedCountry.population &gt; 10000000 ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>!.</code></dt>
<dd>
<p>Use this operator to dereference a property in a null-safe way. The value to the left of the <code>!.</code> operator must be not null (interpreted as <code>!= null</code>) in order to give a positive result for pattern matching.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraint with null-safe dereferencing</div>
<div class="content">
<pre class="highlight"><code>/person[ $streetName : address!.street ]

// This is internally rewritten in the following way:

/person[ address != null, $streetName : address.street ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>[]</code></dt>
<dd>
<p>Use this operator to access a <code>List</code> value by index or a <code>Map</code> value by key.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>List</code> and <code>Map</code> access</div>
<div class="content">
<pre class="highlight"><code>// The following format is the same as `childList(0).getAge() == 18`:
/person[childList[0].age == 18]

// The following format is the same as `credentialMap.get("jdoe").isValid()`:
/person[credentialMap["jdoe"].valid]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code></dt>
<dd>
<p>Use these operators on properties with natural ordering. For example, for <code>Date</code> fields, the <code>&lt;</code> operator means <em>before</em>, and for <code>String</code> fields, the operator means <em>alphabetically before</em>. These properties apply only to comparable properties.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>before</code> operator</div>
<div class="content">
<pre class="highlight"><code>/person[ birthDate &lt; $otherBirthDate ]

/person[ firstName &lt; $otherFirstName ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>==</code>, <code>!=</code></dt>
<dd>
<p>Use these operators as <code>equals()</code> and <code>!equals()</code> methods in constraints, instead of the usual <code>same</code> and <code>not same</code> semantics.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraint with null-safe equality</div>
<div class="content">
<pre class="highlight"><code>/person[ firstName == "John" ]

// This is similar to the following formats:

java.util.Objects.equals(person.getFirstName(), "John")
"John".equals(person.getFirstName())</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraint with null-safe not equality</div>
<div class="content">
<pre class="highlight"><code>/person[ firstName != "John" ]

// This is similar to the following format:

!java.util.Objects.equals(person.getFirstName(), "John")</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&amp;&amp;</code>, <code>||</code></dt>
<dd>
<p>Use these operators to create an abbreviated combined relation condition that adds more than one restriction on a field. You can group constraints with parentheses <code>()</code> to create a recursive syntax pattern.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with abbreviated combined relation</div>
<div class="content">
<pre class="highlight"><code>// Simple abbreviated combined relation condition using a single `&amp;&amp;`:
/person[age &gt; 30 &amp;&amp; &lt; 40]

// Complex abbreviated combined relation using groupings:
/person[age ((&gt; 30 &amp;&amp; &lt; 40) || (&gt; 20 &amp;&amp; &lt; 25))]

// Mixing abbreviated combined relation with constraint connectives:
/person[age &gt; 30 &amp;&amp; &lt; 40 || location == "london"]</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/abbreviatedCombinedRelationCondition.png" alt="abbreviatedCombinedRelationCondition">
</div>
<div class="title">Figure 174. Abbreviated combined relation condition</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/abbreviatedCombinedRelationConditionGroup.png" alt="abbreviatedCombinedRelationConditionGroup">
</div>
<div class="title">Figure 175. Abbreviated combined relation condition withparentheses</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>matches</code>, <code>not matches</code></dt>
<dd>
<p>Use these operators to indicate that a field matches or does not match a specified Java regular expression. Typically, the regular expression is a <code>String</code> literal, but variables that resolve to a valid regular expression are also supported. These operators apply only to <code>String</code> properties. If you use <code>matches</code> against a <code>null</code> value, the resulting evaluation is always <code>false</code>. If you use <code>not matches</code> against a <code>null</code> value, the resulting evaluation is always <code>true</code>. As in Java, regular expressions that you write as <code>String</code> literals must use a double backslash <code>\\</code> to escape.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraint to match or not match a regular expression</div>
<div class="content">
<pre class="highlight"><code>/person[ country matches "(USA)?\\S*UK" ]

/person[ country not matches "(USA)?\\S*UK" ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>contains</code>, <code>not contains</code></dt>
<dd>
<p>Use these operators to verify whether a field that is an <code>Array</code> or a <code>Collection</code> contains or does not contain a specified value. These operators apply to <code>Array</code> or <code>Collection</code> properties, but you can also use these operators in place of <code>String.contains()</code> and <code>!String.contains()</code> constraints checks.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>contains</code> and <code>not contains</code> for a Collection</div>
<div class="content">
<pre class="highlight"><code>// Collection with a specified field:
/familyTree[ countries contains "UK" ]

/familyTree[ countries not contains "UK" ]


// Collection with a variable:
/familyTree[ countries contains $var ]

/familyTree[ countries not contains $var ]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>contains</code> and <code>not contains</code> for a String literal</div>
<div class="content">
<pre class="highlight"><code>// Sting literal with a specified field:
/person[ fullName contains "Jr" ]

/person[ fullName not contains "Jr" ]


// String literal with a variable:
/person[ fullName contains $var ]

/person[ fullName not contains $var ]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For backward compatibility, the <code>excludes</code> operator is a supported synonym for <code>not contains</code>.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>memberOf</code>, <code>not memberOf</code></dt>
<dd>
<p>Use these operators to verify whether a field is a member of or is not a member of an <code>Array</code> or a <code>Collection</code> that is defined as a variable. The <code>Array</code> or <code>Collection</code> must be a variable.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>memberOf</code> and <code>not memberOf</code> with a Collection</div>
<div class="content">
<pre class="highlight"><code>/familyTree[ person memberOf $europeanDescendants ]

/familyTree[ person not memberOf $europeanDescendants ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>soundslike</code></dt>
<dd>
<p>Use this operator to verify whether a word has almost the same sound, using English pronunciation, as the given value (similar to the <code>matches</code> operator). This operator uses the Soundex algorithm.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraint with <code>soundslike</code></div>
<div class="content">
<pre class="highlight"><code>// Match firstName "Jon" or "John":
/person[ firstName soundslike "John" ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>str</code></dt>
<dd>
<p>Use this operator to verify whether a field that is a <code>String</code> starts with or ends with a specified value. You can also use this operator to verify the length of the <code>String</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>str</code></div>
<div class="content">
<pre class="highlight"><code>// Verify what the String starts with:
/message[ routingValue str[startsWith] "R1" ]

// Verify what the String ends with:
/message[ routingValue str[endsWith] "R2" ]

// Verify the length of the String:
/message[ routingValue str[length] 17 ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>in</code>, <code>notin</code></dt>
<dd>
<p>Use these operators to specify more than one possible value to match in a constraint (compound value restriction). This functionality of compound value restriction is supported only in the <code>in</code> and <code>not in</code> operators. The second operand of these operators must be a comma-separated list of values enclosed in parentheses. You can provide values as variables, literals, return values, or qualified identifiers. These operators are internally rewritten as a list of multiple restrictions using the operators <code>==</code> or <code>!=</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/compoundValueRestriction.png" alt="compoundValueRestriction">
</div>
<div class="title">Figure 176. compoundValueRestriction</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>in</code> and <code>notin</code></div>
<div class="content">
<pre class="highlight"><code>/person[ $color : favoriteColor ]
/color[ type in ( "red", "blue", $color ) ]

/person[ $color : favoriteColor ]
/color[ type notin ( "red", "blue", $color ) ]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="ref-drl-operator-precedence_kogito-developing-decision-services" class="paragraph">
<p>==== Operator precedence in DRL pattern constraints</p>
</div>
<div class="paragraph _abstract">
<p>DRL supports standard Java operator precedence for applicable constraint operators, with some exceptions and with some additional operators that are unique in DRL. The following table lists DRL operator precedence where applicable, from highest to lowest precedence:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 71. Operator precedence in DRL pattern constraints</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operator type</th>
<th class="tableblock halign-left valign-top">Operators</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nested or null-safe property access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code>, <code>!.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List</code> or <code>Map</code> access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constraint binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplicative</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code>, <code>/%</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code>, <code>&lt;&lt;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>instanceof</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>== !=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses <code>equals()</code> and <code>!equals()</code> semantics, not standard Java <code>same</code> and <code>not same</code> semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-short-circuiting <code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-short-circuiting exclusive <code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-short-circuiting inclusive <code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical <code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;&amp;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical <code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>||</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ternary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>? :</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated <code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
</tbody>
</table>
<div id="ref-drl-rules-conditions-elements_kogito-developing-decision-services" class="paragraph">
<p>==== Supported rule condition elements in DRL (keywords)</p>
</div>
<div class="paragraph _abstract">
<p>DRL supports the following rule condition elements (keywords) that you can use with the patterns that you define in DRL rule conditions:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>and</code></dt>
<dd>
<p>Use this to group conditional components into a logical conjunction. Infix and prefix <code>and</code> are supported. You can group patterns explicitly with parentheses <code>()</code>. By default, all listed patterns are combined with <code>and</code> when no conjunction is specified.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/infixAnd.png" alt="infixAnd">
</div>
<div class="title">Figure 177. infixAnd</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/prefixAnd.png" alt="prefixAnd">
</div>
<div class="title">Figure 178. prefixAnd</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>and</code></div>
<div class="content">
<pre class="highlight"><code>//Infix `and`:
colorType: /color/type and /person[ favoriteColor == colorType ]

//Infix `and` with grouping:
(colorType: /color/type and (/person[ favoriteColor == colorType ] or /person[ favoriteColor == colorType ])

// Prefix `and`:
(and colorType: /color/type /person[ favoriteColor == colorType ])

// Default implicit `and`:
colorType: /color/type
/person[ favoriteColor == colorType ]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use a leading declaration binding with the <code>and</code> keyword (as you can with <code>or</code>, for example). A declaration can only reference a single fact at a time, and if you use a declaration binding with <code>and</code>, then when <code>and</code> is satisfied, it matches both facts and results in an error.</p>
</div>
<div class="listingblock">
<div class="title">Example misuse of <code>and</code></div>
<div class="content">
<pre class="highlight"><code>// Causes compile error:
$person : (/person[ name == "Romeo" ] and /person[ name == "Juliet"])</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>or</code></dt>
<dd>
<p>Use this to group conditional components into a logical disjunction. Infix and prefix <code>or</code> are supported. You can group patterns explicitly with parentheses <code>()</code>. You can also use pattern binding with <code>or</code>, but each pattern must be bound separately.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/infixOr.png" alt="infixOr">
</div>
<div class="title">Figure 179. infixOr</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/prefixOr.png" alt="prefixOr">
</div>
<div class="title">Figure 180. prefixOr</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>or</code></div>
<div class="content">
<pre class="highlight"><code>//Infix `or`:
colorType: /color/type or /person[ favoriteColor == colorType]

//Infix `or` with grouping:
colorType: /color/type or (/person[ favoriteColor == colorType] and /person[ favoriteColor == colorType])

// Prefix `or`:
(or colorType: /color/type /person[ favoriteColor == colorType])</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>or</code> and pattern binding</div>
<div class="content">
<pre class="highlight"><code>pensioner : ( /person[ sex == "f", age &gt; 60 ] or /person[ sex == "m", age &gt; 65 ] )

(or pensioner : /person[ sex == "f", age &gt; 60 ]
    pensioner : /person[ sex == "m", age &gt; 65 ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The behavior of the <code>or</code> condition element is different from the connective <code>||</code> operator for constraints and restrictions in field constraints. The {DECISION_ENGINE} does not directly interpret the <code>or</code> element but uses logical transformations to rewrite a rule with <code>or</code> as a number of sub-rules. This process ultimately results in a rule that has a single <code>or</code> as the root node and one sub-rule for each of its condition elements. Each sub-rule is activated and executed like any normal rule, with no special behavior or interaction between the sub-rules.</p>
</div>
<div class="paragraph">
<p>Therefore, consider the <code>or</code> condition element a shortcut for generating two or more similar rules that, in turn, can create multiple activations when two or more terms of the disjunction are true.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>exists</code></dt>
<dd>
<p>Use this to specify facts and constraints that must exist. This option is triggered on only the first match, not subsequent matches. If you use this element with multiple patterns, enclose the patterns with parentheses <code>()</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/exists.png" alt="exists">
</div>
<div class="title">Figure 181. Exists</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>exists</code></div>
<div class="content">
<pre class="highlight"><code>exists /person[ firstName == "John"]

exists (/person[ firstName == "John", age == 42 ])

exists (/person[ firstName == "John" ] and
        /person[ lastName == "Doe" ])</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>not</code></dt>
<dd>
<p>Use this to specify facts and constraints that must not exist. If you use this element with multiple patterns, enclose the patterns with parentheses <code>()</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/not.png" alt="not">
</div>
<div class="title">Figure 182. Not</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>not</code></div>
<div class="content">
<pre class="highlight"><code>not /person[ firstName == "John"]

not (/person[ firstName == "John", age == 42 )]

not (/person[ firstName == "John" ] and
     /person[ lastName == "Doe" ])</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>forall</code></dt>
<dd>
<p>Use this to verify whether all facts that match the first pattern match all the remaining patterns. When a <code>forall</code> construct is satisfied, the rule evaluates to <code>true</code>. This element is a scope delimiter, so it can use any previously bound variable, but no variable bound inside of it is available for use outside of it.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/forall.png" alt="forall">
</div>
<div class="title">Figure 183. Forall</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code></div>
<div class="content">
<pre class="highlight"><code>rule "All full-time employees have red ID badges"
  when
    forall( $emp : /employee[ type == "fulltime" ]
                   /employee[ this == $emp, badgeColor = "red" ] )
  then
    // True, all full-time employees have red ID badges.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the rule selects all <code>employee</code> objects whose type is <code>"fulltime"</code>. For each fact that matches this pattern, the rule evaluates the patterns that follow (badge color) and if they match, the rule evaluates to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>To state that all facts of a given type in the working memory of the {DECISION_ENGINE} must match a set of constraints, you can use <code>forall</code> with a single pattern for simplicity.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code> and a single pattern</div>
<div class="content">
<pre class="highlight"><code>rule "All full-time employees have red ID badges"
  when
    forall( /employee[ badgeColor = "red" ] )
  then
    // True, all full-time employees have red ID badges.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>forall</code> constructs with multiple patterns or nest them with other condition elements, such as inside a <code>not</code> element construct.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code> and multiple patterns</div>
<div class="content">
<pre class="highlight"><code>rule "All employees have health and dental care programs"
  when
    forall( $emp : /employee
            /healthCare[ employee == $emp ]
            /dentalCare[ employee == $emp ]
          )
  then
    // True, all employees have health and dental care.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code> and <code>not</code></div>
<div class="content">
<pre class="highlight"><code>rule "Not all employees have health and dental care"
  when
    not ( forall( $emp : /employee
            /healthCare[ employee == $emp ]
            /dentalCare[ employee == $emp ] )
        )
  then
    // True, not all employees have health and dental care.
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The format <code>forall( p1 p2 p3 &#8230;&#8203;)</code> is equivalent to <code>not( p1 and not( and p2 p3 &#8230;&#8203; ) )</code>.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>accumulate</code></dt>
<dd>
<p>Use this to iterate over a collection of objects, execute custom actions for each of the elements, and return one or more result objects (if the constraints evaluate to <code>true</code>). You can use predefined functions in your <code>accumulate</code> conditions or implement custom functions as needed. You can also use the abbreviation <code>acc</code> for <code>accumulate</code> in rule conditions.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Use the following format to define <code>accumulate</code> conditions in rules:</p>
</div>
<div class="listingblock">
<div class="title">Preferred format for <code>accumulate</code></div>
<div class="content">
<pre class="highlight"><code>accumulate( <em>SOURCE_PATTERN</em>; <em>FUNCTIONS</em> [;<em>CONSTRAINTS</em>] )</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/accumulate.png" alt="accumulate">
</div>
<div class="title">Figure 184. Accumulate</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although the {DECISION_ENGINE} supports alternate formats for the <code>accumulate</code> element for backward compatibility, this format is preferred for optimal performance in rules and applications.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} supports the following predefined <code>accumulate</code> functions. These functions accept any expression as input.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>average</code></p>
</li>
<li>
<p><code>min</code></p>
</li>
<li>
<p><code>max</code></p>
</li>
<li>
<p><code>count</code></p>
</li>
<li>
<p><code>sum</code></p>
</li>
<li>
<p><code>collectList</code></p>
</li>
<li>
<p><code>collectSet</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the following example rule, <code>min</code>, <code>max</code>, and <code>average</code> are <code>accumulate</code> functions that calculate the minimum, maximum, and average temperature values over all the readings for each sensor:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>accumulate</code> to calculate temperature values</div>
<div class="content">
<pre class="highlight"><code>rule "Raise alarm"
  when
    s : /sensor
    accumulate( /reading( sensor == $s, $temp : temperature );
                $min : min( $temp ),
                $max : max( $temp ),
                $avg : average( $temp );
                $min &lt; 20, $avg &gt; 70 )
  then
    // Raise the alarm.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example rule uses the <code>average</code> function with <code>accumulate</code> to calculate the average profit for all items in an order:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>accumulate</code> to calculate average profit</div>
<div class="content">
<pre class="highlight"><code>rule "Average profit"
  when
    $order : /order
    accumulate( /orderItem( order == $order, $cost : cost, $price : price );
                $avgProfit : average( 1 - $cost / $price ) )
  then
    // Average profit for `$order` is `$avgProfit`.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use custom, domain-specific functions in <code>accumulate</code> conditions, create a Java class that implements the <code>org.kie.api.runtime.rule.AccumulateFunction</code> interface. For example, the following Java class defines a custom implementation of an <code>AverageData</code> function:</p>
</div>
<div class="listingblock">
<div class="title">Example Java class with custom implementation of <code>average</code> function</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// An implementation of an accumulator capable of calculating average values

public class AverageAccumulateFunction implements org.kie.api.runtime.rule.AccumulateFunction&lt;AverageAccumulateFunction.AverageData&gt; {

    public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {

    }

    public void writeExternal(ObjectOutput out) throws IOException {

    }

    public static class AverageData implements Externalizable {
        public int    count = 0;
        public double total = 0;

        public AverageData() {}

        public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
            count   = in.readInt();
            total   = in.readDouble();
        }

        public void writeExternal(ObjectOutput out) throws IOException {
            out.writeInt(count);
            out.writeDouble(total);
        }

    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#createContext()
     */
    public AverageData createContext() {
        return new AverageData();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#init(java.io.Serializable)
     */
    public void init(AverageData context) {
        context.count = 0;
        context.total = 0;
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#accumulate(java.io.Serializable, java.lang.Object)
     */
    public void accumulate(AverageData context,
                           Object value) {
        context.count++;
        context.total += ((Number) value).doubleValue();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#reverse(java.io.Serializable, java.lang.Object)
     */
    public void reverse(AverageData context, Object value) {
        context.count--;
        context.total -= ((Number) value).doubleValue();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#getResult(java.io.Serializable)
     */
    public Object getResult(AverageData context) {
        return new Double( context.count == 0 ? 0 : context.total / context.count );
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#supportsReverse()
     */
    public boolean supportsReverse() {
        return true;
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#getResultType()
     */
    public Class&lt; ? &gt; getResultType() {
        return Number.class;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the custom function in a DRL rule, import the function using the <code>import accumulate</code> statement:</p>
</div>
<div class="listingblock">
<div class="title">Format to import a custom function</div>
<div class="content">
<pre class="highlight"><code>import accumulate <em>CLASS_NAME</em> <em>FUNCTION_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with the imported <code>average</code> function</div>
<div class="content">
<pre class="highlight"><code>import accumulate AverageAccumulateFunction.AverageData average

rule "Average profit"
  when
    $order : /order
    accumulate( /orderItem[ order == $order, $cost : cost, $price : price ];
                $avgProfit : average( 1 - $cost / $price ) )
  then
    // Average profit for `$order` is `$avgProfit`.
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For backward compatibility, the {DECISION_ENGINE} also supports the configuration of <code>accumulate</code> functions through configuration files and system properties, but this is a deprecated method. To configure the <code>average</code> function from the previous example using the configuration file or system property, set a property as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>drools.accumulate.function.average = AverageAccumulateFunction.AverageData</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>drools.accumulate.function</code> is a required prefix, <code>average</code> is how the function is used in the DRL files, and <code>AverageAccumulateFunction.AverageData</code> is the fully qualified name of the class that implements the function behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div id="ref-drl-rules-conditions-elements-diagrams_kogito-developing-decision-services" class="paragraph">
<p>==== Railroad diagrams for rule condition elements in DRL</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateAction.png" alt="AccumulateAction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateClause.png" alt="AccumulateClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateFunction.png" alt="AccumulateFunction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateInit.png" alt="AccumulateInit">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateResult.png" alt="AccumulateResult">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateReverse.png" alt="AccumulateReverse">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AccumulateSteps.png" alt="AccumulateSteps">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Accumulations.png" alt="Accumulations">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AdditiveExpr.png" alt="AdditiveExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Annotation.png" alt="Annotation">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Arguments.png" alt="Arguments">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ArrayCreatorRest.png" alt="ArrayCreatorRest">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ArrayInitializer.png" alt="ArrayInitializer">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/AssignmentOperator.png" alt="AssignmentOperator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/BindingPattern.png" alt="BindingPattern">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Block.png" alt="Block">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/BooleanLiteral.png" alt="BooleanLiteral">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/CompilationUnit.png" alt="CompilationUnit">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalAnd.png" alt="ConditionalAnd">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalElementAccumulate.png" alt="ConditionalElementAccumulate">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalElementEval.png" alt="ConditionalElementEval">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalElementExists.png" alt="ConditionalElementExists">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalElementForall.png" alt="ConditionalElementForall">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalElementNot.png" alt="ConditionalElementNot">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalElement.png" alt="ConditionalElement">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalExpr.png" alt="ConditionalExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalOrExpr.png" alt="ConditionalOrExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ConditionalOr.png" alt="ConditionalOr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Constraints.png" alt="Constraints">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/CreatedName.png" alt="CreatedName">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Creator.png" alt="Creator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Definition.png" alt="Definition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Digit.png" alt="Digit">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ExplicitGenericInvocationSuffix.png" alt="ExplicitGenericInvocationSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ExplicitGenericInvocation.png" alt="ExplicitGenericInvocation">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Exponent.png" alt="Exponent">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ExpressionList.png" alt="ExpressionList">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Expression.png" alt="Expression">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Field.png" alt="Field">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Fraction.png" alt="Fraction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/FromAccumulateClause.png" alt="FromAccumulateClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/FromClause.png" alt="FromClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/FromCollectClause.png" alt="FromCollectClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/FunctionDefinition.png" alt="FunctionDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/GlobalDefinition.png" alt="GlobalDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/IdentifierSuffix.png" alt="IdentifierSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ImportDefinition.png" alt="ImportDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/InExpr.png" alt="InExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/InlineListExpr.png" alt="InlineListExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/InlineMapExpr.png" alt="InlineMapExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/InnerCreator.png" alt="InnerCreator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/InstanceOfExpr.png" alt="InstanceOfExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/IntLiteral.png" alt="IntLiteral">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Literal.png" alt="Literal">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ModifyStatement.png" alt="ModifyStatement">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/NonWildcardTypeArguments.png" alt="NonWildcardTypeArguments">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/OrRestriction.png" alt="OrRestriction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/OverClause.png" alt="OverClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Parameters.png" alt="Parameters">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Pattern.png" alt="Pattern">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Placeholders.png" alt="Placeholders">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Primary.png" alt="Primary">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/PrimitiveType.png" alt="PrimitiveType">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/QualifiedName.png" alt="QualifiedName">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/QueryDefinition.png" alt="QueryDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/QueryOptions.png" alt="QueryOptions">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RealLiteral.png" alt="RealLiteral">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RealTypeSuffix.png" alt="RealTypeSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RelationalExpr.png" alt="RelationalExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RelationalOperator.png" alt="RelationalOperator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RhsStatement.png" alt="RhsStatement">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RuleAttributes.png" alt="RuleAttributes">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RuleAttribute.png" alt="RuleAttribute">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RuleDefinition.png" alt="RuleDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/RuleOptions.png" alt="RuleOptions">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Selector.png" alt="Selector">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ShiftExpr.png" alt="ShiftExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/SingleRestriction.png" alt="SingleRestriction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/SourcePattern.png" alt="SourcePattern">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/StringId.png" alt="StringId">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/SuperSuffix.png" alt="SuperSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/ThenPart.png" alt="ThenPart">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/TypeArguments.png" alt="TypeArguments">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/TypeArgument.png" alt="TypeArgument">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/TypeDefinition.png" alt="TypeDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/TypeOptions.png" alt="TypeOptions">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Type.png" alt="Type">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/UnaryExprNotPlusMinus.png" alt="UnaryExprNotPlusMinus">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/UnaryExpr.png" alt="UnaryExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/Value.png" alt="Value">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/VariableInitializer.png" alt="VariableInitializer">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/WhenPart.png" alt="WhenPart">
</div>
</div>
<div id="con-drl-rules-actions_kogito-developing-decision-services" class="paragraph">
<p>=== Rule actions in DRL</p>
</div>
<div class="paragraph _abstract">
<p>The <code>then</code> part of the rule (also known as the <em>Right Hand Side (RHS)</em> of the rule) contains the actions to be performed when the conditional part of the rule has been met. Rule actions are typically determined by one or more <em>data sources</em> that you define as part of your DRL rule unit. For example, if a bank requires loan applicants to have over 21 years of age (with a rule condition <code>/applicant[ applicantName : name, age &lt; 21 ]</code>) and a loan applicant is under 21 years old, the <code>then</code> action of an <code>"Underage"</code> rule would be <code>setApproved( false )</code> based on a defined data source, declining the loan because the applicant is under age.</p>
</div>
<div class="paragraph">
<p>The main purpose of rule actions is to to insert, delete, or modify data in the working memory of the {DECISION_ENGINE}. Effective rule actions are small, declarative, and readable. If you need to use imperative or conditional code in rule actions, then divide the rule into multiple smaller and more declarative rules.</p>
</div>
<div class="listingblock">
<div class="title">Example rule for loan application age limit</div>
<div class="content">
<pre class="highlight"><code>rule "Underage"
  when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about using data sources for rule actions, see <a href="#con-drl-rule-units_kogito-drl-rules">[con-drl-rule-units_kogito-drl-rules]</a>.</p>
</div>
<div id="con-drl-rules-comments_kogito-developing-decision-services" class="paragraph">
<p>=== Comments in DRL files</p>
</div>
<div class="paragraph _abstract">
<p>DRL supports single-line comments prefixed with a double forward slash <code>//</code> and multi-line comments enclosed with a forward slash and asterisk <code>/* &#8230;&#8203; */</code>. You can use DRL comments to annotate rules or any related components in DRL files. DRL comments are ignored by the {DECISION_ENGINE} when the DRL file is processed.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with comments</div>
<div class="content">
<pre class="highlight"><code>rule "Underage"
  // This is a single-line comment.
  when
    /applicant[ applicantName : name, age &lt; 21 ]  // This is an in-line comment
    $application : /loanApplication[ applicant == applicantName ]
  then
    /* This is a multi-line comment
    in the rule actions. */
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/multi_line_comment.png" alt="multi line comment">
</div>
<div class="title">Figure 185. Multi-line comment</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The hash symbol <code>#</code> is not supported for DRL comments.
</td>
</tr>
</table>
</div>
<div id="ref-drl-rules-errors_kogito-developing-decision-services" class="paragraph">
<p>=== Error messages for DRL troubleshooting</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides standardized messages for DRL errors to help you troubleshoot and resolve problems in your DRL files. The error messages use the following format:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/error_message.png" alt="error message">
</div>
<div class="title">Figure 186. Error message format for DRL file problems</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>1st Block:</strong> Error code</p>
</li>
<li>
<p><strong>2nd Block:</strong> Line and column in the DRL source where the error occurred</p>
</li>
<li>
<p><strong>3rd Block:</strong> Description of the problem</p>
</li>
<li>
<p><strong>4th Block:</strong> Component in the DRL source (rule, function, query) where the error occurred</p>
</li>
<li>
<p><strong>5th Block:</strong> Pattern in the DRL source where the error occurred (if applicable)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{PRODUCT} supports the following standardized error messages:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">101: no viable alternative</dt>
<dd>
<p>Indicates that the parser reached a decision point but could not identify an alternative.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with incorrect spelling</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     exists /person
4:     exits /student  // Must be `exists`
5:   then
6: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 101] Line 4:4 no viable alternative at input 'exits' in rule "simple rule"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule without a rule name</div>
<div class="content">
<pre class="highlight"><code>1: package org.drools.examples;
2: rule    // Must be `rule "rule name"` (or `rule rule_name` if no spacing)
3:   when
4:     Object()
5:   then
6:     System.out.println("A RHS");
7: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 101] Line 3:2 no viable alternative at input 'when'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the parser encountered the keyword <code>when</code> but expected the rule name, so it flags <code>when</code> as the incorrect expected token.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with incorrect syntax</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     /student[ name == "Andy ]  // Must be `"Andy"`
4:   then
5: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 101] Line 0:-1 no viable alternative at input '&lt;eof&gt;' in rule "simple rule" in pattern student</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A line and column value of <code>0:-1</code> means the parser reached the end of the source file (<code>&lt;eof&gt;</code>) but encountered incomplete constructs, usually due to missing quotation marks <code>"&#8230;&#8203;"</code>, apostrophes <code>'&#8230;&#8203;'</code>, or parentheses <code>(&#8230;&#8203;)</code>.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">102: mismatched input</dt>
<dd>
<p>Indicates that the parser expected a particular symbol that is missing at the current input position.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with an incomplete rule statement</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     $p : /person[
        // Must be a complete rule statement</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 102] Line 0:-1 mismatched input '&lt;eof&gt;' expecting ']' in rule "simple rule" in pattern person</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A line and column value of <code>0:-1</code> means the parser reached the end of the source file (<code>&lt;eof&gt;</code>) but encountered incomplete constructs, usually due to missing quotation marks <code>"&#8230;&#8203;"</code>, apostrophes <code>'&#8230;&#8203;'</code>, or parentheses <code>(&#8230;&#8203;)</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example rule with incorrect syntax</div>
<div class="content">
<pre class="highlight"><code>1: package org.drools.examples;
2:
3: rule "Wrong syntax"
4:   when
5:     not /car[ ( type == "tesla", price == 10000 ) || ( type == "kia", price == 1000 ) ]
       // Must use `&amp;&amp;` operators instead of commas `,`
6:   then
7:     System.out.println("OK");
8: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error messages</div>
<div class="content">
<pre class="highlight"><code>[ERR 102] Line 5:36 mismatched input ',' expecting ')' in rule "Wrong syntax" in pattern car
[ERR 101] Line 5:57 no viable alternative at input 'type' in rule "Wrong syntax"
[ERR 102] Line 5:106 mismatched input ']' expecting 'then' in rule "Wrong syntax"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the syntactic problem results in multiple error messages related to each other. The single solution of replacing the commas <code>,</code> with <code>&amp;&amp;</code> operators resolves all errors. If you encounter multiple errors, resolve one at a time in case errors are consequences of previous errors.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">103: failed predicate</dt>
<dd>
<p>Indicates that a validating semantic predicate evaluated to <code>false</code>. These semantic predicates are typically used to identify component keywords in DRL files, such as <code>declare</code>, <code>rule</code>, <code>exists</code>, <code>not</code>, and others.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with an invalid keyword</div>
<div class="content">
<pre class="highlight"><code> 1: package nesting;
 2:
 3: import org.drools.compiler.Person
 4: import org.drools.compiler.Address
 5:
 6: Some text  // Must be a valid DRL keyword
 7:
 8: rule "test something"
 9:   when
10:     $p: /person[ name=="Michael" ]
11:   then
12:     $p.name = "other";
13:     System.out.println(p.name);
14: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 103] Line 6:0 rule 'rule_key' failed predicate: {(validateIdentifierKey(DroolsSoftKeywords.RULE))}? in rule</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Some text</code> line is invalid because it does not begin with or is not a part of a DRL keyword construct, so the parser fails to validate the rest of the DRL file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This error is similar to <code>102: mismatched input</code>, but usually involves DRL keywords.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">104: trailing semi-colon not allowed</dt>
<dd>
<p>Indicates that an <code>eval()</code> clause in a rule condition uses a semicolon <code>;</code> but must not use one.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>eval()</code> and trailing semicolon</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     eval( abc(); )  // Must not use semicolon `;`
4:   then
5: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 104] Line 3:4 trailing semi-colon not allowed in rule "simple rule"</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">105: did not match anything</dt>
<dd>
<p>Indicates that the parser reached a sub-rule in the grammar that must match an alternative at least once, but the sub-rule did not match anything. The parser has entered a branch with no way out.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with invalid text in an empty condition</div>
<div class="content">
<pre class="highlight"><code>1: rule "empty condition"
2:   when
3:     None  // Must remove `None` if condition is empty
4:   then
5:      insert( new Person() );
6: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 105] Line 2:2 required (...)+ loop did not match anything at input 'WHEN' in rule "empty condition"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the condition is intended to be empty but the word <code>None</code> is used. This error is resolved by removing <code>None</code>, which is not a valid DRL keyword, data type, or pattern construct.</p>
</div>
<div class="openblock">
<div class="content">
<div id="con-drl-legacy_kogito-developing-decision-services" class="paragraph">
<p>=== Legacy DRL conventions</p>
</div>
<div class="paragraph _abstract">
<p>The following Drools Rule Language (DRL) conventions are no longer applicable or optimal in {PRODUCT} but might be available for backward compatibility.</p>
</div>
<div class="paragraph">
<p>==== Legacy functions in DRL</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/function.png" alt="function">
</div>
<div class="title">Figure 187. Function</div>
</div>
<div class="paragraph">
<p>Functions in DRL files put semantic code in your rule source file instead of in Java classes. Functions are especially useful if an action (<code>then</code>) part of a rule is used repeatedly and only the parameters differ for each rule. Above the rules in the DRL file, you can declare the function or import a static method from a helper class as a function, and then use the function by name in an action (<code>then</code>) part of the rule.</p>
</div>
<div class="paragraph">
<p>The following examples illustrate a function that is either declared or imported in a DRL file:</p>
</div>
<div class="listingblock">
<div class="title">Example function declaration with a rule (option 1)</div>
<div class="content">
<pre class="highlight"><code>function String hello(String applicantName) {
    return "Hello " + applicantName + "!";
}

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example function import with a rule (option 2)</div>
<div class="content">
<pre class="highlight"><code>import function my.package.applicant.hello;

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== Legacy rule attributes</p>
</div>
<div class="paragraph">
<p>The following attributes were used in earlier versions of the {DECISION_ENGINE} to provide grouping of rules across a rule base. These attributes are superseded by DRL rule units and are only available for backward compatibility reasons. If you need to group your rules, use DRL rule units as a clearer and simpler grouping method.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 72. Legacy rule attributes</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>agenda-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying an agenda group to which you want to assign the rule. Agenda groups allow you to partition the agenda to provide more execution control over groups of rules. Only rules in an agenda group that has acquired a focus are able to be activated.</p>
<p class="tableblock">Example: <code>agenda-group "GroupName"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ruleflow-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying a rule flow group. In rule flow groups, rules can fire only when the group is activated by the associated rule flow.</p>
<p class="tableblock">Example: <code>ruleflow-group "GroupName"</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>==== Legacy DRL rule condition syntax</p>
</div>
<div class="paragraph">
<p>In {PRODUCT}, the preferred syntax for DRL rule conditions is through OOPath expressions. For legacy use cases, you can write rules using traditional pattern matching. In this case, you must explicitly indicate the data source using the <code>from</code> clause, as shown in the following comparative examples:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file using OOPath notation</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: /person[ age &gt; 18 ]
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file using traditional notation</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: Person(age &gt; 18) from person
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== Legacy DRL rule condition elements</p>
</div>
<div class="paragraph">
<p>The following rule condition elements (keywords) are obsolete in {PRODUCT}:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>from</code></dt>
<dd>
<p>(Obsolete with OOPath notation)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Use this to specify a data source for a pattern. This enables the {DECISION_ENGINE} to reason over data that is not in the working memory. The data source can be a sub-field on a bound variable or the result of a method call. The expression used to define the object source is any expression that follows regular MVEL syntax. Therefore, the <code>from</code> element enables you to easily use object property navigation, execute method calls, and access maps and collection elements.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/from.png" alt="from">
</div>
<div class="title">Figure 188. from</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> and pattern binding</div>
<div class="content">
<pre class="highlight"><code>rule "Validate zipcode"
  when
    Person( $personAddress : address )
    Address( zipcode == "23920W" ) from $personAddress
  then
    // Zip code is okay.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> and a graph notation</div>
<div class="content">
<pre class="highlight"><code>rule "Validate zipcode"
  when
    $p : Person()
    $a : Address( zipcode == "23920W" ) from $p.address
  then
    // Zip code is okay.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> to iterate over all objects</div>
<div class="content">
<pre class="highlight"><code>rule "Apply 10% discount to all items over US$ 100 in an order"
  when
    $order : Order()
    $item  : OrderItem( value &gt; 100 ) from $order.items
  then
    // Apply discount to `$item`.
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For large collections of objects, instead of adding an object with a large graph that the {DECISION_ENGINE} must iterate over frequently, add the collection directly to the KIE session and then join the collection in the condition, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>when
  $order : Order()
  OrderItem( value &gt; 100, order == $order )</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> and <code>lock-on-active</code> rule attribute</div>
<div class="content">
<pre class="highlight"><code>rule "Assign people in North Carolina (NC) to sales region 1"
  ruleflow-group "test"
  lock-on-active true
  when
    $p : Person()
    $a : Address( state == "NC" ) from $p.address
  then
    modify ($p) {} // Assign the person to sales region 1.
end

rule "Apply a discount to people in the city of Raleigh"
  ruleflow-group "test"
  lock-on-active true
  when
    $p : Person()
    $a : Address( city == "Raleigh" ) from $p.address
  then
    modify ($p) {} // Apply discount to the person.
end</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using <code>from</code> with <code>lock-on-active</code> rule attribute can result in rules not being executed. You can address this issue in one of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid using the <code>from</code> element when you can insert all facts into the working memory of the {DECISION_ENGINE} or use nested object references in your constraint expressions.</p>
</li>
<li>
<p>Place the variable used in the <code>modify()</code> block as the last sentence in your rule condition.</p>
</li>
<li>
<p>Avoid using the <code>lock-on-active</code> rule attribute when you can explicitly manage how rules within the same ruleflow group place activations on one another.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The pattern that contains a <code>from</code> clause cannot be followed by another pattern starting with a parenthesis. The reason for this restriction is that the DRL parser reads the <code>from</code> expression as <code>"from $l (String() or Number())"</code> and it cannot differentiate this expression from a function call. The simplest workaround to this is to wrap the <code>from</code> clause in parentheses, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example rules with <code>from</code> used incorrectly and correctly</div>
<div class="content">
<pre class="highlight"><code>// Do not use `from` in this way:
rule R
  when
    $l : List()
    String() from $l
    (String() or Number())
  then
    // Actions
end

// Use `from` in this way instead:
rule R
  when
    $l : List()
    (String() from $l)
    (String() or Number())
  then
    // Actions
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>entry-point</code></dt>
<dd>
<p>(Superseded by rule unit data sources)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Use this to define an entry point, or <em>event stream</em>, corresponding to a data source for the pattern. This element is typically used with the <code>from</code> condition element. You can declare an entry point for events so that the {DECISION_ENGINE} uses data from only that entry point to evaluate the rules. You can declare an entry point either implicitly by referencing it in DRL rules or explicitly in your Java application.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from entry-point</code></div>
<div class="content">
<pre class="highlight"><code>rule "Authorize withdrawal"
  when
    WithdrawRequest( $ai : accountId, $am : amount ) from entry-point "ATM Stream"
    CheckingAccount( accountId == $ai, balance &gt; $am )
  then
    // Authorize withdrawal.
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>collect</code></dt>
<dd>
<p>(Obsolete with OOPath notation)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Use this to define a collection of objects that the rule can use as part of the condition. The rule obtains the collection either from a specified source or from the working memory of the {DECISION_ENGINE}. The result pattern of the <code>collect</code> element can be any concrete class that implements the <code>java.util.Collection</code> interface and provides a default no-arg public constructor. You can use Java collections like <code>List</code>, <code>LinkedList</code>, and <code>HashSet</code>, or your own class. If variables are bound before the <code>collect</code> element in a condition, you can use the variables to constrain both your source and result patterns. However, any binding made inside the <code>collect</code> element is not available for use outside of it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/collect.png" alt="collect">
</div>
<div class="title">Figure 189. Collect</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>collect</code></div>
<div class="content">
<pre class="highlight"><code>import java.util.List

rule "Raise priority when system has more than three pending alarms"
  when
    $system : System()
    $alarms : List( size &gt;= 3 )
              from collect( Alarm( system == $system, status == 'pending' ) )
  then
    // Raise priority because `$system` has three or more `$alarms` pending.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the rule assesses all pending alarms in the working memory of the {DECISION_ENGINE} for each given system and groups them in a <code>List</code>. If three or more alarms are found for a given system, the rule is executed.</p>
</div>
<div class="paragraph">
<p>You can also use the <code>collect</code> element with nested <code>from</code> elements, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>collect</code> and nested <code>from</code></div>
<div class="content">
<pre class="highlight"><code>import java.util.LinkedList;

rule "Send a message to all parents"
  when
    $town : Town( name == 'Paris' )
    $mothers : LinkedList()
               from collect( Person( children &gt; 0 )
                             from $town.getPeople()
                           )
  then
    // Send a message to all parents.
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>accumulate</code> alternate syntax for a single function with return type</dt>
<dd>
<p>The accumulate syntax evolved over time with the goal of becoming more compact and expressive.
Nevertheless, {PRODUCT} still supports previous syntaxes for backward compatibility purposes.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>In case the rule is using a single accumulate function on a given accumulate, the author may add a pattern for the result object and use the "from" keyword to link it to the accumulate result.</p>
</div>
<div class="paragraph">
<p>Example: a rule to apply a 10% discount on orders over $100 could be written in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Apply 10% discount to orders over US$ 100,00"
when
    $order : /order
    $total : Number( doubleValue &gt; 100 )
             from accumulate( OrderItem( order == $order, $value : value ),
                              sum( $value ) )
then
    // apply discount to $order
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the accumulate element is using only one function (sum), and so, the rules author opted to explicitly write a pattern for the result type of the accumulate function (Number) and write the constraints inside it.
There are no problems in using this syntax over the compact syntax presented before, except that is is a bit more verbose.
Also note that it is not allowed to use both the return type and the functions binding in the same accumulate statement.</p>
</div>
<div class="paragraph">
<p>Compile-time checks are performed in order to ensure the pattern used with the "<code>from</code>" keyword is  assignable from the result of the accumulate function used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>With this syntax, the "<code>from</code>" binds to the single result returned by the accumulate function, and it does not iterate.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the above example, "<code>$total</code>" is bound to the result returned by the accumulate sum() function.</p>
</div>
<div class="paragraph">
<p>As another example however, if the result of the accumulate function is a collection, "<code>from</code>" still binds to the single result and it does not iterate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Person names"
when
  $x : Object() from accumulate(MyPerson( $val : name );
                                collectList( $val ) )
then
  // $x is a List
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bound "<code>$x : Object()</code>" is the List itself, returned by the collectList accumulate function used.</p>
</div>
<div class="paragraph">
<p>This is an important distinction to highlight, as the "<code>from</code>" keyword can also be used separately of accumulate, to iterate over the elements of a collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Iterate the numbers"
when
    $xs : List()
    $x : Integer() from $xs
then
  // $x matches and binds to each Integer in the collection
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>While this syntax is still supported for backward compatibility purposes, for this and other reasons we encourage rule authors to make use instead of the preferred <code>accumulate</code> syntax (described previously), to avoid any potential pitfalls.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>accumulate</code> with inline custom code</dt>
<dd>
<p>Another possible syntax for the <code>accumulate</code> is to define inline custom code, instead of using accumulate functions.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>The use of accumulate with inline custom code is not a good practice for several reasons, including difficulties on maintaining and testing rules that use them, as well as the inability of reusing that code.
Implementing your own accumulate functions is very simple and straightforward, they are easy to unit test and to use.
This form of accumulate is supported for backward compatibility only.</p>
</div>
<div class="paragraph">
<p>Only limited support for inline accumulate is provided while using the executable model.
For example, you cannot use an external binding in the code while using the MVEL dialect:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule R
dialect "mvel"
when
    String( $l : length )
    $sum : Integer() from accumulate (
                           Person( age &gt; 18, $age : age ),
                           init( int sum = 0 * $l; ),
                           action( sum += $age; ),
                           reverse( sum -= $age; ),
                           result( sum )
                     )</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The general syntax of the <code>accumulate</code> CE with inline custom code is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code><em>RESULT_PATTERN</em> from accumulate( <em>SOURCE_PATTERN</em>,
                                  init( <em>INIT_CODE</em> ),
                                  action( <em>ACTION_CODE</em> ),
                                  reverse( <em>REVERSE_CODE</em> ),
                                  result( <em>RESULT_EXPRESSION</em> ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of each of the elements is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>SOURCE_PATTERN</em>: the source pattern is a regular pattern that the {DECISION_ENGINE} will try to match against each of the source objects.</p>
</li>
<li>
<p><em>INIT_CODE</em>: this is a semantic block of code in the selected dialect that will be executed once for each tuple, before iterating over the source objects.</p>
</li>
<li>
<p><em>ACTION_CODE</em>: this is a semantic block of code in the selected dialect that will be executed for each of the source objects.</p>
</li>
<li>
<p><em>REVERSE_CODE</em>: this is an optional semantic block of code in the selected dialect that if present will be executed for each source object that no longer matches the source pattern. The objective of this code block is to undo any calculation done in the <em>ACTION_CODE</em> block, so that the {DECISION_ENGINE} can do decremental calculation when a source object is modified or deleted, hugely improving performance of these operations.</p>
</li>
<li>
<p><em>RESULT_EXPRESSION</em>: this is a semantic expression in the selected dialect that is executed after all source objects are iterated.</p>
</li>
<li>
<p><em>RESULT_PATTERN</em>: this is a regular pattern that the {DECISION_ENGINE} tries to match against the object returned from the <em>RESULT_EXPRESSION</em>. If it matches, the <code>accumulate</code> conditional element evaluates to <em>true</em> and the {DECISION_ENGINE} proceeds with the evaluation of the next CE in the rule. If it does not matches, the <code>accumulate</code> CE evaluates to <em>false</em> and the {DECISION_ENGINE} stops evaluating CEs for that rule.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is easier to understand if we look at an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Apply 10% discount to orders over US$ 100,00"
when
    $order : Order()
    $total : Number( doubleValue &gt; 100 )
             from accumulate( OrderItem( order == $order, $value : value ),
                              init( double total = 0; ),
                              action( total += $value; ),
                              reverse( total -= $value; ),
                              result( total ) )
then
    // apply discount to $order
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, for each <code>Order</code> in the Working Memory, the {DECISION_ENGINE} will execute the <em>INIT_CODE</em> initializing the total variable to zero.
Then it will iterate over all <code>OrderItem</code> objects for that order, executing the <em>action</em> for each one (in the example, it will sum the value of all items into the total variable). After iterating over all <code>OrderItem</code> objects, it will return the value corresponding to the <em>result
          expression</em> (in the above example, the value of variable <code>total</code>). Finally, the {DECISION_ENGINE} will try to match the result with the <code>Number</code> pattern, and if the double value is greater than 100, the rule will fire.</p>
</div>
<div class="paragraph">
<p>The example used Java as the semantic dialect, and as such, note that the usage of the semicolon as statement delimiter is mandatory in the init, action and reverse code blocks.
The result is an expression and, as such, it does not admit ';'. If the user uses any other dialect, he must comply to that dialect&#8217;s specific syntax.</p>
</div>
<div class="paragraph">
<p>As mentioned before, the <em>REVERSE_CODE</em> is optional, but it is strongly recommended that the user writes it in order to benefit from the <em>improved performance on update
          and delete</em>.</p>
</div>
<div class="paragraph">
<p>The <code>accumulate</code> CE can be used to execute any action on source objects.
The following example instantiates and populates a custom object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Accumulate using custom objects"
when
    $person   : Person( $likes : likes )
    $cheesery : Cheesery( totalAmount &gt; 100 )
                from accumulate( $cheese : Cheese( type == $likes ),
                                 init( Cheesery cheesery = new Cheesery(); ),
                                 action( cheesery.addCheese( $cheese ); ),
                                 reverse( cheesery.removeCheese( $cheese ); ),
                                 result( cheesery ) );
then
    // do something
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>eval</code></dt>
<dd>
<p>The conditional element <code>eval</code> is essentially a catch-all which allows any semantic code (that returns a primitive boolean) to be executed.
This code can refer to variables that were bound in the conditions of the rule and functions in the rule package.
Overuse of <code>eval</code> reduces the declarativeness of your rules and can result in a poorly performing {DECISION_ENGINE}.
While <code>eval</code> can be used anywhere in the patterns, it is typically added as the last conditional element in the conditions of a rule.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/drl/eval.png" alt="eval">
</div>
<div class="title">Figure 190. Eval</div>
</div>
<div class="paragraph">
<p>Instances of <code>eval</code> cannot be indexed and thus are not as efficient as Field Constraints.
However this makes them ideal for being used when functions return values that change over time, which is not allowed within Field Constraints.</p>
</div>
<div class="paragraph">
<p>For those who are familiar with {PRODUCT} 2.x lineage, the old {PRODUCT} parameter and condition tags are equivalent to binding a variable to an appropriate type, and then using it in an <code>eval</code> node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>p1 : Parameter()
p2 : Parameter()
eval( p1.getList().containsKey( p2.getItem() ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>p1 : Parameter()
p2 : Parameter()
// call function isValid in the LHS
eval( isValid( p1, p2 ) )</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="proc-drl-rules-central-create_kogito-developing-decision-services" class="paragraph">
<p>== Creating DRL rules for your {PRODUCT} project</p>
</div>
<div class="paragraph _abstract">
<p>You can create and manage DRL rules for your {PRODUCT} project in your integrated development environment (IDE). For {PRODUCT} service, VSCode is the preferred IDE. In each DRL rule file, you define rule conditions, actions, and other components related to the rule, based on the data objects you create or import in the package.</p>
</div>
<div class="paragraph">
<p>In {PRODUCT}, you typically define DRL rules in rule units. A DRL rule unit is a module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained.</p>
</div>
<div class="paragraph">
<p>For this procedure, create the following example DRL type declarations and DRL rule unit to define DRL rules in a decision service for a loan application:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL type declarations for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;

declare Bankruptcy
    name: String
    yearOfOccurrence: int
end

declare Applicant
    name: String
    age: int
end

declare LoanApplication
    applicant: String
    approved: boolean
    explanation: String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MortgageRules extends RuleUnitData
  bankruptcy: DataStore&lt;Bankruptcy&gt; = DataSource.createStore()
  applicant: DataStore&lt;Applicant&gt; = DataSource.createStore()
  application: DataStore&lt;LoanApplication&gt; = DataSource.createStore()
end

rule "Bankruptcy history"
	salience 10
	when
    $a : /loanApplication[ applicantName: applicant ]
    exists (/bankruptcy[ name == applicantName, yearOfOccurrence &gt; 1990 || amountOwed &gt; 100000 ])
	then
		$a.setApproved( false );
		$a.setExplanation( "has been bankrupt" );
		loanApplication.remove( $a );
end

rule "Underage"
	salience 15
	when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
	then
		$application.setApproved( false );
		$application.setExplanation( "Underage" );
		loanApplication.remove( $a );
end</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a {PRODUCT} project and have included any Java data objects required for your {PRODUCT} service. For information about creating a project, see {URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>].</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open your {PRODUCT} project and create a <code>src/main/resources/org/mortgages</code> folder. This folder serves as the package for your DRL files in this example.</p>
</li>
<li>
<p>In your new <code>src/main/resources/org/mortgages</code> folder, add the following <code>ApplicationTypes.drl</code> file to define the fact types for the loan application service:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL type declarations for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;

declare Bankruptcy
    name: String
    yearOfOccurrence: int
end

declare Applicant
    name: String
    age: int
end

declare LoanApplication
    applicant: String
    approved: boolean
    explanation: String
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This DRL file defines the fact types that you can declare in any rule units in the same package for the decision service. Declarations in DRL files define new fact types or metadata for fact types to be used by rules in a DRL files. If you declare these types directly in the DRL rule unit file, you cannot declare them in any other rule units.</p>
</div>
<div class="paragraph">
<p>This example defines the following fact types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Bankruptcy</code>: Provides data for bankruptcy status, if applicable</p>
</li>
<li>
<p><code>Applicant</code>: Provides data about the loan applicant</p>
</li>
<li>
<p><code>LoanApplication</code>: Provides data about loan approval status for a specified applicant, with an explanation if needed</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the same <code>src/main/resources/org/mortgages</code> folder of your {PRODUCT} project, create the following <code>LoanApplication.drl</code> file to declare the DRL rule unit and data sources:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL file with rule unit and data sources</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStore;

declare MortgageRules extends RuleUnitData
  bankruptcy: DataStore&lt;Bankruptcy&gt; = DataSource.createStore()
  applicant: DataStore&lt;Applicant&gt; = DataSource.createStore()
  application: DataStore&lt;LoanApplication&gt; = DataSource.createStore()
end
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the rule unit is named <code>MortgageRules</code> and the previously defined fact types are declared as <code>DataStore</code> data sources.</p>
</div>
<div class="paragraph">
<p>Data sources are typed sources of data that rule units can subscribe to for updates. You interact with the rule unit through the data sources it exposes. A data source can be a <code>DataStream</code> source for append-only storage, a <code>DataStore</code> source for writable storage to add or remove data, or a <code>SingletonStore</code> source for writable storage to set and clear a single element.</p>
</div>
<div class="paragraph">
<p>This example uses the <code>DataStore</code> data source to enable application data to be added or removed as part of the decision service.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To complete the DRL rule unit file, add the following rules for <code>"Bankruptcy history"</code> and <code>"Underage"</code> logic:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MortgageRules extends RuleUnitData
  bankruptcy: DataStore&lt;Bankruptcy&gt; = DataSource.createStore()
  applicant: DataStore&lt;Applicant&gt; = DataSource.createStore()
  application: DataStore&lt;LoanApplication&gt; = DataSource.createStore()
end

rule "Bankruptcy history"
	salience 10
	when
    $a : /loanApplication[ applicantName: applicant ]
    exists (/bankruptcy[ name == applicantName, yearOfOccurrence &gt; 1990 || amountOwed &gt; 100000 ])
	then
		$a.setApproved( false );
		$a.setExplanation( "has been bankrupt" );
		loanApplication.remove( $a );
end

rule "Underage"
	salience 15
	when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
	then
		$application.setApproved( false );
		$application.setExplanation( "Underage" );
		loanApplication.remove( $a );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example rules consist of the following rule components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>rule</code>: Use this segment to define each rule in the DRL file. Rules consist of a rule name in the format <code>rule "rule name"</code>, followed by optional attributes that define rule behavior, such as <code>salience</code> or <code>no-loop</code>, followed by <code>when</code> and <code>then</code> definitions. Each rule must have a unique name within the rule package.</p>
<div class="paragraph">
<p>In this example, the <code>"Bankruptcy history"</code> rule has a defined salience of <code>10</code> and the <code>"Underage"</code> rule has a defined salience of <code>15</code>. These values ensure that the <code>"Bankruptcy history"</code> rule is executed first.</p>
</div>
</li>
<li>
<p><code>when</code> and <code>then</code>: Use the <code>when</code> portion to define the condition patterns and constraints in OOPath syntax and use the <code>then</code> portion to define the actions to be executed when the conditions are met.</p>
<div class="paragraph">
<p>In this example, the <code>"Bankruptcy history"</code> rule states that if an applicant has owed more than 100,000 USD of unresolved debt since 1990 (beginning 1991), then the applicant is considered to have been bankrupt and is not approved for a loan. The application is removed from memory.</p>
</div>
<div class="paragraph">
<p>If the applicant passes the bankruptcy check, then the <code>"Underage"</code> rule states that if the applicant is younger than 21 years old, then the applicant is not approved for the loan. The application is removed from memory.</p>
</div>
<div class="paragraph">
<p>If the applicant passes both checks, then the loan is approved.</p>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After you define all components of the data sources and rules, save all DRL files.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#con-drl-rule-units_kogito-drl-rules">[con-drl-rule-units_kogito-drl-rules]</a></p>
</li>
<li>
<p><a href="#con-drl-rules-conditions_kogito-drl-rules">[con-drl-rules-conditions_kogito-drl-rules]</a></p>
</li>
<li>
<p><a href="#con-drl-rules-actions_kogito-drl-rules">[con-drl-rules-actions_kogito-drl-rules]</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved directive in drl/chap-kogito-using-drl-rules.adoc - include::{asciidoc-dir}/dmn/chap-kogito-using-dmn-models.adoc[tags=con-kogito-service-execution]</p>
</div>
<div id="chap-kogito-using-spreadsheet-decision-tables" class="paragraph">
<p>= Using spreadsheet decision tables in {PRODUCT} services
:parent-context: kogito-developing-decision-services
:context: kogito-decision-tables</p>
</div>
<div class="paragraph _abstract">
<p>As a developer of business decisions, you can define business rules in a tabular format in spreadsheet decision tables and then include the spreadsheet file in your {PRODUCT} project. These rules are compiled into Drools Rule Language (DRL) for the decision service in your project.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in decision-tables/chap-kogito-using-spreadsheet-decision-tables.adoc - include::{asciidoc-dir}/dmn/chap-kogito-using-dmn-models.adoc[tags=ref-decision-authoring-assets]</p>
</div>
<div id="con-decision-tables_kogito-developing-decision-services" class="paragraph">
<p>== Spreadsheet decision tables</p>
</div>
<div class="paragraph _abstract">
<p>Spreadsheet decision tables are XLS or XLSX spreadsheet files that contain business rules defined in a tabular format. You can include spreadsheet decision tables as part of your {PRODUCT} project. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute. After you create and include your spreadsheet decision tables in your project, the rules you defined are compiled into Drools Rule Language (DRL) rules for the decision service.</p>
</div>
<div id="con-decision-tables-use-case_kogito-developing-decision-services" class="paragraph">
<p>== Decision table use case</p>
</div>
<div class="paragraph _abstract">
<p>An online shopping site lists the shipping charges for ordered items. The site provides free shipping under the following conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of items ordered is 4 or more and the checkout total is $300 or more.</p>
</li>
<li>
<p>Standard shipping is selected (4 or 5 business days from the date of purchase).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following are the shipping rates under these conditions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 73. For orders less than $300</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of items</th>
<th class="tableblock halign-left valign-top">Delivery day</th>
<th class="tableblock halign-left valign-top">Shipping charge in USD, N = Number of items</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 or fewer</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>35</p>
</div>
<div class="paragraph">
<p>15</p>
</div>
<div class="paragraph">
<p>10</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 or more</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N*7.50</p>
</div>
<div class="paragraph">
<p>N*3.50</p>
</div>
<div class="paragraph">
<p>N*2.50</p>
</div></div></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 74. For orders more than $300</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of items</th>
<th class="tableblock halign-left valign-top">Delivery day</th>
<th class="tableblock halign-left valign-top">Shipping charge in USD, N = Number of items</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 or fewer</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>25</p>
</div>
<div class="paragraph">
<p>10</p>
</div>
<div class="paragraph">
<p>N*1.50</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 or more</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N*5</p>
</div>
<div class="paragraph">
<p>N*2</p>
</div>
<div class="paragraph">
<p>FREE</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These conditions and rates are shown in the following example spreadsheet decision table:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/decision-tables/decision-table-example-02.png" alt="Decision table example">
</div>
<div class="title">Figure 191. Decision table for shipping charges</div>
</div>
<div class="paragraph">
<p>In order for a decision table to be compiled in your {PRODUCT} project, the table must comply with certain structure and syntax requirements within an XLS or XLSX spreadsheet, as shown in this example. For more information, see <a href="#proc-decision-tables-creating_kogito-decision-tables">[proc-decision-tables-creating_kogito-decision-tables]</a>.</p>
</div>
<div id="proc-decision-tables-creating_kogito-developing-decision-services" class="paragraph">
<p>== Creating spreadsheet decision tables for your {PRODUCT} project</p>
</div>
<div class="paragraph _abstract">
<p>Spreadsheet decision tables (XLS or XLSX) require two key areas that define rule data: a <code>RuleSet</code> area and a <code>RuleTable</code> area. The <code>RuleSet</code> area of the spreadsheet defines elements that you want to apply globally to all rules in the same package (not only the spreadsheet), such as a rule set name or universal rule attributes. The <code>RuleTable</code> area defines the actual rules (rows) and the conditions, actions, and other rule attributes (columns) that constitute that rule table within the specified rule set. A spreadsheet of decision tables can contain multiple <code>RuleTable</code> areas, but only one <code>RuleSet</code> area.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
For each {PRODUCT} project, try to include only one spreadsheet of decision tables, containing all necessary <code>RuleTable</code> definitions. Although you can include separate decision table spreadsheets, including multiple spreadsheets in the same project package can cause compilation errors from conflicting <code>RuleSet</code> or <code>RuleTable</code> attributes and is therefore not recommended.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Refer to the following sample spreadsheet as you define your decision table:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/decision-tables/decision-table-example-02.png" alt="Decision table example">
</div>
<div class="title">Figure 192. Sample spreadsheet decision table for shipping charges</div>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have added the following dependency to the <code>pom.xml</code> file of your {PRODUCT} project to enable decision tables for decision services:</p>
<div class="listingblock">
<div class="title">Dependency to enable decision tables for decision services</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
    &lt;artifactId&gt;drools-decisiontables&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a new XLS or XLSX spreadsheet, go to the second or third column and label a cell <code>RuleSet</code> (row 1 in example). Reserve the column or columns to the left for descriptive metadata (optional).</p>
</li>
<li>
<p>In the next cell to the right, enter a name for the <code>RuleSet</code>. This named rule set will contain all <code>RuleTable</code> rules defined in the rule package.</p>
</li>
<li>
<p>Under the <code>RuleSet</code> cell, define any rule attributes (one per cell) that you want to apply globally to all rule tables in the package. Specify attribute values in the cells to the right. For example, you can enter an <code>Import</code> label and in the cell to the right, specify relevant data objects from other packages that you want to import into the package for the decision table (in the format <code>package.name.object.name</code>). For supported cell labels and values, see <a href="#ref-decision-tables-rule-set-entries_kogito-decision-tables">[ref-decision-tables-rule-set-entries_kogito-decision-tables]</a>.</p>
</li>
<li>
<p>Below the <code>RuleSet</code> area and in the same column as the <code>RuleSet</code> cell, skip a row and label a new cell <code>RuleTable</code> (row 7 in example) and enter a table name in the same cell. The name is used as the initial part of the name for all rules derived from this rule table, with the row number appended for distinction. You can override this automatic naming by inserting a <code>NAME</code> attribute column.</p>
</li>
<li>
<p>Use the next four rows to define the following elements as needed (rows 8-11 in example):</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule attributes:</strong> Conditions, actions, or other attributes. For supported cell labels and values, see <a href="#ref-decision-tables-rule-table-entries_kogito-decision-tables">[ref-decision-tables-rule-table-entries_kogito-decision-tables]</a>.</p>
</li>
<li>
<p><strong>Object types:</strong> The data objects to which the rule attributes apply. If the same object type applies to multiple columns, merge the object cells into one cell across multiple columns (as shown in the sample decision table), instead of repeating the object type in multiple cells. When an object type is merged, all columns below the merged range will be combined into one set of constraints within a single pattern for matching a single fact at a time. When an object is repeated in separate columns, the separate columns can create different patterns, potentially matching different or identical facts.</p>
</li>
<li>
<p><strong>Constraints:</strong> Constraints on the object types.</p>
</li>
<li>
<p><strong>Column label:</strong> (Optional) Any descriptive label for the column, as a visual aid. Leave blank if unused.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to populating both the object type and constraint cells, you can leave the object type cell or cells empty and enter the full expression in the corresponding constraint cell or cells. For example, instead of <code>Order</code> as the object type and <code>itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code>Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for other constraint cells.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>After you have defined all necessary rule attributes (columns), enter values for each column as needed, row by row, to generate rules (rows 12-17 in example). Cells with no data are ignored (such as when a condition or action does not apply).</p>
<div class="paragraph">
<p>If you need to add more rule tables to this decision table spreadsheet, skip a row after the last rule in the previous table, label another <code>RuleTable</code> cell in the same column as the previous <code>RuleTable</code> and  <code>RuleSet</code> cells, and create the new table following the same steps in this section (rows 19-29 in example).</p>
</div>
</li>
<li>
<p>Save your XLS or XLSX spreadsheet to finish.</p>
</li>
<li>
<p>In your VSCode IDE, import the XLS or XLSX spreadsheet file in the relevant folder of your {PRODUCT} project, typically in <code>src/main/resources</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Only the first worksheet in a spreadsheet workbook is processed as a decision table when you include the spreadsheet in your {PRODUCT} project. Each <code>RuleSet</code> name combined with the <code>RuleTable</code> name must be unique across all decision table files in the same package.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After you include the decision table in your {PRODUCT} project, the rules are rendered as DRL rules like the following example, from the sample spreadsheet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>//row 12
rule "Basic_12"
salience 10
  when
    $order : /orders[ itemsCount &gt; 0, itemsCount &lt;= 3, deliverInDays == 1 ]
  then
    insert( new Charge( 35 ) );
end</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Enabling white space used in cell values</div>
<div class="paragraph">
<p>By default, any white space before or after values in decision table cells is removed before the decision table is processed by the {DECISION_ENGINE}. To retain white space that you use intentionally before or after values in cells, set the <code>drools.trimCellsInDTable</code> system property to <code>false</code> in the <code>application.properties</code> file of your {PRODUCT} project:</p>
</div>
<div class="listingblock">
<div class="title">Enable white space in <code>application.properties</code></div>
<div class="content">
<pre class="highlight"><code>drools.trimCellsInDTable=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also set this property as a start-up option when you build your {PRODUCT} project:</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn compile quarkus:dev -Ddrools.trimCellsInDTable=false</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>mvn spring-boot:run -Ddrools.trimCellsInDTable=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div id="ref-decision-tables-rule-set-entries_kogito-developing-decision-services" class="paragraph">
<p>=== RuleSet definitions</p>
</div>
<div class="paragraph _abstract">
<p>Entries in the <code>RuleSet</code> area of a decision table define DRL constructs and rule attributes that you want to apply to all rules in a package (not only in the spreadsheet). Entries must be in a vertically stacked sequence of cell pairs, where the first cell contains a label and the cell to the right contains the value. A decision table spreadsheet can have only one <code>RuleSet</code> area.</p>
</div>
<div class="paragraph">
<p>The following table lists the supported labels and values for <code>RuleSet</code> definitions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 75. Supported <code>RuleSet</code> definitions</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 40%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RuleSet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The package name for the generated DRL file. Optional, the default is <code>rule_table</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Must be the first entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the rule unit for the generated DRL file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Recommended for optimal rule grouping and execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Sequential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code>. If <code>true</code>, then salience is used to ensure that rules fire from the top down.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. If omitted, no firing order is imposed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SequentialMaxPriority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer numeric value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. In sequential mode, this option is used to set the start value of the salience. If omitted, the default value is <code>65535</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SequentialMinPriority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer numeric value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. In sequential mode, this option is used to check if this minimum salience value is not violated. If omitted, the default value is <code>0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EscapeQuotes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code>. If <code>true</code>, then quotation marks are escaped so that they appear literally in the DRL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. If omitted, quotation marks are escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of Java classes to import from another package.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, may be used repeatedly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Queries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more query definitions, according to DRL syntax.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, may be used repeatedly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Declare</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more declarative types, according to DRL syntax.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, may be used repeatedly.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
In some cases, Microsoft Office, LibreOffice, and OpenOffice might encode a double quotation mark differently, causing a compilation error. For example, <code>&#8220;A&#8221;</code> fails, but <code>"A"</code> succeeds.
</td>
</tr>
</table>
</div>
<div id="ref-decision-tables-rule-table-entries_kogito-developing-decision-services" class="paragraph">
<p>=== RuleTable definitions</p>
</div>
<div class="paragraph _abstract">
<p>Entries in the <code>RuleTable</code> area of a decision table define conditions, actions, and other rule attributes for the rules in that rule table. A spreadsheet of decision tables can contain multiple <code>RuleTable</code> areas.</p>
</div>
<div class="paragraph">
<p>The following table lists the supported labels (column headers) and values for <code>RuleTable</code> definitions. For column headers, you can use either the given labels or any custom labels that begin with the letters listed in the table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 76. Supported <code>RuleTable</code> definitions</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 35%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Or custom label that begins with</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides the name for the rule generated from that row. The default is constructed from the text following the <code>RuleTable</code> tag and the row number.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At most one column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DESCRIPTION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Results in a comment within the generated rule.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At most one column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONDITION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code snippet and interpolated values for constructing a constraint within a pattern in a condition.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At least one per rule table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACTION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code snippet and interpolated values for constructing an action for the consequence of the rule.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At least one per rule table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>METADATA</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code snippet and interpolated values for constructing a metadata entry for the rule.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, any number of columns.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following sections provide more details about how condition, action, and metadata columns use cell data:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Conditions</dt>
<dd>
<p>For columns headed <code>CONDITION</code>, the cells in consecutive lines result in a conditional element:</p>
<div class="ulist">
<ul>
<li>
<p><strong>First cell:</strong> Text in the first cell below <code>CONDITION</code> develops into a pattern for the rule condition, and uses the snippet in the next line as a constraint. If the cell is merged with one or more neighboring cells, a single pattern with multiple constraints is formed. All constraints are combined into a parenthesized list and appended to the text in this cell.</p>
<div class="paragraph">
<p>If this cell is empty, the code snippet in the cell below it must result in a valid conditional element on its own. For example, instead of <code>Order</code> as the object type and <code>itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code>Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for any other constraint cells.</p>
</div>
<div class="paragraph">
<p>To include a pattern without constraints, you can write the pattern in front of the text of another pattern, with or without an empty pair of parentheses. You can also append a <code>from</code> clause to the pattern.</p>
</div>
<div class="paragraph">
<p>If the pattern ends with <code>eval</code>, code snippets produce boolean expressions for inclusion into a pair of parentheses after <code>eval</code>.</p>
</div>
</li>
<li>
<p><strong>Second cell:</strong> Text in the second cell below <code>CONDITION</code> is processed as a constraint on the object reference in the first cell. The code snippet in this cell is modified by interpolating values from cells farther down in the column. If you want to create a constraint consisting of a comparison using <code>==</code> with the value from the cells below, then the field selector alone is sufficient. Any other comparison operator must be specified as the last item within the snippet, and the value from the cells below is appended. For all other constraint forms, you must mark the position for including the contents of a cell with the symbol <code>$param</code>. Multiple insertions are possible if you use the symbols <code>$1</code>, <code>$2</code>, and so on, and a comma-separated list of values in the cells below. However, do not separate <code>$1</code>, <code>$2</code>, and so on, by commas, or the table will fail to process.</p>
<div class="paragraph">
<p>To expand a text according to the pattern <code>forall($delimiter){$snippet}</code>, repeat the <code>$snippet</code> once for each of the values of the comma-separated list in each of the cells below, insert the value in place of the symbol <code>$</code>, and join these expansions by the given <code>$delimiter</code>. Note that the <code>forall</code> construct may be surrounded by other text.</p>
</div>
<div class="paragraph">
<p>If the first cell contains an object, the completed code snippet is added to the conditional element from that cell. A pair of parentheses is provided automatically, as well as a separating comma if multiple constraints are added to a pattern in a merged cell. If the first cell is empty, the code snippet in this cell must result in a valid conditional element on its own. For example, instead of <code>Order</code> as the object type and <code>itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code>Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for any other constraint cells.</p>
</div>
</li>
<li>
<p><strong>Third cell:</strong> Text in the third cell below <code>CONDITION</code> is a descriptive label that you define for the column, as a visual aid.</p>
</li>
<li>
<p><strong>Fourth cell:</strong> From the fourth row on, non-blank entries provide data for interpolation. A blank cell omits the condition or constraint for this rule.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Actions</dt>
<dd>
<p>For columns headed <code>ACTION</code>, the cells in consecutive lines result in an action statement:</p>
<div class="ulist">
<ul>
<li>
<p><strong>First cell:</strong> Text in the first cell below <code>ACTION</code> is optional. If present, the text is interpreted as an object reference.</p>
</li>
<li>
<p><strong>Second cell:</strong> Text in the second cell below <code>ACTION</code> is a code snippet that is modified by interpolating values from cells farther down in the column. For a singular insertion, mark the position for including the contents of a cell with the symbol <code>$param</code>. Multiple insertions are possible if you use the symbols <code>$1</code>, <code>$2</code>, and so on, and a comma-separated list of values in the cells below. However, do not separate <code>$1</code>, <code>$2</code>, and so on, by commas, or the table will fail to process.</p>
<div class="paragraph">
<p>A text without any marker symbols can execute a method call without interpolation. In this case, use any non-blank entry in a row below the cell to include the statement. The <code>forall</code> construct is supported.</p>
</div>
<div class="paragraph">
<p>If the first cell contains an object, then the cell text (followed by a period), the text in the second cell, and a terminating semicolon are strung together, resulting in a method call that is added as an action statement for the consequence. If the first cell is empty, the code snippet in this cell must result in a valid action element on its own.</p>
</div>
</li>
<li>
<p><strong>Third cell:</strong> Text in the third cell below <code>ACTION</code> is a descriptive label that you define for the column, as a visual aid.</p>
</li>
<li>
<p><strong>Fourth cell:</strong> From the fourth row on, non-blank entries provide data for interpolation. A blank cell omits the condition or constraint for this rule.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Metadata</dt>
<dd>
<p>For columns headed <code>METADATA</code>, the cells in consecutive lines result in a metadata annotation for the generated rules:</p>
<div class="ulist">
<ul>
<li>
<p><strong>First cell:</strong> Text in the first cell below <code>METADATA</code> is ignored.</p>
</li>
<li>
<p><strong>Second cell:</strong> Text in the second cell below <code>METADATA</code> is subject to interpolation, using values from the cells in the rule rows. The metadata marker character <code>@</code> is prefixed automatically, so you do not need to include that character in the text for this cell.</p>
</li>
<li>
<p><strong>Third cell:</strong> Text in the third cell below <code>METADATA</code> is a descriptive label that you define for the column, as a visual aid.</p>
</li>
<li>
<p><strong>Fourth cell:</strong> From the fourth row on, non-blank entries provide data for interpolation. A blank cell results in the omission of the metadata annotation for this rule.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="ref-decision-tables-attributes_kogito-developing-decision-services" class="paragraph">
<p>=== Additional rule attributes for RuleSet or RuleTable definitions</p>
</div>
<div class="paragraph _abstract">
<p>The <code>RuleSet</code> and <code>RuleTable</code> areas also support labels and values for other rule attributes, such as <code>PRIORITY</code> or <code>NO-LOOP</code>. Rule attributes specified in a <code>RuleSet</code> area will affect all rule assets in the same package (not only in the spreadsheet). Rule attributes specified in a <code>RuleTable</code> area will affect only the rules in that rule table. You can use each rule attribute only once in a <code>RuleSet</code> area and once in a <code>RuleTable</code> area. If the same attribute is used in both <code>RuleSet</code> and <code>RuleTable</code> areas within the spreadsheet, then <code>RuleTable</code> takes priority and the attribute in the <code>RuleSet</code> area is overridden.</p>
</div>
<div class="paragraph">
<p>The following table lists the supported labels (column headers) and values for additional <code>RuleSet</code> or <code>RuleTable</code> definitions. For column headers, you can use either the given labels or any custom labels that begin with the letters listed in the table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 77. Additional rule attributes for <code>RuleSet</code> or <code>RuleTable</code> definitions</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Or custom label that begins with</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PRIORITY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer defining the <code>salience</code> value of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue. Overridden by the <code>Sequential</code> flag.</p>
<p class="tableblock">Example: <code>PRIORITY 10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE-EFFECTIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code>DATE-EFFECTIVE</code> attribute.</p>
<p class="tableblock">Example: <code>DATE-EFFECTIVE "4-Sep-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE-EXPIRES</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code>DATE-EXPIRES</code> attribute.</p>
<p class="tableblock">Example: <code>DATE-EXPIRES "4-Oct-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NO-LOOP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value. When this option is set to <code>true</code>, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition.</p>
<p class="tableblock">Example: <code>NO-LOOP true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACTIVATION-GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.</p>
<p class="tableblock">Example: <code>ACTIVATION-GROUP "GroupName"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DURATION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.</p>
<p class="tableblock">Example: <code>DURATION 10000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying either <code>int</code> (interval) or <code>cron</code> timer definitions for scheduling the rule.</p>
<p class="tableblock">Example: <code>TIMER "*/5 * * * *"</code>  (every 5 minutes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALENDAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Quartz calendar definition for scheduling the rule.</p>
<p class="tableblock">Example: <code>CALENDAR "* * 0-7,18-23 ? * *"</code>  (exclude non-business hours)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AUTO-FOCUS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within agenda groups. When this option is set to <code>true</code>, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.</p>
<p class="tableblock">Example: <code>AUTO-FOCUS true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCK-ON-ACTIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within rule flow groups or agenda groups. When this option is set to <code>true</code>, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code>no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.</p>
<p class="tableblock">Example: <code>LOCK-ON-ACTIVE true</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="kogito/decision-tables/decision-table-example-03.png" alt="Example decision table with definitions used">
</div>
<div class="title">Figure 193. Sample decision table spreadsheet with attribute columns</div>
</div>
<div class="paragraph">
<p>Unresolved directive in decision-tables/chap-kogito-using-spreadsheet-decision-tables.adoc - include::{asciidoc-dir}/dmn/chap-kogito-using-dmn-models.adoc[tags=con-kogito-service-execution]</p>
</div>
<div id="chap-kogito-decision-engine" class="paragraph">
<p>= {DECISION_ENGINE_CAP} in {PRODUCT}
:parent-context: kogito-developing-decision-services
:context: kogito-decision-engine</p>
</div>
<div class="paragraph _abstract">
<p>As a developer of business decisions, your understanding of the {DECISION_ENGINE} in {PRODUCT} can help you design more effective business assets and a more scalable decision management architecture. The {DECISION_ENGINE} is the {PRODUCT} component that stores, processes, and evaluates data to execute business rules and to reach the decisions that you define. This document describes basic concepts and functions of the {DECISION_ENGINE} to consider as you create your business rule system and decision services in {PRODUCT}.</p>
</div>
<div id="con-decision-engine_kogito-developing-decision-services" class="paragraph">
<p>== {DECISION_ENGINE_CAP} in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>The {DECISION_ENGINE} is the rules engine in {PRODUCT}. The {DECISION_ENGINE} stores, processes, and evaluates data to execute the business rules or decision models that you define. The basic function of the {DECISION_ENGINE} is to match incoming data, or <em>facts</em>, to the conditions of rules and determine whether and how to execute the rules.</p>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} operates using the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Rules:</strong> Business rules or DMN decisions that you define. All rules must contain at a minimum the conditions that trigger the rule and the actions that the rule dictates.</p>
</li>
<li>
<p><strong>Facts:</strong> Data that enters or changes in the {DECISION_ENGINE} that the {DECISION_ENGINE} matches to rule conditions to execute applicable rules.</p>
</li>
<li>
<p><strong>Production memory:</strong> Location where rules are stored in the {DECISION_ENGINE}.</p>
</li>
<li>
<p><strong>Working memory:</strong> Location where facts are stored in the {DECISION_ENGINE}.</p>
</li>
<li>
<p><strong>Agenda:</strong> Location where activated rules are registered and sorted (if applicable) in preparation for execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a business user or an automated system adds or updates rule-related information in {PRODUCT}, that information is inserted into the working memory of the {DECISION_ENGINE} in the form of one or more facts. The {DECISION_ENGINE} matches those facts to the conditions of the rules that are stored in the production memory to determine eligible rule executions. (This process of matching facts to rules is often referred to as <em>pattern matching</em>.) When rule conditions are met, the {DECISION_ENGINE} activates and registers rules in the agenda, where the {DECISION_ENGINE} then sorts prioritized or conflicting rules in preparation for execution.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates these basic components of the {DECISION_ENGINE}:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/decision-engine/rule-engine-inkscape_enterprise.png" alt="rule engine inkscape enterprise">
</div>
<div class="title">Figure 194. Overview of basic {DECISION_ENGINE} components</div>
</div>
<div class="paragraph">
<p>These core concepts can help you to better understand other more advanced components, processes, and subprocesses of the {DECISION_ENGINE}, and as a result, to design more effective business assets in {PRODUCT}.</p>
</div>
<div id="con-execution-control_kogito-developing-decision-services" class="paragraph">
<p>== Execution control in the {DECISION_ENGINE}</p>
</div>
<div class="paragraph _abstract">
<p>When new rule data enters the working memory of the {DECISION_ENGINE}, rules may become fully matched and eligible for execution. A single working memory action can result in multiple eligible rule executions. When a rule is fully matched, the {DECISION_ENGINE} creates an activation instance, referencing the rule and the matched facts, and adds the activation onto the {DECISION_ENGINE} agenda. The agenda controls the execution order of these rule activations using a conflict resolution strategy.</p>
</div>
<div class="paragraph">
<p>When rules are executed, the {DECISION_ENGINE} cycles repeatedly through two phases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Agenda evaluation.</strong> In this phase, the {DECISION_ENGINE} selects all rules that can be executed. If no executable rules exist, the execution cycle ends. If an executable rule is found, the {DECISION_ENGINE} registers the activation in the agenda and then moves on to the working memory actions phase to perform rule consequence actions.</p>
</li>
<li>
<p><strong>Working memory actions.</strong> In this phase, the {DECISION_ENGINE} performs the rule consequence actions (the <code>then</code> portion of each rule) for all activated rules previously registered in the agenda. After all the consequence actions are complete or the rules are executed again, the {DECISION_ENGINE} returns to the agenda evaluation phase to reassess rules.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="kogito/decision-engine/Two_Phase_enterprise.png" alt="Two Phase enterprise">
</div>
<div class="title">Figure 195. Two-phase execution process in the {DECISION_ENGINE}</div>
</div>
<div class="paragraph">
<p>When multiple rules exist on the agenda, the execution of one rule may cause another rule to be removed from the agenda. To avoid this, you can define how and when rules are executed in the {DECISION_ENGINE}. Some common methods for defining rule execution order are by using rule salience, agenda groups, activation groups, or rule units for DRL rule sets.</p>
</div>
<div class="paragraph">
<p>=== Salience for rules</p>
</div>
<div class="paragraph">
<p>Each rule has an integer <code>salience</code> attribute that determines the order of execution. Rules with a higher salience value are given higher priority when ordered in the activation queue. The default salience value for rules is zero, but the salience can be negative or positive.</p>
</div>
<div class="paragraph">
<p>For example, the following sample DRL rules are listed in the {DECISION_ENGINE} stack in the order shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "RuleA"
salience 95
  when
    $fact : /myFact[ field1 == true ]
  then
    System.out.println("Rule2 : " + $fact);
    update($fact);
end

rule "RuleB"
salience 100
  when
    $fact : /myFact[ field1 == false ]
  then
    System.out.println("Rule1 : " + $fact);
    $fact.setField1(true);
    update($fact);
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>RuleB</code> rule is listed second, but it has a higher salience value than the <code>RuleA</code> rule and is therefore executed first.</p>
</div>
<div class="paragraph">
<p>=== Activation groups for rules</p>
</div>
<div class="paragraph">
<p>An activation group is a set of rules bound together by the same <code>activation-group</code> rule attribute. In this group, only one rule can be executed. After conditions are met for a rule in that group to be executed, all other pending rule executions from that activation group are removed from the agenda.</p>
</div>
<div class="paragraph">
<p>For example, the following sample DRL rules belong to the specified activation group and are listed in the {DECISION_ENGINE} stack in the order shown:</p>
</div>
<div class="listingblock">
<div class="title">Sample DRL rules for banking</div>
<div class="content">
<pre class="highlight"><code>rule "Print balance for AccountPeriod1"
activation-group "report"
  when
    ap : AccountPeriod1()
    acc : Account()
  then
    System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Print balance for AccountPeriod2"
activation-group "report"
  when
    ap : AccountPeriod2()
    acc : Account()
  then
    System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example, if the first rule in the <code>"report"</code> activation group is executed, the second rule in the group and all other executable rules on the agenda are removed from the agenda.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example CEP application code with the {DECISION_ENGINE} in active mode</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();
config.setOption( ClockTypeOption.get("realtime") );
KieSession session = kbase.newKieSession( conf, null );

new Thread( new Runnable() {
  @Override
  public void run() {
      session.fireUntilHalt();
  }
} ).start();

session.insert( tick1 );

... Thread.sleep( 1000L ); ...

session.insert( tick2 );

... Thread.sleep( 1000L ); ...

session.insert( tick3 );

session.halt();
session.dispose();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example calls <code>fireUntilHalt()</code> from a dedicated execution thread to prevent the current thread from being blocked indefinitely while the {DECISION_ENGINE} continues evaluating rules. The dedicated thread also enables you to call <code>halt()</code> at a later stage in the application code.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Although you should avoid using both <code>fireAllRules()</code> and <code>fireUntilHalt()</code> calls, especially from different threads, the {DECISION_ENGINE} can handle such situations safely using thread-safety logic and an internal state machine. If a <code>fireAllRules()</code> call is in progress and you call <code>fireUntilHalt()</code>, the {DECISION_ENGINE} continues to run in passive mode until the <code>fireAllRules()</code> operation is complete and then starts in active mode in response to the <code>fireUntilHalt()</code> call. However, if the {DECISION_ENGINE} is running in active mode following a <code>fireUntilHalt()</code> call and you call <code>fireAllRules()</code>, the <code>fireAllRules()</code> call is ignored and the {DECISION_ENGINE} continues to run in active mode until you call <code>halt()</code>.</p>
</div>
<div class="paragraph">
<p>For added thread safety in active mode, the {DECISION_ENGINE} supports a <code>submit()</code> method that you can use to group and perform operations on a KIE session in a thread-safe, atomic action:</p>
</div>
<div class="listingblock">
<div class="title">Example application code with <code>submit()</code> method to perform atomic operations in active mode</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieSession session = ...;

new Thread( new Runnable() {
  @Override
  public void run() {
      session.fireUntilHalt();
  }
} ).start();

final FactHandle fh = session.insert( fact_a );

... Thread.sleep( 1000L ); ...

session.submit( new KieSession.AtomicAction() {
  @Override
  public void execute( KieSession kieSession ) {
    fact_a.setField("value");
    kieSession.update( fh, fact_a );
    kieSession.insert( fact_1 );
    kieSession.insert( fact_2 );
    kieSession.insert( fact_3 );
  }
} );

... Thread.sleep( 1000L ); ...

session.insert( fact_z );

session.halt();
session.dispose();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Thread safety and atomic operations are also helpful from a client-side perspective. For example, you might need to insert more than one fact at a given time, but require the {DECISION_ENGINE} to consider the insertions as an atomic operation and to wait until all the insertions are complete before evaluating the rules again.</p>
</div>
<div id="con-fact-propagation-modes_kogito-developing-decision-services" class="paragraph">
<p>=== Fact propagation modes in the {DECISION_ENGINE}</p>
</div>
<div class="paragraph">
<p><strong>&lt;@Edoardo, also this section. This is coupled with rule execution modes and also came up a lot in 7.x and is/was a hot topic.&gt;</strong></p>
</div>
<div class="paragraph _abstract">
<p>The {DECISION_ENGINE} supports the following fact propagation modes that determine how the {DECISION_ENGINE} progresses inserted facts through the engine network in preparation for rule execution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Lazy</strong>: (Default) Facts are propagated in batch collections at rule execution, not in real time as the facts are individually inserted by a user or application. As a result, the order in which the facts are ultimately propagated through the {DECISION_ENGINE} may be different from the order in which the facts were individually inserted.</p>
</li>
<li>
<p><strong>Immediate</strong>: Facts are propagated immediately in the order that they are inserted by a user or application.</p>
</li>
<li>
<p><strong>Eager</strong>: Facts are propagated lazily (in batch collections), but before rule execution. The {DECISION_ENGINE} uses this propagation behavior for rules that have the <code>no-loop</code> or <code>lock-on-active</code> attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, the Phreak rule algorithm in the {DECISION_ENGINE} uses lazy fact propagation for improved rule evaluation overall. However, in few cases, this lazy propagation behavior can alter the expected result of certain rule executions that may require immediate or eager propagation.</p>
</div>
<div class="paragraph">
<p>For example, the following rule uses a specified query with a <code>?</code> prefix to invoke the query in pull-only or passive fashion:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with a passive query</div>
<div class="content">
<pre class="highlight"><code>query Q (Integer i)
    String( this == i.toString() )
end

rule "Rule"
  when
    $i : Integer()
    ?Q( $i; )
  then
    System.out.println( $i );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example, the rule should be executed only when a <code>String</code> that satisfies the query is inserted before the <code>Integer</code>, such as in the following example commands:</p>
</div>
<div class="listingblock">
<div class="title">Example commands that should trigger the rule execution</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieSession ksession = ...
ksession.insert("1");
ksession.insert(1);
ksession.fireAllRules();</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, due to the default lazy propagation behavior in Phreak, the {DECISION_ENGINE} does not detect the insertion sequence of the two facts in this case, so this rule is executed regardless of <code>String</code> and <code>Integer</code> insertion order. For this example, immediate propagation is required for the expected rule evaluation.</p>
</div>
<div class="paragraph">
<p>To alter the {DECISION_ENGINE} propagation mode to achieve the expected rule evaluation in this case, you can add the <code>@Propagation(<em>TYPE</em>)</code> tag to your rule and set <code><em>TYPE</em></code> to <code>LAZY</code>, <code>IMMEDIATE</code>, or <code>EAGER</code>.</p>
</div>
<div class="paragraph">
<p>In the same example rule, the immediate propagation annotation enables the rule to be evaluated only when a <code>String</code> that satisfies the query is inserted before the <code>Integer</code>, as expected:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with a passive query and specified propagation mode</div>
<div class="content">
<pre class="highlight"><code>query Q (Integer i)
    String( this == i.toString() )
end

rule "Rule" @Propagation(IMMEDIATE)
  when
    $i : Integer()
    ?Q( $i; )
  then
    System.out.println( $i );
end</code></pre>
</div>
</div>
<div id="con-agenda-filters_kogito-developing-decision-services" class="paragraph">
<p>=== Agenda evaluation filters</p>
</div>
<div class="paragraph">
<p><strong>&lt;@Edoardo, see this section.&gt;</strong></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="UserGuide/AgendaFilter.png" alt="AgendaFilter">
</div>
<div class="title">Figure 196. AgendaFilters</div>
</div>
<div class="paragraph _abstract">
<p>The {DECISION_ENGINE} supports an <code>AgendaFilter</code> object in the filter interface that you can use to allow or deny the evaluation of specified rules during agenda evaluation. You can specify an agenda filter as part of a <code>fireAllRules()</code> call.</p>
</div>
<div class="paragraph">
<p>The following example code permits only rules ending with the string <code>"Test"</code> to be evaluated and executed. All other rules are filtered out of the {DECISION_ENGINE} agenda.</p>
</div>
<div class="listingblock">
<div class="title">Example agenda filter definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ksession.fireAllRules( new RuleNameEndsWithAgendaFilter( "Test" ) );</code></pre>
</div>
</div>
<div id="con-rule-base-configuration_kogito-developing-decision-services" class="paragraph">
<p>=== Rule base configuration</p>
</div>
<div class="paragraph">
<p><strong>&lt;@Edoardo, see this section.&gt;</strong></p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} contains a <code>RuleBaseConfiguration.java</code> object that you can use to configure exception handler settings, multithreaded execution, and sequential mode in the {DECISION_ENGINE}.</p>
</div>
<div class="paragraph">
<p>For the rule base configuration options,
see the {PRODUCT} <a href="https://github.com/kiegroup/drools/blob/{COMMUNITY_VERSION_BRANCH}/drools-core/src/main/java/org/drools/core/RuleBaseConfiguration.java">RuleBaseConfiguration.java</a> page in GitHub.</p>
</div>
<div class="paragraph">
<p>The following rule base configuration options are available for the {DECISION_ENGINE}:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">drools.consequenceExceptionHandler</dt>
<dd>
<p>When configured, this system property defines the class that manages the exceptions thrown by rule consequences. You can use this property to specify a custom exception handler for rule evaluation in the {DECISION_ENGINE}.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default value: <code>org.drools.core.runtime.rule.impl.DefaultConsequenceExceptionHandler</code></p>
</div>
<div class="paragraph">
<p>You can specify the custom exception handler using one of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the exception handler in a system property:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>drools.consequenceExceptionHandler=org.drools.core.runtime.rule.impl.MyCustomConsequenceExceptionHandler</code></pre>
</div>
</div>
</li>
<li>
<p>Specify the exception handler while creating the KIE base programmatically:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration(); kieBaseConf.setOption(ConsequenceExceptionHandlerOption.get(MyCustomConsequenceExceptionHandler.class));
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">drools.multithreadEvaluation</dt>
<dd>
<p>When enabled, this system property enables the {DECISION_ENGINE} to evaluate rules in parallel by dividing the Phreak rule network into independent partitions. You can use this property to increase the speed of rule evaluation for specific rule bases.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default value: <code>false</code></p>
</div>
<div class="paragraph">
<p>You can enable multithreaded evaluation using one of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enable the multithreaded evaluation system property:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>drools.multithreadEvaluation=true</code></pre>
</div>
</div>
</li>
<li>
<p>Enable multithreaded evaluation while creating the KIE base programmatically:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(MultithreadEvaluationOption.YES);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Rules that use queries, salience, or agenda groups are currently not supported by the parallel {DECISION_ENGINE}. If these rule elements are present in the KIE base, the compiler emits a warning and automatically switches back to single-threaded evaluation. However, in some cases, the {DECISION_ENGINE} might not detect the unsupported rule elements and rules might be evaluated incorrectly. For example, the {DECISION_ENGINE} might not detect when rules rely on implicit salience given by rule ordering inside the DRL file, resulting in incorrect evaluation due to the unsupported salience attribute.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">drools.sequential</dt>
<dd>
<p>When enabled, this system property enables sequential mode in the {DECISION_ENGINE}. In sequential mode, the {DECISION_ENGINE} evaluates rules one time in the order that they are listed in the {DECISION_ENGINE} agenda without regard to changes in the working memory. This means that the {DECISION_ENGINE} ignores any <code>insert</code>, <code>modify</code>, or <code>update</code> statements in rules and executes rules in a single sequence. As a result, rule execution may be faster in sequential mode, but important updates may not be applied to your rules. You can use this property if you use stateless KIE sessions and you do not want the execution of rules to influence subsequent rules in the agenda. Sequential mode applies to stateless KIE sessions only.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Default value: <code>false</code></p>
</div>
<div class="paragraph">
<p>You can enable sequential mode using one of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enable the sequential mode system property:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>drools.sequential=true</code></pre>
</div>
</div>
</li>
<li>
<p>Enable sequential mode while creating the KIE base programmatically:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(SequentialOption.YES);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</code></pre>
</div>
</div>
</li>
<li>
<p>Enable sequential mode in the KIE module descriptor file (<code>kmodule.xml</code>) for a specific {PRODUCT} project:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" sequential="true" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div id="con-phreak-sequential-mode_kogito-developing-decision-services" class="paragraph">
<p>=== Sequential mode in Phreak</p>
</div>
<div class="paragraph">
<p><strong>&lt;@Edoardo, see this section. This was another hot topic in 7.x.&gt;</strong></p>
</div>
<div class="paragraph _abstract">
<p>Sequential mode is an advanced rule base configuration in the {DECISION_ENGINE}, supported by Phreak, that enables the {DECISION_ENGINE} to evaluate rules one time in the order that they are listed in the {DECISION_ENGINE} agenda without regard to changes in the working memory. In sequential mode, the {DECISION_ENGINE} ignores any <code>insert</code>, <code>modify</code>, or <code>update</code> statements in rules and executes rules in a single sequence. As a result, rule execution may be faster in sequential mode, but important updates may not be applied to your rules.</p>
</div>
<div class="paragraph">
<p>Sequential mode applies to only stateless KIE sessions because stateful KIE sessions inherently use data from previously invoked KIE sessions. If you use a stateless KIE session and you want the execution of rules to influence subsequent rules in the agenda, then do not enable sequential mode. Sequential mode is disabled by default in the {DECISION_ENGINE}.</p>
</div>
<div class="paragraph">
<p>To enable sequential mode, use one of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the system property <code>drools.sequential</code> to <code>true</code>.</p>
</li>
<li>
<p>Enable sequential mode while creating the KIE base programmatically:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(SequentialOption.YES);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</code></pre>
</div>
</div>
</li>
<li>
<p>Enable sequential mode in the KIE module descriptor file (<code>kmodule.xml</code>) for a specific {PRODUCT} project:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" sequential="true" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure sequential mode to use a dynamic agenda, use one of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the system property <code>drools.sequential.agenda</code> to <code>dynamic</code>.</p>
</li>
<li>
<p>Set the sequential agenda option while creating the KIE base programmatically:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">KieServices ks = KieServices.Factory.get();
KieBaseConfiguration kieBaseConf = ks.newKieBaseConfiguration();
kieBaseConf.setOption(SequentialAgendaOption.DYNAMIC);
KieBase kieBase = kieContainer.newKieBase(kieBaseConf);</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you enable sequential mode, the {DECISION_ENGINE} evaluates rules in the following way:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Rules are ordered by salience and position in the rule set.</p>
</li>
<li>
<p>An element for each possible rule match is created. The element position indicates the execution order.</p>
</li>
<li>
<p>Node memory is disabled, with the exception of the right-input object memory.</p>
</li>
<li>
<p>The left-input adapter node propagation is disconnected and the object with the node is referenced in a <code>Command</code> object. The <code>Command</code> object is added to a list in the working memory for later execution.</p>
</li>
<li>
<p>All objects are asserted, and then the list of <code>Command</code> objects is checked and executed.</p>
</li>
<li>
<p>All matches that result from executing the list are added to elements based on the sequence number of the rule.</p>
</li>
<li>
<p>The elements that contain matches are executed in a sequence. If you set a maximum number of rule executions, the {DECISION_ENGINE} activates no more than that number of rules in the agenda for execution.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In sequential mode, the <code>LeftInputAdapterNode</code> node creates a <code>Command</code> object and adds it to a list in the working memory of the {DECISION_ENGINE}. This <code>Command</code> object contains references to the <code>LeftInputAdapterNode</code> node and the propagated object. These references stop any left-input propagations at insertion time so that the right-input propagation never needs to attempt to join the left inputs. The references also avoid the need for the left-input memory.</p>
</div>
<div class="paragraph">
<p>All nodes have their memory turned off, including the left-input tuple memory, but excluding the right-input object memory. After all the assertions are finished and the right-input memory of all the objects is populated, the {DECISION_ENGINE} iterates over the list of <code>LeftInputAdatperNode</code> <code>Command</code> objects. The objects propagate down the network, attempting to join the right-input objects, but they are not retained in the left input.</p>
</div>
<div class="paragraph">
<p>The agenda with a priority queue to schedule the tuples is replaced by an element for each rule. The sequence number of the <code>RuleTerminalNode</code> node indicates the element where to place the match. After all <code>Command</code> objects have finished, the elements are checked and existing matches are executed. To improve performance, the first and the last populated cell in the elements are retained.</p>
</div>
<div class="paragraph">
<p>When the network is constructed, each <code>RuleTerminalNode</code> node receives a sequence number based on its salience number and the order in which it was added to the network.</p>
</div>
<div class="paragraph">
<p>The right-input node memories are typically hash maps for fast object deletion. Because object deletions are not supported, Phreak uses an object list when the values of the object are not indexed. For a large number of objects, indexed hash maps provide a performance increase. If an object has only a few instances, Phreak uses an object list instead of an index.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Disable default property reactivity in a DRL type declaration</div>
<div class="content">
<pre class="highlight"><code>declare Person
  @classReactive
    firstName : String
    lastName : String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Disable default property reactivity in a Java class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@classReactive
public static class Person {
    private String firstName;
    private String lastName;
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">@propertyReactive</dt>
<dd>
<p>If property reactivity is set to <code>ALLOWED</code> in the {DECISION_ENGINE} (no types are property reactive unless specified), this tag enables property reactivity for a specific Java class or a declared DRL fact type. You can use this tag if you want the {DECISION_ENGINE} to react only to modified properties that are constrained or bound inside a given pattern for the specified fact type, instead of re-evaluating all fact patterns for the fact each time the rule is triggered.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Enable property reactivity in a DRL type declaration (when reactivity is disabled globally)</div>
<div class="content">
<pre class="highlight"><code>declare Person
  @propertyReactive
    firstName : String
    lastName : String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Enable property reactivity in a Java class (when reactivity is disabled globally)</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@propertyReactive
public static class Person {
    private String firstName;
    private String lastName;
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">

</div>
</div>
<div class="paragraph">
<p>Default parameter: None</p>
</div>
<div class="paragraph">
<p>Supported parameters: Property name, <code>*</code> (all), <code>!</code> (not), <code>!*</code> (no properties)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;factPattern&gt; @watch ( &lt;property&gt; )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Enable or disable property reactivity in fact patterns</div>
<div class="content">
<pre class="highlight"><code>// Listens for changes in both `firstName` (inferred) and `lastName`:
Person(firstName == $expectedFirstName) @watch( lastName )

// Listens for changes in all properties of the `Person` fact:
Person(firstName == $expectedFirstName) @watch( * )

// Listens for changes in `lastName` and explicitly excludes changes in `firstName`:
Person(firstName == $expectedFirstName) @watch( lastName, !firstName )

// Listens for changes in all properties of the `Person` fact except `age`:
Person(firstName == $expectedFirstName) @watch( *, !age )

// Excludes changes in all properties of the `Person` fact (equivalent to using `@classReactivity` tag):
Person(firstName == $expectedFirstName) @watch( !* )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} generates a compilation error if you use the <code>@watch</code> tag for properties in a fact type that uses the <code>@classReactive</code> tag (disables property reactivity) or when property reactivity is set to <code>ALLOWED</code> in the {DECISION_ENGINE} and the relevant fact type does not use the <code>@propertyReactive</code> tag. Compilation errors also arise if you duplicate properties in listener annotations, such as <code>@watch( firstName, ! firstName )</code>.</p>
</div>
<div class="openblock">
<div class="content">

</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare property change support in JavaBeans object</div>
<div class="content">
<pre class="highlight"><code>declare Person
    @propertyChangeSupport
end</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">

</div>
</div>
<div class="paragraph">
<p>Cloud mode does not impose any kind of additional requirements on facts. However, because the {DECISION_ENGINE} in this mode has no concept of time, it cannot use temporal features such as sliding windows or automatic life-cycle management. In cloud mode, events must be explicitly retracted when they are no longer needed.</p>
</div>
<div class="paragraph">
<p>The following requirements are not imposed in cloud mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No clock synchronization because the {DECISION_ENGINE} has no notion of time</p>
</li>
<li>
<p>No ordering of events because the {DECISION_ENGINE} processes events as an unordered cloud, against which the {DECISION_ENGINE} match rules</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can specify cloud mode either by setting the system property in the relevant configuration files or by using the Java client API:</p>
</div>
<div class="listingblock">
<div class="title">Set cloud mode using system property</div>
<div class="content">
<pre class="highlight"><code>drools.eventProcessingMode=cloud</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Set cloud mode using Java client API</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.kie.api.conf.EventProcessingOption;
import org.kie.api.KieBaseConfiguration;
import org.kie.api.KieServices.Factory;

KieBaseConfiguration config = KieServices.Factory.get().newKieBaseConfiguration();

config.setOption(EventProcessingOption.CLOUD);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify cloud mode using the <code>eventProcessingMode="&lt;mode&gt;"</code> KIE base attribute in the KIE module descriptor file (<code>kmodule.xml</code>) for a specific {PRODUCT} project:</p>
</div>
<div class="listingblock">
<div class="title">Set cloud mode using project <code>kmodule.xml</code> file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" eventProcessingMode="cloud" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Stream mode</dt>
<dd>
<p>Stream mode enables the {DECISION_ENGINE} to process events chronologically and in real time as they are inserted into the {DECISION_ENGINE}. In stream mode, the {DECISION_ENGINE} synchronizes streams of events (so that events in different streams can be processed in chronological order), implements sliding windows of time or length, and enables automatic life-cycle management.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The following requirements apply to stream mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Events in each stream must be ordered chronologically.</p>
</li>
<li>
<p>A session clock must be present to synchronize event streams.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Your application does not need to enforce ordering events between streams, but using event streams that have not been synchronized may cause unexpected results.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can specify stream mode either by setting the system property in the relevant configuration files or by using the Java client API:</p>
</div>
<div class="listingblock">
<div class="title">Set stream mode using system property</div>
<div class="content">
<pre class="highlight"><code>drools.eventProcessingMode=stream</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Set stream mode using Java client API</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.kie.api.conf.EventProcessingOption;
import org.kie.api.KieBaseConfiguration;
import org.kie.api.KieServices.Factory;

KieBaseConfiguration config = KieServices.Factory.get().newKieBaseConfiguration();

config.setOption(EventProcessingOption.STREAM);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify stream mode using the <code>eventProcessingMode="&lt;mode&gt;"</code> KIE base attribute in the KIE module descriptor file (<code>kmodule.xml</code>) for a specific {PRODUCT} project:</p>
</div>
<div class="listingblock">
<div class="title">Set stream mode using project <code>kmodule.xml</code> file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;kmodule&gt;
  ...
  &lt;kbase name="KBase2" default="false" eventProcessingMode="stream" packages="org.domain.pkg2, org.domain.pkg3" includes="KBase1"&gt;
    ...
  &lt;/kbase&gt;
  ...
&lt;/kmodule&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-cep-negative-patterns_kogito-developing-decision-services" class="paragraph">
<p>==== Negative patterns in {DECISION_ENGINE} stream mode</p>
</div>
<div class="paragraph _abstract">
<p>A negative pattern is a pattern for conditions that are not met. For example, the following DRL rule activates a fire alarm if a fire is detected and the sprinkler is not activated:</p>
</div>
<div class="listingblock">
<div class="title">Fire alarm rule with a negative pattern</div>
<div class="content">
<pre class="highlight"><code>rule "Sound the alarm"
when
  $f : FireDetected()
  not(SprinklerActivated())
then
  // Sound the alarm.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In cloud mode, the {DECISION_ENGINE} assumes all facts (regular facts and events) are known in advance and evaluates negative patterns immediately. In stream mode, the {DECISION_ENGINE} can support temporal constraints on facts to wait for a set time before activating a rule.</p>
</div>
<div class="paragraph">
<p>The same example rule in stream mode activates the fire alarm as usual, but applies a 10-second delay.</p>
</div>
<div class="listingblock">
<div class="title">Fire alarm rule with a negative pattern and time delay (stream mode only)</div>
<div class="content">
<pre class="highlight"><code>rule "Sound the alarm"
when
  $f : FireDetected()
  not(SprinklerActivated(this after[0s,10s] $f))
then
  // Sound the alarm.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following modified fire alarm rule expects one <code>Heartbeat</code> event to occur every 10 seconds. If the expected event does not occur, the rule is executed. This rule uses the same type of object in both the first pattern and in the negative pattern. The negative pattern has the temporal constraint to wait 0 to 10 seconds before executing and excludes the <code>Heartbeat</code> event bound to <code>$h</code> so that the rule can be executed. The bound event <code>$h</code> must be explicitly excluded in order for the rule to be executed because the temporal constraint <code>[0s, &#8230;&#8203;]</code> does not inherently exclude that event from being matched again.</p>
</div>
<div class="listingblock">
<div class="title">Fire alarm rule excluding a bound event in a negative pattern (stream mode only)</div>
<div class="content">
<pre class="highlight"><code>rule "Sound the alarm"
when
  $h: Heartbeat() from entry-point "MonitoringStream"
  not(Heartbeat(this != $h, this after[0s,10s] $h) from entry-point "MonitoringStream")
then
  // Sound the alarm.
end</code></pre>
</div>
</div>
<div id="ref-cep-temporal-operators_kogito-developing-decision-services" class="paragraph">
<p>=== Temporal operators for events</p>
</div>
<div class="paragraph _abstract">
<p>In stream mode, the {DECISION_ENGINE} supports the following temporal operators for events that are inserted into the working memory of the {DECISION_ENGINE}. You can use these operators to define the temporal reasoning behavior of the events that you declare in your Java class or DRL rule file. Temporal operators are not supported when the {DECISION_ENGINE} is running in cloud mode.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>after</code></p>
</li>
<li>
<p><code>before</code></p>
</li>
<li>
<p><code>coincides</code></p>
</li>
<li>
<p><code>during</code></p>
</li>
<li>
<p><code>includes</code></p>
</li>
<li>
<p><code>finishes</code></p>
</li>
<li>
<p><code>finished by</code></p>
</li>
<li>
<p><code>meets</code></p>
</li>
<li>
<p><code>met by</code></p>
</li>
<li>
<p><code>overlaps</code></p>
</li>
<li>
<p><code>overlapped by</code></p>
</li>
<li>
<p><code>starts</code></p>
</li>
<li>
<p><code>started by</code></p>
<div class="dlist">
<dl>
<dt class="hdlist1">after</dt>
</dl>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>This operator specifies if the current event occurs after the correlated event. This operator can also define an amount of time after which the current event can follow the correlated event, or a delimiting time range during which the current event can follow the correlated event.</p>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> starts between 3 minutes and 30 seconds and 4 minutes after <code>$eventB</code> finishes. If <code>$eventA</code> starts earlier than 3 minutes and 30 seconds after <code>$eventB</code> finishes, or later than 4 minutes after <code>$eventB</code> finishes, then the pattern is not matched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this after[3m30s, 4m] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>3m30s &lt;= $eventA.startTimestamp - $eventB.endTimeStamp &lt;= 4m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>after</code> operator supports up to two parameter values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If two values are defined, the interval starts on the first value (3 minutes and 30 seconds in the example) and ends on the second value (4 minutes in the example).</p>
</li>
<li>
<p>If only one value is defined, the interval starts on the provided value and runs indefinitely with no end time.</p>
</li>
<li>
<p>If no value is defined, the interval starts at 1 millisecond and runs indefinitely with no end time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>after</code> operator also supports negative time ranges:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this after[-3m30s, -2m] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the first value is greater than the second value, the {DECISION_ENGINE} automatically reverses them. For example, the following two patterns are interpreted by the {DECISION_ENGINE} in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this after[-3m30s, -2m] $eventB)
$eventA : EventA(this after[-2m, -3m30s] $eventB)</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">before</dt>
<dd>
<p>This operator specifies if the current event occurs before the correlated event. This operator can also define an amount of time before which the current event can precede the correlated event, or a delimiting time range during which the current event can precede the correlated event.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> finishes between 3 minutes and 30 seconds and 4 minutes before <code>$eventB</code> starts. If <code>$eventA</code> finishes earlier than 3 minutes and 30 seconds before <code>$eventB</code> starts, or later than 4 minutes before <code>$eventB</code> starts, then the pattern is not matched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this before[3m30s, 4m] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>3m30s &lt;= $eventB.startTimestamp - $eventA.endTimeStamp &lt;= 4m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>before</code> operator supports up to two parameter values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If two values are defined, the interval starts on the first value (3 minutes and 30 seconds in the example) and ends on the second value (4 minutes in the example).</p>
</li>
<li>
<p>If only one value is defined, the interval starts on the provided value and runs indefinitely with no end time.</p>
</li>
<li>
<p>If no value is defined, the interval starts at 1 millisecond and runs indefinitely with no end time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>before</code> operator also supports negative time ranges:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this before[-3m30s, -2m] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the first value is greater than the second value, the {DECISION_ENGINE} automatically reverses them. For example, the following two patterns are interpreted by the {DECISION_ENGINE} in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this before[-3m30s, -2m] $eventB)
$eventA : EventA(this before[-2m, -3m30s] $eventB)</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">coincides</dt>
<dd>
<p>This operator specifies if the two events occur at the same time, with the same start and end times.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if both the start and end time stamps of <code>$eventA</code> and <code>$eventB</code> are identical:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this coincides $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>coincides</code> operator supports up to two parameter values for the distance between the event start and end times, if they are not identical:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If only one parameter is given, the parameter is used to set the threshold for both the start and end times of both events.</p>
</li>
<li>
<p>If two parameters are given, the first is used as a threshold for the start time and the second is used as a threshold for the end time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following pattern uses start and end time thresholds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this coincides[15s, 10s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pattern matches if the following conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs($eventA.startTimestamp - $eventB.startTimestamp) &lt;= 15s
&amp;&amp;
abs($eventA.endTimestamp - $eventB.endTimestamp) &lt;= 10s</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>coincides</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">during</dt>
<dd>
<p>This operator specifies if the current event occurs within the time frame of when the correlated event starts and ends. The current event must start after the correlated event starts and must end before the correlated event ends. (With the <code>coincides</code> operator, the start and end times are the same or nearly the same.)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> starts after <code>$eventB</code> starts and ends before <code>$eventB</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this during $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventB.startTimestamp &lt; $eventA.startTimestamp &lt;= $eventA.endTimestamp &lt; $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>during</code> operator supports one, two, or four optional parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If one value is defined, this value is the maximum distance between the start times of the two events and the maximum distance between the end times of the two events.</p>
</li>
<li>
<p>If two values are defined, these values are a threshold between which the current event start time and end time must occur in relation to the correlated event start and end times.</p>
<div class="paragraph">
<p>For example, if the values are <code>5s</code> and <code>10s</code>, the current event must start between 5 and 10 seconds after the correlated event starts and must end between 5 and 10 seconds before the correlated event ends.</p>
</div>
</li>
<li>
<p>If four values are defined, the first and second values are the minimum and maximum distances between the start times of the events, and the third and fourth values are the minimum and maximum distances between the end times of the two events.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">includes</dt>
<dd>
<p>This operator specifies if the correlated event occurs within the time frame of when the current event occurs. The correlated event must start after the current event starts and must end before the current event ends. (The behavior of this operator is the reverse of the <code>during</code> operator behavior.)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventB</code> starts after <code>$eventA</code> starts and ends before <code>$eventA</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this includes $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA.startTimestamp &lt; $eventB.startTimestamp &lt;= $eventB.endTimestamp &lt; $eventA.endTimestamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>includes</code> operator supports one, two, or four optional parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If one value is defined, this value is the maximum distance between the start times of the two events and the maximum distance between the end times of the two events.</p>
</li>
<li>
<p>If two values are defined, these values are a threshold between which the correlated event start time and end time must occur in relation to the current event start and end times.</p>
<div class="paragraph">
<p>For example, if the values are <code>5s</code> and <code>10s</code>, the correlated event must start between 5 and 10 seconds after the current event starts and must end between 5 and 10 seconds before the current event ends.</p>
</div>
</li>
<li>
<p>If four values are defined, the first and second values are the minimum and maximum distances between the start times of the events, and the third and fourth values are the minimum and maximum distances between the end times of the two events.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">finishes</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>This operator specifies if the current event starts after the correlated event but both events end at the same time.</p>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> starts after <code>$eventB</code> starts and ends at the same time when <code>$eventB</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this finishes $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventB.startTimestamp &lt; $eventA.startTimestamp
&amp;&amp;
$eventA.endTimestamp == $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>finishes</code> operator supports one optional parameter that sets the maximum time allowed between the end times of the two events:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this finishes[5s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern matches if these conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventB.startTimestamp &lt; $eventA.startTimestamp
&amp;&amp;
abs($eventA.endTimestamp - $eventB.endTimestamp) &lt;= 5s</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>finishes</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">finished by</dt>
<dd>
<p>This operator specifies if the correlated event starts after the current event but both events end at the same time. (The behavior of this operator is the reverse of the <code>finishes</code> operator behavior.)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventB</code> starts after <code>$eventA</code> starts and ends at the same time when <code>$eventA</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this finishedby $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA.startTimestamp &lt; $eventB.startTimestamp
&amp;&amp;
$eventA.endTimestamp == $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>finished by</code> operator supports one optional parameter that sets the maximum time allowed between the end times of the two events:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this finishedby[5s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern matches if these conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA.startTimestamp &lt; $eventB.startTimestamp
&amp;&amp;
abs($eventA.endTimestamp - $eventB.endTimestamp) &lt;= 5s</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>finished by</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">meets</dt>
<dd>
<p>This operator specifies if the current event ends at the same time when the correlated event starts.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> ends at the same time when <code>$eventB</code> starts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this meets $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs($eventB.startTimestamp - $eventA.endTimestamp) == 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>meets</code> operator supports one optional parameter that sets the maximum time allowed between the end time of the current event and the start time of the correlated event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this meets[5s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern matches if these conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs($eventB.startTimestamp - $eventA.endTimestamp) &lt;= 5s</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>meets</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">met by</dt>
<dd>
<p>This operator specifies if the correlated event ends at the same time when the current event starts. (The behavior of this operator is the reverse of the <code>meets</code> operator behavior.)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventB</code> ends at the same time when <code>$eventA</code> starts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this metby $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs($eventA.startTimestamp - $eventB.endTimestamp) == 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>met by</code> operator supports one optional parameter that sets the maximum distance between the end time of the correlated event and the start time of the current event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this metby[5s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern matches if these conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs($eventA.startTimestamp - $eventB.endTimestamp) &lt;= 5s</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>met by</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">overlaps</dt>
<dd>
<p>This operator specifies if the current event starts before the correlated event starts and it ends during the time frame that the correlated event occurs. The current event must end between the start and end times of the correlated event.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> starts before <code>$eventB</code> starts and then ends while <code>$eventB</code> occurs, before <code>$eventB</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this overlaps $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>overlaps</code> operator supports up to two parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If one parameter is defined, the value is the maximum distance between the start time of the correlated event and the end time of the current event.</p>
</li>
<li>
<p>If two parameters are defined, the values are the minimum distance (first value) and the maximum distance (second value) between the start time of the correlated event and the end time of the current event.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">overlapped by</dt>
<dd>
<p>This operator specifies if the correlated event starts before the current event starts and it ends during the time frame that the current event occurs. The correlated event must end between the start and end times of the current event. (The behavior of this operator is the reverse of the <code>overlaps</code> operator behavior.)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventB</code> starts before <code>$eventA</code> starts and then ends while <code>$eventA</code> occurs, before <code>$eventA</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this overlappedby $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>overlapped by</code> operator supports up to two parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If one parameter is defined, the value is the maximum distance between the start time of the current event and the end time of the correlated event.</p>
</li>
<li>
<p>If two parameters are defined, the values are the minimum distance (first value) and the maximum distance (second value) between the start time of the current event and the end time of the correlated event.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">starts</dt>
<dd>
<p>This operator specifies if the two events start at the same time but the current event ends before the correlated event ends.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> and <code>$eventB</code> start at the same time, and <code>$eventA</code> ends before <code>$eventB</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this starts $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA.startTimestamp == $eventB.startTimestamp
&amp;&amp;
$eventA.endTimestamp &lt; $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>starts</code> operator supports one optional parameter that sets the maximum distance between the start times of the two events:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this starts[5s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern matches if these conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs($eventA.startTimestamp - $eventB.startTimestamp) &lt;= 5s
&amp;&amp;
$eventA.endTimestamp &lt; $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>starts</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">started by</dt>
<dd>
<p>This operator specifies if the two events start at the same time but the correlated event ends before the current event ends. (The behavior of this operator is the reverse of the <code>starts</code> operator behavior.)</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following pattern matches if <code>$eventA</code> and <code>$eventB</code> start at the same time, and <code>$eventB</code> ends before <code>$eventA</code> ends:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA(this startedby $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also express this operator in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA.startTimestamp == $eventB.startTimestamp
&amp;&amp;
$eventA.endTimestamp &gt; $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>started by</code> operator supports one optional parameter that sets the maximum distance between the start times of the two events:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$eventA : EventA( this starts[5s] $eventB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This pattern matches if these conditions are met:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>abs( $eventA.startTimestamp - $eventB.startTimestamp ) &lt;= 5s
&amp;&amp;
$eventA.endTimestamp &gt; $eventB.endTimestamp</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The {DECISION_ENGINE} does not support negative intervals for the <code>started by</code> operator. If you use negative intervals, the {DECISION_ENGINE} generates an error.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div id="ref-cep-clock_kogito-developing-decision-services" class="paragraph">
<p>=== Session clock implementations in the {DECISION_ENGINE}</p>
</div>
<div class="paragraph _abstract">
<p>During complex event processing, events in the {DECISION_ENGINE} may have temporal constraints and therefore require a session clock that provides the current time. For example, if a rule needs to determine the average price of a given stock over the last 60 minutes, the {DECISION_ENGINE} must be able to compare the stock price event time stamp with the current time in the session clock.</p>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} supports a real-time clock and a pseudo clock. You can use one or both clock types depending on the scenario:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Rules testing:</strong> Testing requires a controlled environment, and when the tests include rules with temporal constraints, you must be able to control the input rules and facts and the flow of time.</p>
</li>
<li>
<p><strong>Regular execution:</strong> The {DECISION_ENGINE} reacts to events in real time and therefore requires a real-time clock.</p>
</li>
<li>
<p><strong>Special environments:</strong> Specific environments may have specific time control requirements. For example, clustered environments may require clock synchronization or Java Enterprise Edition (JEE) environments may require a clock provided by the application server.</p>
</li>
<li>
<p><strong>Rules replay or simulation:</strong> In order to replay or simulate scenarios, the application must be able to control the flow of time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Consider your environment requirements as you decide whether to use a real-time clock or pseudo clock in the {DECISION_ENGINE}.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Real-time clock</dt>
<dd>
<p>The real-time clock is the default clock implementation in the {DECISION_ENGINE} and uses the system clock to determine the current time for time stamps. To configure the {DECISION_ENGINE} to use the real-time clock, set the KIE session configuration parameter to <code>realtime</code>:</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Configure real-time clock in KIE session</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.kie.api.KieServices.Factory;
import org.kie.api.runtime.conf.ClockTypeOption;
import org.kie.api.runtime.KieSessionConfiguration;

KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();

config.setOption(ClockTypeOption.get("realtime"));</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Pseudo clock</dt>
<dd>
<p>The pseudo clock implementation in the {DECISION_ENGINE} is helpful for testing temporal rules and it can be controlled by the application. To configure the {DECISION_ENGINE} to use the pseudo clock, set the KIE session configuration parameter to <code>pseudo</code>:</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Configure pseudo clock in KIE session</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.kie.api.runtime.conf.ClockTypeOption;
import org.kie.api.runtime.KieSessionConfiguration;
import org.kie.api.KieServices.Factory;

KieSessionConfiguration config = KieServices.Factory.get().newKieSessionConfiguration();

config.setOption(ClockTypeOption.get("pseudo"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use additional configurations and fact handlers to control the pseudo clock:</p>
</div>
<div class="listingblock">
<div class="title">Control pseudo clock behavior in KIE session</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.util.concurrent.TimeUnit;

import org.kie.api.runtime.KieSessionConfiguration;
import org.kie.api.KieServices.Factory;
import org.kie.api.runtime.KieSession;
import org.drools.core.time.SessionPseudoClock;
import org.kie.api.runtime.rule.FactHandle;
import org.kie.api.runtime.conf.ClockTypeOption;

KieSessionConfiguration conf = KieServices.Factory.get().newKieSessionConfiguration();

conf.setOption( ClockTypeOption.get("pseudo"));
KieSession session = kbase.newKieSession(conf, null);

SessionPseudoClock clock = session.getSessionClock();

// While inserting facts, advance the clock as necessary.
FactHandle handle1 = session.insert(tick1);
clock.advanceTime(10, TimeUnit.SECONDS);

FactHandle handle2 = session.insert(tick2);
clock.advanceTime(30, TimeUnit.SECONDS);

FactHandle handle3 = session.insert(tick3);</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-cep-event-streams_kogito-developing-decision-services" class="paragraph">
<p>=== Event streams and entry points</p>
</div>
<div class="paragraph _abstract">
<p>The {DECISION_ENGINE} can process high volumes of events in the form of event streams. In DRL rule declarations, a stream is also known as an <em>entry point</em>. When you declare an entry point in a DRL rule or Java application, the {DECISION_ENGINE}, at compile time, identifies and creates the proper internal structures to use data from only that entry point to evaluate that rule.</p>
</div>
<div class="paragraph">
<p>Facts from one entry point, or stream, can join facts from any other entry point in addition to facts already in the working memory of the {DECISION_ENGINE}. Facts always remain associated with the entry point through which they entered the {DECISION_ENGINE}. Facts of the same type can enter the {DECISION_ENGINE} through several entry points, but facts that enter the {DECISION_ENGINE} through entry point A can never match a pattern from entry point B.</p>
</div>
<div class="paragraph">
<p>Event streams have the following characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Events in the stream are ordered by time stamp. The time stamps may have different semantics for different streams, but they are always ordered internally.</p>
</li>
<li>
<p>Event streams usually have a high volume of events.</p>
</li>
<li>
<p>Atomic events in streams are usually not useful individually, only collectively in a stream.</p>
</li>
<li>
<p>Event streams can be homogeneous and contain a single type of event, or heterogeneous and contain events of different types.</p>
</li>
</ul>
</div>
<div id="proc-cep-event-streams_kogito-developing-decision-services" class="paragraph">
<p>==== Declaring entry points for rule data</p>
</div>
<div class="paragraph _abstract">
<p>You can declare an entry point (event stream) for events so that the {DECISION_ENGINE} uses data from only that entry point to evaluate the rules. You can declare an entry point either implicitly by referencing it in DRL rules or explicitly in your Java application.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Use one of the following methods to declare the entry point:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the DRL rule file, specify <code>from entry-point "&lt;name&gt;"</code> for the inserted fact:</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Authorize withdrawal rule with "ATM Stream" entry point</div>
<div class="content">
<pre class="highlight"><code>rule "Authorize withdrawal"
when
  WithdrawRequest($ai : accountId, $am : amount) from entry-point "ATM Stream"
  CheckingAccount(accountId == $ai, balance &gt; $am)
then
  // Authorize withdrawal.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Apply fee rule with "Branch Stream" entry point</div>
<div class="content">
<pre class="highlight"><code>rule "Apply fee on withdraws on branches"
when
  WithdrawRequest($ai : accountId, processed == true) from entry-point "Branch Stream"
  CheckingAccount(accountId == $ai)
then
  // Apply a $2 fee on the account.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both example DRL rules from a banking application insert the event <code>WithdrawalRequest</code> with the fact <code>CheckingAccount</code>, but from different entry points. At run time, the {DECISION_ENGINE} evaluates the <code>Authorize withdrawal</code> rule using data from only the <code>"ATM Stream"</code> entry point, and evaluates the <code>Apply fee</code> rule using data from only the <code>"Branch Stream"</code> entry point. Any events inserted into the <code>"ATM Stream"</code> can never match patterns for the <code>"Apply fee"</code> rule, and any events inserted into the <code>"Branch Stream"</code> can never match patterns for the <code>"Authorize withdrawal rule"</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>In the Java application code, use the <code>getEntryPoint()</code> method to specify and obtain an <code>EntryPoint</code> object and insert facts into that entry point accordingly:</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Java application code with EntryPoint object and inserted facts</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.kie.api.runtime.KieSession;
import org.kie.api.runtime.rule.EntryPoint;

// Create your KIE base and KIE session as usual.
KieSession session = ...

// Create a reference to the entry point.
EntryPoint atmStream = session.getEntryPoint("ATM Stream");

// Start inserting your facts into the entry point.
atmStream.insert(aWithdrawRequest);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any DRL rules that specify <code>from entry-point "ATM Stream"</code> are then evaluated based on the data in this entry point only.</p>
</div>
<div class="openblock">
<div class="content">
<div id="con-cep-sliding-windows_kogito-developing-decision-services" class="paragraph">
<p>=== Sliding windows of time or length</p>
</div>
<div class="paragraph _abstract">
<p>In stream mode, the {DECISION_ENGINE} can process events from a specified sliding window of time or length. A sliding time window is a specified period of time during which events can be processed. A sliding length window is a specified number of events that can be processed. When you declare a sliding window in a DRL rule or Java application, the {DECISION_ENGINE}, at compile time, identifies and creates the proper internal structures to use data from only that sliding window to evaluate that rule.</p>
</div>
<div class="paragraph">
<p>For example, the following DRL rule snippets instruct the {DECISION_ENGINE} to process only the stock points from the last 2 minutes (sliding time window) or to process only the last 10 stock points (sliding length window):</p>
</div>
<div class="listingblock">
<div class="title">Process stock points from the last 2 minutes (sliding time window)</div>
<div class="content">
<pre class="highlight"><code>StockPoint() over window:time(2m)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Process the last 10 stock points (sliding length window)</div>
<div class="content">
<pre class="highlight"><code>StockPoint() over window:length(10)</code></pre>
</div>
</div>
<div id="proc-cep-sliding-windows_kogito-developing-decision-services" class="paragraph">
<p>==== Declaring sliding windows for rule data</p>
</div>
<div class="paragraph _abstract">
<p>You can declare a sliding window of time (flow of time) or length (number of occurrences) for events so that the {DECISION_ENGINE} uses data from only that window to evaluate the rules.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In the DRL rule file, specify <code>over window:&lt;time_or_length&gt;(&lt;value&gt;)</code> for the inserted fact.</p>
</div>
<div class="paragraph">
<p>For example, the following two DRL rules activate a fire alarm based on an average temperature. However, the first rule uses a sliding time window to calculate the average over the last 10 minutes while the second rule uses a sliding length window to calculate the average over the last one hundred temperature readings.</p>
</div>
<div class="listingblock">
<div class="title">Average temperature over sliding time window</div>
<div class="content">
<pre class="highlight"><code>rule "Sound the alarm if temperature rises above threshold"
when
  TemperatureThreshold($max : max)
  Number(doubleValue &gt; $max) from accumulate(
    SensorReading($temp : temperature) over window:time(10m),
    average($temp))
then
  // Sound the alarm.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Average temperature over sliding length window</div>
<div class="content">
<pre class="highlight"><code>rule "Sound the alarm if temperature rises above threshold"
when
  TemperatureThreshold($max : max)
  Number(doubleValue &gt; $max) from accumulate(
    SensorReading($temp : temperature) over window:length(100),
    average($temp))
then
  // Sound the alarm.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} discards any <code>SensorReading</code> events that are more than 10 minutes old or that are not part of the last one hundred readings, and continues recalculating the average as the minutes or readings "slide" forward in real time.</p>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} does not automatically remove outdated events from the KIE session because other rules without sliding window declarations might depend on those events. The {DECISION_ENGINE} stores events in the KIE session until the events expire either by explicit rule declarations or by implicit reasoning within the {DECISION_ENGINE} based on inferred data in the KIE base.</p>
</div>
<div id="con-cep-memory-management_kogito-developing-decision-services" class="paragraph">
<p>=== Memory management for events</p>
</div>
<div class="paragraph _abstract">
<p>In stream mode, the {DECISION_ENGINE} uses automatic memory management to maintain events that are stored in KIE sessions. The {DECISION_ENGINE} can retract from a KIE session any events that no longer match any rule due to their temporal constraints and release any resources held by the retracted events.</p>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} uses either explicit or inferred expiration to retract outdated events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Explicit expiration:</strong> The {DECISION_ENGINE} removes events that are explicitly set to expire in rules that declare the <code>@expires</code> tag:</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">DRL rule snippet with explicit expiration</div>
<div class="content">
<pre class="highlight"><code>declare StockPoint
  @expires( 30m )
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example rule sets any <code>StockPoint</code> events to expire after 30 minutes and to be removed from the KIE session if no other rules use the events.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Inferred expiration:</strong> The {DECISION_ENGINE} can calculate the expiration offset for a given event implicitly by analyzing the temporal constraints in the rules:</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">DRL rule with temporal constraints</div>
<div class="content">
<pre class="highlight"><code>rule "Correlate orders"
when
  $bo : BuyOrder($id : id)
  $ae : AckOrder(id == $id, this after[0,10s] $bo)
then
  // Perform an action.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example rule, the {DECISION_ENGINE} automatically calculates that whenever a <code>BuyOrder</code> event occurs, the {DECISION_ENGINE} needs to store the event for up to 10 seconds and wait for the matching <code>AckOrder</code> event. After 10 seconds, the {DECISION_ENGINE} infers the expiration and removes the event from the KIE session. An <code>AckOrder</code> event can only match an existing <code>BuyOrder</code> event, so the {DECISION_ENGINE} infers the expiration if no match occurs and removes the event immediately.</p>
</div>
<div class="paragraph">
<p>The {DECISION_ENGINE} analyzes the entire KIE base to find the offset for every event type and to ensure that no other rules use the events that are pending removal. Whenever an implicit expiration clashes with an explicit expiration value, the {DECISION_ENGINE} uses the greater time frame of the two to store the event longer.</p>
</div>
<div class="openblock">
<div class="content">
<div id="con-engine-queries_kogito-developing-decision-services" class="paragraph">
<p>== {DECISION_ENGINE_CAP} queries and live queries</p>
</div>
<div class="paragraph">
<p><strong>&lt;@Edoardo, so verdict on this?&gt;</strong></p>
</div>
<div class="paragraph _abstract">
<p>You can use queries with the {DECISION_ENGINE} to retrieve fact sets based on fact patterns as they are used in rules. The patterns might also use optional parameters.</p>
</div>
<div class="paragraph">
<p>To use queries with the {DECISION_ENGINE}, you add the query definitions in DRL files and then obtain the matching results in your application code. While a query iterates over a result collection, you can use any identifier that is bound to the query to access the corresponding fact or fact field by calling the <code>get()</code> method with the binding variable name as the argument. If the binding refers to a fact object, you can retrieve the fact handle by calling <code>getFactHandle()</code> with the variable name as the parameter.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="UserGuide/QueryResults.png" alt="QueryResults">
</div>
<div class="title">Figure 197. QueryResults</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="UserGuide/QueryResultsRow.png" alt="QueryResultsRow">
</div>
<div class="title">Figure 198. QueryResultsRow</div>
</div>
<div class="listingblock">
<div class="title">Example query definition in a DRL file</div>
<div class="content">
<pre class="highlight"><code>query "people under the age of 21"
    $person : Person( age &lt; 21 )
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example application code to obtain and iterate over query results</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">QueryResults results = ksession.getQueryResults( "people under the age of 21" );
System.out.println( "we have " + results.size() + " people under the age of 21" );

System.out.println( "These people are under the age of 21:" );

for ( QueryResultsRow row : results ) {
    Person person = ( Person ) row.get( "person" );
    System.out.println( person.getName() + "\n" );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Invoking queries and processing the results by iterating over the returned set can be difficult when you are monitoring changes over time. To alleviate this difficulty with ongoing queries, {PRODUCT} provides <em>live queries</em>, which use an attached listener for change events instead of returning an iterable result set. Live queries remain open by creating a view and publishing change events for the contents of this view.</p>
</div>
<div class="paragraph">
<p>To activate a live query, start your query with parameters and monitor changes in the resulting view. You can use the <code>dispose()</code> method to terminate the query and discontinue this reactive scenario.</p>
</div>
<div class="listingblock">
<div class="title">Example query definition in a DRL file</div>
<div class="content">
<pre class="highlight"><code>query colors(String $color1, String $color2)
    TShirt(mainColor = $color1, secondColor = $color2, $price: manufactureCost)
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example application code with an event listener and a live query</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">final List updated = new ArrayList();
final List removed = new ArrayList();
final List added = new ArrayList();

ViewChangedEventListener listener = new ViewChangedEventListener() {
 public void rowUpdated(Row row) {
  updated.add( row.get( "$price" ) );
 }

 public void rowRemoved(Row row) {
  removed.add( row.get( "$price" ) );
 }

 public void rowAdded(Row row) {
  added.add( row.get( "$price" ) );
 }
};

// Open the live query:
LiveQuery query = ksession.openLiveQuery( "colors",
                                          new Object[] { "red", "blue" },
                                          listener );
...
...

// Terminate the live query:
query.dispose()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more live query examples, see <a href="http://blog.athico.com/2010/07/glazed-lists-examples-for-drools-live.html">Glazed Lists examples for Drools Live Queries</a>.</p>
</div>
<div id="proc-logging-decision-engine_kogito-developing-decision-services" class="paragraph">
<p>=== Configuring a logging utility in the {DECISION_ENGINE}</p>
</div>
<div class="paragraph">
<p><strong>&lt;@Edoardo, see this section.&gt;</strong></p>
</div>
<div class="paragraph _abstract">
<p>The {DECISION_ENGINE} uses the Java logging API SLF4J for system logging. You can use one of the following logging utilities with the {DECISION_ENGINE} to investigate {DECISION_ENGINE} activity, such as for troubleshooting or data gathering:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logback</p>
</li>
<li>
<p>Apache Commons Logging</p>
</li>
<li>
<p>Apache Log4j</p>
</li>
<li>
<p><code>java.util.logging</code> package</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>For the logging utility that you want to use, add the relevant dependency to your Maven project or save the relevant XML configuration file in the <code>org.drools</code> package of your {PRODUCT} distribution:</p>
</div>
<div class="listingblock">
<div class="title">Example Maven dependency for Logback</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
  &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
  &lt;version&gt;${logback.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example logback.xml configuration file in org.drools package</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;configuration&gt;
  &lt;logger name="org.drools" level="debug"/&gt;
  ...
&lt;configuration&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example log4j.xml configuration file in org.drools package</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
  &lt;category name="org.drools"&gt;
    &lt;priority value="debug" /&gt;
  &lt;/category&gt;
  ...
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are developing for an ultra light environment, use the <code>slf4j-nop</code> or <code>slf4j-simple</code> logger.
</td>
</tr>
</table>
</div>
<div id="ref-performance-tuning-decision-engine_kogito-developing-decision-services" class="paragraph">
<p>== Performance tuning considerations with the {DECISION_ENGINE}</p>
</div>
<div class="paragraph _abstract">
<p>The following key concepts or suggested practices can help you optimize {DECISION_ENGINE} performance. These concepts are summarized in this section as a convenience and are explained in more detail in the cross-referenced documentation, where applicable. This section will expand or change as needed with new releases of {PRODUCT}.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Use sequential mode for stateless KIE sessions that do not require important {DECISION_ENGINE} updates</dt>
<dd>
<p>Sequential mode is an advanced rule base configuration in the {DECISION_ENGINE} that enables the {DECISION_ENGINE} to evaluate rules one time in the order that they are listed in the {DECISION_ENGINE} agenda without regard to changes in the working memory. As a result, rule execution may be faster in sequential mode, but important updates may not be applied to your rules. Sequential mode applies to stateless KIE sessions only.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>To enable sequential mode, set the system property <code>drools.sequential</code> to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>For more information about sequential mode or other options for enabling it, see <a href="#con-phreak-sequential-mode_kogito-decision-engine">[con-phreak-sequential-mode_kogito-decision-engine]</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Use simple operations with event listeners</dt>
<dd>
<p>Limit the number of event listeners and the type of operations they perform. Use event listeners for simple operations, such as debug logging and setting properties. Complicated operations, such as network calls, in listeners can impede rule execution. After you finish working with a KIE session, remove the attached event listeners so that the session can be cleaned, as shown in the following example:</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example event listener removed after use</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Listener listener = ...;
StatelessKnowledgeSession ksession = createSession();
try {
    ksession.insert(fact);
    ksession.fireAllRules();
    ...
} finally {
    if (session != null) {
        ksession.detachListener(listener);
        ksession.dispose();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For information about built-in event listeners and debug logging in the {DECISION_ENGINE}, see <a href="#con-engine-event-listeners_kogito-decision-engine">[con-engine-event-listeners_kogito-decision-engine]</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>|Conditional
|<span class="image"><img src="kogito/bpmn/bpmn-conditional-start.png" alt="bpmn conditional start"></span>
|<span class="image"><img src="kogito/bpmn/bpmn-conditional-start.png" alt="bpmn conditional start"></span>
|<span class="image"><img src="kogito/bpmn/bpmn-conditional-non-interrupt.png" alt="bpmn conditional non interrupt"></span></p>
</div>
<div class="paragraph">
<p>|Compensation
|<span class="image"><img src="kogito/bpmn/bpmn-compensation-start.png" alt="bpmn compensation start"></span>
|<span class="image"><img src="kogito/bpmn/bpmn-compensation-start.png" alt="bpmn compensation start"></span>
|</p>
</div>
<div class="paragraph">
<p>|Error
|
|<span class="image"><img src="kogito/bpmn/bpmn-error-start.png" alt="bpmn error start"></span>
|</p>
</div>
<div class="paragraph">
<p>|Escalation
|<span class="image"><img src="kogito/bpmn/bpmn-escalation-start.png" alt="bpmn escalation start"></span>
|<span class="image"><img src="kogito/bpmn/bpmn-escalation-start.png" alt="bpmn escalation start"></span>
|<span class="image"><img src="kogito/bpmn/bpmn-escalation-non-interrupt.png" alt="bpmn escalation non interrupt"></span></p>
</div>
</div>
</div>
<div class="paragraph">
<p>The none start event is a start event without a trigger condition. A process or a subprocess can contain at most one none start event, which is triggered on process or subprocess start by default, and the outgoing flow is taken immediately.</p>
</div>
<div class="paragraph">
<p>When you use a none start event in a subprocess, the execution of the process flow is transferred from the parent process into the subprocess and the none start event is triggered. This means that the token (the current location within the process flow) is passed from the parent process into the subprocess activity and the none start event of the subprocess generates a token of its own.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Message</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A process can contain multiple message start events, which are triggered by a particular message. The process instance with a message start event starts its execution from this event after it has received the respective message. After the message is received, the process is instantiated and its message start event is executed immediately (its outgoing flow is taken).</p>
</div>
<div class="paragraph">
<p>Because a message can be consumed by an arbitrary number of processes and process elements, including no elements, one message can trigger multiple message start events and therefore instantiate multiple processes.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Timer</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The timer start event is a start event with a timing mechanism that is triggered at the start of the process. A process can contain multiple timer start events.</p>
</div>
<div class="paragraph">
<p>When you use a timer start event in a subprocess, execution of the process flow is transferred from the parent process into the subprocess and the timer start event is triggered. The token is taken from the parent subprocess activity and the timer start event of the subprocess is triggered and waits for the timer to trigger.</p>
</div>
<div class="paragraph">
<p>After the time defined by the timer definition is reached, the outgoing flow is taken.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Signal</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The signal start event is triggered by a signal with a particular signal code. The signal start event is triggered when the process instance receives the required signal, and then the signal start event is executed and its outgoing flow is taken. A process can contain multiple signal start events.</p>
</div>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-intermediate-events_kogito-developing-decision-services" class="paragraph">
<p>=== Intermediate events supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>BPMN intermediate events drive the flow of a business process. Intermediate events catch or throw an event during the execution of the business process. You can add these events between start and end events or as a catch event on the boundary of an activity, such as a subprocess or a user task. You can configure boundary catch events as interrupting or non-interrupting events. An interrupting boundary catch event cancels the bound activity whereas a non-interrupting event does not.</p>
</div>
<div class="paragraph">
<p>An intermediate event handles a particular situation that occurs during process execution. The situation is a trigger for an intermediate event. In a process, you can add an intermediate event with one outgoing flow to an activity boundary.</p>
</div>
<div class="paragraph">
<p>If the event occurs while the activity is being executed, the event triggers its execution to the outgoing flow. One activity may have multiple boundary intermediate events. Note that depending on the behavior you require from the activity with the boundary intermediate event, you can use either of the following intermediate event types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interrupting: The activity execution is interrupted and the execution of the intermediate event is triggered.</p>
</li>
<li>
<p>Non-interrupting: The intermediate event is triggered and the activity execution continues.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following intermediate events:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 78. Supported intermediate events</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Intermediate event type</th>
<th class="tableblock halign-left valign-top">Catching</th>
<th class="tableblock halign-left valign-top">Boundary</th>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Throwing</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Interrupt</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Non-interrupt</p></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-message.png" alt="bpmn intermediate message"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-message.png" alt="bpmn intermediate message"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-message-noninterrupt.png" alt="bpmn message noninterrupt"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-message-throwing.png" alt="bpmn message throwing"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-timer.png" alt="bpmn intermediate timer"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-timer.png" alt="bpmn intermediate timer"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-timer-noninterrupt.png" alt="bpmn timer noninterrupt"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-signal.png" alt="bpmn intermediate signal"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-signal.png" alt="bpmn intermediate signal"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-signal-noninterrupt.png" alt="bpmn signal noninterrupt"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-link-catching.png" alt="bpmn link catching"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-link-throwing.png" alt="bpmn link throwing"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-catch.png" alt="bpmn intermediate catch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-catch.png" alt="bpmn intermediate catch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-intermediate-compensation-throwing.png" alt="bpmn intermediate compensation throwing"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Message</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A message intermediate event is an intermediate event that enables you to manage a message object. Use one of the following events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A throwing message intermediate event produces a message object based on the defined properties.</p>
</li>
<li>
<p>A catching message intermediate event listens for a message object with the defined properties.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Timer</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A timer intermediate event enables you to delay workflow execution or to trigger the workflow execution periodically. It represents a timer that can trigger one or multiple times after a specified period of time. When the timer intermediate event is triggered, the defined timer condition is checked and the outgoing flow is taken.</p>
</div>
<div class="paragraph">
<p>When you add a timer intermediate event in the process workflow, it has one incoming flow and one outgoing flow. Its execution starts when the incoming flow transfers to the event. When you add a timer intermediate event on an activity boundary, the execution is triggered at the same time as the activity execution.</p>
</div>
<div class="paragraph">
<p>The timer is canceled if the timer element is canceled, for example, by completing or aborting the enclosing process instance.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Signal</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A signal intermediate event enables you to produce or consume a signal object. Use either of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A throwing signal intermediate event produces a signal object based on the defined properties.</p>
</li>
<li>
<p>A catching signal intermediate event listens for a signal object with the defined properties.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Link</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A link intermediate event enables you to jump from one place of the diagram to another. A link intermediate event is equivalent to the <code>goto</code> functionality in older programming languages.</p>
</div>
<div class="paragraph">
<p>Use throwing and catching link intermediate events together, where each functions in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A throwing link intermediate event refers to the target catching node.</p>
</li>
<li>
<p>A catching link intermediate event refers to the source throwing node.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Compensation</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A compensation intermediate event is a boundary event attached to an activity in a transaction subprocess. It can finish with a compensation end event or a cancel end event. The compensation intermediate event must be associated with a flow, which is connected to the compensation activity.</p>
</div>
<div class="paragraph">
<p>The activity associated with the boundary compensation intermediate event is executed if the transaction subprocess finishes with the compensation end event. The execution continues with the respective flow.</p>
</div>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-end-events_kogito-developing-decision-services" class="paragraph">
<p>=== End events supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>BPMN end events terminate a business process. An end event has one or more incoming sequence flows and typically has no outgoing flows. A business process can contain multiple end events. All end events, with the exception of the none and terminate end events, are throw events. A process must contain at least one end event.</p>
</div>
<div class="paragraph">
<p>During runtime, an end event finishes the process workflow. The end event can finish only the workflow that reached it, or all workflows in the process instance, depending on the end event type.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following end events:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 79. Supported end events</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">End event type</th>
<th class="tableblock halign-left valign-top">Icon</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-end-node.png" alt="bpmn end node"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-end-message.png" alt="bpmn end message"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-end-error.png" alt="bpmn end error"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-end-terminate.png" alt="bpmn end terminate"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-end-compensation.png" alt="bpmn end compensation"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">None</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The none end event specifies that no other special behavior is associated with the end of the process.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Message</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>When a flow enters a message end event, the flow finishes and the end event produces a message as defined in its properties.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Error</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The throwing error end event finishes the incoming workflow (consumes the incoming token) and produces an error object. Any other running workflows in the process or subprocess remain uninfluenced.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Terminate</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The terminate end event finishes all execution flows in the specified process or subprocess instance. Activities being executed are canceled. A terminate end event inside a subprocess ends the subprocess instance but does not automatically end the parent process instance.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Compensation</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A compensation end event is used to finish a transaction subprocess and trigger the compensation defined by the compensation intermediate event attached to the boundary of the subprocess activities.</p>
</div>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-tasks_kogito-developing-decision-services" class="paragraph">
<p>=== Tasks supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>BPMN tasks identify actions to be completed in a business process model and are the smallest unit of work in a process flow.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following tasks:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 80. Supported tasks</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task type</th>
<th class="tableblock halign-left valign-top">Task node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business rule task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-business-rule-task.png" alt="bpmn business rule task"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-script-task.png" alt="bpmn script task"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-user-task.png" alt="bpmn user task"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-service-task.png" alt="bpmn service task"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Business rule task</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A business rule task specifies a business decision to be executed either through a Decision Model and Notation (DMN) model or a Drools Rule Language (DRL) rule unit.</p>
</div>
<div class="paragraph">
<p>When a process reaches a business rule task defined by a DMN model, the {PROCESS_ENGINE} executes the DMN model decision with the inputs provided.</p>
</div>
<div class="paragraph">
<p>When a process reaches a business rule task defined by a DRL rule unit, the {PROCESS_ENGINE} begins executing the rules in the designated rule unit group. When there are no more active rules in the rule unit, the execution continues to the next element. During the rule unit execution, new activations in the rule unit are added to the {DECISION_ENGINE} agenda because these activations are changed by other rules.</p>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected business rule task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 81. Business rule task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rule Language</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the task invokes a decision from a Decision Model and Notation (DMN) model or a Drools Rule Language (DRL) rule unit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rule Flow Group</strong> (for DRL)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the DRL rule unit in the format <code>unit:<em>PACKAGE_NAME</em>.<em>UNIT_NAME</em></code>, such as <code>unit:org.acme.PersonRules</code>. This rule unit syntax specifies that you are using a rule unit instead of a traditional rule flow group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Namespace</strong>, <strong>Decision Name</strong>, <strong>DMN Model Name</strong> (for DMN)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the relevant DMN model as found in the DMN model file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the task, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the task, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Script task</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A script task represents a script to be executed during the process execution. The associated script can access process variables. When a script task is reached during execution, the script is executed and the outgoing flow is taken.</p>
</div>
<div class="paragraph">
<p>Review the following list of suggestions before using a script task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid low-level implementation details in the process. Although you can use a script task to manipulate variables, consider using a service task when modeling more complex operations.</p>
</li>
<li>
<p>Ensure that the script is executed immediately. If the script is not intended to be executed immediately, consider using an asynchronous service task.</p>
</li>
<li>
<p>Avoid contacting external services through a script task. Use a service task to model communication with an external service.</p>
</li>
<li>
<p>Ensure scripts do not generate exceptions. Runtime exceptions should be caught and managed inside the script or transformed into signals or errors that can then be handled inside the process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected script task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 82. Script task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Script</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a Java, JavaScript, or MVEL script to be executed by the task and specifies the script type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">User task</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A user task is an activity in the process workflow that cannot be performed automatically by the system and therefore requires the intervention of a human user, or <em>actor</em>.</p>
</div>
<div class="paragraph">
<p>On execution, the user task element is instantiated as a task that appears in the list of tasks of one or more actors. If a user task element defines the <code>Groups</code> property, the task is displayed in task lists of all users that are members of the group. Any user who is a member of the group can claim the task. After a user task is claimed, the task disappears from the task list of the other users.</p>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected user task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 83. User task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Task Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task as it is displayed to human user (actor).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Subject</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the subject for the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Actors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the authorized human users (actors) who can complete the user task. Click <strong>Add</strong> to add a row and then select an actor from the list or click <strong>New</strong> to add a new actor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the authorized group of human users (actors) who can complete the user task. Click <strong>Add</strong> to add a row and then select a group from the list or click <strong>New</strong> to add a new group. Any actor in the group can complete the user task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Reassignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a different actor to complete the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Notifications</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines notifications associated with the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Skippable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the task is optional and can be skipped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Priority</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a priority for the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task as it is displayed to a human user (actor).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Created By</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the human user (actor) who created the task. Click <strong>Add</strong> to add a row and then select a user from the list or click <strong>New</strong> to add a new user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multiple Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task has multiple instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the task, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the task, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Content</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the content of the script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Service task</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A service task is an activity that is completed automatically by an external software service and does not require human interaction.</p>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected service task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 84. Service task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Implementation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the task is implemented in Java or is a web service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Interface</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the class used to implement the script, for example, <code>org.xyz.HelloWorld</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Operation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the method called by the interface, for example, <code>sayHello()</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multiple Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task has multiple instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the task, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the task, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-custom-tasks_kogito-developing-decision-services" class="paragraph">
<p>=== Custom tasks supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>The BPMN specification supports the ability to extend the <code>bpmn2:task</code> element to create custom tasks in a software implementation. Similar to standard BPMN tasks, custom tasks identify actions to be completed in a business process model, but they also include specialized functionality, such as compatibility with an external service of a specific type (REST, email, or web service) or checkpoint behavior within a process (milestone).</p>
</div>
<div class="paragraph">
<p>{PRODUCT} provides predefined custom tasks under <strong>Custom Tasks</strong> in the BPMN modeler palette, but currently does not support the ability for you to define your own custom task extensions.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following predefined custom tasks:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 85. Supported custom tasks</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Custom task type</th>
<th class="tableblock halign-left valign-top">Custom task node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milestone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-milestone.png" alt="bpmn milestone"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Milestone</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A milestone represents a single point of achievement within a process instance. You can use milestones to flag certain events to trigger other tasks or track the progress of the process. Milestones are useful for Key Performance Indicator (KPI) tracking or for identifying the tasks that are still to be completed. Milestones can occur at the end of a stage in a process or they can be the result of achieving other milestones.</p>
</div>
<div class="paragraph">
<p>A milestone typically uses a defined input condition that must be met in order to complete the milestone. If no input condition is defined, the milestone is completed automatically when the process reaches the milestone. You can also configure milestones with the <code>AdHoc Autostart</code> property to be triggered automatically when the process starts or you can set the <strong>Signal</strong> definition in a signal event in the process to trigger the milestone explicitly. Milestones can be triggered as many times as required. A milestone is achieved when the condition is met or is achieved automatically if no condition is defined.</p>
</div>
<div class="paragraph">
<p>In the following example process, several milestones control the process for IT hardware orders. For example, when the condition for the <code>Order placed</code> milestone is met, the completed milestone triggers a notification script task and leads to an end signal event that triggers the next <code>Order shipped</code> milestone, and so on to subsequent milestones until the process is complete.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-milestone-example.png" alt="Image of example process with milestones">
</div>
<div class="title">Figure 199. Example process with milestones</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-milestone-example-signal.png" alt="Image of example signal configuration with a milestone">
</div>
<div class="title">Figure 200. Example end signal event configured to trigger the next milestone</div>
</div>
<div class="paragraph">
<p>Milestones can reach the following states during process execution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Active</code>: A milestone condition has been defined for the milestone node but it has not been met.</p>
</li>
<li>
<p><code>Completed</code>: A milestone condition has been met (if applicable), the milestone has been achieved, and the process can proceed to the next task or can end.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected milestone:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 86. Milestone properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the milestone.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the milestone. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this milestone is invoked asynchronously. Make milestones asynchronous if they cannot be executed instantaneously, such as in a process performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc milestone that is started automatically. This option enables the milestone to automatically start when the process is created instead of being started by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the milestone, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the milestone, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines data input and output for the milestone. Click to open the <strong>Data I/O</strong> window and add data input and output as required. A milestone typically uses a defined input condition that must be met in order to complete the milestone. If no input condition is defined, the milestone is completed automatically when the process reaches the milestone.</p>
</div>
<div class="paragraph">
<p>For each milestone that requires a condition, enter at least one input data assignment with the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: <code>Condition</code></p>
</li>
<li>
<p><strong>Data Type</strong>: <code>String</code></p>
</li>
<li>
<p><strong>Source</strong>: Enter a Java expression for the condition to be met, such as <code>order.isShipped()</code> in a process that uses an <code>order</code> process variable.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-subprocesses_kogito-developing-decision-services" class="paragraph">
<p>=== Subprocesses supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>BPMN subprocesses are portions of a parent process that contain process nodes. You can embed part of the parent process within a subprocess. You can also include variable definitions within the subprocess. These variables are accessible to all nodes inside the subprocess.</p>
</div>
<div class="paragraph">
<p>A subprocess must have one incoming connection and one outgoing connection. A terminate end event inside a subprocess ends the subprocess instance but does not automatically end the parent process instance. A subprocess ends when there are no more active elements in it.</p>
</div>
<div class="paragraph">
<p>In the following example, the <code>Place order</code> subprocess checks whether sufficient stock is available to place the order and updates the stock information if the order can be placed. The customer is then notified through the main process based on whether the order was placed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/subprocess.png" alt="subprocess">
</div>
<div class="title">Figure 201. Example subprocess</div>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following subprocesses:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 87. Supported subprocesses</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Subprocess type</th>
<th class="tableblock halign-left valign-top">Subprocess node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded subprocess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-embedded-subprocess.png" alt="bpmn embedded subprocess"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ad hoc subprocess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-adhoc-subprocess.png" alt="bpmn adhoc subprocess"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable subprocess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-reusable-subprocess.png" alt="bpmn reusable subprocess"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Embedded subprocess</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>An embedded subprocess encapsulates a part of the parent process and shares the parent process data. This subprocess must contain a start event and at least one end event. You can define local subprocess variables that are accessible to all elements inside this container.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Multiple-instance behavior is currently not supported for embedded subprocesses in {PRODUCT}.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected embedded subprocess:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 88. Embedded subprocess properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the subprocess.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the subprocess. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this subprocess is invoked asynchronously. Make subprocesses asynchronous if they cannot be executed instantaneously, such as a subprocess performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines any process variables for the subprocess. Process variables are visible within the specific subprocess instance. Process variables are initialized at subprocess creation and destroyed on subprocess completion. Variable <strong>Tags</strong> provide greater control over the variable behavior, such as whether the variable is <code>required</code> or <code>internal</code>. For more information about variable tags, see <a href="#con-bpmn-variables_kogito-developing-process-services">[con-bpmn-variables_kogito-developing-process-services]</a>.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Ad hoc subprocess</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>An ad hoc subprocess contains embedded inner activities and is intended to be executed with a more flexible ordering compared to the typical routing of processes. Unlike typical processes, an ad hoc subprocess does not contain a complete, structured BPMN diagram description, such as from a start event to an end event. Instead, the ad hoc subprocess contains only activities, sequence flows, gateways, and intermediate events. An ad hoc subprocess can also contain data objects and data associations.</p>
</div>
<div class="paragraph">
<p>The activities within ad hoc subprocesses are not required to have incoming and outgoing sequence flows. However, you can specify sequence flows between some of the contained activities. Sequence flows provide the same ordering constraints in ad hoc subprocesses as in a typical process. Any intermediate events must have outgoing sequence flows and they can be triggered multiple times while the ad hoc subprocess is active.</p>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected ad hoc subprocess:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 89. Ad hoc subprocess properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the subprocess.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the subprocess. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHocActivationCondition</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines a Java expression that determines when the subprocess is activated, such as <code>order.isShipped()</code> in a process that uses an <code>order</code> process variable. To activate the subprocess automatically when the parent process starts, leave this field empty with no condition specified.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This field supports only Java expressions and does not support Drools expressions as indicated in the field label. This label will be updated in a future release.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHocCompletionCondition</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines a Java expression that determines when the subprocess is completed, such as <code>order.isDelivered()</code> in a process that uses an <code>order</code> process variable. By default, this field contains the value <code>autocomplete</code> to complete the subprocess automatically when the subprocess ends.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This field supports only Java expressions and does not support Drools and MVEL expressions as indicated in the field label. This label will be updated in a future release.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHocOrdering</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property specifies whether the subprocess is executed in <strong>Sequential</strong> or <strong>Parallel</strong> order in the parent process, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this ad hoc subprocess is started automatically. This option enables the subprocess to automatically start when the subprocess is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this subprocess is invoked asynchronously. Make subprocesses asynchronous if they cannot be executed instantaneously, such as a subprocess performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines any process variables for the subprocess. Process variables are visible within the specific subprocess instance. Process variables are initialized at subprocess creation and destroyed on subprocess completion. Variable <strong>Tags</strong> provide greater control over the variable behavior, such as whether the variable is <code>required</code> or <code>internal</code>. For more information about variable tags, see <a href="#con-bpmn-variables_kogito-developing-process-services">[con-bpmn-variables_kogito-developing-process-services]</a>.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Reusable subprocess</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A reusable subprocess calls another process or subprocess instance to be used within a parent process. This subprocess enables you to reuse the same process repeatedly without manually duplicating the subprocess.  This subprocess typically appears collapsed within the parent process.</p>
</div>
<div class="paragraph">
<p>In the {PRODUCT} BPMN modeler, you can modify the following properties for a selected reusable subprocess:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 90. Reusable subprocess properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the subprocess.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the subprocess. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Called Element</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the ID of the process or subprocess that the activity calls and instantiates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Independent</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the subprocess is started and completed independently of the parent process or whether the subprocess is canceled when the parent process is terminated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Abort Parent</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Available only when <strong>Independent</strong> is not selected.) Determines whether a dependent reusable subprocess can abort the parent process when the subprocess is aborted or when an error occurs during the subprocess execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Wait for completion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the parent process must wait for this subprocess to complete before continuing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this subprocess is invoked asynchronously. Make subprocesses asynchronous if they cannot be executed instantaneously, such as a subprocess performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multiple Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determines whether the subprocess is executed multiple times. When you select this option, the following additional options appear:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>MI Execution mode</strong>: Specifies whether the multiple subprocess instances are executed in <strong>Sequential</strong> or <strong>Parallel</strong> order as each instance is triggered. In sequential order, a triggered subprocess starts only after the previous subprocess instance completes. In parallel order, a subprocess instance starts whenever it is triggered and can run in parallel with any other triggered subprocesses.</p>
</li>
<li>
<p><strong>MI Collection input</strong>: Specifies the process variable that represents a collection of elements for which new instances are created. The subprocess is instantiated as many times as needed according to the size of the collection.</p>
</li>
<li>
<p><strong>MI Data Input</strong>: Specifies the name of the process variable that contains the selected element in the collection. The variable is used to access elements in the collection.</p>
</li>
<li>
<p><strong>MI Collection output</strong>: (Optional) Specifies the process variable that represents the collection of elements that gather the output of the multi-instance node.</p>
</li>
<li>
<p><strong>MI Data Output</strong>: Specifies the name of the process variable that is added to the output collection that you selected in the <strong>MI Collection output</strong> property.</p>
</li>
<li>
<p><strong>MI Completion Condition</strong>: Not supported in {PRODUCT}. This property defines a Java expression that is evaluated on each completed subprocess instance, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-gateways_kogito-developing-decision-services" class="paragraph">
<p>=== Gateways supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>BPMN gateways create or synchronize branches in a process workflow using a set of conditions in a gating mechanism. BPMN2 supports <em>converging gateways</em> that merge multiple flows into one flow, and <em>diverging gateways</em> that split one flow into multiple flows. One gateway cannot have multiple incoming and multiple outgoing flows.</p>
</div>
<div class="paragraph">
<p>In the following business process diagram, the exclusive (XOR) gateway evaluates only the incoming flow whose condition evaluates to true:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/gateway.png" alt="gateway">
</div>
<div class="title">Figure 202. Example process with exclusive gateway</div>
</div>
<div class="paragraph">
<p>In this example, the customer details are verified by a user and the process is assigned to a user for approval. If the request is approved, an approval notification is sent to the user. If the request is rejected, a rejection notification is sent to the user.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following gateways:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 91. Supported gateways</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Gateway type</th>
<th class="tableblock halign-left valign-top">Icon</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclusive (XOR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-gateway-exclusive.png" alt="bpmn gateway exclusive"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inclusive (OR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-gateway-inclusive.png" alt="bpmn gateway inclusive"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel (AND)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-gateway-parallel.png" alt="bpmn gateway parallel"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event (AND)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="kogito/bpmn/bpmn-gateway-event.png" alt="bpmn gateway event"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Exclusive</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A diverging exclusive gateway selects only the first incoming flow that evaluates to true and that contains the lowest <code>priority</code> number, if applicable. A converging exclusive gateway activates the next node for each triggered incoming flow.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that at least one of the outgoing flows evaluates to true at runtime. If no outgoing flows evaluate to true, the process instance terminates with a runtime exception.</p>
</div>
<div class="paragraph">
<p>Although priorities are evaluated in {PRODUCT}, the BPMN2 specification does not guarantee the priority order. Avoid depending on the <code>priority</code> attribute in your workflow.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A converging exclusive gateway also enables a workflow branch to continue to its outgoing flow as soon as it reaches the gateway. When one of the incoming flows triggers the gateway, the workflow continues to the outgoing flow of the gateway. If a gateway is triggered by more than one incoming flow, the gateway activates the next node for each trigger.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Inclusive</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A diverging inclusive gateway selects the incoming flow and all outgoing flows that evaluate to true. Connections with lower <code>priority</code> numbers are triggered before triggering higher <code>priority</code> connections. Although priorities are evaluated, the BPMN2 specification does not guarantee the priority order. Avoid depending on the <code>priority</code> attribute in your workflow.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that at least one of the outgoing flows evaluates to true at runtime. If no outgoing flows evaluate to true, the process instance terminates with a runtime exception.</p>
</div>
<div class="paragraph">
<p>Although priorities are evaluated in {PRODUCT}, the BPMN2 specification does not guarantee the priority order. Avoid depending on the <code>priority</code> attribute in your workflow.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A converging inclusive gateway also merges all incoming flows previously created by an inclusive diverging gateway. A converging inclusive gateway acts as a synchronizing entry point for the inclusive gateway branches.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Parallel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>A parallel gateway synchronizes and creates parallel flows. A diverging parallel gateway selects the incoming flow and all outgoing flows simultaneously. A converging parallel gateway waits until all incoming flows have entered and then triggers the outgoing flow.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Event</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>An event gateway is only diverging and reacts to possible events, as opposed to the data-based exclusive gateway that reacts to the process data. An event gateway selects the outgoing flow based on the event that occurs, and selects only one outgoing flow at a time. An event gateway might act as a start event, where the process is instantiated only if one of the intermediate events connected to the event-based gateway occurs.</p>
</div>
<div class="openblock">
<div class="content">
<div id="ref-bpmn-connectors_kogito-developing-decision-services" class="paragraph">
<p>=== Connectors supported in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>BPMN connectors create an association between two components in a process. When a connector is directed, the association is sequential and indicates that one of the elements is executed immediately before the other within an instance of the process. Connectors can start and end at the top, bottom, right, or left of the process components being associated. The BPMN2 specification allows you to use your discretion, placing connectors in a way that makes the process behavior easy to follow and understand.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports only sequence flow connectors. A sequence flow connects elements of a process and defines the order in which those elements are executed within an instance.</p>
</div>
<div id="proc-bpmn-model-creating_kogito-developing-decision-services" class="paragraph">
<p>== Creating and editing BPMN models in the {PRODUCT} BPMN modeler</p>
</div>
<div class="paragraph _abstract">
<p>You can use the {PRODUCT} BPMN modeler in VSCode to design BPMN process models and define process logic for a complete and functional BPMN model.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports a subset of the <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation 2.0 specification</a>. Although the {PRODUCT} BPMN modeler displays many BPMN components in the canvas palette, the {PROCESS_ENGINE} (process runtime component) in {PRODUCT} currently executes only the supported subset of components. If you use any BPMN components from the {PRODUCT} BPMN modeler palette that are not supported by the {PROCESS_ENGINE}, your {PRODUCT} project might fail to compile or execute. Additional BPMN components are added to {PRODUCT} runtime support with every release.</p>
</div>
<div class="paragraph">
<p>For more information about BPMN2 support in {PRODUCT}, see <a href="#ref-bpmn-support_kogito-developing-process-services">[ref-bpmn-support_kogito-developing-process-services]</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a> 1.46.0 or later is installed.</p>
</li>
<li>
<p>The <strong>{PRODUCT} Bundle</strong> VSCode extension is installed and enabled in your VSCode IDE. For information about enabling the VSCode extension, see {URL_CREATING_RUNNING}#proc-kogito-vscode-extension_kogito-creating-running[<em>{CREATING_RUNNING}</em>].</p>
</li>
<li>
<p>You have created a {PRODUCT} project and have included any Java objects required for your {PRODUCT} service. For information about creating a project, see {URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>].</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, create or import a BPMN file in the relevant folder of your {PRODUCT} project, typically in <code>src/main/resources</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For a new BPMN file, you can also enter <code>bpmn.new</code> in a web browser to design your business process in the {PRODUCT} online BPMN modeler. When you finish creating your process model, you can click <strong>Download</strong> in the online modeler page to import your BPMN file into your {PRODUCT} project.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Open the new or imported BPMN file to view the process diagram in the {PRODUCT} BPMN modeler.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>If the process diagram does not open in the {PRODUCT} BPMN modeler, ensure that you have installed and enabled the <strong>{PRODUCT} Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the {PRODUCT} BPMN modeler opens only the XML source of the BPMN file and displays an error message, review the reported errors and the BPMN model file to ensure that all BPMN elements are correctly defined.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the background of the BPMN modeler canvas and, in the upper-right corner of the modeler, click <strong>Properties</strong> to add or verify information for the BPMN file as described in the following table:</p>
</li>
</ol>
</div>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 92. General process properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the name of the process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the process. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ID</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter an identifier for this process, such as <code>orderItems</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Package</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the package location for this process in your {PRODUCT} project, such as <code>org.acme</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ProcessType</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify whether the process is public or private (or null, if not applicable).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Version</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the artifact version for the process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Ad hoc</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this option if this process is a flexible process that uses other ad hoc auto-start fragments and that does not require strict start and end events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Instance Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter a description of the process purpose.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Imports</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click to open the <strong>Imports</strong> window and add any data object classes required for your process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Executable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this option to make the process executable as part of your {PRODUCT} project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add any process variables for the process. Process variables are visible within the specific process instance. Process variables are initialized at process creation and destroyed on process completion. Variable <strong>Tags</strong> provide greater control over the variable behavior, such as whether the variable is <code>required</code> or <code>internal</code>. For more information about variable tags, see <a href="#con-bpmn-variables_kogito-developing-process-services">[con-bpmn-variables_kogito-developing-process-services]</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add any custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">You can also use this field to configure role-based access to the process. To configure role-based access, set the attribute <strong>Name</strong> to <code>securityRoles</code> and set the attribute value to the relevant group or groups defined for the process, such as <code>employees,managers</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Global Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in {PRODUCT}. Global variables are visible to all process instances and assets in a project, and apply only to distributions of the BPMN modeler in jBPM and Red Hat Process Automation Manager.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Metadata Attributes</strong> entries are similar to <strong>Process Variables</strong> tags in that they enable new <code>metaData</code> extensions to BPMN diagrams. However, process variable tags modify the behavior of specific process variables, such as whether a certain variable is <code>required</code> or <code>internal</code>, whereas metadata attributes are key-value definitions that modify the behavior of the overall process, such as whether the process contains <code>securityRoles</code> or is used in conjunction with a custom event listener.</p>
</div>
<div class="paragraph">
<p>For example, the following custom metadata attribute <code>riskLevel</code> and value <code>low</code> in a BPMN process correspond to a custom event listener for starting the process:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-metadata-attributes-custom.png" alt="Image of custom metadata attribute and value">
</div>
<div class="title">Figure 203. Example metadata attribute and value in the BPMN modeler</div>
</div>
<div class="listingblock">
<div class="title">Example metadata attribute and value in the BPMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bpmn2:process id="approvals" name="approvals" isExecutable="true" processType="Public"&gt;
  &lt;bpmn2:extensionElements&gt;
    &lt;tns:metaData name="riskLevel"&gt;
      &lt;tns:metaValue&gt;&lt;![CDATA[low]]&gt;&lt;/tns:metaValue&gt;
    &lt;/tns:metaData&gt;
  &lt;/bpmn2:extensionElements&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example event listener with metadata value</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyListener implements ProcessEventListener {
    ...
    @Override
    public void beforeProcessStarted(ProcessStartedEvent event) {
        Map &lt; String, Object &gt; metadata = event.getProcessInstance().getProcess().getMetaData();
        if (metadata.containsKey("low")) {
            // Implement some action for that metadata attribute
        }
    }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Begin adding components to your new or imported BPMN process model by clicking and dragging one of the BPMN nodes from the left palette:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-drag-nodes.png" alt="bpmn drag nodes">
</div>
<div class="title">Figure 204. Adding BPMN components</div>
</div>
<div class="paragraph">
<p>Although the {PRODUCT} BPMN modeler displays many BPMN components in the canvas palette, the {PROCESS_ENGINE} (process runtime component) in {PRODUCT} currently supports only the following BPMN components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Start events</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Start</strong></p>
</li>
<li>
<p><strong>Start Signal</strong></p>
</li>
<li>
<p><strong>Start Timer</strong></p>
</li>
<li>
<p><strong>Start Message</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Intermediate events</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Intermediate Signal</strong> (catching and boundary)</p>
</li>
<li>
<p><strong>Intermediate Timer</strong> (catching and boundary)</p>
</li>
<li>
<p><strong>Intermediate Message</strong> (catching, boundary, and throwing)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>End events</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>End</strong></p>
</li>
<li>
<p><strong>End Error</strong></p>
</li>
<li>
<p><strong>End Terminate</strong></p>
</li>
<li>
<p><strong>End Message</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Tasks</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Business Rule</strong></p>
</li>
<li>
<p><strong>User</strong></p>
</li>
<li>
<p><strong>Service</strong></p>
</li>
<li>
<p><strong>Script</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Subprocesses</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Embedded</strong></p>
</li>
<li>
<p><strong>Reusable</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Gateways</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Parallel</strong></p>
</li>
<li>
<p><strong>Event</strong></p>
</li>
<li>
<p><strong>Exclusive</strong></p>
</li>
<li>
<p><strong>Inclusive</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the BPMN modeler canvas, for each new BPMN component that you add, select the new node, and in the upper-right corner of the BPMN modeler, click <strong>Properties</strong> to define the node identity and behavior.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For more information about BPMN component properties, see <a href="#ref-bpmn-support_kogito-developing-process-services">[ref-bpmn-support_kogito-developing-process-services]</a>.</p>
</div>
<div class="paragraph">
<p>For this example, use a business rule task based on a Decision Model and Notation (DMN) decision model as your first activity node.</p>
</div>
<div class="paragraph">
<p>This example assumes that you have the following assets in your {PRODUCT} project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Java object <code>org.acme.Person</code></p>
</li>
<li>
<p>A DMN model <code>PersonDecisions.dmn</code> with the namespace <code>https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1</code></p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>Business Rule</strong>, drag the task to the canvas, and link to it from a start event.</p>
</li>
<li>
<p>Select the business rule task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Name the rule task <code>Evaluate person</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule Language</strong>: <code>DMN</code></p>
</li>
<li>
<p><strong>Namespace</strong>: <code>https://kiegroup.org/dmn/_52CEF9FD-9943-4A89-96D5-6F66810CA4C1</code></p>
</li>
<li>
<p><strong>Decision Name</strong>: <code>isAdult</code></p>
</li>
<li>
<p><strong>DMN Model Name</strong>: <code>PersonDecisions</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Data Assignments</strong>: Add the following assignments:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Data Input</strong>: Add a data input with the name <code>Person</code>, with the type <code>org.acme.Person</code>, and with the source <code>person</code>.</p>
</li>
<li>
<p><strong>Data Output</strong>: Add a data output with the name <code>isAdult</code>, with the type <code>Boolean</code>, and with the source <code>isAdult</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>Gateways</strong> &#8594; <strong>Exclusive</strong>, drag the gateway to the canvas, and link to it from the rule task.</p>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>User</strong>, drag the user task to the canvas, and link to it from the exclusive gateway.</p>
</li>
<li>
<p>Select the user task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Name the user task <code>Special handling for children</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the task name to <code>ChildrenHandling</code>, and add a data input with the name <code>person</code>, the type <code>org.acme.Person</code>, and the source <code>person</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>End Events</strong> &#8594; <strong>End</strong>, drag two end events to the canvas, and link to one end event from the user task and to the other end event from the exclusive gateway.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the end event and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition <code>return isAdult == true;</code>.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the user task and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition to <code>return isAdult == false;</code></p>
</li>
<li>
<p>Save the BPMN process file.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The following is the BPMN model for applicant age evaluation in this example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of `persons.bpmn2` process diagram">
</div>
<div class="title">Figure 205. Example <code>persons.bpmn2</code> BPMN process</div>
</div>
<div class="paragraph">
<p>You can continue adding or modifying any remaining components and properties of your BPMN process or create a separate example.</p>
</div>
<div class="paragraph">
<p>The following are additional BPMN models that are used with the <code>persons.bpmn2</code> process as part of the same example application:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-model-example-orders.png" alt="Image of `orders.bpmn2` example process">
</div>
<div class="title">Figure 206. Example <code>orders.bpmn2</code> process</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-model-example-order-items.png" alt="Image of `orderItems.bpmn` example process">
</div>
<div class="title">Figure 207. Example <code>orderItems.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>As an illustration of a more complex use case, the following is an example BPMN model from a separate mortgage loan application for determining loan approval:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-model-example-mortgage-application.png" alt="Image of mortgage application business process.">
</div>
<div class="title">Figure 208. Example business process for a mortgage loan application</div>
</div>
<div class="paragraph">
<p>For more {PRODUCT} examples and instructions for using them, see the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub.</p>
</div>
<div class="openblock">
<div class="content">
<div id="con-bpmn-variables_kogito-developing-decision-services" class="paragraph">
<p>== Variables in {PRODUCT} processes</p>
</div>
<div class="paragraph _abstract">
<p>Variables in {PRODUCT} processes store data that is used during runtime. The {PRODUCT} BPMN modeler supports the following types of variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process variables</strong>: Variables that are visible within a specific process instance. Process variables are initialized at process creation and destroyed on process completion.</p>
</li>
<li>
<p><strong>Local variables</strong>: Variables that are visible within a specific process component, such as a task. Local variables are initialized when the element context is initialized (when the execution workflow enters the node and execution of the <code>onEntry</code> action has finished, if applicable). Local variables are destroyed when the element context is destroyed (when the execution workflow leaves the element).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A BPMN component, such as a process, subprocess, or task, can only access variables in its own context or in its parent context. A component cannot access a variable defined in a child component. When a BPMN component requires access to a variable during runtime, its own context is searched first.</p>
</div>
<div class="paragraph">
<p>If the variable cannot be found directly in the component context, the immediate parent context is searched. The search continues until the process context is reached.</p>
</div>
<div class="paragraph">
<p>If the variable cannot be found, a read access request returns <code>null</code>, a write access produces an error message, and the process continues its execution. Variables are searched for based on their unique ID.</p>
</div>
<div class="paragraph">
<p>=== Variable tags in BPMN process files</p>
</div>
<div class="paragraph">
<p>For greater control over variable behavior, you can tag process variables and local variables in the  BPMN process file. Tags are simple string values that you add as metadata to a specific variable.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} supports the following tags for process variables and local variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>internal</code>: Sets the variable as internal only for a process instance and hides the variable from the exposed REST model. For example, you can use this tag with intermediate variables that help hold some state during the execution of the process but are not part of the domain.</p>
</li>
<li>
<p><code>required</code>: Sets the variable as a requirement in order to start a process instance. If a process instance starts without the required variable, {PRODUCT} generates a <code>VariableViolationException</code> error.</p>
</li>
<li>
<p><code>readonly</code>: Indicates that the variable is for informational purposes only and can be set only once during process instance execution. If the value of a read-only variable is modified at any time, {PRODUCT} generates a <code>VariableViolationException</code> error.</p>
</li>
<li>
<p><code>input</code>: Sets the variable as an input of the process and therefore is not exposed in the returned data model. As a result, the value of an input variable is not returned in response to REST requests.</p>
</li>
<li>
<p><code>output</code>: Sets the variable as an output of the process and therefore is not expected for a process start and is included in the returned data model. As a result, the value of an output variable is returned in response to REST requests.</p>
</li>
<li>
<p><code>business-relevant</code>: Indicates that the variable is relevant for a particular item of business value. This tag is helpful for monitoring purposes or for implying that the variable is relevant to another application.</p>
</li>
<li>
<p><code>tracked</code>: Sets a variable to be tracked for changes so that {PRODUCT} generates events anytime the value of this variable is changed. Events are published to the <code>kogito-variables-events</code> topic in {PRODUCT}, where you can access the previous and new values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define a variable tag in the {KOGITO} BPMN modeler in VSCode, or you can add the tag directly in the BPMN process source file as a <code>customTags</code> metadata property with the tag value defined in the format <code>![CDATA[<em>TAG_NAME</em>]]</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following BPMN process applies the <code>required</code> tag to an <code>approver</code> process variable:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-variable-tags-ui.png" alt="Image of variable tags in BPMN modeler">
</div>
<div class="title">Figure 209. Example variable tagged in the BPMN modeler</div>
</div>
<div class="listingblock">
<div class="title">Example variable tagged in a BPMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bpmn2:property id="approver" itemSubjectRef="ItemDefinition_9" name="approver"&gt;
  &lt;bpmn2:extensionElements&gt;
    &lt;tns:metaData name="customTags"&gt;
      &lt;tns:metaValue&gt;&lt;![CDATA[required]]&gt;&lt;/tns:metaValue&gt;
    &lt;/tns:metaData&gt;
  &lt;/bpmn2:extensionElements&gt;
&lt;/bpmn2:property&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use multiple tags for a variable where applicable, but use caution and ensure that the tags are logical and do not conflict. For example, avoid tagging a variable as both <code>internal</code> and <code>required</code>.</p>
</div>
<div class="paragraph">
<p>By default, if a process variable has no tag assigned to it, {PRODUCT} assigns an <code>input</code> and an <code>output</code> tag to it.</p>
</div>
<div class="paragraph">
<p>You can also define custom variable tags in your BPMN files to make variable data available to {PRODUCT} process event listeners. Custom tags do not influence the {PRODUCT} runtime as the standard variable tags do and are for informational purposes only. You define custom variable tags in the same <code>customTags</code> metadata property format that you use for standard {PRODUCT} variable tags.</p>
</div>
<div id="proc-bpmn-variables-process_kogito-developing-decision-services" class="paragraph">
<p>=== Defining process variables in {PRODUCT} processes</p>
</div>
<div class="paragraph _abstract">
<p>Process variables are visible within a specific process instance. Process variables are initialized at process creation and destroyed on process completion. You can map process variables to local variables.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the relevant BPMN process file to view the process in the {PRODUCT} BPMN modeler.</p>
</li>
<li>
<p>Select the background of the BPMN modeler canvas and, in the upper-right corner of the modeler, click <strong>Properties</strong>.</p>
</li>
<li>
<p>Under <strong>Process Data</strong> &#8594; <strong>Process Variables</strong>, click the plus icon to add a new process variable and enter the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter the name of the process variable, such as <code>order</code> for a process variable with order information shared by all applicable nodes in the process.</p>
</li>
<li>
<p><strong>Data Type</strong>: Enter a custom or standard data type of the variable, such as <code>org.acme.Order</code>.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-process-variables.png" alt="Image of process variable example">
</div>
<div class="title">Figure 210. Example process variables in BPMN modeler</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="proc-bpmn-variables-local_kogito-developing-decision-services" class="paragraph">
<p>=== Defining local variables in {PRODUCT} processes</p>
</div>
<div class="paragraph _abstract">
<p>Local variables are visible within a specific process component, typically a task. Local variables are initialized when the element context is initialized (when the execution workflow enters the node and execution of the <code>onEntry</code> action has finished, if applicable). Local variables are destroyed when the element context is destroyed (when the execution workflow leaves the element).</p>
</div>
<div class="paragraph">
<p>You can map local variables to global or process variables. This mapping enables you to maintain relative independence from the parent context that accommodates the local variable. This isolation helps prevent technical exceptions.</p>
</div>
<div class="paragraph">
<p>For tasks, with the exception of script tasks, you define local variables as data input or output assignments under <strong>Assignments</strong> in the task properties. Data input assignments define variables that enter the task and provide the entry data required for the task execution. Data output assignments refer to the context of the task after execution to acquire output data.</p>
</div>
<div class="paragraph">
<p>User tasks present data related to the actor who is completing the user task. User tasks also require the actor to provide result data related to the execution.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the relevant BPMN process file to view the process in the {PRODUCT} BPMN modeler.</p>
</li>
<li>
<p>Select the relevant task (non-script task) and, in the upper-right corner of the modeler, click <strong>Properties</strong>.</p>
</li>
<li>
<p>Under <strong>Assignments</strong>, click the edit icon to open the <strong>Data I/O</strong> window, and click <strong>Add</strong> to begin adding local variables as data input or output:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter the name of the data input or output, such as <code>person</code> for a local variable with person information as the input and <code>isAdult</code> for a local variable with adult status as the output.</p>
</li>
<li>
<p><strong>Data Type</strong>: Enter a custom or standard data type of the data input or output, such as <code>org.acme.Person</code>.</p>
</li>
<li>
<p><strong>Source</strong> or <strong>Target</strong>: Enter the source object for the data input or the target object for the data output, such as <code>person</code> for a Java class with person information.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-local-variables.png" alt="Image of local variable example">
</div>
<div class="title">Figure 211. Example local variables in BPMN modeler</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Unresolved directive in bpmn/chap-kogito-developing-process-services.adoc - include::{asciidoc-dir}/configuration/chap-kogito-configuring.adoc[tags=con-persistence]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in bpmn/chap-kogito-developing-process-services.adoc - include::{asciidoc-dir}/configuration/chap-kogito-configuring.adoc[tags=proc-infinispan-persistence-enabling]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in bpmn/chap-kogito-developing-process-services.adoc - include::{asciidoc-dir}/configuration/chap-kogito-configuring.adoc[tags=proc-mongodb-persistence-enabling]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in bpmn/chap-kogito-developing-process-services.adoc - include::{asciidoc-dir}/configuration/chap-kogito-configuring.adoc[tags=proc-messaging-enabling]</p>
</div>
<div id="con-knative-eventing_kogito-developing-decision-services" class="paragraph">
<p>== Knative Eventing in {PRODUCT} services</p>
</div>
<div class="paragraph _abstract">
<p><a href="https://knative.dev/docs/eventing/">Knative Eventing</a> is a system that enables you to create event producers and consumers for your applications. Knative Eventing uses standard HTTP POST requests to send and receive events between event producers and consumers. These events conform to the <a href="https://github.com/cloudevents/spec">CloudEvents specification</a>, which enables creating, parsing, sending, and receiving events in any programming language.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} provides a <code>knative-eventing-addon</code> add-on that enables you to use Knative Eventing with {PRODUCT} services that consume or publish messages within a Business Process Model and Notation (BPMN) process model or Serverless Workflow. {PRODUCT} runtime events for messages, processes, tasks, and other application activities are published in <a href="https://cloudevents.io/">CloudEvents</a> format so that they can be consumed efficiently by other entities, such as the Knative Eventing system.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Knative Eventing is currently supported for {PRODUCT} services on Quarkus only. The {PRODUCT} Operator supports Knative Eventing 0.17 or later.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-messaging-example.png" alt="Image of BPMN process receiving and publishing messages">
</div>
<div class="title">Figure 212. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>When the Knative Eventing add-on is enabled in the {PRODUCT} project that contains this example process, an event consumer is generated from the message start node and an event producer is generated from the message end node at build time.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates a scenario with Knative Eventing and a {PRODUCT} service that contains event consumers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-knative-impl-listening-event.png" alt="{PRODUCT} service listening to events">
</div>
<div class="title">Figure 213. Knative Eventing and a {PRODUCT} service with event consumers</div>
</div>
<div class="paragraph">
<p>In this scenario, three Knative Eventing <a href="https://knative.dev/docs/eventing/triggers/">Triggers</a> are generated to filter the messages that are received by the {PRODUCT} service. These messages are sent to the default {PRODUCT} service port. A message-routing mechanism in the generated code redirects the message to an inner channel based on the name of the message start event in the BPMN process model. The names of message start and end events serve as unique CloudEvents <a href="https://github.com/cloudevents/spec/blob/v1.0/spec.md#type"><code>type</code> attribute</a> definitions in Knative Eventing.</p>
</div>
<div class="paragraph">
<p>In the example <code>handle-travlers.bpmn2</code> process, the message start node is named <code>travelers</code>, so a message with a <code>type</code> named <code>travelers</code> triggers the message start node, as shown in the following example curl request:</p>
</div>
<div class="listingblock">
<div class="title">Example request to trigger the <code>travelers</code> message start event</div>
<div class="content">
<pre class="highlight"><code>$ curl -X POST \
      -H "content-type: application/json"  \
      -H "ce-specversion: 1.0"  \
      -H "ce-source: /from/localhost"  \
      -H "ce-type: travelers"  \
      -H "ce-id: 12346"  \
      -d '{"firstName": "Jane", "lastName": "Doe", "email": "jane.doe@example.com", "nationality": "German"}' \
  http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following diagram illustrates a scenario with Knative Eventing and a {PRODUCT} service that contains event producers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-knative-impl-producing-event.png" alt="{PRODUCT} service producing events">
</div>
<div class="title">Figure 214. Knative Eventing and a {PRODUCT} service with event producers</div>
</div>
<div class="paragraph">
<p>In this scenario, the {PRODUCT} service sends HTTP POST messages to the Knative Eventing <a href="https://knative.dev/docs/eventing/broker/">Broker</a> through the <code>SinkBinding</code> resource. The <code>SinkBinding</code> endpoint is generated by the Knative Eventing platform and is injected in the {PRODUCT} service container as an environment variable named <code>${K_SINK}</code>.</p>
</div>
<div class="paragraph">
<p>The following example message is generated by the {PRODUCT} service:</p>
</div>
<div class="listingblock">
<div class="title">Example message generated by the {PRODUCT} service</div>
<div class="content">
<pre class="highlight"><code>Context Attributes,
  specversion: 1.0
  type: process/travelers/processedtravellers
  source: /process/Travelers/2f692fd9-fff8-4b0a-bb64-96d1a4772490
  id: 29e43b17-3a70-4b46-aca0-7ab8e2133eee
  time: 2020-08-10T20:52:39.383346Z
Extensions,
  knativearrivaltime: 2020-08-10T20:52:39.391404032Z
  knativehistory: default-kne-trigger-kn-channel.kogito.svc.cluster.local
  kogitoprocessid: Travelers
  kogitoprocessinstanceid: 2f692fd9-fff8-4b0a-bb64-96d1a4772490
  kogitoprocessinstancestate: 1
Data,
  {"firstName":"Jan","lastName":"Kowalski","email":"jan.kowalski@example.com","nationality":"German","processed":true}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the CloudEvents <code>type</code> attribute uses the format <code>process/<em>PROCESS_ID</em>/<em>NODE_NAME</em></code>. This format prevents the messages generated by the {PRODUCT} service from conflicting with other messages being generated within the cluster, and enables the <code>SinkBinding</code> objects to filter these messages by a unique <code>type</code>. The generated CloudEvents message also contains information about the process instance, such as the process ID, process instance ID, and process instance state.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates the overall architecture of a {PRODUCT} service deployed in a Knative Eventing environment on a Kubernetes or OpenShift cluster:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-knative-deployment-architecture.png" alt="{PRODUCT} service deployed on Knative Eventing environment">
</div>
<div class="title">Figure 215. {PRODUCT} service deployed in Knative Eventing environment on Kubernetes or OpenShift</div>
</div>
<div id="proc-knative-eventing-process-services_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Knative Eventing for {PRODUCT} services</p>
</div>
<div class="paragraph _abstract">
<p>You can enable <a href="https://knative.dev/docs/eventing/">Knative Eventing</a> support for {PRODUCT} services that consume or publish messages within a Business Process Model and Notation (BPMN) process model. When you enable Knative Eventing for a {PRODUCT} project, event consumers and producers are generated from message start and end nodes in BPMN processes at build time. You can use these event consumers and producers as part of your {PRODUCT} service deployment in a Knative Eventing environment on Kubernetes or OpenShift clusters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Knative Eventing is currently supported for {PRODUCT} services on Quarkus only. The {PRODUCT} Operator supports Knative Eventing 0.17 or later.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed and deployed Knative Eventing 0.17 or later on a Kubernetes or an OpenShift cluster. For information about Knative Eventing on OpenShift, see <a href="https://docs.openshift.com/container-platform/4.5/serverless/installing_serverless/installing-knative-eventing.html">Installing Knative Eventing</a> in the OpenShift documentation.</p>
</li>
<li>
<p>You have created a BPMN model in your {PRODUCT} project with message start or end events that you want to integrate with Knative Eventing. For information about creating BPMN models, see <a href="#proc-bpmn-model-creating_kogito-developing-process-services">[proc-bpmn-model-creating_kogito-developing-process-services]</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your {PRODUCT} project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Knative Eventing dependencies</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
    &lt;artifactId&gt;knative-eventing-addon&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
    &lt;artifactId&gt;kogito-cloudevents-quarkus-addon&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-smallrye-reactive-messaging&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.smallrye.reactive&lt;/groupId&gt;
    &lt;artifactId&gt;smallrye-reactive-messaging-http&lt;/artifactId&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These dependencies enable Knative Eventing add-on and messaging requirements. When a {PRODUCT} service has the Knative Eventing add-on enabled, {PRODUCT} generates code based on <a href="http://www.smallrye.io/smallrye-reactive-messaging/">Smallrye Reactive Messaging</a> to publish messages.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your {PRODUCT} project, open the BPMN file that you want to use for consuming or producing messages in the Knative Eventing environment. BPMN files are typically in <code>src/main/resources</code>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-messaging-example.png" alt="Image of BPMN process receiving and publishing messages">
</div>
<div class="title">Figure 216. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>The names of message start and end events serve as CloudEvents <a href="https://github.com/cloudevents/spec/blob/v1.0/spec.md#type"><code>type</code> attribute</a> definitions in Knative Eventing and must be unique.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For each message event in the BPMN process model, select the node, click <strong>Properties</strong> in the upper-right corner of the modeler, and verify that the node name is clear and unique.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, consider adding the project or process name as a prefix to the message node name, such as <code>travelagency.travelers</code> in the following example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-knative-set-node-name.png" alt="Image of a message node property name">
</div>
<div class="title">Figure 217. Set a unique message node name</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After you verify and save the message node names, navigate to the <code>src/main/resources/application.properties</code> file in your {PRODUCT} project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required application properties for publishing</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-http
mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-http
mp.messaging.outgoing.kogito_outgoing_stream.url=${K_SINK}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>smallrye-http</code> property defines the HTTP endpoint for the published messages. The <code>${K_SINK}</code> property is an environment variable injected by Knative Eventing when you deploy a {PRODUCT} service that references a Knative Eventing <a href="https://knative.dev/docs/eventing/samples/sinkbinding/"><code>SinkBinding</code></a> object.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Build your {PRODUCT} project locally using your usual method, such as <code>mvn clean package</code>, and navigate to the <code>target/generated-sources/kogito</code> directory in your project and verify the following contents:</p>
<div class="ulist">
<ul>
<li>
<p>Generated classes with the suffixes <code>MessageConsumer</code> and <code>MessageProducer</code>. These classes are generated based on the message start and end events in your BPMN model.</p>
</li>
<li>
<p>Generated <code>app</code> folder containing a <code>CloudEventListenerResource.java</code> file. This file detects any CloudEvents messages produced by the Knative Eventing source that targets your {PRODUCT} service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these items are missing, ensure that you have configured all required dependencies, applications properties, and message event name. After all checks are complete, rebuild the project.</p>
</div>
</li>
<li>
<p>After you configure and test your {PRODUCT} project locally, in your Kubernetes or OpenShift environment, add the following custom resources to prepare your {PRODUCT} project for deployment. These resources enable the {PRODUCT} Operator to generate the required resources for consuming or producing events in a Knative Eventing environment.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Broker</code>: When you deploy a {PRODUCT} service that uses the <code>knative-eventing-addon</code> add-on, you must also deploy a Knative Eventing <a href="https://knative.dev/docs/eventing/broker/">Broker</a> in the same namespace. The {PRODUCT} service uses this Broker to publish or listen to CloudEvents messages. You can use any Broker channel for the {PRODUCT} service, such as InMemoryChannel, KafkaChannel, or NatssChannel.</p>
<div class="paragraph">
<p>By default, the InMemoryChannel channel is used when no channel is specified, as shown in the following <code>Broker</code> custom resource example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>Broker</code> custom resource for Knative Eventing with default InMemoryChannel</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Broker
metadata:
  name: default</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
InMemoryChannel channels are for development use only. Do not use this channel in a production deployment.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about available Broker channels and how to install them, see <a href="https://knative.dev/docs/eventing/channels/channels-crds/">Available Channels</a> in the Knative documentation.</p>
</div>
</li>
<li>
<p><code>KogitoInfra</code>: To bind the Knative Eventing Broker instance to the {PRODUCT} service being deployed, you must create a <code>KogitoInfra</code> instance, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example <code>KogitoInfra</code> custom resource for a {PRODUCT} service with <code>Broker</code> binding</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoInfra
metadata:
  name: kogito-knative-infra
spec:
  # Bind Knative Broker to the service
  resource:
    apiVersion: eventing.knative.dev/v1
    kind: Broker
    name: default</code></pre>
</div>
</div>
</li>
<li>
<p><code>KogitoRuntime</code>: The <code>KogitoRuntime</code> resource used to deploy the {PRODUCT} service using the {PRODUCT} Operator must have this <code>KogitoInfra</code> instance linked to it, as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example <code>KogitoRuntime</code> custom resource for a {PRODUCT} service with <code>KogitoInfra</code> bound to it</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: app.kiegroup.org/v1beta1
kind: KogitoRuntime
metadata:
  name: process-knative-quickstart-quarkus
spec:
  replicas: 1
  image: quay.io/<em>NAME_SPACE</em>/process-knative-quickstart-quarkus:latest
  # Reference to the KogitoInfra resource with the Knative Broker binding
  infra:
  - kogito-knative-infra</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you apply these resources to the Kubernetes or OpenShift namespace, if any BPMN or Serverless Workflow files in the {PRODUCT} project contain events to be consumed or produced, the {PRODUCT} Operator automatically creates the required Knative Eventing <a href="https://knative.dev/docs/eventing/triggers/"><code>Trigger</code></a> resource for consuming events and the <a href="https://knative.dev/docs/eventing/samples/sinkbinding/"><code>SinkBinding</code></a> resource for producing events.</p>
</div>
<div class="paragraph">
<p>The following is an example <code>Trigger</code> resource generated by the {PRODUCT} Operator:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>Trigger</code> custom resource generated by the operator (consuming)</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: travelers-trigger
spec:
  # The default Broker is enabled in the cluster because the namespace is labeled with `knative-eventing-injection=enabled`.
  broker: default
  filter:
    attributes:
      # Name of the message node in the process.
      type: travelers
  # The subscriber is the deployed service. Any event that matches the filter in the Broker is sent here.
  subscriber:
    ref:
      apiVersion: v1
      kind: Service
      name: process-knative-quickstart-quarkus</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Knative Eventing Trigger resource filters all messages delivered to the default Broker and sends them to the default service deployed by the {PRODUCT} Operator.</p>
</div>
<div class="paragraph">
<p>The following is an example <code>SinkBinding</code> resource generated by the {PRODUCT} Operator:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>SinkBinding</code> custom resource generated by the operator (producing)</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: sources.knative.dev/v1alpha1
kind: SinkBinding
metadata:
  name: process-knative-quickstart-quarkus-sink
spec:
  subject:
    apiVersion: apps/v1
    kind: Deployment
    selector:
      matchLabels:
        app: process-knative-quickstart-quarkus
  # Any cloud event produced by the application is delivered to the Broker.
  sink:
    ref:
      apiVersion: eventing.knative.dev/v1
      kind: Broker
      name: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Knative Eventing <code>SinkBinding</code> resource injects the <code>${K_SINK}</code> environment variable to the <code>Deployment</code> resource created by the {PRODUCT} Operator. Every message produced by the {PRODUCT} service is redirected to the default Knative Broker.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you deploy your {PRODUCT} services without the {PRODUCT} Operator, you must create these <code>Trigger</code> and <code>SinkBinding</code> resources manually.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If any other components need to consume the messages produced by the {PRODUCT} service, you must create an additional Knative Eventing <code>Trigger</code> resource as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Custom resource for other consuming components</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: event-display-trigger
spec:
  # The default Broker is enabled in the namespace.
  broker: default
  filter:
    # Listens only to events of type `success` emitted by the CloudEvents-processing service.
    attributes:
      # The same type being generated by the custom service.
      type: /process/travelers/processedtravellers
      # The subscriber is the deployed displayer service. Any event that matches the filter in the Broker is sent here.
  subscriber:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: event-display</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>spec.filter.attributes.type</code> value defined in the <code>Trigger</code> resource is the same as the value generated by the {PRODUCT} service.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For an example {PRODUCT} service with Knative Eventing enabled, see the <a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-knative-quickstart-quarkus"><code>process-knative-quickstart-quarkus</code></a> example application.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DEPLOYING_ON_OPENSHIFT}#chap-kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>]</p>
</li>
<li>
<p>{URL_DEPLOYING_ON_OPENSHIFT}#proc-kogito-deploying-on-kubernetes_kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>]</p>
</li>
</ul>
</div>
<div id="con-task-lifecycle_kogito-developing-decision-services" class="paragraph">
<p>== Task lifecycle in {PRODUCT} processes</p>
</div>
<div class="paragraph _abstract">
<p>In {PRODUCT} business processes, tasks are implemented as work items and their execution is defined by work item handlers. User tasks in particular are a core construct in {PRODUCT} processes. When a user task is reached in a process, the task progresses through phases of a defined lifecycle until it reaches an end state.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} supports the following default phases in a work item (task) lifecycle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Active</strong>: Indicates initial state when the work item is activated</p>
</li>
<li>
<p><strong>Abort</strong>: Indicates abnormal completion of the work item</p>
</li>
<li>
<p><strong>Complete</strong>: Indicates normal completion of the work item</p>
</li>
<li>
<p><strong>Claim</strong>: Assigns the work item to a specific actor, restricting access to anyone else</p>
</li>
<li>
<p><strong>Release</strong>: Unassigns the work item from a specific actor, releasing it to any other potential user or group to work on it (by claiming or completing)</p>
</li>
<li>
<p><strong>Skip</strong>: Skips the work item</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With {PRODUCT}, you can also add custom lifecycles and lifecycle phases to meet your business needs.</p>
</div>
<div class="paragraph">
<p>A lifecycle moves a work item across various phases that are not defined by the <code>WorkItem</code> interface and defines the behavior of a work item at runtime. You typically add a lifecycle on top of the <code>WorkItemHandler</code> interface so that the lifecycle is pluggable with more flexible runtime characteristics.</p>
</div>
<div class="paragraph">
<p>The <code>WorkItemHandler</code> interface provides the option to move between task phases, as shown in the following method example:</p>
</div>
<div class="listingblock">
<div class="title">WorkItemHandler support for moving between task phases</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void transitionToPhase(WorkItem workItem, WorkItemManager manager, Transition&lt;?&gt; transition)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This method is a default method that does nothing when not implemented. This functionality maintains backward compatibility with existing work item handler implementations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You typically implement the <code>transitionToPhase</code> method as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example implementation of transitionToPhase method</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
public void transitionToPhase(WorkItem workItem, WorkItemManager manager, Transition&lt;?&gt; transition) {

    lifeCycle.transitionTo(workItem, manager, (Transition&lt;Map&lt;String, Object&gt;&gt;) transition);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>lifeCycle</code> element is an implementation of <code>org.kie.{PRODUCT_INIT}.process.workitem.LifeCycle&lt;T&gt;</code> that defines the execution semantics.</p>
</div>
<div class="paragraph">
<p>=== User task authorization</p>
</div>
<div class="paragraph">
<p>The <code>org.jbpm.process.instance.impl.humantask.BaseHumanTaskLifeCycle</code> implementation in {PRODUCT} ensures that a user task is worked on by authorized users, based on the user or group assignments that you provide.</p>
</div>
<div class="paragraph">
<p>You can use the following parameters to provide assignments for authorized users or groups in the relevant BPMN process model. All of the listed parameters support expressions.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 93. Parameters for authorized users or groups</caption>
<colgroup>
<col style="width: 35%;">
<col style="width: 35%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ActorId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of authorized users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>John,Mary,#{actor}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GroupId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of authorized groups of users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mangers,#{mygroup}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BusinessAdministratorId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of authorized administrators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>administrator,#{adminuser}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BusinessAdministratorGroupId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of groups of administrators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admins,#{admingroup}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ExcludedOwnerId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of unauthorized users who cannot work on this task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>paul,#{lastactor}</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Authorization is only enforced when the method that calls the work item lifecycle methods uses a security context. This security behavior is dependent on the API that you use.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>=== API interaction with task lifecycle phases</p>
</div>
<div class="paragraph">
<p>The following example API interacts with user tasks (work items) using lifecycle phases:</p>
</div>
<div class="listingblock">
<div class="title">Example API to interact with task lifecycle phases</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Start process instance
ProcessInstance&lt;?&gt; processInstance = approvalsProcess.createInstance(m);
processInstance.start();

// Set up security policy with identity information
StaticIdentityProvider identity = new StaticIdentityProvider("admin", Collections.singletonList("managers"));
SecurityPolicy policy = SecurityPolicy.of(identity);

// Get list of work items, taking security restrictions into account
List&lt;WorkItem&gt; workItems = processInstance.workItems(policy);

// Work on a task
final String wiId = workItems.get(0).getId();
processInstance.transitionWorkItem(wiId,
                                   new HumanTaskTransition(Claim.ID, null, policy));

processInstance.transitionWorkItem(wiId,
                                   new HumanTaskTransition(Complete.ID, Collections.singletonMap("approved", false), policy));</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you interact with user tasks through a REST API, you can also provide the following query parameters for user and group information:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 94. Query parameters for user or group information in REST APIs</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Multi-value support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User name to be used for the user task authorization check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zero or more group names to be used for the user task authorization check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, the following REST endpoints interact with user tasks in an <code>orderItems.bpmn2</code> process for verifying customer orders:</p>
</div>
<div class="listingblock">
<div class="title">Example GET request to retrieve open tasks using the process UUID</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orderItems/66c11e3e-c211-4cee-9a07-848b5e861bc5/tasks</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"62f1c985-d31c-4ead-9906-2fe8d05937f0":"Verify order"}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example GET request to retrieve task details by process and task UUID</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orderItems/66c11e3e-c211-4cee-9a07-848b5e861bc5/Verify_order/62f1c985-d31c-4ead-9906-2fe8d05937f0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"62f1c985-d31c-4ead-9906-2fe8d05937f0","input1":{"orderNumber":"12345","shipped":false,"total":0.537941914075738},"name":"Verify order"}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example POST request to complete the task and define the authorized group and user</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orderItems/66c11e3e-c211-4cee-9a07-848b5e861bc5/Verify_order/62f1c985-d31c-4ead-9906-2fe8d05937f0?group=managers&amp;user=john -H "accept: application/json" -H "content-type: application/json"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"66c11e3e-c211-4cee-9a07-848b5e861bc5","order":{"orderNumber":"12345","shipped":false,"total":0.537941914075738}}</code></pre>
</div>
</div>
<div id="proc-task-lifecycle-custom_kogito-developing-decision-services" class="paragraph">
<p>=== Creating a custom task lifecycle and phase</p>
</div>
<div class="paragraph _abstract">
<p>You can extend the user task lifecycle and lifecycle phases in {PRODUCT} to implement a custom lifecycle and phases as needed.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To add custom lifecycle phases, implement the <code>org.kie.kogito.process.workitem.LifeCyclePhase</code> resource in the Java class for your custom lifecycle phases.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>This resource implements the following key methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: Assigns a unique ID that is used when transitioning through phases</p>
</li>
<li>
<p><code>canTransition</code>: Provides a checkpoint between phases, if this phase can be transitioned from a specified phase</p>
</li>
<li>
<p><code>status</code>: Defines a human-readable status for this phase</p>
</li>
<li>
<p><code>isTerminating</code>: Determines if this phase is a completion stage, and if so, completes the work item and moves on to the next activity in the process</p>
</li>
<li>
<p><code>apply</code>: Enables additional updates to the work item when transitioning through phases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can implement as many phases as needed or extend existing phases.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To add a custom lifecycle, implement the <code>org.kie.kogito.process.workitem.LifeCycle&lt;Map&lt;String, Object&gt;&gt;</code> resource in the Java class for your custom lifecycle.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To support user tasks, the parameterized type <code>LifeCycle</code> must be <code>Map&lt;String, Object&gt;</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This resource implements the following key methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>phaseById</code>: Retrieves the lifecycle phase by ID to verify if the phase is supported by the lifecycle implementation</p>
</li>
<li>
<p><code>phases</code>: Returns all supported phases by a specified lifecycle implementation</p>
</li>
<li>
<p><code>transitionTo</code>: Provides the main logic to handle phase transition</p>
</li>
<li>
<p><code>data</code>: Returns the current state of data for the work item</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example Java class that extends the <code>Complete</code> lifecycle phase from a custom lifecycle implementation:</p>
</div>
<div class="listingblock">
<div class="title">Example Java class to extend the <code>Complete</code> lifecycle phase</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.travels.usertasks;

import java.util.Arrays;
import java.util.List;

import org.jbpm.process.instance.impl.workitem.Complete;
import org.kie.kogito.process.workitem.LifeCyclePhase;

public class CompleteStartedOnly extends Complete {

    private List&lt;String&gt; allowedTransitions = Arrays.asList(Start.ID);

    @Override
    public boolean canTransition(LifeCyclePhase phase) {
        return allowedTransitions.contains(phase.id());
    }

}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After you implement your custom lifecycle or lifecycle phases, create a Java configuration class to enable the {PROCESS_ENGINE} to use the new lifecycle or phase instead of the default lifecycle.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>In this configuration, you use the <code>WorkItemHandlerConfig</code> class as you do for any other work item handler, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example configuration class for a custom lifecycle phase</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class CustomWorkItemHandlerConfig extends DefaultWorkItemHandlerConfig {
 {
  register("Human Task", new HumanTaskWorkItemHandler(new CustomHumanTaskLifeCycle()));
 }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The work item handler is the same as the default, but instead of the default lifecycle, you pass as a constructor argument the custom implementation of the <code>LifeCycle</code> interface.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example {PRODUCT} services with custom task lifecycle configurations, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-usertasks-custom-lifecycle-quarkus"><code>process-usertasks-custom-lifecycle-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-usertasks-custom-lifecycle-springboot"><code>process-usertasks-custom-lifecycle-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="con-flex-processes_kogito-developing-decision-services" class="paragraph">
<p>== Flexible processes for case management in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} does not support the <a href="https://www.omg.org/cmmn/">Case Management Model and Notation (CMMN) specification</a> for case management in process services. Instead, {PRODUCT} uses Business Process Model and Notation (BPMN) extensions to provide similar case-management functionality through <em>flexible processes</em>.</p>
</div>
<div class="paragraph">
<p>A flexible process in {PRODUCT} is any process definition that uses ad hoc components or other features that enable the process to be executed more flexibly than traditional processes. For example, a flexible process does not require a standard start event and does not require all nodes to be connected. Some of the typical components in flexible processes include the <code>Ad-Hoc</code> process property that enables the process to use ad hoc auto-start fragments and to not require strict start and end events, ad hoc subprocesses that contain embedded inner activities within another process, and milestones that flag or trigger tasks and events.</p>
</div>
<div class="paragraph">
<p>Similar to case files in CMMN, flexible processes enable you to define traditional processes with more flexibility when the execution path is not rigid. This flexibility is helpful when the process cannot be fully automated or when the scope of the process is difficult to measure. A typical example of a case or flexible process is related to healthcare. A patient has a file that is accessible to the doctor and to any health professionals (or <em>knowledge workers</em>) who are assigned to the patient. These assigned workers take action and make different decisions and assessments until the patient is diagnosed and treated, completing the case or flexible process.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following key case-related features in flexible processes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ad hoc processes</strong>: An ad hoc process is any process definition that has the <code>Ad-Hoc</code> property enabled in the process diagram <strong>Properties</strong> panel. This property enables the process to use ad hoc auto-start fragments, such as ad hoc subprocesses and ad hoc tasks, and to not require strict start and end events. An ad hoc process is similar to a Case in CMMN.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-ad-hoc-process.png" alt="Image of Ad-Hoc process property">
</div>
<div class="title">Figure 218. Ad hoc process property</div>
</div>
</li>
<li>
<p><strong>Ad hoc subprocesses</strong>: An ad hoc subprocess contains embedded inner activities within another process and is a standard BPMN component that is supported in {PRODUCT}. An ad hoc subprocess is similar to a Stage in CMMN.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-adhoc-subprocess.png" alt="Image of ad hoc subprocess node in process designer">
</div>
<div class="title">Figure 219. Ad hoc subprocess node</div>
</div>
</li>
<li>
<p><strong>Ad hoc auto-start fragments</strong>: An ad hoc auto-start fragment is any ad hoc process, ad hoc subprocess, or ad hoc task with the <code>AdHoc Autostart</code> property enabled. This property enables the fragment to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-adhoc-subprocess-autostart.png" alt="Image of ad hoc subprocess node in process designer">
</div>
<div class="title">Figure 220. Ad hoc auto-start property</div>
</div>
</li>
<li>
<p><strong>Milestones</strong>: A milestone is a standard CMMN component that is incorporated in {PRODUCT} as a BPMN custom task. A milestone represents a single point of achievement within a process instance. You can use milestones to flag certain events to trigger other tasks or track the progress of the process.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-milestone.png" alt="Image of Mileston node in process designer">
</div>
<div class="title">Figure 221. Milestone node</div>
</div>
</li>
<li>
<p><strong>REST API requests as signals</strong>: A REST API request can serve as a signal event to trigger milestones or to create and start ad hoc fragments such as ad hoc processes, ad hoc subprocesses, or tasks. For non-flexible processes, an empty <code>POST</code> request for a process triggers the start node, whereas in a flexible process, the request creates the process instance. Similarly for ad hoc tasks, an empty <code>POST</code> request instantiates the task node. All ad hoc auto-start fragments with the <code>AdHoc Autostart</code> property enabled are started automatically when the process is created.</p>
<div class="listingblock">
<div class="title">Example curl request to add comments to a ticket</div>
<div class="content">
<pre class="highlight"><code>curl -D -X POST -H 'Content-Type:application/json' -H 'Accept:application/json' http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP/1.1 201 Created
Content-Length: 305
Location: http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment/f3b36cf9-3953-43ae-afe6-2a48fea8a79a
Content-Type: application/json

{
  "id":"b3c75b24-2691-4a76-902c-c9bc29ea076c",
  "supportCase":{
    "product": {
      "name":"Kogito",
      "family":"Middleware"
    },
    "description":"Kogito is not working for some reason.",
    "engineer":"kelly",
    "customer":"Paco the customer",
    "state":"WAITING_FOR_OWNER",
    "comments":null,
    "questionnaire":null
  },
  "supportGroup":"Kogito"
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div id="ref-flex-process-example_kogito-developing-decision-services" class="paragraph">
<p>=== Flexible process example</p>
</div>
<div class="paragraph _abstract">
<p>A typical flexible process consists of one or more of the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Optional start event (might or might not be explicit)</p>
</li>
<li>
<p>Optional node connections (might or might not connect all nodes)</p>
</li>
<li>
<p>Enabled <code>Ad-Hoc</code> process property</p>
</li>
<li>
<p>One or more subprocesses, typically ad hoc subprocesses</p>
</li>
<li>
<p>Ad hoc auto-start fragments, such as ad hoc subprocesses or ad hoc tasks</p>
</li>
<li>
<p>Milestones that flag or trigger events</p>
</li>
<li>
<p>End event to terminate the process</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example is a real-world BPMN model scenario that demonstrates how you can use flexible processes for case management. In this scenario, a service desk uses a flexible process for handling customer tickets related to problems or questions about a specific product.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This example is based on the <code>flexible-process-quarkus</code> application in the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub. However, this example may differ from the exact example source code as {PRODUCT} continues to be developed. Be sure to explore this and other {PRODUCT} examples in GitHub to help you develop your own applications.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-flex-process-example.png" alt="Image of `service-desk.bpmn2` example process">
</div>
<div class="title">Figure 222. Example <code>service-desk.bpmn2</code> flexible process</div>
</div>
<div class="paragraph">
<p>To start the process and generate a ticket, a user provides an initial <code>supportCase</code> object in a REST request that contains information about the product, the customer, and the related issue:</p>
</div>
<div class="listingblock">
<div class="title">Example REST request to start the process and generate a ticket</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "supportCase": {
    "customer": "Paco the customer",
    "description": "Kogito is not working for some reason.",
    "product": {
      "family": "Middleware",
      "name": "Kogito"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the ticket is generated, the <code>Triage</code> ad hoc subprocess is automatically started and the ticket is assigned to a support team and then to a support engineer. If the system cannot determine which team to assign the ticket to, a user assigns the ticket manually to a support engineer.</p>
</div>
<div class="paragraph">
<p>The decision logic for the <code>Triage</code> subprocess is defined in the following <code>SupportGroup</code> decision table in the <code>triage.dmn</code> Decision Model and Notation (DMN) model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-flex-process-example-decision-table.png" alt="Image of `SupportGroup` example DMN decision table">
</div>
<div class="title">Figure 223. Example <code>SupportGroup</code> DMN decision table</div>
</div>
<div class="paragraph">
<p>The <code>Work case</code> ad hoc subprocess is also automatically started when the process is created. Anyone from the <code>customer</code> and <code>support</code> groups can add comments. To create a task that can be used to add a comment, a user can send an empty <code>POST</code> request as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -D -X POST -H 'Content-Type:application/json' -H 'Accept:application/json' http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP/1.1 201 Created
Content-Length: 305
Location: http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment/f3b36cf9-3953-43ae-afe6-2a48fea8a79a
Content-Type: application/json

{
  "id":"b3c75b24-2691-4a76-902c-c9bc29ea076c",
  "supportCase":{
    "product": {
      "name":"Kogito",
      "family":"Middleware"
    },
    "description":"Kogito is not working for some reason.",
    "engineer":"kelly",
    "customer":"Paco the customer",
    "state":"WAITING_FOR_OWNER",
    "comments":null,
    "questionnaire":null
  },
  "supportGroup":"Kogito"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A user can then use the URL in the <code>Location</code> HTTP header when rendering the <code>form action</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example form action for a user comment</div>
<div class="content">
<pre class="highlight"><code>&lt;form action="http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment/f3b36cf9-3953-43ae-afe6-2a48fea8a79a" method="post"&gt;
  &lt;label for="comment"&gt;Comment:&lt;/label&gt;
  &lt;input type="text" id="comment" name="comment"&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the customer is satisfied with the ticket response and actions, a user clicks a <strong>Resolve Case</strong> button, which sends an empty <code>POST</code> request to the service task to set the case to <code>Resolved</code> and the process emits a <code>CaseResolved</code> event. This event signals the <code>CaseResolved</code> milestone, which starts the <code>Close</code> ad hoc subprocess that sends, receives, and saves the customer questionnaire and closes the case.</p>
</div>
<div id="con-bpmn-process-management-addon_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} process management add-on</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a <code>process-management-addon</code> add-on that enables basic REST operations that you can use to manage process instances. These REST operations are supplemental to any other specific REST operations that you have configured in your application.</p>
</div>
<div class="paragraph">
<p>To configure process management REST capabilities for your {PRODUCT} services, you can add the process management add-on as a dependency in the <code>pom.xml</code> file of your {PRODUCT} project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process management REST operations</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;process-management-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} process management add-on provides REST support for the following basic operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process instances</strong>: Abort an active process instance</p>
</li>
<li>
<p><strong>Node instances</strong>:  Cancel or re-trigger a node instance, or trigger a new node instance</p>
</li>
<li>
<p><strong>Error handling</strong>: Retrieve error details for a process instance, or skip or re-trigger a failed node instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to exposed REST operations, the process management add-on also provides the following REST exception mappers to generate more meaningful error messages for typical exception types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ProcessInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeNotFound</code></p>
</li>
<li>
<p><code>ProcessInstanceExecutionError</code></p>
</li>
<li>
<p><code>NotAuthorized</code></p>
</li>
<li>
<p><code>InvalidTransition</code> (for work items)</p>
</li>
<li>
<p><code>InvalidLifeCyclePhase</code> (for work items)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These exception mappers produce a valid HTTP error code with JSON payload with the context that caused the exception.</p>
</div>
<div class="paragraph">
<p>For example, the following is a <code>ProcessInstanceNotFoundException</code> error generated at runtime:</p>
</div>
<div class="listingblock">
<div class="title">Example error with JSON payload at runtime</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP code : 404

{
  "processInstanceId" : "c6862071-0f2e-4f21-9bc8-586245a76c3aa",
  "message" : "Process instance with id c6862071-0f2e-4f21-9bc8-586245a76c3aa not found"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>=== REST endpoints for the process management add-on</p>
</div>
<div class="paragraph">
<p>After you add the <code>process-management-addon</code> dependency to your {PRODUCT} project and run your {PRODUCT} services, you can use the following REST endpoints to manage your process and node instances. These REST operations are supplemental to any other specific REST operations that you have configured in your application.</p>
</div>
<div class="paragraph">
<p>For each endpoint, use a REST client, curl utility, or Swagger UI (if configured for the application) to send requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base URL</strong>: <code>http://<em>HOST</em>:<em>PORT</em>/management/processes/{processId}/instances/{processInstanceId}</code></p>
</li>
<li>
<p><strong>Path parameters</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>{processId}</code>: The string identifier of the process definition, such as <code>orders</code></p>
</li>
<li>
<p><code>{processInstanceId}</code>: The integer identifier of the process instance, such as <code>ec44f890-d21d-444f-a4ec-cb88589bd79</code></p>
</li>
<li>
<p><code>{nodeId}</code>: The string identifier of the node, such as <code>verifyOrders</code></p>
</li>
<li>
<p><code>{nodeInstanceId}</code>: The integer identifier of the node instance, such as <code>6e46bec2-0273-46f6-ad7d-2ff156e55a6c</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>==== Process instances</p>
</div>
<div class="paragraph">
<p>Use the following REST endpoints from the process management add-on to interact with process instances:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return active node instances for a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[GET] /management/processes/{processId}/instances/{processInstanceId}/nodeInstances</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "ec44f890-d21d-444f-a4ec-cb88589bd79a",
  "name": "Verify order",
  "nodeInstanceId": "6e46bec2-0273-46f6-ad7d-2ff156e55a6c",
  "parameters": {
    "Locale": "en-UK",
    "TaskName": "Verify order",
    "NodeName": "Verify order",
    "Priority": "1",
    "input1": {
      "orderNumber": "12345",
      "shipped": false,
      "total": 0.8233575052440095
    },
    "Skippable": "true",
    "ActorId": "john"
  },
  "phase": "active",
  "phaseStatus": "Ready",
  "results": {},
  "state": 0
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Abort a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[DELETE] /management/processes/{processId}/instances/{processInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>==== Nodes</p>
</div>
<div class="paragraph">
<p>Use the following REST endpoint from the process management add-on to interact with process nodes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return nodes from a process</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[GET] /management/processes/{processId}/nodes</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/nodes</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET localhost:8080/management/processes/orders/nodes -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[
  {
    "name": "End",
    "id": 1,
    "type": "EndNode",
    "uniqueId": "1"
  },
  {
    "name": "End",
    "id": 2,
    "type": "EndNode",
    "uniqueId": "2"
  },
  {
    "name": "Hello2",
    "id": 3,
    "type": "HumanTaskNode",
    "uniqueId": "3"
  },
  {
    "name": "Split",
    "id": 4,
    "type": "Split",
    "uniqueId": "4"
  },
  {
    "name": "End",
    "id": 5,
    "type": "EndNode",
    "uniqueId": "5"
  },
  {
    "name": "End",
    "id": 6,
    "type": "EndNode",
    "uniqueId": "6"
  },
  {
    "name": "Hello1",
    "id": 7,
    "type": "HumanTaskNode",
    "uniqueId": "7"
  },
  {
    "name": "Start",
    "id": 8,
    "type": "StartNode",
    "uniqueId": "8"
  },
  {
    "name": "BoundaryEvent",
    "id": 9,
    "type": "BoundaryEventNode",
    "uniqueId": "9"
  },
  {
    "name": "BoundaryEvent",
    "id": 10,
    "type": "BoundaryEventNode",
    "uniqueId": "10"
  }
]</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>==== Node instances</p>
</div>
<div class="paragraph">
<p>Use the following REST endpoints from the process management add-on to interact with node instances:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Cancel a node instance within a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[DELETE] /management/processes/{processId}/instances/{processInstanceId}/nodeInstances/{nodeInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Re-trigger a node instance within a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/nodeInstances/{nodeInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Trigger a new instance of a node within a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/nodes/{nodeId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodes/verifyOrder</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodes/verifyOrder -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>==== Error handling</p>
</div>
<div class="paragraph">
<p>Use the following REST endpoints from the process management add-on to troubleshoot errors with process and node instances:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These endpoints function only when a process instance is in an <code>ERROR</code> state.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return error details for a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[GET] /management/processes/{processId}/instances/{processInstanceId}/error</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/error</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/error -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "processInstanceId" : "ec44f890-d21d-444f-a4ec-cb88589bd79a",
  "message" : "Process instance with id c6862071-0f2e-4f21-9bc8-586245a76c3aa contains no input assignment"
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Re-trigger any failed nodes within a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/retrigger</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/retrigger</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/retrigger -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Skip any failed nodes within a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/skip</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/skip</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/skip -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-management-console_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} Management Console</p>
</div>
<div class="paragraph _abstract">
<p>The {PRODUCT} Management Console is a user interface for viewing the state of all available {PRODUCT} services and managing process instances:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console.png" alt="Image of Kogito Management Console">
</div>
<div class="title">Figure 224. {PRODUCT} Management Console</div>
</div>
<div class="paragraph">
<p>You can use the Management Console to view process, subprocess, and node instance details, abort process instances, and view domain-specific process data.</p>
</div>
<div class="paragraph">
<p>The Management Console requires your {PRODUCT} services to use the following {PRODUCT} components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>{PRODUCT} Data Index Service</strong>: Enables the Management Console to access stored events related to processes and domain data from your {PRODUCT} services. The {PRODUCT} Data Index Service requires Infinispan persistence and Apache Kafka messaging for your {PRODUCT} service. For more information about the Data Index Service, see {URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{CONFIGURING_KOGITO}</em>].</p>
</li>
<li>
<p><strong>{PRODUCT} process management add-on</strong>: Enables the Management Console to interact with the process data from your {PRODUCT} services through the add-on REST endpoint <code>/management/processes</code>. If you do not enable this add-on for your {PRODUCT} service, the Management Console provides read-only access to your service data without the ability to modify instances, such as aborting process instances. For more information about the process management add-on, see <a href="#con-bpmn-process-management-addon_kogito-developing-process-services">[con-bpmn-process-management-addon_kogito-developing-process-services]</a>.</p>
</li>
</ul>
</div>
<div id="proc-management-console-using_kogito-developing-decision-services" class="paragraph">
<p>=== Using the {PRODUCT} Management Console to manage process instances</p>
</div>
<div class="paragraph _abstract">
<p>You can use the {PRODUCT} Management Console to view and manage process instance details from your {PRODUCT} services. You can run the Management Console for local {PRODUCT} services or add it to your {PRODUCT} infrastructure on {OPENSHIFT}.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A {PRODUCT} Data Index Service instance is configured and running for your {PRODUCT} service. The Data Index Service enables the Management Console to access stored process data. The Data Index Service requires Infinispan persistence and Apache Kafka messaging for your {PRODUCT} service. For information about the Data Index Service, see {URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{CONFIGURING_KOGITO}</em>].</p>
</li>
<li>
<p>The <code>pom.xml</code> file of your {PRODUCT} project contains the following dependency for the process management add-on. This add-on enables the Management Console to interact with the process data through the add-on REST endpoint <code>/management/processes</code>. For more information about the process management add-on, see <a href="#con-bpmn-process-management-addon_kogito-developing-process-services">[con-bpmn-process-management-addon_kogito-developing-process-services]</a>.</p>
<div class="listingblock">
<div class="title">Project dependency to enable process management REST operations</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;process-management-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>The <code>application.properties</code> file of your {PRODUCT} project contains the following system properties for the location where the {PRODUCT} service is deployed, such as <code>http://localhost:8080</code>, and for Quarkus Cross-Origin Resource Sharing (CORS) support. These properties enable the Management Console to generate the URLs to execute the REST operations from the process management add-on.</p>
<div class="listingblock">
<div class="title">Application properties for REST URLs</div>
<div class="content">
<pre class="highlight"><code>kogito.service.url=http://<em>HOST</em>:<em>PORT</em>
quarkus.http.cors=true</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/management-console/"><code>management-console</code></a> artifacts page, select the latest release of the {PRODUCT} Management Console, and download the <code>management-console-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>management-console-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Management Console:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Management Console</div>
<div class="content">
<pre class="highlight"><code>$ java -Dquarkus.http.port=8280 -jar management-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The default port for the Management Console is 8080, but this example specifies port 8280 to avoid conflicts with the example {PRODUCT} service running at port 8080.</p>
</div>
<div class="paragraph">
<p>Also, the Management Console uses the default Data Index Service port 8180. If you modified this port in your Data Index Service instance, you must also modify the port in the Management Console properties by using the start-up property <code>-Dkogito.dataindex.http.url=http://<em>HOST</em>:<em>PORT</em></code> when you run the Management Console.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To change the logging level of the Management Console, such as for debugging, you can specify the following start-up properties:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Management Console logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -Dquarkus.http.port=8280  \
  -jar management-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>In an OpenShift environment, you can use the {PRODUCT} command-line interface (CLI) or the OpenShift web console to add the Management Console to your {PRODUCT} infrastructure:</p>
</div>
<div class="listingblock">
<div class="title">Adding the Management Console to your OpenShift infrastructure using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ kogito install mgmt-console -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-management-console-instance.png" alt="Image of Kogito Management Console instance on OpenShift">
</div>
<div class="title">Figure 225. {PRODUCT} Management Console instance on OpenShift web console</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, navigate to <code><a href="http://localhost:8280" class="bare">http://localhost:8280</a></code> to open the Management Console. If you modified the configured Management Console port, use the modified location.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>On OpenShift, navigate to the route URL for the Management Console instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console.png" alt="Image of Kogito Management Console">
</div>
<div class="title">Figure 226. {PRODUCT} Management Console</div>
</div>
<div class="paragraph">
<p>In this example, the Management Console displays data for the <code>kogito-travel-agency</code> extended example application in the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Management Console, use the following pages from the left menu to interact with your process instances and data:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process Instances</strong>: Use this page to view and filter process and subprocess instances by status or business key. You can select a specific process instance name to view process details or abort, skip, or retry the process. You can also select the check box for multiple instances and use the bulk operation options at the top of the screen.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-subprocesses.png" alt="Image of expanded process with subprocesses in Management Console">
</div>
<div class="title">Figure 227. Expanded process with subprocesses</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-process-details.png" alt="Image of process details in Management Console">
</div>
<div class="title">Figure 228. Details for a selected process instance</div>
</div>
<div class="paragraph">
<p>For process instances in an error state, you can select the <strong>Error</strong> icon to view error details and skip or retry the process instance. You can also select the process instance name to view the exact node instance in the process <strong>Timeline</strong> where the error occurred and skip or retry the specific node instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-process-error.png" alt="Image of process with error in Management Console">
</div>
<div class="title">Figure 229. Skip or retry a process instance with an error</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-error.png" alt="Image of node with error in Management Console">
</div>
<div class="title">Figure 230. Node instance with an error in a selected process</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-error-skip.png" alt="Image of skipping a node instance in error state in Management Console">
</div>
<div class="title">Figure 231. Skip or retry a node instance with an error</div>
</div>
<div class="paragraph">
<p>You can also cancel or retrigger active nodes in the process <strong>Timeline</strong> page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-cancel-retrigger.png" alt="Image of retrigger and cancel options in timeline of Management Console">
</div>
<div class="title">Figure 232. Cancel or retrigger a node instance in active state</div>
</div>
<div class="paragraph">
<p>If a node in the timeline is related to a job, you can select the clock icon to view the job details or select the kebab menu for additional job operations, such as <strong>Job Reschedule</strong> or <strong>Job Cancel</strong>, depending on the job status.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-error-job-actions.png" alt="Image of job actions options for error node in timeline of Management Console">
</div>
<div class="title">Figure 233. Reschedule the job for a node in error state</div>
</div>
<div class="paragraph">
<p>In the <strong>Process Variables</strong> panel of the <strong>Process Details</strong> page, you can add, update, or delete variables and save the changes to the process instance. For example, to add an object to a key, you can hover over the key and select the edit icon, provide an object in JSON format, and click the check mark icon or press Enter to apply the change. After making all changes to the process variables, click <strong>Save</strong> in the upper-right corner to save the changes or click the refresh icon to revert the changes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-variables-add-attribute.png" alt="Image of adding attributes on process variables in Management Console">
</div>
<div class="title">Figure 234. Add a new property to process variables</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-variables-update-attribute.png" alt="Image of updating attributes on process variables in Management Console">
</div>
<div class="title">Figure 235. Update a property in process variables</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-variables-save-changes.png" alt="Image of updating attributes on process variables in Management Console">
</div>
<div class="title">Figure 236. Save changes made to process variables</div>
</div>
<div class="paragraph">
<p>The <strong>Jobs</strong> panel displays a list of available jobs related to the process instance and enables you to view details for each job.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-panel.png" alt="Image of jobs panel in Management Console">
</div>
<div class="title">Figure 237. Jobs panel</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-panel-details.png" alt="Image of jobs panel details in Management Console">
</div>
<div class="title">Figure 238. Job details</div>
</div>
<div class="paragraph">
<p>For jobs in <strong>Scheduled</strong> or <strong>Error</strong> state, you can also select the <strong>Reschedule</strong> option to reschedule the jobs or <strong>Cancel</strong> to cancel the jobs. You can modify the expiration time for one-time jobs, or the expiration time, repeat interval, and repeat limit for periodic jobs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-panel-reschedule.png" alt="Image of jobs reschedule option in Management Console">
</div>
<div class="title">Figure 239. Reschedule a job in Scheduled or Error state</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-reschedule.png" alt="Image of jobs reschedule details in Management Console">
</div>
<div class="title">Figure 240. Define job reschedule details</div>
</div>
<div class="paragraph">
<p>The <strong>Milestones</strong> panel displays a list of available milestones for the process instance, if applicable.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-milestones-panel.png" alt="Image of milestones panel in Management Console">
</div>
<div class="title">Figure 241. Process instance milestones</div>
</div>
<div class="paragraph">
<p>The <strong>Node Trigger</strong> panel displays a list of nodes that you can select from the drop-down menu and trigger.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-trigger-panel.png" alt="Image of node trigger panel in Management Console">
</div>
<div class="title">Figure 242. Trigger a selected node</div>
</div>
<div class="paragraph">
<p>As a shortcut to view the process or application UI that triggered a process instance, you can select the <strong>Endpoint</strong> for the specified process instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-process-endpoint.png" alt="Image of process instance endpoint in Management Console">
</div>
<div class="title">Figure 243. Process instance endpoint</div>
</div>
</li>
<li>
<p><strong>Domain Explorer</strong>: Use this page to view data that is generated from your process instances in the available {PRODUCT} services, or <em>domains</em>, such as the <code>Travels</code> and <code>VisaApplications</code> domains in this example. You can also refine which columns for the listed domain data are displayed based on available attributes, such as the <code>approved</code>, <code>country</code>, or <code>nationality</code> attributes in this example.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer.png" alt="Image of domain explorer in Management Console">
</div>
<div class="title">Figure 244. Domain explorer with available domains</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visa-domain-data.png" alt="Image of filters for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 245. VisaApplications domain data</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-attributes.png" alt="Image of attributes for VisaApplications domain data in Management Console">
</div>
<div class="title">Figure 246. Attributes for refining VisaApplications domain data columns</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-sorted-data.png" alt="Image of sorted data for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 247. Refined columns for VisaApplications domain data</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-select-filter-field.png" alt="Image of select filter field for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 248. Fields to filter VisaApplications domain data</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-select-filter-operator.png" alt="Image of select filter operator for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 249. Operators to filter VisaApplications domain data</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-enter-filter-text.png" alt="Image of select filter text for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 250. Sample value to filter VisaApplications domain data</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-filter-results.png" alt="Image of filter results for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 251. Filtered results</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-domain-explorer-visas-sorting-results.png" alt="Image of sorting results for VisaApplications domain in Management Console">
</div>
<div class="title">Figure 252. Sorted results</div>
</div>
</li>
<li>
<p><strong>Jobs Management</strong>: Use this page to view a list of available jobs, to filter jobs by status, and perform actions for individual jobs, such as view details, reschedule, or cancel.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-management.png" alt="Image of Jobs Management page in Management Console">
</div>
<div class="title">Figure 253. Jobs Management page</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-management-filter.png" alt="Image of Jobs Management filter in Management Console">
</div>
<div class="title">Figure 254. Jobs Management filters</div>
</div>
<div class="paragraph">
<p>You can also select multiple jobs and perform bulk operations at the top of the page, such as canceling all selected jobs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-management-bulk-cancel.png" alt="Image of Jobs Management cancel operation result in Management Console">
</div>
<div class="title">Figure 255. Cancel operation result</div>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div id="proc-management-console-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling {PRODUCT} Management Console security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based {PRODUCT} services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the {PRODUCT} Management Console to enable the console to interact with the {PRODUCT} Data Index Service using bearer token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/kiegroup/kogito-apps/tree/master/management-console">{PRODUCT} Management Console</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/kiegroup/kogito-apps/tree/master/management-console">{PRODUCT} Management Console</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the {PRODUCT} Management Console repository and enter the following command to run the application with security enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Management Console with security enabled</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Ensure that the service is not started at the same port as the security server. You can change the port by adding <code>-Dquarkus.http.port=<em>PORT_NUMBER</em></code> to the start-up properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The {PRODUCT} Management Console contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Management Console project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-console-quarkus
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=web-app
%keycloak.quarkus.oidc.logout.path=/logout
%keycloak.quarkus.oidc.logout.post-logout-path=/

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Stop and restart the {PRODUCT} Management Console to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="con-task-console_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} Task Console</p>
</div>
<div class="paragraph _abstract">
<p>The {PRODUCT} Task Console is a user interface for viewing and interacting with user tasks in {PRODUCT} process services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console.png" alt="Image of Kogito Task Console">
</div>
<div class="title">Figure 256. {PRODUCT} Task Console</div>
</div>
<div class="paragraph">
<p>You can use the Task Console to view your list of assigned tasks, view the task details for each task, and move the task to the next phase of the task lifecycle. For more information about the task lifecycle, see <a href="#con-task-lifecycle_kogito-developing-process-services">[con-task-lifecycle_kogito-developing-process-services]</a>.</p>
</div>
<div class="paragraph">
<p>The Task Console requires your {PRODUCT} services to use the {PRODUCT} Data Index Service. The Data Index Service enables the Task Console to access stored events related to tasks and domain data from your {PRODUCT} services. The {PRODUCT} Data Index Service requires Infinispan persistence and Apache Kafka messaging for your {PRODUCT} service. For more information about the Data Index Service, see {URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{CONFIGURING_KOGITO}</em>].</p>
</div>
<div id="proc-task-console-using_kogito-developing-decision-services" class="paragraph">
<p>=== Using the {PRODUCT} Task Console to interact with user tasks</p>
</div>
<div class="paragraph _abstract">
<p>You can use the {PRODUCT} Task Console to view and interact with user tasks in {PRODUCT} process services. You can run the Task Console for local {PRODUCT} services or add it to your {PRODUCT} infrastructure on {OPENSHIFT}.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A {PRODUCT} Data Index Service instance is configured and running for your {PRODUCT} service. The Data Index Service enables the Task Console to access stored tasks and process data. The Data Index Service requires Infinispan persistence and Apache Kafka messaging for your {PRODUCT} service. For information about the Data Index Service, see {URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{CONFIGURING_KOGITO}</em>].</p>
</li>
<li>
<p>The <code>application.properties</code> file of your {PRODUCT} project contains the following system properties for the location where the {PRODUCT} service is deployed, such as <code>http://localhost:8080</code>, and for Quarkus Cross-Origin Resource Sharing (CORS) support.</p>
<div class="listingblock">
<div class="title">Application properties for REST URLs</div>
<div class="content">
<pre class="highlight"><code>kogito.service.url=http://<em>HOST</em>:<em>PORT</em>
quarkus.http.cors=true</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/task-console/"><code>task-console</code></a> artifacts page, select the latest release of the {PRODUCT} Task Console, and download the <code>task-console-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>task-console-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Task Console:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Task Console</div>
<div class="content">
<pre class="highlight"><code>$ java -Dquarkus.http.port=8280 -jar task-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The default port for the Task Console is 8080, but this example specifies port 8280 to avoid conflicts with the example {PRODUCT} service running at port 8080.</p>
</div>
<div class="paragraph">
<p>Also, the Task Console uses the default Data Index Service port 8180. If you modified this port in your Data Index Service instance, you must also modify the port in the Task Console properties by using the start-up property <code>-Dkogito.dataindex.http.url=http://<em>HOST</em>:<em>PORT</em></code> when you run the Task Console.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To change the logging level of the Task Console, such as for debugging, you can specify the following start-up properties:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Task Console logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -Dquarkus.http.port=8280  \
  -jar task-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>In an OpenShift environment, you can use the {PRODUCT} command-line interface (CLI) or the OpenShift web console to add the Task Console to your {PRODUCT} infrastructure:</p>
</div>
<div class="listingblock">
<div class="title">Adding the Task Console to your OpenShift infrastructure using the {PRODUCT} CLI</div>
<div class="content">
<pre class="highlight"><code>$ kogito install task-console -p <em>PROJECT_NAME</em></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-task-console-instance.png" alt="Image of Kogito Task Console instance on OpenShift">
</div>
<div class="title">Figure 257. {PRODUCT} Task Console instance on OpenShift web console</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, navigate to <code><a href="http://localhost:8280" class="bare">http://localhost:8280</a></code> to open the Task Console. If you modified the configured Task Console port, use the modified location.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>On OpenShift, navigate to the route URL for the Task Console instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console.png" alt="Image of Kogito Task Console">
</div>
<div class="title">Figure 258. {PRODUCT} Task Console</div>
</div>
<div class="paragraph">
<p>In this example, the Task Console displays data for the <code>kogito-travel-agency</code> extended example application in the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub.</p>
</div>
<div class="paragraph">
<p>The <strong>Task Inbox</strong> page lists the available user tasks that you can interact with. You can use the upper toolbar options to filter the tasks or use the column headers to sort the tasks as needed. You can also search for tasks by the full name or by partial name, such as <code>Apply</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console-inbox.png" alt="Image of the tasks assigned to the current user">
</div>
<div class="title">Figure 259. Tasks assigned to the current user</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console-filters-status.png" alt="Image of status filtering on *Task Inbox*">
</div>
<div class="title">Figure 260. Available task status filters</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console-filters.png" alt="Image of status and names filtering on *Task Inbox*">
</div>
<div class="title">Figure 261. Applied filters</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select a task name to view task details and interact with the task:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console-details-page.png" alt="Image of *Task Details* page">
</div>
<div class="title">Figure 262. Task details</div>
</div>
<div class="paragraph">
<p>Depending on the current phase of the selected task, you can select from the available actions for that task, such as <strong>Abort</strong>, <strong>Release</strong>, <strong>Skip</strong>, or <strong>Complete</strong>, to move the task to the next phase.</p>
</div>
<div class="paragraph">
<p>For additional task details, you can select <strong>View details</strong>. This panel lists the task ID, state, owner, related process instance ID, and other helpful information about the task.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console-details-expanded.png" alt="Image of task details panel">
</div>
<div class="title">Figure 263. Task details panel</div>
</div>
<div class="openblock">
<div class="content">
<div id="proc-task-console-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling {PRODUCT} Task Console security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based {PRODUCT} services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the {PRODUCT} Task Console to enable the console to interact with the {PRODUCT} Data Index Service using bearer token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/kiegroup/kogito-apps/tree/master/task-console">{PRODUCT} Task Console</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/kiegroup/kogito-apps/tree/master/task-console">{PRODUCT} Task Console</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the {PRODUCT} Task Console repository and enter the following command to run the application with security enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Task Console with security enabled</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Ensure that the service is not started at the same port as the security server. You can change the port by adding <code>-Dquarkus.http.port=<em>PORT_NUMBER</em></code> to the start-up properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The {PRODUCT} Task Console contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Task Console project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-console-quarkus
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=web-app
%keycloak.quarkus.oidc.logout.path=/logout
%keycloak.quarkus.oidc.logout.post-logout-path=/

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Stop and restart the {PRODUCT} Task Console to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved directive in bpmn/chap-kogito-developing-process-services.adoc - include::{asciidoc-dir}/dmn/chap-kogito-using-dmn-models.adoc[tags=con-kogito-service-execution]</p>
</div>
<div id="chap-kogito-orchestrating-serverless" class="paragraph">
<p>= Orchestrating microservices with Serverless Workflow in {PRODUCT}
:parent-context: kogito-developing-decision-services
:context: kogito-orchestrating-serverless</p>
</div>
<div class="paragraph _abstract">
<p>As a microservices developer or architect, you can use the <a href="https://github.com/serverlessworkflow/specification">Serverless Workflow specification</a> to orchestrate application services in your {PRODUCT} project. The Serverless Workflow specification enables you to define declarative workflow models that orchestrate event-driven, serverless applications. The specification is hosted by the <a href="https://www.cncf.io/">Cloud Native Computing Foundation (CNCF)</a> and is currently a CNCF <a href="https://www.cncf.io/sandbox-projects/">Sandbox project</a> that is progressing to become an <a href="https://www.cncf.io/projects/">Incubating project</a>.</p>
</div>
<div class="paragraph">
<p>For more information about Serverless Workflow, see the <a href="https://serverlessworkflow.github.io/">Serverless Workflow</a> website.</p>
</div>
<div id="con-serverless-workflow_kogito-developing-decision-services" class="paragraph">
<p>== Serverless Workflow orchestration</p>
</div>
<div class="paragraph _abstract">
<p><a href="https://github.com/serverlessworkflow/specification/blob/master/specification.md">Serverless Workflow</a> is a specification for defining declarative workflow models that orchestrate event-driven, serverless applications. The main benefit of a Serverless Workflow strategy is that it provides a clear separation of business logic and orchestration logic in your serverless applications. Developers can focus on solving business logic inside functions and use workflows to define function invocations, specify event behavior, and provide data management for different microservices.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/serverlessworkflow/specification">Serverless Workflow specification</a> defines a vendor-neutral, platform-independent, and declarative workflow model that you can use across multiple cloud or container platforms. This portability enables you to move your workflow definitions from one cloud or container platform to another with the same execution results.</p>
</div>
<div class="paragraph">
<p>The specification is hosted by the <a href="https://www.cncf.io/">Cloud Native Computing Foundation (CNCF)</a> and is currently a CNCF <a href="https://www.cncf.io/sandbox-projects/">Sandbox project</a> that is progressing to become an <a href="https://www.cncf.io/projects/">Incubating project</a>. The specification has been created by CNCF community members and individuals from different companies and is a fully open source project (Apache 2.0 license).</p>
</div>
<div class="paragraph">
<p>The target users of Serverless Workflow orchestration are mostly developers and architects who want to define logical steps of execution declaratively (no code) for cloud-native services. Although you can orchestrate your services using process diagrams in <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation (BPMN)</a>, the Serverless Workflow has less focus on business definition and more focus on function-level steps of execution. Serverless Workflow is also designed specifically for microservice orchestration and therefore has a smaller scope than BPMN. Serverless Workflow also enables you to write workflows in formats (JSON or YAML) that might be better suited for developing and deploying serverless applications in cloud or container environments.</p>
</div>
<div class="paragraph">
<p>Ultimately, the choice of which specification to use for orchestrating event-driven microservices depends on your environment needs, development goals, and personal preference.</p>
</div>
<div class="paragraph">
<p>=== Serverless Workflow architecture</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/serverlessworkflow/specification">Serverless Workflow specification</a> provides a <a href="https://github.com/serverlessworkflow/specification/blob/master/schema/workflow.json">JSON schema</a> that defines the structure of JSON or YAML workflow definitions. The specification also provides a set of SDKs for <a href="https://github.com/serverlessworkflow/sdk-java">Java</a> and <a href="https://github.com/serverlessworkflow/sdk-go">Go</a> that can help developers get started with the specification to create workflows. The specification provides a set of <a href="https://github.com/serverlessworkflow/specification/blob/master/extensions/README.md">workflow extensions</a>, such as key performance indicators (KPIs), that you can use to enhance workflow definitions with additional information. This information can then be used during execution of the workflows to provide additional data, such as metrics for improving workflow performance.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates a general Serverless Workflow architecture:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-spec-overview.png" alt="Image of Serverless Workflow architecture">
</div>
<div class="title">Figure 264. General Serverless Workflow architecture</div>
</div>
<div class="paragraph">
<p>Serverless Workflow focuses on orchestration of event-driven microservices. Although the specification provides a generic markup that you can use for general workflow or pipeline (CI/CD) definitions, its declarative nature is designed for microservice orchestration.</p>
</div>
<div class="paragraph">
<p>Similar to other specification-based standards for business automation, Serverless Workflow provides a unified core definition for workflows. For example, the following diagram illustrates a single Serverless Workflow definition that is executed on multiple runtime services. Each of these services can then be deployed onto various cloud or container platforms with the same execution results.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-example-implementation.png" alt="Image of example Serverless Workflow implementation" width="95%">
</div>
<div class="title">Figure 265. Example Serverless Workflow implementation</div>
</div>
<div id="con-serverless-workflow-definitions_kogito-developing-decision-services" class="paragraph">
<p>=== Serverless Workflow definitions</p>
</div>
<div class="paragraph _abstract">
<p>In the <a href="https://github.com/serverlessworkflow/specification">Serverless Workflow specification</a>, Serverless Workflow definitions are JSON or YAML files with the extension <code>.sw.json</code> or <code>.sw.yaml</code> that provide the orchestration details for the relevant application services.</p>
</div>
<div class="paragraph">
<p>A Serverless Workflow definition file consists of the following basic components:</p>
</div>
<div class="listingblock">
<div class="title">Serverless Workflow definition format in JSON</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "sampleWorkflow",
  "version": "1.0",
  "name": "Sample Workflow",
  "description": "Sample Workflow",
  "functions": [],
  "events": [],
  "states": []
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Serverless Workflow definition format in YAML</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: sampleWorkflow
version: '1.0'
name: Sample Workflow
description: Sample Workflow
functions: []
events: []
states: []</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Serverless Workflow <code>functions</code>, <code>events</code>, and <code>states</code> are the core constructs for defining the orchestration behavior for your services. You can use one or all of these three constructs in your workflow definitions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>functions</code>: Function definitions are reusable constructs that you can use to define invocation information about services that need to be invoked during workflow execution. Function definitions can be referenced by workflow <code>states</code> (control-logic blocks) whenever a service needs to be invoked.</p>
</li>
<li>
<p><code>events</code>: Event definitions are reusable constructs that you can use to define all consumed and produced events during workflow execution. Serverless Workflow requires <a href="https://cloudevents.io/">CloudEvents</a> format for both consumed and produced events. Event definitions can be referenced by workflow states to determine how a workflow instance is created, what events are needed to continue workflow execution, what events need to be produced during workflow execution, and how multiple events are associated with one another (correlation rules). You can also use event definitions to trigger function or service invocation for services that do not use exposed invocation endpoints and that are only invoked by events.</p>
</li>
<li>
<p><code>states</code>: State definitions enable you to define your workflow states (control-logic blocks) and determine what your workflow should do. State definitions specify details such as how the workflow is started, what data is expected, how the workflow should transition from one state to another given some data or event constraints, and how and when the workflow execution completes.</p>
<div class="paragraph">
<p>The following diagram illustrates some of the control-flow constructs that you can build with Serverless Workflow state definitions:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-states.png" alt="Image of example control-flow constructs from state definitions">
</div>
<div class="title">Figure 266. Example control-flow constructs from state definitions</div>
</div>
<div class="paragraph">
<p>For more information about supported workflow states, see the <a href="https://github.com/serverlessworkflow/specification/blob/master/specification.md#state-definition">Serverless Workflow specification</a>.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following Serverless Workflow definition performs a customer credit check in a loan application service. In this example, the Serverless Workflow integrates with an external microservice to assess customer credit and approve or deny the customer loan application. After this decision is made, the service emits a CloudEvents message that includes the decision information as part of the payload. The workflow receives this callback event and triggers workflow transitions based on the credit check decision results.</p>
</div>
<div class="listingblock">
<div class="title">Example Serverless Workflow definition for credit check (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "customercreditcheck",
  "version": "1.0",
  "name": "Customer Credit Check Workflow",
  "description": "Perform Customer Credit Check",
  "functions": [
    {
      "name": "callCreditCheckMicroservice",
      "resource": "creditCheckResource",
      "type": "service"
    },
    {
      "name": "sendRejectionEmailFunction",
      "resource": "rejectEmailResource"
    }
  ],
  "events": [
    {
      "name": "CreditCheckCompletedEvent",
      "type": "creditCheckCompleteType",
      "source": "creditCheckSource",
      "correlation": [
        {
          "contextAttributeName": "customerId"
        }
      ]
    }
  ],
  "states": [
    {
      "name": "CheckCredit",
      "type": "callback",
      "start": {
        "kind": "default"
      },
      "action": {
        "functionRef": {
          "refName": "callCreditCheckMicroservice",
          "parameters": {
            "customer": "{{ $.customer }}"
          }
        }
      },
      "eventRef": "CreditCheckCompletedEvent",
      "timeout": "PT15M",
      "transition": {
        "nextState": "EvaluateDecision"
      }
    },
    {
      "name": "EvaluateDecision",
      "type": "switch",
      "dataConditions": [
        {
          "condition": "{{ $.creditCheck[?(@.decision == 'Approved')] }}",
          "transition": {
            "nextState": "StartApplication"
          }
        },
        {
          "condition": "{{ $.creditCheck[?(@.decision == 'Denied')] }}",
          "transition": {
            "nextState": "RejectApplication"
          }
        }
      ],
      "default": {
        "transition": {
          "nextState": "RejectApplication"
        }
      }
    },
    {
      "name": "StartApplication",
      "type": "subflow",
      "workflowId": "startApplicationWorkflowId",
      "end": {
        "kind": "default"
      }
    },
    {
      "name": "RejectApplication",
      "type": "operation",
      "actionMode": "sequential",
      "actions": [
        {
          "functionRef": {
            "refName": "sendRejectionEmailFunction",
            "parameters": {
              "applicant": "{{ $.customer }}"
            }
          }
        }
      ],
      "end": {
        "kind": "default"
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Serverless Workflow definition for credit check (YAML)</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: customercreditcheck
version: '1.0'
name: Customer Credit Check Workflow
description: Perform Customer Credit Check
functions:
- name: callCreditCheckMicroservice
  resource: creditCheckResource
  type: microservice
- name: sendRejectionEmailFunction
  resource: rejectEmailResource
events:
- name: CreditCheckCompletedEvent
  type: creditCheckCompleteType
  source: creditCheckSource
  correlation:
  - contextAttributeName: customerId
states:
- name: CheckCredit
  type: callback
  start:
    kind: default
  action:
    functionRef:
      refName: callCreditCheckMicroservice
      parameters:
        customer: "{{ $.customer }}"
  eventRef: CreditCheckCompletedEvent
  timeout: PT15M
  transition:
    nextState: EvaluateDecision
- name: EvaluateDecision
  type: switch
  dataConditions:
  - condition: "{{ $.creditCheck[?(@.decision == 'Approved')] }}"
    transition:
      nextState: StartApplication
  - condition: "{{ $.creditCheck[?(@.decision == 'Denied')] }}"
    transition:
      nextState: RejectApplication
  default:
    transition:
      nextState: RejectApplication
- name: StartApplication
  type: subflow
  workflowId: startApplicationWorkflowId
  end:
    kind: default
- name: RejectApplication
  type: operation
  actionMode: sequential
  actions:
  - functionRef:
      refName: sendRejectionEmailFunction
      parameters:
        applicant: "{{ $.customer }}"
  end:
    kind: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the workflow uses the following data input:</p>
</div>
<div class="listingblock">
<div class="title">Example data input</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "customer": {
    "id": "customer123",
    "name": "John Doe",
    "SSN": 123456,
    "yearlyIncome": 50000,
    "address": "123 MyLane, MyCity, MyCountry",
    "employer": "MyCompany"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example workflow receives the following callback events:</p>
</div>
<div class="listingblock">
<div class="title">Example callback event for approved credit check</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "specversion" : "1.0",
  "type" : "creditCheckCompleteType",
  "datacontenttype" : "application/json",
  ...
  "data": {
    "creditCheck": [
        {
          "id": "customer123",
          "score": 700,
          "decision": "Approved",
          "reason": "Good credit score"
        }
      ]
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example callback event for denied credit check</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "specversion" : "1.0",
  "type" : "creditCheckCompleteType",
  "datacontenttype" : "application/json",
  ...
  "data": {
    "creditCheck": [
        {
          "id": "customer123",
          "score": 580,
          "decision": "Denied",
          "reason": "Low credit score. Recent late payments"
        }
      ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more Serverless Workflow definition examples, see the <a href="https://github.com/serverlessworkflow/specification/blob/master/examples/examples.md">Serverless Workflow specification</a>.</p>
</div>
<div id="ref-serverless-workflow-use-cases_kogito-developing-decision-services" class="paragraph">
<p>=== Serverless Workflow use cases</p>
</div>
<div class="paragraph _abstract">
<p>Use cases for the <a href="https://github.com/serverlessworkflow/specification">Serverless Workflow specification</a> vary widely and depend on the reference implementations and the ecosystem available during workflow execution, such as available functions, services, and events.</p>
</div>
<div class="paragraph">
<p>The following scenarios illustrate example use cases for Serverless Workflow orchestration with microservices. For more Serverless Workflow use cases, see the <a href="https://github.com/serverlessworkflow/specification/tree/master/usecases">Serverless Workflow specification</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Payment processing</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Servlerless Workflow is ideal for coordinating session-based applications, such as e-commerce sites. You can
use Serverless Workflow to coordinate all steps of the checkout process, and even enable users to take a photo of their credit card instead of having to type in the numbers and information.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-usecase-app-payment.png" alt="Image of Serverless Workflow orchestration for payment processing">
</div>
<div class="title">Figure 267. Serverless Workflow orchestration for payment processing</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Online vehicle auction</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use Serverless Workflow to coordinate all steps of an online vehicle auction, such as the following aspects of the orchestration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authentication of users making bids</p>
</li>
<li>
<p>Communication with bidding and inventory services</p>
</li>
<li>
<p>Decisions to start and end the auction under certain conditions</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-usecase-vehicle-auction.png" alt="Image of Serverless Workflow orchestration for online vehicle auction">
</div>
<div class="title">Figure 268. Serverless Workflow orchestration for online vehicle auction</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Data analysis</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use Serverless Workflow to coordinate data analysis, such as for marketing and sales information. Analysis can be scheduled on a timely basis to trigger workflow coordination of different extract, transform, load (ETL) services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-usecase-data-analysis.png" alt="Image of Serverless Workflow orchestration for data analysis">
</div>
<div class="title">Figure 269. Serverless Workflow orchestration for data analysis</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Error notifications</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can design Serverless Workflow definitions that trigger notifications about the success or failure of the workflow orchestration. In conjunction with available messaging services, you can notify developers on different platforms of any failures, including error information and the exact point in the execution where the failure occurred. You can also log the workflow execution status to cloud storage services for further analysis.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-usecase-error-notifications.png" alt="Image of Serverless Workflow orchestration for error notifications">
</div>
<div class="title">Figure 270. Serverless Workflow orchestration for error notifications</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Continuous integration and continuous deployment (CI/CD)</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Serverless Workflow can help you build efficient continuous integration and continuous deployment (CI/CD) solutions. Code check-ins can trigger website builds and automatic redeploys. Pull requests can trigger automated tests that ensure the code is well-tested before human reviews.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-usecase-continuous-integration.png" alt="Image of Serverless Workflow orchestration for CI/CD">
</div>
<div class="title">Figure 271. Serverless Workflow orchestration for CI/CD</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-serverless-workflow-in-kogito_kogito-developing-decision-services" class="paragraph">
<p>== Serverless Workflow orchestration in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides the runtime implementation that supports Serverless Workflow, including both JSON and YAML formats, in compliance with the <a href="https://github.com/serverlessworkflow/specification">Serverless Workflow specification</a>.</p>
</div>
<div class="paragraph">
<p>You can use Serverless Workflow definition files in your {PRODUCT} project to define your domain-specific orchestration services. Your Serverless Workflow files can be in JSON or YAML format with the extension <code>.sw.json</code> or <code>.sw.yaml</code>.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates Serverless Workflow orchestration in {PRODUCT}:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-kogito.png" alt="Image of Serverless Workflow orchestration in Kogito">
</div>
<div class="title">Figure 272. Serverless Workflow orchestration in {PRODUCT}</div>
</div>
<div class="paragraph">
<p>=== Serverless Workflow example in {PRODUCT}</p>
</div>
<div class="paragraph">
<p>The following example is a real-world Serverless Workflow scenario in {PRODUCT} that demonstrates how you can use Serverless Workflow definitions to orchestrate your {PRODUCT} services. In this scenario, an order service uses Serverless Workflow to process orders from multiple sources and approve or deny orders.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This example is based on the <code>orders-demo</code> application in the <a href="https://github.com/Serverless-Workflow-Kogito"><code>Serverless-Workflow-Kogito</code></a> repository in GitHub. However, this example may differ from the exact example source code as {PRODUCT} continues to be developed. For more example {PRODUCT} services that use Serverless Workflow, see the <a href="https://github.com/kiegroup/kogito-examples"><code>kogito-examples</code></a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following diagram illustrates the basic architecture of this scenario:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-kogito-orders.png" alt="Image of example Serverless Workflow orchestration for processing orders in Kogito">
</div>
<div class="title">Figure 273. Example Serverless Workflow orchestration for processing orders in {PRODUCT}</div>
</div>
<div class="paragraph">
<p>New orders can come from different sources, such as web applications or messaging services. Each order is then converted into <a href="https://cloudevents.io/">CloudEvents</a> messages, which represent the events that need to trigger the workflow execution. The events are pushed to an Apache Kafka topic.</p>
</div>
<div class="paragraph">
<p>New order events that are pushed to Kafka trigger new instances of the workflow. The workflow invokes a business rule service and a human task service to make the order approval decision. The business rule service can be a {PRODUCT} service with Decision Model and Notation (DMN) decision models or Drools Rule Language (DRL) rules, or it can be an external service. For this example, the rule service uses a DRL rules in {PRODUCT} to verify whether the order can be auto-approved. If the order cannot be auto-approved, then the workflow uses the human task service, which likewise can be a {PRODUCT} service or an external service, to notify a manager that the order requires human approval.</p>
</div>
<div class="paragraph">
<p>After the order decision is made, the workflow generates an event in CloudEvents format that notifies other services or other workflows that a decision was made for a particular order.</p>
</div>
<div class="paragraph">
<p>To orchestrate these services in this way, the example uses the following <code>ordersworkflow.sw.json</code> Serverless Workflow definition:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>ordersworkflow.sw.json</code> workflow definition (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "ordersworkflow",
  "name": "Orders Workflow",
  "version": "1.0",
  "events": [
    {
      "name": "NewOrderEvent",
      "source": "neworder",
      "type": "kafka"
    },
    {
      "name": "ApprovalDecisionEvent",
      "source": "out-approvaldecision",
      "type": "kafka"
    }
  ],
  "functions": [
    {
      "name": "AutoAproveOrderFunction",
      "type": "rule",
      "metadata": {
        "ruleflowgroup": "neworder"
      }
    },
    {
      "name": "OrderManagerApprovalFunction",
      "type": "decision",
      "metadata": {
        "taskname": "managerApproval",
        "actorid": "managers",
        "groupid": "managers"
      }
    }
  ],
  "states": [
    {
      "name": "HandleNewOrder",
      "type": "event",
      "start": {
        "kind": "default"
      },
      "eventsActions": [
        {
          "eventRefs": [
            "NewOrderEvent"
          ],
          "actions": [
            {
              "functionRef": {
                "refName": "AutoAproveOrderFunction"
              }
            }
          ]
        }
      ],
      "transition": {
        "nextState": "CheckIfNeedManagerApproval"
      }
    },
    {
      "name": "CheckIfNeedManagerApproval",
      "type": "switch",
      "dataConditions": [
        {
          "path": "$.decision",
          "value": "Approved",
          "operator": "equals",
          "transition": {
            "nextState": "OrderAutoApproved"
          }
        },
        {
          "path": "$.decision",
          "value": "NeedManagerApproval",
          "operator": "equals",
          "transition": {
            "nextState": "OrderManagerApproval"
          }
        }
      ],
      "default": {
        "nextState": "OrderManagerApproval"
      }
    },
    {
      "name": "OrderAutoApproved",
      "type": "inject",
      "data": {
        "finalDecision": "Approved"
      },
      "end": {
        "kind": "event",
        "produceEvent": {
          "eventRef": "ApprovalDecisionEvent"
        }
      }
    },
    {
      "name": "OrderManagerApproval",
      "type": "operation",
      "actionMode": "sequential",
      "actions": [
        {
          "name": "managerAprovalAction",
          "functionRef": {
            "refName": "OrderManagerApprovalFunction"
          }
        }
      ],
      "end": {
        "kind": "event",
        "produceEvent": {
          "eventRef": "ApprovalDecisionEvent"
        }
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following diagram illustrates the basic structure and sequence of this example workflow definition:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/serverless/serverless-workflow-kogito-orders-structure.png" alt="Image of `ordersworkflow.sw.json` workflow definition">
</div>
<div class="title">Figure 274. Structure of the example <code>ordersworkflow.sw.json</code> workflow definition</div>
</div>
<div class="paragraph">
<p>The <code>HandleNewOrder</code> state is the workflow starting state. This state is an <code>event</code> type state that requires one or more events to be consumed before the workflow can be invoked. This event state defines the instances of this workflow that are created when the referenced <code>NewOrderEvent</code> is consumed. In this case, events are consumed by Kafka.</p>
</div>
<div class="paragraph">
<p>After the <code>NewOrderEvent</code> is consumed, the state defines a list of <code>actions</code> to be performed. Actions define all the functions or services that must be invoked as part of the workflow. In this case, a single <code>AutoApproveOrderFunction</code> function or service defines how to invoke the rule service.</p>
</div>
<div class="paragraph">
<p>After the execution of the rule service is complete, the event state specifies that the workflow must transition to the <code>CheckIfNeedManagerApprvoal</code> state, which is a <code>switch</code> type state. The order is then either auto-approved if no manager approval is required, or is assigned to a manager to complete the remaining states of the workflow.</p>
</div>
<div class="paragraph">
<p>For more example {PRODUCT} services that use Serverless Workflow, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/serverless-workflow-events-quarkus"><code>serverless-workflow-events-quarkus</code></a>: A Serverless Workflow service for processing job applicant approvals and that showcases event-driven services</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/serverless-workflow-greeting-quarkus"><code>serverless-workflow-greeting-quarkus</code></a> and <a href="https://github.com/kiegroup/kogito-examples/tree/stable/serverless-workflow-greeting-springboot"><code>serverless-workflow-greeting-springboot</code></a>: A Serverless Workflow greeting service with both JSON and YAML workflow definitions</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/serverless-workflow-service-calls-quarkus"><code>serverless-workflow-service-calls-quarkus</code></a> and <a href="https://github.com/kiegroup/kogito-examples/tree/stable/serverless-workflow-service-calls-springboot"><code>serverless-workflow-service-calls-springboot</code></a>: A Serverless Workflow service for returning country information</p>
</li>
</ul>
</div>
<div id="proc-serverless-workflow-definitions_kogito-developing-decision-services" class="paragraph">
<p>== Creating and editing Serverless Workflow definitions in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>You can use <a href="https://github.com/serverlessworkflow/specification/blob/master/specification.md">Serverless Workflow</a> definition files in your {PRODUCT} project to define your domain-specific orchestration services. Your Serverless Workflow definition files can be in JSON or YAML format with the extension <code>.sw.json</code> or <code>.sw.yaml</code>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a {PRODUCT} project and have included any Java objects or other business assets required for your Serverless Workflow service. For information about creating a project, see {URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>].</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your {PRODUCT} project, create or import a <code>.sw.json</code> or <code>.sw.yaml</code> Serverless Workflow definition file in the relevant folder, typically in <code>src/main/resources</code>.</p>
<div class="paragraph">
<p>{PRODUCT} supports both JSON and YAML formats for workflow definitions. You can use multiple workflow definitions in both formats if needed.</p>
</div>
</li>
<li>
<p>Open the workflow definition file and define the following basic components:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Serverless Workflow definition format in JSON</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "sampleWorkflow",
  "version": "1.0",
  "name": "Sample Workflow",
  "description": "Sample Workflow",
  "functions": [],
  "events": [],
  "states": []
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Serverless Workflow definition format in YAML</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: sampleWorkflow
version: '1.0'
name: Sample Workflow
description: Sample Workflow
functions: []
events: []
states: []</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Serverless Workflow <code>functions</code>, <code>events</code>, and <code>states</code> are the core constructs for defining the orchestration behavior for your services. You can use one or all of these three constructs in your workflow definitions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>functions</code>: Function definitions are reusable constructs that you can use to define invocation information about services that need to be invoked during workflow execution. Function definitions can be referenced by workflow <code>states</code> (control-logic blocks) whenever a service needs to be invoked.</p>
</li>
<li>
<p><code>events</code>: Event definitions are reusable constructs that you can use to define all consumed and produced events during workflow execution. Serverless Workflow requires <a href="https://cloudevents.io/">CloudEvents</a> format for both consumed and produced events. Event definitions can be referenced by workflow states to determine how a workflow instance is created, what events are needed to continue workflow execution, what events need to be produced during workflow execution, and how multiple events are associated with one another (correlation rules). You can also use event definitions to trigger function or service invocation for services that do not use exposed invocation endpoints and that are only invoked by events.</p>
</li>
<li>
<p><code>states</code>: State definitions enable you to define your workflow states (control-logic blocks) and determine what your workflow should do. State definitions specify details such as how the workflow is started, what data is expected, how the workflow should transition from one state to another given some data or event constraints, and how and when the workflow execution completes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following Serverless Workflow definition performs a customer credit check in a loan application service to approve or deny the customer loan application:</p>
</div>
<div class="listingblock">
<div class="title">Example Serverless Workflow definition for credit check (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "customercreditcheck",
  "version": "1.0",
  "name": "Customer Credit Check Workflow",
  "description": "Perform Customer Credit Check",
  "functions": [
    {
      "name": "callCreditCheckMicroservice",
      "resource": "creditCheckResource",
      "type": "service"
    },
    {
      "name": "sendRejectionEmailFunction",
      "resource": "rejectEmailResource"
    }
  ],
  "events": [
    {
      "name": "CreditCheckCompletedEvent",
      "type": "creditCheckCompleteType",
      "source": "creditCheckSource",
      "correlation": [
        {
          "contextAttributeName": "customerId"
        }
      ]
    }
  ],
  "states": [
    {
      "name": "CheckCredit",
      "type": "callback",
      "start": {
        "kind": "default"
      },
      "action": {
        "functionRef": {
          "refName": "callCreditCheckMicroservice",
          "parameters": {
            "customer": "{{ $.customer }}"
          }
        }
      },
      "eventRef": "CreditCheckCompletedEvent",
      "timeout": "PT15M",
      "transition": {
        "nextState": "EvaluateDecision"
      }
    },
    {
      "name": "EvaluateDecision",
      "type": "switch",
      "dataConditions": [
        {
          "condition": "{{ $.creditCheck[?(@.decision == 'Approved')] }}",
          "transition": {
            "nextState": "StartApplication"
          }
        },
        {
          "condition": "{{ $.creditCheck[?(@.decision == 'Denied')] }}",
          "transition": {
            "nextState": "RejectApplication"
          }
        }
      ],
      "default": {
        "transition": {
          "nextState": "RejectApplication"
        }
      }
    },
    {
      "name": "StartApplication",
      "type": "subflow",
      "workflowId": "startApplicationWorkflowId",
      "end": {
        "kind": "default"
      }
    },
    {
      "name": "RejectApplication",
      "type": "operation",
      "actionMode": "sequential",
      "actions": [
        {
          "functionRef": {
            "refName": "sendRejectionEmailFunction",
            "parameters": {
              "applicant": "{{ $.customer }}"
            }
          }
        }
      ],
      "end": {
        "kind": "default"
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Serverless Workflow definition for credit check (YAML)</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: customercreditcheck
version: '1.0'
name: Customer Credit Check Workflow
description: Perform Customer Credit Check
functions:
- name: callCreditCheckMicroservice
  resource: creditCheckResource
  type: microservice
- name: sendRejectionEmailFunction
  resource: rejectEmailResource
events:
- name: CreditCheckCompletedEvent
  type: creditCheckCompleteType
  source: creditCheckSource
  correlation:
  - contextAttributeName: customerId
states:
- name: CheckCredit
  type: callback
  start:
    kind: default
  action:
    functionRef:
      refName: callCreditCheckMicroservice
      parameters:
        customer: "{{ $.customer }}"
  eventRef: CreditCheckCompletedEvent
  timeout: PT15M
  transition:
    nextState: EvaluateDecision
- name: EvaluateDecision
  type: switch
  dataConditions:
  - condition: "{{ $.creditCheck[?(@.decision == 'Approved')] }}"
    transition:
      nextState: StartApplication
  - condition: "{{ $.creditCheck[?(@.decision == 'Denied')] }}"
    transition:
      nextState: RejectApplication
  default:
    transition:
      nextState: RejectApplication
- name: StartApplication
  type: subflow
  workflowId: startApplicationWorkflowId
  end:
    kind: default
- name: RejectApplication
  type: operation
  actionMode: sequential
  actions:
  - functionRef:
      refName: sendRejectionEmailFunction
      parameters:
        applicant: "{{ $.customer }}"
  end:
    kind: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more Serverless Workflow definition examples in {PRODUCT}, see <a href="#con-serverless-workflow-in-kogito_kogito-orchestrating-serverless">[con-serverless-workflow-in-kogito_kogito-orchestrating-serverless]</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Continue adding and defining any remaining components for your workflow definition files and save the completed files.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you define your serverless workflow definitions, you can build and deploy your {PRODUCT} services as usual to your preferred cloud or container platform, such as {OPENSHIFT}. When an event trigger occurs, your application orchestrates your {PRODUCT} services according to the workflow definition or definitions that you have defined. If you are using a serverless deployment platform, such as OpenShift Serverless, your application automatically scales up based on incoming demand, or scales to zero after use.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>]</p>
</li>
<li>
<p>{URL_DEPLOYING_ON_OPENSHIFT}#chap-kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>]</p>
</li>
</ul>
</div>
<div id="chap-kogito-configuring" class="paragraph">
<p>= Configuring {PRODUCT} supporting services and runtime capabilities
:parent-context: kogito-developing-decision-services
:context: kogito-configuring</p>
</div>
<div class="paragraph _abstract">
<p>As a developer of business processes and decisions, you can configure {PRODUCT} supporting services and runtime properties for advanced use cases with your {PRODUCT} services.</p>
</div>
<div id="con-kogito-supporting-services-and-configuration_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} supporting services and runtime configuration</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} supporting services consist of middleware infrastructure services and other dedicated services that help you build additional functionality in the {PRODUCT} domain-specific services that you develop.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} supports the following key middleware infrastructure services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Infinispan persistence</p>
</li>
<li>
<p>Apache Kafka reactive messaging</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>{PRODUCT} also provides the following dedicated services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{PRODUCT} Data Index Service indexing and querying</p>
</li>
<li>
<p>{PRODUCT} Jobs Service job scheduling</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The {PRODUCT} runtime supports various configuration options for these supporting services and for other capabilities, such as the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom event listeners</p>
</li>
<li>
<p>Prometheus metrics monitoring</p>
</li>
<li>
<p>Process instance management</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These supporting services, runtime configurations, and {PRODUCT} add-on components enable you to optimize your {PRODUCT} domain-specific services for your business automation requirements.</p>
</div>
<div id="ref-kogito-runtime-properties_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} runtime properties quick reference</p>
</div>
<div class="paragraph _abstract">
<p>The following table serves as a quick reference for commonly used runtime configuration properties supported by {PRODUCT}. You can define these properties in the <code>src/main/resources/application.properties</code> file of the relevant {PRODUCT} project or by using the <code>-D</code> prefix during application start-up.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some of these properties might require accompanying dependencies in the relevant {PRODUCT} project to enable the specified capability. For more information about dependency requirements, review the sections of the {PRODUCT} configuration documentation that relate to that property.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 95. Common runtime properties in {PRODUCT}</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Relevance</th>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.events.processinstances.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determines whether runtime events are published for process instances, either <code>enabled</code> or <code>disabled</code></p>
</div>
<div class="paragraph">
<p>Default value: <code>enabled</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.events.processinstances.enabled</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.events.usertasks.enabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether runtime events are published for user task instances, either <code>enabled</code> or <code>disabled</code></p>
<p class="tableblock">Default value: <code>enabled</code></p>
<p class="tableblock">Example: <code>kogito.events.usertasks.enabled</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.messaging.as-cloudevents</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether messages (sent or received through message events) are published in CloudEvents format, either <code>true</code> of <code>false</code></p>
<p class="tableblock">Example: <code>kogito.messaging.as-cloudevents=true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Infinispan persistence</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>quarkus.infinispan-client.server-list</code></p>
</div>
<div class="paragraph">
<p>For Spring Boot: <code>infinispan.remote.server-list</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the location where an Infinispan Server is running, typically used to connect your application to Infinispan for persistence</p>
</div>
<div class="paragraph">
<p>Example: <code>quarkus.infinispan-client.server-list=localhost:11222</code></p>
</div>
<div class="paragraph">
<p>For Spring Boot: <code>infinispan.remote.server-list=127.0.0.1:11222</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>quarkus.infinispan-client.auth-username</code></p>
</div>
<div class="paragraph">
<p><code>quarkus.infinispan-client.auth-password</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the Infinispan user name and password to authenticate Infinispan persistence capabilities in the relevant application, if required, such as in the {PRODUCT} Data Index Service</p>
<p class="tableblock">Examples:</p>
<p class="tableblock"><code>quarkus.infinispan-client.auth-username=admin</code></p>
<p class="tableblock"><code>quarkus.infinispan-client.auth-password=admin123</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.persistence.infinispan.template</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines an optional template name of the Infinispan cache configuration to be used to persist process instance data</p>
<p class="tableblock">Example: <code>kogito.persistence.infinispan.template=MyTemplate</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka messaging</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Incoming:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.connector</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.topic</code> (Optional, defaults to <code>kogito_incoming_stream</code>)</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.value.deserializer</code></p>
</div>
<div class="paragraph">
<p>Outgoing:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.connector</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.topic</code> (Optional, defaults to <code>kogito_outgoing_stream</code>)</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.value.serializer</code></p>
</div>
<div class="paragraph">
<p>Spring Boot:</p>
</div>
<div class="paragraph">
<p><code>kafka.bootstrapAddress</code></p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_incoming_stream</code> (Optional, defaults to <code>kogito_incoming_stream</code>)</p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_outgoing_stream</code> (Optional, defaults to <code>kogito_outgoing_stream</code>)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the connector, topic, and deserializer for the incoming and outgoing messages and channels for reactive messaging with Apache Kafka</p>
</div>
<div class="paragraph">
<p>Examples for incoming:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.topic=travellers</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer</code></p>
</div>
<div class="paragraph">
<p>Examples for outgoing:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-kafka</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.topic=processedtravellers</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></p>
</div>
<div class="paragraph">
<p>Examples for Spring Boot:</p>
</div>
<div class="paragraph">
<p><code>kafka.bootstrapAddress=localhost:9092</code></p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_incoming_stream=travellers</code></p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_outgoing_stream=processedtravellers</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="7"><p class="tableblock">{PRODUCT} Jobs Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.service.url</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the location where the {PRODUCT} service is deployed, typically used by the Jobs Service to find the source of the jobs</p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.service.url=http://localhost:8080</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.jobs-service.url</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the callback URL that posts to a running {PRODUCT} Jobs Service</p>
<p class="tableblock">Example: <code>kogito.jobs-service.url=http://localhost:8085</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.persistence</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Identifies the persistence mechanism used by the Jobs Service, either <code>in-memory</code> or <code>infinispan</code></p>
</div>
<div class="paragraph">
<p>Default value: <code>in-memory</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.jobs-service.persistence=in-memory</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.backoffRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Defines the retry back-off time in milliseconds between job execution attempts, in case the execution fails</p>
</div>
<div class="paragraph">
<p>Default value: <code>1000</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.jobs-service.backoffRetryMillis=1000</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.maxIntervalLimitToRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Defines the maximum interval in milliseconds when retrying to execute jobs, in case the execution fails</p>
</div>
<div class="paragraph">
<p>Default value: <code>60000</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.jobs-service.maxIntervalLimitToRetryMillis=60000</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Identifies the Kafka bootstrap server address with the port used to publish events</p>
</div>
<div class="paragraph">
<p>Default value: <code>localhost:9092</code></p>
</div>
<div class="paragraph">
<p>Example: <code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers=localhost:9092</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Defines the name of the Kafka topic where the events are published</p>
</div>
<div class="paragraph">
<p>Default value: <code>kogito-jobs-events</code></p>
</div>
<div class="paragraph">
<p>Example: <code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic=kogito-jobs-events</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resteasy.jaxrs.scan-packages</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Spring Boot only) Lists comma-separated package names that contain REST endpoint Java classes. Sub-packages are automatically scanned. Wildcard notation is supported. Packages generated by DMN namespaces typically start with <code>http</code>.</p>
</div>
<div class="paragraph">
<p>Example: <code>resteasy.jaxrs.scan-packages=org.kie.kogito.example,http*</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div id="con-kogito-runtime-events_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} runtime events</p>
</div>
<div class="paragraph _abstract">
<p>A runtime event is record of a significant change of state in the application domain at a point in time. {PRODUCT} emits runtime events as a result of successfully executed requests, or <em>units of work</em>, in a process instance or task instance in a process. {PRODUCT} can use these events to notify third parties about changes to the BPMN process instance and its data.</p>
</div>
<div class="paragraph">
<p>=== Process instance events</p>
</div>
<div class="paragraph">
<p>For every executed process instance, an event is generated that contains information for that instance, such as the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Process instance metadata, such as the process definition ID, process instance ID, process instance state, and other identifying information</p>
</li>
<li>
<p>Node instances that have been triggered during the execution</p>
</li>
<li>
<p>Variables used and the current state of variables after the execution</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These events provide a complete view of the process instances being executed and can be consumed by an event listener, such as a <code>ProcessEventListener</code> configuration.</p>
</div>
<div class="paragraph">
<p>If multiple processes are executed within a single request (unit of work), each process instance is given a dedicated event.</p>
</div>
<div class="paragraph">
<p>The following event is an example process instance event generated after the request was executed successfully:</p>
</div>
<div class="listingblock">
<div class="title">Example process instance event</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "specversion": "0.3",
  "id": "f52af50c-4fe2-4581-9184-7ad48137fb3f",
  "source": null,
  "type": "ProcessInstanceEvent",
  "time": "2019-08-05T17:47:49.019494+02:00[Europe/Warsaw]",
  "data": {
    "id": "c1aced49-399b-4938-9071-b2ffa3fb7045",
    "parentInstanceId": null,
    "rootInstanceId": null,
    "processId": "deals",
    "processName": "SubmitDeal",
    "startDate": 1565020069015,
    "endDate": null,
    "state": 1,
    "nodeInstances": [
      {
        "id": "a8fe24c4-27a5-4869-85df-16e9f170f2c4",
        "nodeId": "2",
        "nodeDefinitionId": "CallActivity_1",
        "nodeName": "Call a deal",
        "nodeType": "SubProcessNode",
        "triggerTime": 1565020069015,
        "leaveTime": null
      },
      {
        "id": "7a3bf1b1-b167-4928-969d-20bddf16c87a",
        "nodeId": "1",
        "nodeDefinitionId": "StartEvent_1",
        "nodeName": "StartProcess",
        "nodeType": "StartNode",
        "triggerTime": 1565020069015,
        "leaveTime": 1565020069015
      }
    ],
    "variables": {
      "name": "my fancy deal",
      "traveller": {
        "firstName": "John",
        "lastName": "Doe",
        "email": "jon.doe@example.com",
        "nationality": "American",
        "address": {
          "street": "main street",
          "city": "Boston",
          "zipCode": "10005",
          "country": "US"
        }
      }
    }
  },
  "kogitoProcessinstanceId": "c1aced49-399b-4938-9071-b2ffa3fb7045",
  "kogitoParentProcessinstanceId": null,
  "kogitoRootProcessinstanceId": null,
  "kogitoProcessId": "deals",
  "kogitoProcessinstanceState": "1"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event is in <a href="https://cloudevents.io/">CloudEvents</a> format so that it can be consumed efficiently by other entities.</p>
</div>
<div class="paragraph">
<p>The event data also includes the following extensions to enable event routing based on the event metadata without requiring the body of the event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogitoProcessinstanceId</code></p>
</li>
<li>
<p><code>kogitoParentProcessinstanceId</code></p>
</li>
<li>
<p><code>kogitoRootProcessinstanceId</code></p>
</li>
<li>
<p><code>kogitoProcessId</code></p>
</li>
<li>
<p><code>kogitoProcessinstanceState</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== User task instance events</p>
</div>
<div class="paragraph">
<p>If an executed request (unit of work) in a process instance interacts with a user task, an event is generated for that user task and contains information for the task instance, such as the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Task metadata, such as the task description, priority, start and complete dates, and other identifying information</p>
</li>
<li>
<p>Task input and output data</p>
</li>
<li>
<p>Task assignments, such as the task owner, potential users and groups, business administrator and business administrator groups, or excluded users</p>
</li>
<li>
<p>Task reference name that should be used to interact with the task using the {PRODUCT} service endpoints</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following event is an example user task instance event generated after the relevant request was executed successfully:</p>
</div>
<div class="listingblock">
<div class="title">Example user task instance event</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "data": {
    "adminGroups": [],
    "adminUsers": [],
    "excludedUsers": [],
    "id": "4d899471-19dd-485d-b7f4-b313185d430d",
    "inputs": {
      "Locale": "en-UK",
      "trip": {
        "begin": "2019-09-22T22:00:00Z[UTC]",
        "city": "Boston",
        "country": "US",
        "end": "2019-09-26T22:00:00Z[UTC]",
        "visaRequired": true
      },
      "TaskName": "VisaApplication",
      "NodeName": "Apply for visa",
      "Priority": "1",
      "Skippable": "true",
      "traveller": {
        "address": {
          "city": "Krakow",
          "country": "Poland",
          "street": "Polna",
          "zipCode": "12345"
        },
        "email": "jan.kowalski@email.com",
        "firstName": "Jan",
        "lastName": "Kowalski",
        "nationality": "Polish"
      }
    },
    "outputs": {},
    "potentialGroups": [],
    "potentialUsers": [],
    "processId": "travels",
    "processInstanceId": "63c297cb-f5ac-4e20-8254-02f37bd72b80",
    "referenceName": "VisaApplication",
    "startDate": "2019-09-16T15:22:26.658Z[UTC]",
    "state": "Ready",
    "taskName": "Apply for visa",
    "taskPriority": "1"
  },
  "id": "9c340cfa-c9b6-46f2-a048-e1114b077a7f",
  "kogitoProcessId": "travels",
  "kogitoProcessinstanceId": "63c297cb-f5ac-4e20-8254-02f37bd72b80",
  "kogitoUserTaskinstanceId": "4d899471-19dd-485d-b7f4-b313185d430d",
  "kogitoUserTaskinstanceState": "Ready",
  "source": "http://localhost:8080/travels",
  "specversion": "0.3",
  "time": "2019-09-16T17:22:26.662592+02:00[Europe/Berlin]",
  "type": "UserTaskInstanceEvent"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event data also includes the following extensions to enable event routing based on the event metadata without requiring the body of the event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogitoUserTaskinstanceId</code></p>
</li>
<li>
<p><code>kogitoUserTaskinstanceState</code></p>
</li>
<li>
<p><code>kogitoProcessinstanceId</code></p>
</li>
<li>
<p><code>kogitoProcessId</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Event publishing</p>
</div>
<div class="paragraph">
<p>{PRODUCT} generates events only when at least one publisher is configured. A {PRODUCT} service environment can have many event publishers that publish these events into different channels.</p>
</div>
<div class="paragraph">
<p>By default, {PRODUCT} includes the following message-based event publishers, depending on your application framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>For Quarkus</strong>: <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a> for sending events using Apache Kafka, Apache Camel, Advanced Message Queuing Protocol (AMQP), or MQ Telemetry Transport (MQTT)</p>
</li>
<li>
<p><strong>For Spring Boot</strong>: <a href="https://spring.io/projects/spring-kafka">Spring for Apache Kafka</a> for sending events using Kafka</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enable or disable event publishing, you can adjust the following properties in the <code>src/main/resources/application.properties</code> file in your {PRODUCT} project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogito.events.processinstances.enabled</code>: Enables or disables publishing for process instance events (default: <code>enabled</code>)</p>
</li>
<li>
<p><code>kogito.events.usertasks.enabled</code>: Enables or disables publishing for user task instance events (default: <code>enabled</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To develop additional event publishers, you can implement the <code>org.kie.kogito.event.EventPublisher</code> implementation and include the required annotations for JavaBeans discovery.</p>
</div>
<div id="proc-messaging-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kafka messaging for {PRODUCT} services</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} supports the <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> specification for messaging in your services. You can enable messaging to configure message events as either input or output of business process execution.</p>
</div>
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-messaging-example.png" alt="Image of message-based process">
</div>
<div class="title">Figure 275. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>In this example, the message start and end events require the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Message name that maps to the channel that delivers messages</p>
</li>
<li>
<p>Message payload that maps to a process instance variable</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-messaging-start-event.png" alt="Image of message start event data">
</div>
<div class="title">Figure 276. Example message configuration for start event</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/bpmn-messaging-end-event.png" alt="Image of message end event data">
</div>
<div class="title">Figure 277. Example message configuration for end event</div>
</div>
<div class="paragraph">
<p>For this procedure, the messaging is based on <a href="https://kafka.apache.org/">Apache Kafka</a> as the event publisher, so you must have Kafka installed in order to enable messaging. Your marshalling configuration depends on the messaging solution that you use.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed and includes any required topics. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your {PRODUCT} project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;kogito-cloudevents-quarkus-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
  &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;kogito-cloudevents-spring-boot-addon&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
  &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the incoming and outgoing messaging channels and properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>On Quarkus</strong>: Add the following properties to the <code>src/main/resources/application.properties</code> file in your {PRODUCT} project to configure the incoming and outgoing messages and channels:</p>
<div class="listingblock">
<div class="title">Configure incoming and outgoing messages and channels</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka
mp.messaging.incoming.kogito_incoming_stream.topic=travellers
mp.messaging.incoming.kogito_incoming_stream.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-kafka
mp.messaging.outgoing.kogito_outgoing_stream.topic=processedtravellers
mp.messaging.outgoing.kogito_outgoing_stream.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace <code>travellers</code> with the name of the message start event.
Replace <code>processedtravellers</code> with the name of the message end event.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To prevent execution errors due to long wait times with messaging, you can also use the following property to disable waiting for message completion:</p>
</div>
<div class="listingblock">
<div class="title">Disable message wait time</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.[channel-name].waitForWriteCompletion=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>On Spring Boot</strong>: Add the following property to the <code>src/main/resources/application.properties</code> file in your {PRODUCT} project to configure the messaging channel:</p>
<div class="listingblock">
<div class="title">Configure messaging channel</div>
<div class="content">
<pre class="highlight"><code>kafka.bootstrapAddress=localhost:9092
kogito.addon.cloudevents.kafka.kogito_incoming_stream=travellers
kogito.addon.cloudevents.kafka.kogito_outgoing_stream=processedtravellers</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to enabling Kafka messaging explicitly in {PRODUCT} services, you can use the {PRODUCT} Operator to install the Kafka infrastructure and enable messaging for the service during deployment on OpenShift. For more information about enabling Kafka messaging with the {PRODUCT} Operator, see {URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-operator-with-kafka_kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>].
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example {PRODUCT} services with Kafka messaging, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-kafka-quickstart-quarkus"><code>process-kafka-quickstart-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-kafka-quickstart-springboot"><code>process-kafka-quickstart-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="proc-event-listeners-registering_kogito-developing-decision-services" class="paragraph">
<p>=== Registering event listeners</p>
</div>
<div class="paragraph _abstract">
<p>You can register custom event listeners to detect and publish events that are not published by {PRODUCT} by default. Your custom event listener configuration must implement the relevant implementation for either processes or rules.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create an event listener configuration class for either process or rule events, such as a <code>ProcessEventListenerConfig</code> class or a <code>RuleEventListenerConfig</code> class.</p>
</li>
<li>
<p>In your event listener configuration class, extend the default implementation of the configuration class as part of your listener definition:</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>Implementation for process events: <code>org.kie.kogito.process.impl.DefaultProcessEventListenerConfig</code></p>
</li>
<li>
<p>Implementation for rule events: <code>org.drools.core.config.DefaultRuleEventListenerConfig</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example process event listener with extended default implementation</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class ProcessEventListenerConfig extends DefaultProcessEventListenerConfig {

    public ProcessEventListenerConfig() {
        super(new CustomProcessEventListener());
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule event listener with extended default implementation</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class RuleEventListenerConfig extends DefaultRuleEventListenerConfig {

    public RuleEventListenerConfig() {
        super(new CustomRuleEventListener());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These configuration classes must be injectable, so ensure that you properly annotate the classes, such as with the annotations <code>@ApplicationScoped</code> or <code>@Component</code>, so that they can be found and registered.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you can implement the relevant event listener interface instead of extending the default implementation, but this approach excludes other listeners provided by {PRODUCT}.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interface for process events: <code>org.kie.kogito.process.ProcessEventListenerConfig</code></p>
</li>
<li>
<p>Interface for rule events: <code>org.kie.kogito.rules.RuleEventListenerConfig</code></p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After the event listener is configured, package the listener configuration class in the <code>src/main/java</code> folder of the relevant application or add it as dependency in the <code>pom.xml</code> file of the application to make the listener available.</p>
</li>
</ol>
</div>
<div id="proc-prometheus-metrics-monitoring_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Prometheus metrics monitoring in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>Prometheus is an open-source systems monitoring toolkit that you can use with {PRODUCT} to collect and store metrics related to the execution of Business Process Model and Notation (BPMN) process models, business rules, and Decision Model and Notation (DMN) decision models. You can access the stored metrics through a REST API call to a configured application endpoint, through the Prometheus expression browser, or using a data-graphing tool such as Grafana.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Prometheus is installed. For information about downloading and using Prometheus, see the <a href="https://prometheus.io/docs/introduction/overview/">Prometheus documentation page</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your {PRODUCT} project, add following dependency to the <code>pom.xml</code> file to enable the Prometheus add-on:</p>
<div class="listingblock">
<div class="title">Add dependency for Prometheus add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;monitoring-prometheus-addon&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>In the <code>src/main/java</code> folder of your project, create an event listener configuration class for the following Prometheus event listeners for monitoring processes or rules, such as a <code>ProcessEventListenerConfig</code> class or a <code>RuleEventListenerConfig</code> class:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Prometheus event listener for processes: <code>org.kie.addons.monitoring.process.PrometheusProcessEventListener</code></p>
</li>
<li>
<p>Prometheus event listener for rules: <code>org.kie.addons.monitoring.rule.PrometheusMetricsDroolsListener</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example process event listener for Prometheus</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class ProcessEventListenerConfig extends DefaultProcessEventListenerConfig {

    public ProcessEventListenerConfig() {
        super(new PrometheusProcessEventListener("acme-travels"));
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule event listener for Prometheus</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class RuleEventListenerConfig extends DefaultRuleEventListenerConfig {

    public RuleEventListenerConfig() {
        super(new PrometheusMetricsDroolsListener("acme-travels"));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument <code>acme-travels</code> in these listener examples identifies the relevant data when the data is returned from the {PRODUCT} runtime and grouped in Prometheus metrics.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>prometheus.yaml</code> file of your Prometheus distribution, add the following settings in the <code>scrape_configs</code> section to configure Prometheus to scrape metrics from your {PRODUCT} service:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example scrape configurations in <code>prometheus.yaml</code> file</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">scrape_configs:
  job_name: 'travels'
metrics_path: /metrics
static_configs:
  - targets: ["localhost:8080"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace the values according to your {PRODUCT} service settings.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a command terminal, navigate to your {PRODUCT} project and run the project using your preferred run mode, such as development mode:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you start your {PRODUCT} service, Prometheus begins collecting metrics and {PRODUCT} publishes the metrics to the configured REST API endpoint.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To verify the metrics configuration, use a REST client or curl utility to send a <code>GET</code> request to the configured <code>/metrics</code> endpoint, such as <code>http://localhost:8080/metrics</code> in this example:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to return Prometheus metrics</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/metrics</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code># HELP kie_process_instance_completed_total Completed Process Instances
# TYPE kie_process_instance_completed_total counter
# HELP kie_process_instance_started_total Started Process Instances
# TYPE kie_process_instance_started_total counter
kie_process_instance_started_total{app_id="acme-travels",process_id="travels",} 1.0
# HELP kie_work_item_duration_seconds Work Items Duration
# TYPE kie_work_item_duration_seconds summary
# HELP drl_match_fired_nanosecond Drools Firing Time
# TYPE drl_match_fired_nanosecond histogram
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="1000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="2000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="3000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="4000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="5000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="6000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="7000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="8000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="9000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="+Inf",} 1.0
drl_match_fired_nanosecond_count{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",} 1.0
drl_match_fired_nanosecond_sum{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",} 789941.0
# HELP kie_process_instance_sla_violated_total Process Instances SLA Violated
# TYPE kie_process_instance_sla_violated_total counter
# HELP kie_process_instance_duration_seconds Process Instances Duration
# TYPE kie_process_instance_duration_seconds summary
# HELP kie_process_instance_running_total Running Process Instances
# TYPE kie_process_instance_running_total gauge
kie_process_instance_running_total{app_id="acme-travels",process_id="travels",} 1.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the metrics are not available at the defined endpoint, review and verify the {PRODUCT} and Prometheus configurations described in this section.</p>
</div>
<div class="paragraph">
<p>You can also interact with your collected metrics and application targets in the Prometheus expression browser at <code>http://<em>HOST:PORT</em>/graph</code> and <code>http://<em>HOST:PORT</em>/targets</code>, or integrate your Prometheus data source with a data-graphing tool such as Grafana:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/configuration/prometheus-expression-browser-targets.png" alt="Image of targets in Prometheus expression browser">
</div>
<div class="title">Figure 278. Prometheus expression browser with {PRODUCT} service targets</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/configuration/prometheus-grafana-data.png" alt="Image of application metrics in Grafana">
</div>
<div class="title">Figure 279. Grafana dashboard with {PRODUCT} service metrics</div>
</div>
<div class="openblock">
<div class="content">
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://prometheus.io/docs/prometheus/latest/getting_started/">Getting Started with Prometheus</a></p>
</li>
<li>
<p><a href="https://prometheus.io/docs/visualization/grafana/">Grafana Support for Prometheus</a></p>
</li>
<li>
<p><a href="https://grafana.com/docs/grafana/latest/features/datasources/prometheus/">Using Prometheus in Grafana</a></p>
</li>
</ul>
</div>
<div id="con-persistence_kogito-developing-decision-services" class="paragraph">
<p>== Persistence in {PRODUCT} services</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} supports runtime persistence for preserving process data in your services, such as active process nodes and process instance variables, across application restarts. For {PRODUCT} persistence, you can use <a href="https://infinispan.org/">Infinispan</a> and configure key-value storage definitions to persist data, or you can use <a href="https://www.mongodb.com/">MongoDB</a> to persist data in a document-based format.</p>
</div>
<div class="paragraph">
<p>Runtime persistence is intended primarily for storing data that is required to resume workflow execution for a particular process instance. Persistence applies to both public and private processes that are not yet complete. Once a process completes, persistence is no longer applied. This persistence behavior means that only the information that is required to resume execution is persisted.</p>
</div>
<div class="paragraph">
<p>Node instances that are currently active or in wait states are persisted. When a process instance finishes execution but has not reached the end state (completed or aborted), the node instance data is persisted.</p>
</div>
<div class="paragraph">
<p>=== Persistence workflow in {PRODUCT}</p>
</div>
<div class="paragraph">
<p>In {PRODUCT}, a process instance is persisted when the process reaches a wait state, where the process does not execute anymore but has not reached the end state (completed or aborted).</p>
</div>
<div class="paragraph">
<p>For example, when a process reaches a user task or a catching signal event, the process instance pauses and the {PRODUCT} {PROCESS_ENGINE} takes a complete snapshot of the process, including the following data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Process instance metadata, such as process instance ID, process definition ID, state, description, and start date</p>
</li>
<li>
<p>Process instance variables</p>
</li>
<li>
<p>Active node instances, including local variables</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Process instance metadata is persisted with a predefined protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema that is aware of the metadata and supports node instances that are in wait states.</p>
</div>
<div class="paragraph">
<p>Process instance and node instance variables are persisted based on the generated protobuf schema and generated marshallers. Custom data types are also persisted during execution.</p>
</div>
<div class="paragraph">
<p>For straight-through process instances that do not trigger any activity, persistence is not invoked and no data is stored.</p>
</div>
<div class="paragraph">
<p>Each process definition has its own cache for storing runtime information. The cache is based on the process definition ID and is named in the Infinispan Server or in the MongoDB Server. If no process cache exists, cache is automatically created in Infinispan or in MongoDB. This setup facilitates maintenance of process instance data and reduces concurrency on the cache instances.</p>
</div>
<div class="paragraph">
<p>=== Persisted process instance variables and data types</p>
</div>
<div class="paragraph">
<p>Persisted process variables, local variables, and other process data are stored with the process instance. The stored data is marshalled into bytes format so it can be transferred and persisted into the key-value storage definition for Infinispan or into document-based format for MongoDB. The marshalling and unmarshalling is implemented based on protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) and requires a schema and marshallers for handling a specified type of data.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} generates both the protobuf schema (as PROTO files) and marshallers for persisting variables. The {PRODUCT} marshallers are based on the <a href="https://github.com/infinispan/protostream">ProtoStream</a> subproject of Infinispan.</p>
</div>
<div class="paragraph">
<p>When you build your {PRODUCT} project, {PRODUCT} scans all process definitions and extracts information about the data within the business assets. Based on the unique data types (regardless of how many processes reference a specified type), a PROTO file called <code>kogito-application.proto</code> is generated that builds a complete schema for the application. This file is stored in the <code>target/classes/persistence/</code> folder of your project after successful build.</p>
</div>
<div class="listingblock">
<div class="title">Example PROTO file generated by {PRODUCT} to persist process data</div>
<div class="content">
<pre class="highlight"><code>syntax = "proto2";
package org.kie.kogito.examples;
import "kogito-types.proto";

message Order {
        option java_package = "org.kie.kogito.examples.demo";
        optional string orderNumber = 1;
        optional bool shipped = 2;
        optional double total = 3;
}
message Person {
        option java_package = "org.kie.kogito.examples.demo";
        optional bool adult = 1;
        optional int32 age = 2;
        optional string name = 3;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Each <code>kogito-application.proto</code> file imports a <code>kogito-types.proto</code> file that automatically defines the base types managed by {PRODUCT}.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on the <code>kogito-application.proto</code> file, marshallers are also generated and configured in the application so that whenever a particular data type is used in a process instance, the data is successfully marshalled and unmarshalled.</p>
</div>
<div class="paragraph">
<p>=== Supported data types for persisted variables</p>
</div>
<div class="paragraph">
<p>For optimal persistence with process data and variables, use Java objects as data types that represent your process variables. If you use other formats for data types, your data might not be persisted or your {PRODUCT} project might fail to compile.</p>
</div>
<div class="paragraph">
<p>{PRODUCT} currently supports the following data types for process variables:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 96. Supported data types</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic text type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended size number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic floating point number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended size floating point number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic date type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom data type built with multiple simple types</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java object with a Java object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom data type built with multiple simple types and includes another Java object</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java object with a list of Java objects</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom data type built with multiple simple types and a list of Java objects, and can also contain another Java object</p></td>
</tr>
</tbody>
</table>
<div id="proc-infinispan-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Infinispan persistence for {PRODUCT} services</p>
</div>
<div class="paragraph _abstract">
<p>You can enable persistence for your {PRODUCT} services using <a href="https://infinispan.org/">Infinispan</a> to persist data, such as active process nodes and process instance variables, so that the data is preserved across application restarts. For {PRODUCT} persistence with Infinispan, you must have a an Infinispan Server installed and running in order to enable persistence.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://infinispan.org/">Infinispan Server</a> 11.0 or later is installed and running. For information about Infinispan installation and configuration, see the <a href="https://infinispan.org/documentation/">Infinispan documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your {PRODUCT} project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;infinispan-persistence-addon&lt;/artifactId&gt;
  &lt;version&gt;<em>{PRODUCT_INIT_CAP}_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-infinispan-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;infinispan-persistence-addon&lt;/artifactId&gt;
  &lt;version&gt;<em>{PRODUCT_INIT_CAP}_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.infinispan&lt;/groupId&gt;
  &lt;artifactId&gt;infinispan-spring-boot-starter-remote&lt;/artifactId&gt;
  &lt;version&gt;<em>INFINISPAN_SPRING_BOOT_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add following property to the <code>src/main/resources/application.properties</code> file in your {PRODUCT} project to configure the connection to the Infinispan Server.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host and port information according to your Infinispan Server installation.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>quarkus.infinispan-client.server-list=localhost:11222</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>infinispan.remote.server-list=127.0.0.1:11222</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to enabling Infinispan persistence explicitly in {PRODUCT} services, you can use the {PRODUCT} Operator to install the Infinispan infrastructure and enable persistence for the service during deployment on OpenShift. For more information about enabling Infinispan persistence with the {PRODUCT} Operator, see {URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-operator-with-infinispan_kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>].
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example {PRODUCT} services with Infinispan persistence, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-infinispan-persistence-quarkus"><code>process-infinispan-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-infinispan-persistence-springboot"><code>process-infinispan-persistence-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="proc-mongodb-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling MongoDB persistence for {PRODUCT} services</p>
</div>
<div class="paragraph _abstract">
<p>As an alternative to using Infinispan for {PRODUCT} runtime persistence, you can enable persistence for your {PRODUCT} services using <a href="https://www.mongodb.com/">MongoDB</a>. MongoDB is a general purpose, document-based database that enables you to store data in JSON-like documents instead of key-value storage definitions in Infinispan-based persistence storage. For {PRODUCT} persistence with MongoDB, you must have a MongoDB Server installed and running in order to enable persistence.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.mongodb.com/try/download">MongoDB Server</a> 3.6 or later is installed and running. For information about MongoDB installation and configuration, see the <a href="https://docs.mongodb.com/manual/installation/">MongoDB documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your {PRODUCT} project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;mongodb-persistence-addon&lt;/artifactId&gt;
  &lt;version&gt;<em>{PRODUCT_INIT_CAP}_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-mongodb-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;mongodb-persistence-addon&lt;/artifactId&gt;
  &lt;version&gt;<em>{PRODUCT_INIT_CAP}_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>MONGODB_SPRING_BOOT_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add following properties to the <code>src/main/resources/application.properties</code> file in your {PRODUCT} project to configure MongoDB persistence and to connect to the relevant MongoDB Server and database.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host, port, and database information according to your MongoDB Server installation. By default, the database is named <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=mongodb
quarkus.mongodb.connection-string = mongodb://localhost:27017
quarkus.mongodb.database=kogito_db</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=mongodb
spring.data.mongodb.uri=mongodb://localhost:27017
spring.data.mongodb.database=kogito_db</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>After you enable MongoDB persistence for your {PRODUCT} services, you can use MongoDB tools such as <a href="https://www.mongodb.com/try/download/compass">MongoDB Compass</a> to query and review the process instance information and model variables from the database, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example persisted process instance</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "_id": "0e6c09de-938f-41f7-acdb-ecbe2e409c23",
  "processInstance": {
    "processType": "RuleFlow",
    "id": "0e6c09de-938f-41f7-acdb-ecbe2e409c23",
    "processId": "dealreviews",
    "state": 1,
    "nodeInstance": [
      {
        "id": "be9542c0-8cc3-4fbc-ac6c-f337bb176682",
        "nodeId": "2",
        "content": {
          "type": "HUMAN_TASK_NODE",
          "humanTask": {
            "workItemId": "d5a61e95-9dce-472b-8dfe-dd948e086f7a",
            "workitem": {
              "id": "d5a61e95-9dce-472b-8dfe-dd948e086f7a",
              "processInstancesId": "0e6c09de-938f-41f7-acdb-ecbe2e409c23",
              "name": "Human Task",
              "state": 0,
              "variable": [
                {
                  "name": "Skippable",
                  "strategyIndex": 0,
                  "value": "true",
                  "dataType": "java.lang.String"
                },
                {
                  "name": "deal",
                  "strategyIndex": 0,
                  "value": "my fancy deal",
                  "dataType": "java.lang.String"
                },
                {
                  "name": "ActorId",
                  "strategyIndex": 0,
                  "value": "john",
                  "dataType": "java.lang.String"
                },
                {
                  "name": "TaskName",
                  "strategyIndex": 0,
                  "value": "review",
                  "dataType": "java.lang.String"
                },
                {
                  "name": "NodeName",
                  "strategyIndex": 0,
                  "value": "Review the deal",
                  "dataType": "java.lang.String"
                },
                {
                  "name": "traveller",
                  "strategyIndex": 0,
                  "value": {
                    "firstName": "John",
                    "lastName": "Doe",
                    "email": "jon.doe@example.com",
                    "nationality": "American",
                    "address": {
                      "street": "main street",
                      "city": "Boston",
                      "zipCode": "10005",
                      "country": "US"
                    }
                  },
                  "dataType": "org.acme.travels.Traveller"
                }
              ],
              "nodeInstanceId": "be9542c0-8cc3-4fbc-ac6c-f337bb176682",
              "nodeId": "2",
              "phaseId": "active",
              "phaseStatus": "Ready",
              "startDate": "1598460385978",
              "taskName": "review",
              "potUsers": [
                "john"
              ],
              "taskReferenceName": "Review the deal"
            }
          }
        },
        "level": 1,
        "slaCompliance": 0,
        "triggerDate": "1598460385976"
      }
    ],
    "variable": [
      {
        "name": "deal",
        "strategyIndex": 0,
        "value": "my fancy deal",
        "dataType": "java.lang.String"
      },
      {
        "name": "traveller",
        "strategyIndex": 0,
        "value": {
          "firstName": "John",
          "lastName": "Doe",
          "email": "jon.doe@example.com",
          "nationality": "American",
          "address": {
            "street": "main street",
            "city": "Boston",
            "zipCode": "10005",
            "country": "US"
          }
        },
        "dataType": "org.acme.travels.Traveller"
      }
    ],
    "parentProcessInstanceId": "57bffb3d-06a7-48e0-87be-004a722792db",
    "completedNodeIds": [
      "_7E3D27D0-6644-4E55-8E41-9F68BD0D1327"
    ],
    "iterationLevels": [
      {
        "id": "_3597E33A-1C00-41B3-924E-09EA47F79D93",
        "level": 1
      }
    ],
    "description": "Deal Review",
    "signalCompletion": true,
    "slaCompliance": 0,
    "rootProcessInstanceId": "57bffb3d-06a7-48e0-87be-004a722792db",
    "startDate": "1598460385975",
    "rootProcessId": "deals"
  },
  "strategies": [
    {
      "name": "org.kie.kogito.mongodb.marshalling.DocumentMarshallingStrategy",
      "value": 0
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example {PRODUCT} services with MongoDB persistence, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-mongodb-persistence-quarkus"><code>process-mongodb-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/process-mongodb-persistence-springboot"><code>process-mongodb-persistence-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="con-data-index-service_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Data Index Service that stores all {PRODUCT} events related to processes, tasks, and domain data. The Data Index Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all {PRODUCT} search, insight, and management capabilities.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/configuration/data-index-architecture_enterprise.png" alt="Diagram of an example Kogito service using Data Index Service">
</div>
<div class="title">Figure 280. Data Index Service architecture in an example {PRODUCT} service</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} Data Index Service has the following key attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Distinct focus on domain data</p>
</li>
<li>
<p>Flexible data structure</p>
</li>
<li>
<p>Distributable and cloud-ready format</p>
</li>
<li>
<p>Infinispan-based persistence support</p>
</li>
<li>
<p>Message-based communication with {PRODUCT} runtime (Apache Kafka, cloud events )</p>
</li>
<li>
<p>Powerful querying API using GraphQL</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The {PRODUCT} Data Index Service is not intended for permanent storage or audit log purposes. The Data Index Service is designed to make business domain data accessible for processes that are currently in progress.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>=== Data Index Service workflow in {PRODUCT}</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Data Index Service is a Quarkus application, based on <a href="https://vertx.io/">Vert.x</a> with <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a>, that exposes a <a href="https://graphql.org">GraphQL</a> endpoint that client applications use to access business domain-specific data and other information about running process instances.</p>
</div>
<div class="paragraph">
<p>The Data Index Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then indexes the returned data for future GraphQL queries. These events contain information about units of work executed for a process.</p>
</div>
<div class="paragraph">
<p>Indexed data from the Data Index Service is parsed and pushed into the following Infinispan caches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Domain cache</strong>: Generic cache for each process definition where the process instance variables are pushed as the root content. This cache also includes some process instance metadata, which enables data correlation between domain and process instances. Data is transferred in JSON format to an Infinispan Server.</p>
</li>
<li>
<p><strong>Process instance cache</strong>: Cache for each process instance. This cache contains all process instance information, including all metadata and other detailed information such as executed nodes.</p>
</li>
<li>
<p><strong>User task instance cache</strong>: Cache for each user task instance. This cache contains all task instance information, including all metadata and other detailed information such as data input and output.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The indexing functionality in the Data Index Service is based on <a href="https://lucene.apache.org/">Apache Lucene</a>, and storage for the Data Index Service is provided by <a href="https://infinispan.org/">Infinispan</a>. Communication between the Data Index Service and Infinispan is handled through a protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema and generated marshallers.</p>
</div>
<div class="paragraph">
<p>After the data is indexed and stored in a cache, the Data Index Service inspects the process model to update the GraphQL schema and enable a type-checked query system that consumer clients can use to access the data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Infinispan indexing</div>
<div class="paragraph">
<p>Infinispan also supports data indexing through an embedded Apache Lucene engine. To determine which attributes must be indexed, Inifinispan requires <code>@Indexed</code> and <code>@Field</code> Hibernate Search parameters that annotate the relevant protobuf file attributes:</p>
</div>
<div class="listingblock">
<div class="title">Example indexed model in Infinispan Server configuration</div>
<div class="content">
<pre class="highlight"><code>/* @Indexed */
message ProcessInstanceMeta {
    /* @Field(store = Store.YES) */
    optional string id = 1;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Infinispan indexing, see <a href="https://infinispan.org/docs/stable/titles/developing/developing.html#enable_indexing">Indexing of protobuf encoded entries</a> in the Infinispan documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="proc-data-index-service-using_kogito-developing-decision-services" class="paragraph">
<p>=== Using the {PRODUCT} Data Index Service to query application data</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Data Index Service that stores all {PRODUCT} events related to processes, tasks, and domain data. The Data Index Service uses Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all {PRODUCT} search, insight, and management capabilities.</p>
</div>
<div class="paragraph">
<p>You can use the {PRODUCT} Data Index Service to index, store, and query process data in your {PRODUCT} services.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://infinispan.org/">Infinispan Server</a> 11.0 or later is installed and running. For information about Infinispan installation and configuration, see the <a href="https://infinispan.org/documentation/">Infinispan documentation</a>.</p>
</li>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed, including required topics, and the Kafka messaging server is running. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>For a list of configuration options for setting up the Kafka consumer, see <a href="https://kafka.apache.org/documentation/#consumerconfigs">Consumer Configs</a> in the Kafka documentation.</p>
</div>
<div class="paragraph">
<p>For more information about using Kafka messaging on Quarkus, see <a href="https://quarkus.io/guides/kafka">Using Apache Kafka with reactive messaging</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Configure your {PRODUCT} project to enable Infinispan persistence and Apache Kafka messaging.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For instructions on enabling persistence, see <a href="#proc-infinispan-persistence-enabling_kogito-configuring">[proc-infinispan-persistence-enabling_kogito-configuring]</a>.</p>
</div>
<div class="paragraph">
<p>For instructions on enabling messaging, see <a href="#proc-messaging-enabling_kogito-configuring">[proc-messaging-enabling_kogito-configuring]</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/data-index-service-infinispan/"><code>data-index-service-infinispan</code></a> artifacts page, select the latest release of the Data Index Service, and download the <code>data-index-service-infinispan-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>data-index-service-infinispan-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Data Index Service with the required Infinispan credentials:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Data Index Service</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.infinispan-client.auth-username=<em>INFINISPAN_USER_NAME</em> \
  -Dquarkus.infinispan-client.auth-password=<em>INFINISPAN_PASSWORD</em> \
  -jar data-index-service-infinispan-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Infinispan authentication on Quarkus, see <a href="https://quarkus.io/guides/infinispan-client">Infinispan client</a> in the Quarkus documentation.</p>
</div>
<div class="paragraph">
<p>To change the logging level of the Data Index Service, such as for debugging, you can specify the following start-up properties as needed when you run the Data Index Service:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Data Index Service logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -jar data-index-service-infinispan-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a separate command terminal window, navigate to your {PRODUCT} project and run the project using your preferred run mode, such as development mode:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the Data Index Service and your {PRODUCT} project both configured and running, the Data Index Service starts consuming messages from the defined Kafka topics, such as <code>kogito-processinstances-events</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, navigate to the <code>http://<em>HOST</em>:<em>PORT</em></code> location configured for your running {PRODUCT} service, such as <code>http://localhost:8080/</code>, to explore the exposed data model.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>To query the available data using the <a href="https://github.com/graphql/graphiql">GraphiQL</a> interface, navigate to <code>http://<em>HOST</em>:<em>PORT</em>/graphql</code>, such as <code>http://localhost:8080/graphql</code> in this example, and begin executing supported queries to interact with your application data.</p>
</div>
<div class="listingblock">
<div class="title">Example query for process instance data</div>
<div class="content">
<pre class="highlight"><code>{ ProcessInstances {
  id,
  processId,
  processName,
  state,
  nodes {
    name,
    type,
    enter,
    exit
  }
} }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/openshift/kogito-data-index-graphiql-process-instances.png" alt="Image of GraphQL query and response for process instances">
</div>
<div class="title">Figure 281. Example response</div>
</div>
<div class="paragraph">
<p>For available query types, click <strong>Docs</strong> in the upper-right corner of the GraphiQL interface.</p>
</div>
<div class="paragraph">
<p>For more information about supported queries with the Data Index Service, see <a href="#ref-data-index-service-queries_kogito-configuring">[ref-data-index-service-queries_kogito-configuring]</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to enabling the Data Index Service explicitly for {PRODUCT} services, you can use the {PRODUCT} Operator to install the Data Index Service custom resource for the service deployment on OpenShift. For more information about installing the Data Index Service with the {PRODUCT} Operator, see {URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-operator-with-data-index-service_kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>].
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div id="ref-data-index-service-queries_kogito-developing-decision-services" class="paragraph">
<p>=== Supported GraphQL queries with the Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>After you configure and run your {PRODUCT} service and the {PRODUCT} Data Index Service, you can query the available data using the <a href="https://github.com/graphql/graphiql">GraphiQL</a> interface displayed at <code>http://<em>HOST</em>:<em>PORT</em>/graphql</code>, such as <code>http://localhost:8080/graphql</code>.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Data Index Service supports GraphQL queries for process definitions (domain cache) and for process instances and task instances (instance caches).</p>
</div>
<div class="paragraph">
<p>==== GraphQL queries for process definitions (domain cache)</p>
</div>
<div class="paragraph">
<p>Use the following GraphQL queries to retrieve data about process definitions. These example queries assume that a <code>Travels</code> Business Process Model and Notation (BPMN) process model is running or has been executed.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from process definitions</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data about a specified process definition from your {PRODUCT} service.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels {
    visaApplication {
      duration
    }
    flight {
      flightNumber
      gate
    }
    hotel {
      name
      address {
        city
        country
      }
    }
    traveller {
      firstName
      lastName
      nationality
      email
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Correlate data using the <code>metadata</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>metadata</code> parameter to correlate data from process definitions (domain cache) with data from process instances and task instances (instance caches). This parameter is added to all root models that are deployed in the Data Index Service and enables you to retrieve and filter query data.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels {
    flight {
      flightNumber
      arrival
      departure
    }
    metadata {
      lastUpdate
      userTasks {
        name
      }
      processInstances {
        processId
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Filter query results using the <code>where</code> and <code>metadata</code> parameters</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>where</code> parameter with multiple combinations to filter query results based on process definition attributes. The attributes available for search depend on the BPMN process model that is deployed, such as a <code>Travels</code> process model in this example.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {traveller: {firstName: {like: "Cri*"}}}) {
    flight {
      flightNumber
      arrival
      departure
    }
    traveller {
      email
    }
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>like</code> operator is case sensitive.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also use the <code>metadata</code> parameter to filter correlated query results from related process instances or tasks.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {metadata: {processInstances: {id: {equal: "1aee8ab6-d943-4dfb-b6be-8ea8727fcdc5"}}}}) {
    flight {
      flightNumber
      arrival
      departure
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {metadata: {userTasks: {id: {equal: "de52e538-581f-42db-be65-09e8739471a6"}}}}) {
    flight {
      flightNumber
      arrival
      departure
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Sort query results using the <code>orderBy</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>orderBy</code> parameter to sort query results based on process definition attributes. You can also specify the direction of sorting in ascending <code>ASC</code> order or descending <code>DESC</code> order. Multiple attributes are applied to the database query in the order they are specified in the query filter.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(orderBy: {trip: {begin: ASC}}) {
    flight {
      flightNumber
      arrival
      departure
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Limit and offset query results using the <code>pagination</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>pagination</code> parameter to specify a <code>limit</code> and <code>offset</code> for query results.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {traveller: {firstName: {like: "Cri*"}}}, pagination: {offset: 0, limit: 10}) {
    flight {
      flightNumber
      arrival
      departure
    }
    traveller {
      email
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>==== GraphQL queries for process instances and user task instances (instance caches)</p>
</div>
<div class="paragraph">
<p>Use the following GraphQL queries to retrieve data about process instances and user task instances.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from process instances</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data about a specified process instance from your process definition.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances {
    id
    processId
    state
    parentProcessInstanceId
    rootProcessId
    rootProcessInstanceId
    variables
    nodes {
      id
      name
      type
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from user task instances</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data from a specified user task instance from the process instance.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  UserTaskInstances {
    id
    name
    actualOwner
    description
    priority
    processId
    processInstanceId
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Filter query results using the <code>where</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>where</code> parameter with multiple combinations to filter query results based on process or task attributes.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {state: {equal: ACTIVE}}) {
    id
    processId
    processName
    start
    state
    variables
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {id: {equal: "d43a56b6-fb11-4066-b689-d70386b9a375"}}) {
    id
    processId
    processName
    start
    state
    variables
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  UserTaskInstances(where: {state: {equal: "Ready"}}) {
    id
    name
    actualOwner
    description
    priority
    processId
    processInstanceId
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, every filtered attribute is executed as an <code>AND</code> operation in queries. You can modify this behavior by combining filters with an <code>AND</code> or <code>OR</code> operator.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {or: {state: {equal: ACTIVE}, rootProcessId: {isNull: false}}}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {and: {processId: {equal: "travels"}, or: {state: {equal: ACTIVE}, rootProcessId: {isNull: false}}}}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the attribute type, the following operators are also available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>String array argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>contains</code> : String</p>
</li>
<li>
<p><code>containsAll</code>: Array of strings</p>
</li>
<li>
<p><code>containsAny</code>: Array of strings</p>
</li>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>String argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>in</code>: Array of strings</p>
</li>
<li>
<p><code>like</code>: String</p>
</li>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
<li>
<p><code>equal</code>: String</p>
</li>
</ul>
</div>
</li>
<li>
<p>ID argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>in</code>: Array of strings</p>
</li>
<li>
<p><code>equal</code>: String</p>
</li>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Boolean argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
<li>
<p><code>equal</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Numeric argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>in</code>: Array of integers</p>
</li>
<li>
<p><code>isNull</code>: Boolean</p>
</li>
<li>
<p><code>equal</code>: Integer</p>
</li>
<li>
<p><code>greaterThan</code>: Integer</p>
</li>
<li>
<p><code>greaterThanEqual</code>: Integer</p>
</li>
<li>
<p><code>lessThan</code>: Integer</p>
</li>
<li>
<p><code>lessThanEqual</code>: Integer</p>
</li>
<li>
<p><code>between</code>: Numeric range</p>
</li>
<li>
<p><code>from</code>: Integer</p>
</li>
<li>
<p><code>to</code>: Integer</p>
</li>
</ul>
</div>
</li>
<li>
<p>Date argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
<li>
<p><code>equal</code>: Date time</p>
</li>
<li>
<p><code>greaterThan</code>: Date time</p>
</li>
<li>
<p><code>greaterThanEqual</code>: Date time</p>
</li>
<li>
<p><code>lessThan</code>: Date time</p>
</li>
<li>
<p><code>lessThanEqual</code>: Date time</p>
</li>
<li>
<p><code>between</code>: Date range</p>
</li>
<li>
<p><code>from</code>: Date time</p>
</li>
<li>
<p><code>to</code>: Date time</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Sort query results using the <code>orderBy</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>orderBy</code> parameter to sort query results based on process or task attributes. You can also specify the direction of sorting in ascending <code>ASC</code> order or descending <code>DESC</code> order. Multiple attributes are applied to the database query in the order they are specified in the query filter.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {state: {equal: ACTIVE}}, orderBy: {start: ASC}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  UserTaskInstances(where: {state: {equal: "Ready"}}, orderBy: {name: ASC, actualOwner: DESC}) {
    id
    name
    actualOwner
    description
    priority
    processId
    processInstanceId
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Limit and offset query results using the <code>pagination</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>pagination</code> parameter to specify a <code>limit</code> and <code>offset</code> for query results.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {state: {equal: ACTIVE}}, orderBy: {start: ASC}, pagination: {limit: 10, offset: 0}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="proc-data-index-service-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling {PRODUCT} Data Index Service security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based {PRODUCT} services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the {PRODUCT} Data Index Service to enable security using token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/kiegroup/kogito-apps/tree/master/data-index">{PRODUCT} Data Index Service</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/kiegroup/kogito-apps/tree/master/data-index">{PRODUCT} Data Index Service</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the {PRODUCT} Data Index Service repository and enter the following command to run the application with the required security properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Data Index Service with security properties</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev  \
  -Dquarkus.profile=keycloak  \
  -Dkogito.protobuf.folder=/home/git/kogito-apps/tree/master/data-index/data-index-service/src/test/resources  \
  -Dkogito.protobuf.watch=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} Data Index Service contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Data Index Service project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-service
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=service

%keycloak.quarkus.oidc.web-app-tenant.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.web-app-tenant.client-id=kogito-service
%keycloak.quarkus.oidc.web-app-tenant.credentials.secret=secret
%keycloak.quarkus.oidc.web-app-tenant.application-type=web-app

kogito.data-index.vertx-graphql.ui.path=/graphiql
kogito.data-index.vertx-graphql.ui.tenant=web-app-tenant

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The default configuration provides a multi-tenant configuration so that the {PRODUCT} Data Index Service can use two endpoints with different security <a href="https://quarkus.io/guides/security-openid-connect#quarkus-oidc_quarkus.oidc.application-type"><code>quarkus.oidc.application-type</code></a> configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>/graphql</code> endpoint is configured as a <code>service</code> application that enables Bearer token authentication.</p>
</li>
<li>
<p>The <code>/graphiql</code> interface endpoint, shown in the previous configuration file example, is configured as a <code>web-app</code> application that redirects unauthenticated users to the Keycloak login page. You configure this endpoint using the <code>kogito.data-index.vertx-graphql.ui.path</code> property.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, you can enable only users with the role <code>confidential</code> to access a single <code>/graphql</code> endpoint:</p>
</div>
<div class="listingblock">
<div class="title">Example GraphQL security role configuration</div>
<div class="content">
<pre class="highlight"><code>%keycloak.quarkus.http.auth.policy.role-policy1.roles-allowed=confidential
%keycloak.quarkus.http.auth.permission.roles1.paths=/graphql
%keycloak.quarkus.http.auth.permission.roles1.policy=role-policy1</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop and restart the {PRODUCT} Data Index Service to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="proc-data-index-service-mongodb_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling MongoDB persistence for the {PRODUCT} Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>Instead of using the default Infinispan-based persistence in the {PRODUCT} Data Index Service, you can configure the Data Index Service to use <a href="https://www.mongodb.com/">MongoDB</a> persistence storage if needed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.mongodb.com/try/download">MongoDB Server</a> 3.6 or later is installed and running. For information about MongoDB installation and configuration, see the <a href="https://docs.mongodb.com/manual/installation/">MongoDB documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/data-index-service-mongodb/"><code>data-index-service-mongodb</code></a> artifacts page, select the latest release of the Data Index Service, and download the <code>data-index-service-mongodb-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>data-index-service-mongodb-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Data Index Service with the required MongoDB connection information:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Data Index Service with MongoDB connection information</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.mongodb.connection-string=<em>MONGODB_SERVER_CONNECTION_STRING</em> \
  -Dquarkus.mongodb.database=<em>DATABASE_NAME</em> \
  -jar data-index-service-mongodb-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about MongoDB configuration on Quarkus, see <a href="https://quarkus.io/guides/mongodb#quarkus-mongodb_configuration">Using the MongoDB client</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After the Data Index Service is running, compile and run your {PRODUCT} project as usual and navigate to the <code>http://<em>HOST</em>:<em>PORT</em></code> location configured for your running {PRODUCT} service, such as <code>http://localhost:8080/</code>, to explore the exposed data model.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Indexes are created on every attribute that is annotated with <code>@Indexed</code> and <code>@Field</code> in the protobuf files. However, a single MongoDB collection can have no more than 64 indexes, including the default <code>_id</code> Index.
</td>
</tr>
</table>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#proc-data-index-service-using_kogito-configuring">[proc-data-index-service-using_kogito-configuring]</a></p>
</li>
<li>
<p><a href="#con-persistence_kogito-configuring">[con-persistence_kogito-configuring]</a></p>
</li>
</ul>
</div>
<div id="con-jobs-service_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} Jobs Service</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Jobs Service for scheduling Business Process Model and Notation (BPMN) process events that are configured to be executed at a specified time. These time-based events in a process model are known as <em>jobs</em>.</p>
</div>
<div class="paragraph">
<p>By default, {PRODUCT} services use an in-memory timer service to handle jobs defined in your BPMN process models. This default timer service does not cover long time intervals and is only suitable for short delays defined in the process. For advanced use cases where time intervals can be days or weeks or when additional event handling options are required, you can configure your {PRODUCT} project to use the {PRODUCT} Jobs Service as an external timer service.</p>
</div>
<div class="paragraph">
<p>The Jobs Service does not execute a job, but triggers a callback that might be an HTTP request on an endpoint specified for the job request or any other configured callback. The Jobs Service receives requests for job scheduling and then sends a request at the time specified on the job request.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/configuration/jobs-service-architecture_enterprise.png" alt="Diagram of the Jobs Service architecture">
</div>
<div class="title">Figure 282. Jobs Service architecture</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The {PRODUCT} Jobs Service currently supports only HTTP <code>POST</code> requests that are sent to an endpoint specified on the job-scheduling request. The HTTP callback information must be specified in the job-scheduling request.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main goal of the Jobs Service is to work with only active jobs. The Jobs Service tracks only the jobs that are scheduled and that need to be executed. When a job reaches a final state, the job is removed from the Jobs Service. All job information and transition states are sent to the {PRODUCT} Data Index Service where they can be indexed and made available for GraphQL queries.</p>
</div>
<div class="paragraph">
<p>The Jobs Service implementation is based on non-blocking APIs and <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a> on top of Quarkus, which provides effective throughput and resource utilization. The scheduling engine is implemented on top of <a href="https://vertx.io/">Vert.x</a> and the external requests are built using a non-blocking HTTP client based on Vert.x.</p>
</div>
<div class="paragraph">
<p>=== Supported job states in the {PRODUCT} Jobs Service</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Jobs Service uses an internal state control mechanism to manage the job scheduling lifecycle using the following supported job states:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Scheduled</strong></p>
</li>
<li>
<p><strong>Executed</strong></p>
</li>
<li>
<p><strong>Canceled</strong></p>
</li>
<li>
<p><strong>Retry</strong></p>
</li>
<li>
<p><strong>Error</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Jobs Service workflow through these states is illustrated in the following diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/configuration/jobs-service-state-control_enterprise.png" alt="Diagram of Jobs Service states">
</div>
<div class="title">Figure 283. Jobs Service state control workflow</div>
</div>
<div class="paragraph">
<p>=== Supported job types in the {PRODUCT} Jobs Service</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Jobs Service supports the following job types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Time scheduled</strong>: A job that is scheduled at a specified time and executed only once when that point in time is reached. The time must be specified on the job scheduling request and must be in the future.</p>
</li>
<li>
<p><strong>Periodic scheduled</strong>: A job that is scheduled at a specified time and executed after a specified interval, and then executed repeatedly over a specified period of time until a limit of executions is reached. The execution limit and interval must be specified in the job-scheduling request.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Supported configuration properties in the {PRODUCT} Jobs Service</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Jobs Service supports the following configuration properties. You can set these properties either using the <code>-D</code> prefix during Jobs Service start-up or in the <code>src/main/resources/application.properties</code> file of the Jobs Service project.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 97. Supported configuration properties in Jobs Service</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 40%;">
<col style="width: 15%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.persistence</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the persistence mechanism used by the Jobs Service.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>in-memory</code>, <code>infinispan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>in-memory</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.backoffRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the retry back-off time in milliseconds between job execution attempts, in case the execution fails</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.maxIntervalLimitToRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the maximum interval in milliseconds when retrying to execute jobs, in case the execution fails</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the Kafka bootstrap server address with the port used to publish events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost:9092</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name of the Kafka topic where the events are published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito-jobs-events</code></p></td>
</tr>
</tbody>
</table>
<div id="proc-jobs-service-using_kogito-developing-decision-services" class="paragraph">
<p>=== Using the {PRODUCT} Jobs Service as a timer service</p>
</div>
<div class="paragraph _abstract">
<p>By default, {PRODUCT} services use an in-memory timer service to handle time-based events (jobs) defined in your Business Process Model and Notation (BPMN) process models. This default timer service does not cover long time intervals and is only suitable for short delays defined in the process.</p>
</div>
<div class="paragraph">
<p>For advanced use cases where time intervals can be days or weeks or when additional event handling options are required, you can configure your {PRODUCT} project to use the {PRODUCT} Jobs Service as an external timer service. Whenever you need to schedule a timer as part of process instance, the timer is scheduled in the Jobs Service and the Jobs Service calls back to the {PRODUCT} service upon timer expiration.</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Jobs Service also supports Infinispan persistence that you can enable when you run the Jobs Service so that job data is preserved across application restarts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/jobs-service/"><code>jobs-service</code></a> artifacts page, select the latest release of the Jobs Service, and download the <code>jobs-service-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>jobs-service-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Jobs Service with Infinispan persistence enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Jobs Service with Infinispan persistence enabled</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -Dkogito.job-service.persistence=infinispan  \
    -jar jobs-service-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Infinispan persistence enables the job data to be preserved across application restarts. If you do not use Infinispan persistence, the Jobs Service uses the default in-memory storage and all job information is lost between application restarts.</p>
</div>
<div class="paragraph">
<p>To change the logging level of the Jobs Service, such as for debugging, you can specify the following start-up properties:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Jobs Service logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -jar jobs-service-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your {PRODUCT} project, add the following dependency to the <code>pom.xml</code> file to enable the Jobs Service add-on:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;jobs-management-quarkus-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kogito&lt;/groupId&gt;
  &lt;artifactId&gt;jobs-management-springboot-addon&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your {PRODUCT} project, add the following properties to the <code>src/main/resources/application.properties</code> to define the locations of the Jobs Service and the callback to be used when the timer expires:</p>
<div class="listingblock">
<div class="title">Configure {PRODUCT} service properties for Jobs Service</div>
<div class="content">
<pre class="highlight"><code>kogito.jobs-service.url=http://localhost:8085
kogito.service.url=http://localhost:8080</code></pre>
</div>
</div>
</li>
<li>
<p>In a command terminal, navigate to your {PRODUCT} project and run the project using your preferred run mode, such as development mode:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the Jobs Service and your {PRODUCT} project both configured and running, the Jobs Service can receive any job-scheduling requests to function as the external timer service.</p>
</div>
<div class="paragraph">
<p>By default, the implementation of the Jobs Service uses the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An implementation of the <code>org.kie.kogito.jobs.JobsService</code> interface that is used by the service to schedule jobs</p>
</li>
<li>
<p>A REST endpoint registered at the path <code>/management/jobs</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the default REST clients used by the Jobs Service add-on do not meet your needs, you can configure custom REST clients using the relevant service implementors. The REST client depends on the application type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On Quarkus, the Jobs Service uses a Vert.x web client: <code>io.vertx.ext.web.client.WebClient</code></p>
</li>
<li>
<p>On Spring Boot, the Jobs Service uses a rest template: <code>org.springframework.web.client.RestTemplate</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In both cases, you produce an instance of the client to enable detailed setup of the client.</p>
</div>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to enabling the Jobs Service explicitly for {PRODUCT} services, you can use the {PRODUCT} Operator to install the Jobs Service custom resource for the service deployment on OpenShift. For more information about installing the Jobs Service with the {PRODUCT} Operator, see {URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-operator-with-jobs-service_kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>].
</td>
</tr>
</table>
</div>
<div id="proc-jobs-service-persistence_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Infinispan persistence in the {PRODUCT} Jobs Service</p>
</div>
<div class="paragraph _abstract">
<p>The {PRODUCT} Jobs Service supports the following persistence mechanisms for job data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>In-memory persistence</strong>: (Default) Job data is persisted with the Jobs Service in-memory storage during the Jobs Service runtime. If the Jobs Service is restarted, all job information is lost. If no other persistence configuration is set, the Jobs Service uses this persistence mechanism.</p>
</li>
<li>
<p><strong>Infinispan persistence</strong>: Job data is persisted using Infinispan storage so that the data is preserved across application restarts. If the Jobs Service is restarted, the service continues to process any previously scheduled jobs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can enable Infinispan persistence in the {PRODUCT} Jobs Service during application start-up and in the Jobs Service <code>application.properties</code> file.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Run the Jobs Service with the property <code>-Dkogito.job-service.persistence=infinispan</code>:</p>
</div>
<div class="listingblock">
<div class="title">Enabling Infinispan persistence during Jobs Service start-up</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -Dkogito.job-service.persistence=infinispan  \
    -jar jobs-service-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can add the same property to the <code>src/main/resources/application.properties</code> file in the Jobs Service project.</p>
</div>
<div class="paragraph">
<p>For more information about Infinispan configuration with Quarkus applications, see <a href="https://quarkus.io/guides/infinispan-client">Infinispan client</a> in the Quarkus documentation.</p>
</div>
<div id="proc-jobs-service-messaging_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kafka messaging in the {PRODUCT} Jobs Service</p>
</div>
<div class="paragraph _abstract">
<p>The {PRODUCT} Jobs Service supports Apache Kafka messaging to publish events for each job state transition to a defined Kafka topic. Any application can subscribe to this Kafka topic to receive information about jobs and job state transitions. For example, the {PRODUCT} Data Index Service is subscribed to the Jobs Service Kafka topic so that if you configure and run the Jobs Service, the Data Index Service can begin indexing jobs with their current state.</p>
</div>
<div class="paragraph">
<p>You can enable Kafka messaging in the {PRODUCT} Jobs Service during application start-up and in the Jobs Service <code>application.properties</code> file.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <code>src/main/resources/application.properties</code> file in the Jobs Service project, add the following properties to identify the Kafka bootstrap server with the port used to publish events and the Kafka topic where the events are published:</p>
<div class="listingblock">
<div class="title">Defining Kafka server and topic in Jobs Service <code>application.properties</code></div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers=<em>SERVER_ADDRESS</em>
mp.messaging.outgoing.kogito-job-service-job-status-events.topic=<em>TOPIC_NAME</em></code></pre>
</div>
</div>
</li>
<li>
<p>Run the Jobs Service with the property <code>-Dquarkus.profile=events-support</code>:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Enabling Kafka messaging during Jobs Service start-up</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -Dquarkus.profile=events-support  \
    -jar jobs-service-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can add the environment variable <code>QUARKUS_PROFILE=events-support</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div id="proc-jobs-service-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling {PRODUCT} Jobs Service security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based {PRODUCT} services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the {PRODUCT} Jobs Service to enable security using bearer token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/kiegroup/kogito-apps/tree/master/jobs-service">{PRODUCT} Jobs Service</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/kiegroup/kogito-apps/tree/master/jobs-service">{PRODUCT} Jobs Service</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the {PRODUCT} Jobs Service repository and enter the following command to run the application with the required security properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Jobs Service with security properties</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev  -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jobs Service contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Jobs Service project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code>%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-jobs-service
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.http.auth.policy.role-policy1.roles-allowed=confidential
%keycloak.quarkus.http.auth.permission.roles1.paths=/*
%keycloak.quarkus.http.auth.permission.roles1.policy=role-policy1</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This example configuration enables only users with role <code>confidential</code> to access any endpoint.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop and restart the {PRODUCT} Jobs Service to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved directive in configuration/chap-kogito-configuring.adoc - include::{asciidoc-dir}/bpmn/chap-kogito-developing-process-services.adoc[tags=con-bpmn-process-management-addon]</p>
</div>
<div id="con-trusty-service_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} Trusty Service and Explainability Service</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} provides a Trusty Service that stores all {PRODUCT} tracing events related to decisions made in {PRODUCT} services. As an aid to the Trusty Service workflow for storing tracing events, {PRODUCT} also provides a supplemental Explainability Service that provides an explanation for the decisions made in {PRODUCT} services.</p>
</div>
<div class="paragraph">
<p>The Trusty Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from {PRODUCT} services, and then processes the tracing events and stores the data, including any explainability results from the Explainability Service, in the Infinispan persistence store. The Explainability Service likewise uses Apache Kafka messaging to consume CloudEvents messages from the Trusty Service, and then applies explainability algorithms. Some algorithms require the Explainability Service to interact with the {PRODUCT} service that evaluated the decision. This communication is performed with HTTP <code>POST</code> requests.</p>
</div>
<div class="paragraph">
<p>The Trusty Service and Explainability Service are at the core of the TrustyAI metrics monitoring initiative in {PRODUCT}.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/configuration/trusty-architecture_enterprise.png" alt="Diagram of an example Kogito service using Trusty Service">
</div>
<div class="title">Figure 284. Trusty Service and Explainability Service architecture in an example {PRODUCT} service</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} Trusty Service has the following key attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Focus on decisions</p>
</li>
<li>
<p>Flexible data structure</p>
</li>
<li>
<p>Distributable and cloud-ready format</p>
</li>
<li>
<p>Infinispan-based persistence support</p>
</li>
<li>
<p>Message-based communication with {PRODUCT} runtime (Apache Kafka, cloud events )</p>
</li>
<li>
<p>Integration with the Explainability Service to retrieve advanced analysis for the decisions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The {PRODUCT} Trusty Service and Explainability Service are Quarkus applications, based on <a href="https://vertx.io/">Vert.x</a> with <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a>. Tracing data from the Trusty Service is parsed and pushed into the <strong>Decisions</strong> cache for each decision made in a {PRODUCT} service. Each record contains information about all decision inputs, outputs, and errors, if any.</p>
</div>
<div class="paragraph">
<p>The Trusty Service storage is provided by <a href="https://infinispan.org/">Infinispan</a>. Communication between the Trusty Service and Infinispan is handled through a protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema and generated marshallers.</p>
</div>
<div class="paragraph">
<p>After the tracing event is analyzed and stored, the Trusty Service exposes the data with a dedicated API.</p>
</div>
<div class="paragraph">
<p>For information about using the {PRODUCT} Trusty Service and Explainability Service with the {PRODUCT} Operator, see {URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-operator-with-trusty-service_kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>].</p>
</div>
<div class="paragraph">
<p>For example {PRODUCT} services that use the Trusty Service and Explainability Service, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/dmn-tracing-quarkus"><code>dmn-tracing-quarkus</code></a>: A DMN decision service on Quarkus that uses the <code>tracing-decision-quarkus-addon</code> add-on to generate tracing events that the {PRODUCT} Trusty Service and Explainability Service can consume and expose.</p>
</li>
<li>
<p><a href="https://github.com/kiegroup/kogito-examples/tree/stable/trusty-demonstration"><code>trusty-demonstration</code></a>: A tutorial for deploying the <code>dmn-tracing-quarkus</code> example application on Kubernetes as a demonstration of {PRODUCT} Trusty Service and Explainability Service capabilities in a cloud environment.</p>
</li>
</ul>
</div>
<div id="proc-trusty-service-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling {PRODUCT} Trusty Service security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based {PRODUCT} services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the {PRODUCT} Trusty Service to enable security using token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/kiegroup/kogito-apps/tree/master/trusty">{PRODUCT} Trusty Service</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/kiegroup/kogito-apps/tree/master/trusty">{PRODUCT} Trusty Service</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the {PRODUCT} Trusty Service repository and enter the following command to run the application with the required security properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the trusty Service with security properties</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {PRODUCT} Trusty Service contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Trusty Service project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-service
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=service

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop and restart the {PRODUCT} Trusty Service to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="ref-kogito-glossary_kogito-developing-decision-services" class="paragraph">
<p>== {PRODUCT} glossary of terms</p>
</div>
<div class="paragraph _abstract">
<p>This glossary defines terms, concepts, or components that are referenced frequently in {PRODUCT} documentation or that have a unique meaning or function in {PRODUCT}.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">BPMN model</dt>
<dd>
<p>A definition of a business process workflow based on the <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation (BPMN) specification</a>. BPMN is a standard established by the Object Management Group (OMG) for describing and modeling business processes. BPMN defines an XML schema that enables BPMN models to be shared between BPMN-compliant platforms and across organizations so that business analysts and business process developers can collaborate in designing and implementing BPMN process services. The BPMN standard is similar to and can be used together with the Decision Model and Notation (DMN) standard for designing and modeling business decisions.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_PROCESS_SERVICES}#chap-kogito-developing-process-services[<em>{PROCESS_SERVICES}</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">business domain API</dt>
<dd>
<p>An API that your business develops and implements within business applications that contain {PRODUCT} services.</p>
</dd>
<dt class="hdlist1">business models</dt>
<dd>
<p>The collection of BPMN process models, DMN decision models, DRL rules, XLS decision tables, and any other assets that define the business logic for a {PRODUCT} service.</p>
</dd>
<dt class="hdlist1">CloudEvents format</dt>
<dd>
<p>A specification for describing event data in a common way. {PRODUCT} runtime events for messages, processes, tasks, and other application activities are published in <a href="https://cloudevents.io/">CloudEvents</a> format so that they can be consumed efficiently by other entities, such as the {PRODUCT} Data Index Service.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-kogito-runtime-events_kogito-configuring[<em>{PRODUCT} runtime events</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{PRODUCT} Data Index Service</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">decision table</dt>
<dd>
<p>A set of business rules defined in a tabular format. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DECISION_SERVICES}#con-decision-tables_kogito-decision-tables[<em>Designing a decision service using spreadsheet decision tables</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">development mode</dt>
<dd>
<p>A project build option that provides a fast feedback loop from code changes to a running system using hot reload. Development mode also enables debugging tools such as Swagger in {PRODUCT} runtime services.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CREATING_RUNNING}#proc-kogito-running-app_kogito-creating-running[<em>Running a {PRODUCT} service</em>]</p>
</li>
<li>
<p><a href="https://quarkus.io/guides/maven-tooling"><em>Quarkus - Building applications with Maven</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DRL rule</dt>
<dd>
<p>A definition of a business rule in Drools Rule Language (DRL) format. DRL is a notation established by the <a href="https://www.drools.org/">Drools</a> open source business automation project for defining and describing business rules.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DECISION_SERVICES}#con-drl_kogito-drl-rules[<em>Designing a decision service using DRL rules</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DRL rule unit</dt>
<dd>
<p>A module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DECISION_SERVICES}#con-drl-rule-units_kogito-drl-rules[<em>Rule units in DRL</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DMN model</dt>
<dd>
<p>A definition of a business decision flow based on the <a href="https://www.omg.org/spec/DMN">Decision Model and Notation (DMN) specification</a>. DMN is a standard established by the Object Management Group (OMG) for describing and modeling operational decisions. DMN defines an XML schema that enables DMN models to be shared between DMN-compliant platforms and across organizations so that business analysts and business rules developers can collaborate in designing and implementing DMN decision services. The DMN standard is similar to and can be used together with the Business Process Model and Notation (BPMN) standard for designing and modeling business processes.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DECISION_SERVICES}#con-dmn_kogito-dmn-models[<em>Designing a decision service using DMN models</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">event listener</dt>
<dd>
<p>A procedure or function in a program that reacts to a specified event, such as a completed node in a process or an executed decision.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-event-listeners-registering_kogito-configuring[<em>Registering event listeners</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">intelligent application</dt>
<dd>
<p>An optimized, integrated solution that uses {PRODUCT} services to implement business-domain knowledge.</p>
</dd>
<dt class="hdlist1">{PRODUCT} Audit Investigation Console</dt>
<dd>
<p>A user interface for monitoring and investigating Decision Model and Notation (DMN) model executions in {PRODUCT}.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DECISION_SERVICES}#con-audit-console_kogito-dmn-models[<em>{PRODUCT} Audit Investigation Console</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} CLI</dt>
<dd>
<p>A command-line interface (CLI) that enables you to interact with the {PRODUCT} Operator for deployment tasks. The {PRODUCT} CLI also enables you to deploy {PRODUCT} services from source instead of relying on custom resources and YAML files.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DEPLOYING_ON_OPENSHIFT}#proc-kogito-deploying-on-ocp-kogito-cli_kogito-deploying-on-openshift[<em>Deploying {PRODUCT} on {OPENSHIFT} using the {PRODUCT} CLI</em>]</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">{PRODUCT} Data Index Service</dt>
<dd>
<p>A dedicated service in {PRODUCT} that stores all {PRODUCT} events related to processes, tasks, and domain data. The Data Index Service uses Apache Kafka messaging to consume CloudEvents messages from {PRODUCT} services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all {PRODUCT} search, insight, and management capabilities.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{PRODUCT} Data Index Service</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} domain-specific service</dt>
<dd>
<p>A business automation service for your business domain that you create using {PRODUCT}. You define the logic of this service using BPMN process models, DMN decision models, or other business models, and any other supported runtime configurations. In {PRODUCT} documentation, the general term for <em>{PRODUCT} services</em> that you create refers to this type of service.</p>
</dd>
<dt class="hdlist1">{PRODUCT} Explainability Service</dt>
<dd>
<p>A dedicated service in {PRODUCT} that provides an explanation for the decisions made in {PRODUCT} services, in conjunction with the <em>{PRODUCT} Trusty Service</em>.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[<em>{PRODUCT} Trusty Service and Explainability Service</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} Jobs Service</dt>
<dd>
<p>A dedicated service in {PRODUCT} for scheduling BPMN process events that are configured to be executed at a specified time. These time-based events in a process model are known as <em>jobs</em>. The Jobs Service does not execute a job, but triggers a callback that might be an HTTP request on a given endpoint specified for the job request or any other configured callback. The Jobs Service receives requests for job scheduling and then sends a request at the time specified on the job request.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-jobs-service_kogito-configuring[<em>{PRODUCT} Jobs Service</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} Management Console</dt>
<dd>
<p>A user interface for viewing the state of all available {PRODUCT} services and managing process instances.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_PROCESS_SERVICES}#con-management-console_kogito-developing-process-services[<em>{PRODUCT} Management Console</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} Operator</dt>
<dd>
<p>An operator that deploys {PRODUCT} services and manages the required {PRODUCT} infrastructure services. The {PRODUCT} Operator is based on the <a href="https://sdk.operatorframework.io/">Operator SDK</a> and automates many of the deployment steps for you.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DEPLOYING_ON_OPENSHIFT}#con-kogito-on-ocp_kogito-deploying-on-openshift[<em>{PRODUCT} on {OPENSHIFT}</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} runtime event</dt>
<dd>
<p>A record of a significant change of state in the application domain at a point in time. {PRODUCT} emits runtime events as a result of successfully executed requests, or <em>units of work</em>, in a process instance or task instance in a process. {PRODUCT} can use these events to notify third parties about changes to the BPMN process instance and its data.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-kogito-runtime-events_kogito-configuring[<em>{PRODUCT} runtime events</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} runtime persistence</dt>
<dd>
<p>An optional capability for preserving {PRODUCT} process data in your services across application restarts. {PRODUCT} persistence is based on <a href="https://infinispan.org/">Infinispan</a> and enables you to configure key-value storage definitions to persist data, such as active process nodes and process instance variables.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-persistence_kogito-configuring[<em>Persistence in {PRODUCT}</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} supporting services</dt>
<dd>
<p>The collection of middleware infrastructure services and other dedicated services that help you build additional functionality in the {PRODUCT} domain-specific services that you develop. Key middleware infrastructure services in {PRODUCT} include Infinispan or MongoDB persistence and Apache Kafka reactive messaging. Dedicated services provided by {PRODUCT} include the {PRODUCT} Data Index Service, Jobs Service, Trusty Service, and Explainability Service.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{PRODUCT} Data Index Service</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-jobs-service_kogito-configuring[<em>{PRODUCT} Jobs Service</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[<em>{PRODUCT} Trusty Service and Explainability Service</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-infinispan-persistence-enabling_kogito-configuring[<em>Enabling Infinispan persistence for {PRODUCT} services</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-mongodb-persistence-enabling_kogito-configuring[<em>Enabling MongoDB persistence for {PRODUCT} services</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-messaging-enabling_kogito-configuring[<em>Enabling messaging for {PRODUCT} services</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} Task Console</dt>
<dd>
<p>A user interface for viewing and interacting with user tasks in {PRODUCT} process services.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_PROCESS_SERVICES}#con-task-console_kogito-developing-process-services[<em>{PRODUCT} Task Console</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">{PRODUCT} Trusty Service</dt>
<dd>
<p>A dedicated service in {PRODUCT} for storing all {PRODUCT} tracing events related to decisions made in {PRODUCT} services. The <em>{PRODUCT} Explainability Service</em> is typically used in conjunction with this service.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[<em>{PRODUCT} Trusty Service and Explainability Service</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">message event</dt>
<dd>
<p>A specified point in a business process where a defined message is used as the input (received) or output (sent) as a result of the process execution. For example, a message event might be an email sent to a specified user after a task is complete.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-kogito-runtime-events_kogito-configuring[<em>{PRODUCT} runtime events</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-messaging-enabling_kogito-configuring[<em>Enabling messaging for {PRODUCT} services</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">MicroProfile Reactive Messaging</dt>
<dd>
<p>A specification for sending and receiving messages within and between microservices using message brokers. {PRODUCT} supports <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> for messaging in {PRODUCT} services, such as message events used as either input or output of business process execution.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-messaging-enabling_kogito-configuring[<em>Enabling messaging for {PRODUCT} services</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">middleware infrastructure services</dt>
<dd>
<p>The collection of supplemental services in {PRODUCT} that provide capabilities such as persistence, messaging, and security. Key middleware infrastructure services in {PRODUCT} include Infinispan persistence and Apache Kafka reactive messaging.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-infinispan-persistence-enabling_kogito-configuring[<em>Enabling Infinispan persistence for {PRODUCT} services</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-messaging-enabling_kogito-configuring[<em>Enabling messaging for {PRODUCT} services</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">process definition</dt>
<dd>
<p>A model that defines the components, workflow, and functionality for a business process, such as a BPMN model.</p>
</dd>
<dt class="hdlist1">process instance</dt>
<dd>
<p>An occurrence of a pending, running, or completed business process, based on the process definition.</p>
</dd>
<dt class="hdlist1">PROTO file (<code>.proto</code>)</dt>
<dd>
<p>A data library used for marshalling Java objects in protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) format. {PRODUCT} runtime persistence and communication with Infinispan are handled through a protobuf schema and generated marshallers.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-persistence_kogito-configuring[<em>Persistence in {PRODUCT}</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">task lifecycle</dt>
<dd>
<p>A mechanism that moves a user task or custom task (work item) across various phases, such as <strong>Active</strong> &#8594; <strong>Claim</strong> &#8594; <strong>Complete</strong>. {PRODUCT} provides standard lifecycle phases for user tasks and also supports custom lifecycles or lifecycle phases.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_PROCESS_SERVICES}#con-task-lifecycle_kogito-developing-process-services[<em>Task lifecycle in {PRODUCT} processes</em>]</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">unit of work</dt>
<dd>
<p>A component in {PRODUCT} that serves as the basis for {PRODUCT} runtime execution. Units of work capture all steps in a process and are used internally to move a process instance from one state to the next state. After all possible steps in a process are successfully executed, the final state is sent to the {PRODUCT} runtime as a runtime event. {PRODUCT} can then use these events to notify third parties about changes to the BPMN process instance and its data.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-kogito-runtime-events_kogito-configuring[<em>{PRODUCT} runtime events</em>]</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="chap-kogito-release-notes" class="paragraph">
<p>= Release notes for {PRODUCT} {PRODUCT_VERSION}
:parent-context: kogito-developing-decision-services
:context: kogito-release-notes</p>
</div>
<div class="paragraph _abstract">
<p>These release notes highlight some of the new features, fixed issues, and known issues in {PRODUCT} {PRODUCT_VERSION}. These release notes are not comprehensive.</p>
</div>
<div class="paragraph">
<p>For the complete list of new features, fixed issues, and known issues in {PRODUCT} {PRODUCT_VERSION}, see the following release notes pages in Atlassian Jira. Each {PRODUCT} release includes one or more {PRODUCT} tooling releases as shown in this list.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://issues.redhat.com/secure/ReleaseNote.jspa?projectId=12322421&amp;version=12342523">{PRODUCT} {COMMUNITY_VERSION}</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="https://issues.redhat.com/secure/ReleaseNote.jspa?projectId=12322421&amp;version=12346967">{PRODUCT} tooling 0.7.1</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>{PRODUCT} is currently in early stages of development. {PRODUCT} releases contain features and APIs that might not be fully tested and that might change in future versions. Users are discouraged from using {PRODUCT} software in production or for business-critical workloads.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="ref-kogito-rn-key-features_kogito-developing-decision-services" class="paragraph">
<p>== Summary of key features in {PRODUCT}</p>
</div>
<div class="paragraph _abstract">
<p>{PRODUCT} offers the following key features. For more information about these and other features in {PRODUCT}, see the {PRODUCT} documentation links where provided. Not all {PRODUCT} features are fully documented.</p>
</div>
<div class="paragraph">
<p>=== {PRODUCT} domain-specific services</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lightweight cloud-native services based on high-level business models, such as processes and decisions</p>
</li>
<li>
<p>Layering on <a href="https://quarkus.io/">Quarkus</a> or <a href="https://spring.io/projects/spring-boot">Spring Boot</a> to enable developers to run {PRODUCT} on their preferred cloud-native application development stack</p>
</li>
<li>
<p>Automated decision-making capabilities based on rule units to run within defined business constraints</p>
</li>
<li>
<p>Automatically generated business domain APIs using domain-specific data models</p>
</li>
<li>
<p>Standards-based resources for {PRODUCT} services, such as <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation (BPMN) 2.0</a> for processes, <a href="https://www.omg.org/spec/DMN">Decision Model and Notation (DMN)</a> for decisions, and <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> and <a href="https://cloudevents.io/">CloudEvents</a> for messaging</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>]</p>
</li>
<li>
<p>{URL_DECISION_SERVICES}#collection-kogito-developing-decision-services[<em>{DECISION_SERVICES}</em>]</p>
</li>
<li>
<p>{URL_PROCESS_SERVICES}#chap-kogito-developing-process-services[<em>{PROCESS_SERVICES}</em>]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== {PRODUCT} supporting services and consoles</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data Index Service for indexing, storing, and querying your {PRODUCT} service data</p>
</li>
<li>
<p>Jobs Service for scheduling process events over extended periods of time</p>
</li>
<li>
<p>Trusty Service for storing all {PRODUCT} tracing events related to decisions made in {PRODUCT} services.</p>
</li>
<li>
<p>Explainability Service that provides an explanation for the decisions made in {PRODUCT} services, in conjunction with the Trusty Service.</p>
</li>
<li>
<p>NoSQL key-value persistence store based on <a href="https://infinispan.org/">Infinispan</a> to enable elastic persistence scalability</p>
</li>
<li>
<p>JSON-like document-based persistence with <a href="https://www.mongodb.com/">MongoDB</a> as an alternative to using Infinispan for {PRODUCT} runtime persistence</p>
</li>
<li>
<p>Messaging capabilities based on <a href="https://kafka.apache.org/">Apache Kafka</a> to enable messages as either input or output of business process execution</p>
</li>
<li>
<p>Business monitoring capabilities based on <a href="https://prometheus.io/">Prometheus</a> for generated metrics</p>
</li>
<li>
<p>Process management add-on to enable basic REST operations for managing process instances</p>
</li>
<li>
<p>Management Console user interface for viewing the state of all available {PRODUCT} services and managing process instances</p>
</li>
<li>
<p>Task Console user interface for viewing and interacting with user tasks in {PRODUCT} process services.</p>
</li>
<li>
<p>Audit Investigation Console user interface for monitoring and investigating Decision Model and Notation (DMN) model executions in {PRODUCT}.</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-data-index-service_kogito-configuring[<em>{PRODUCT} Data Index Service</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-jobs-service_kogito-configuring[<em>{PRODUCT} Jobs Service</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#con-trusty-service_kogito-configuring[<em>{PRODUCT} Trusty Service and Explainability Service</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-infinispan-persistence-enabling_kogito-configuring[<em>Enabling Infinispan persistence for {PRODUCT} services</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-mongodb-persistence-enabling_kogito-configuring[<em>Enabling MongoDB persistence for {PRODUCT} services</em>]</p>
</li>
<li>
<p>{URL_CONFIGURING_KOGITO}#proc-messaging-enabling_kogito-configuring[<em>Enabling messaging for {PRODUCT} services</em>]</p>
</li>
<li>
<p>{URL_PROCESS_SERVICES}#con-management-console_kogito-developing-process-services[<em>{PRODUCT} Management Console</em>]</p>
</li>
<li>
<p>{URL_PROCESS_SERVICES}#con-task-console_kogito-developing-process-services[<em>{PRODUCT} Task Console</em>]</p>
</li>
<li>
<p>{URL_DECISION_SERVICES}#con-audit-console_kogito-dmn-models[<em>{PRODUCT} Audit Investigation Console</em>]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== {PRODUCT} developer tooling</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code generation based on the process models and decision models that developers create</p>
</li>
<li>
<p>Local live (hot reload) coding on Quarkus for {PRODUCT} domain-specific services</p>
</li>
<li>
<p>{PRODUCT} BPMN and DMN modelers offered through the {PRODUCT} Business Modeler Hub:</p>
<div class="ulist">
<ul>
<li>
<p>{PRODUCT} VSCode extension (recommended) for modeling in Visual Studio Code</p>
</li>
<li>
<p>{PRODUCT} GitHub Chrome extension for viewing graphical business models directly in GitHub, including model differences in GitHub pull requests</p>
</li>
<li>
<p>Business Modeler desktop application for local modeling</p>
</li>
<li>
<p>Business Modeler online viewer for online modeling</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_CREATING_RUNNING}#chap-kogito-creating-running[<em>{CREATING_RUNNING}</em>]</p>
</li>
<li>
<p>{URL_CREATING_RUNNING}#con-kogito-modelers_kogito-creating-running[<em>{PRODUCT} BPMN and DMN modelers</em>]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== {PRODUCT} deployment on {OPENSHIFT}</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Scalable and auto-provisioned infrastructure managed by the {PRODUCT} Operator</p>
</li>
<li>
<p>{PRODUCT} command-line interface (CLI) to interact with the {PRODUCT} Operator to deploy {PRODUCT} services on {OPENSHIFT}</p>
</li>
<li>
<p>Support for Source-to-Image (S2I) builds and binary builds for deploying {PRODUCT} services on {OPENSHIFT}</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>{URL_DEPLOYING_ON_OPENSHIFT}#chap-kogito-deploying-on-openshift[<em>{DEPLOYING_ON_OPENSHIFT}</em>]</p>
</li>
</ul>
</div>
<div id="ref-kogito-rn-new-features_kogito-developing-decision-services" class="paragraph">
<p>== New features in {PRODUCT} {PRODUCT_VERSION}</p>
</div>
<div class="paragraph _abstract">
<p>The following sections describe some of the new features or enhancements in {PRODUCT} {PRODUCT_VERSION}.</p>
</div>
<div class="paragraph">
<p>=== {PRODUCT} runtimes</p>
</div>
<div class="paragraph">
<p>====  Migration to Infinispan Server 11.0 for persistence</p>
</div>
<div class="paragraph">
<p>Starting this release, the {PRODUCT} runtime and supporting services, such as the {PRODUCT} Data Index Service and Jobs Service, have been updated to use <a href="https://infinispan.org/">Infinispan Server</a> 11.0 for data persistence.</p>
</div>
<div class="paragraph">
<p>To start using Infinispan Server 11.0 in your {PRODUCT} services, in the <code>pom.xml</code> file of each {PRODUCT} project, update the <code>&lt;kogito.version&gt;</code> property to <code>1.0</code> (the current {PRODUCT} version) and build your project as usual. This regenerates the protobuf files in the <code>target/classes/persistence</code> folder, which are shared between the {PRODUCT} runtime and the Data Index Service.</p>
</div>
<div class="paragraph">
<p>If your Infinispan cache indexing is manually configured in Infinispan and you encounter an error about Infinispan sort fields (<a href="https://issues.redhat.com/browse/ISPN-12203">ISPN-12203</a>), add the following configuration to your Infinispan cache as a workaround:</p>
</div>
<div class="listingblock">
<div class="title">Configuration to avoid sort field error in manually configured Infinispan cache</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;indexing&gt;
  &lt;property name="hibernate.search.index_uninverting_allowed"&gt;true&lt;/property&gt;
&lt;/indexing&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>==== {PRODUCT} Management Console enhancements</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Management Console includes the following key enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>New <em>Jobs Management</em> page</strong>: You can use this new page to view a list of available jobs, to filter jobs by status, and perform actions for individual jobs, such as view details, reschedule, or cancel. You can also select multiple jobs and perform bulk operations at the top of the page, such as canceling all selected jobs.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-management.png" alt="Image of Jobs Management page in Management Console">
</div>
<div class="title">Figure 285. Jobs Management page</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-management-bulk-cancel.png" alt="Image of Jobs Management cancel operation result in Management Console">
</div>
<div class="title">Figure 286. Cancel operation result</div>
</div>
</li>
<li>
<p><strong>New cancel operation in <em>Jobs</em> panel</strong>: In the <strong>Process Details</strong> page, the <strong>Jobs</strong> panel now provides a cancel operation for jobs in <strong>Scheduled</strong>, <strong>Retry</strong>, and <strong>Error</strong> state.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-jobs-panel-cancel.png" alt="Image of jobs cancel option in Management Console">
</div>
<div class="title">Figure 287. Cancel a job</div>
</div>
</li>
<li>
<p><strong>New job operations in <em>Timeline</em> page</strong>: In the <strong>Process Details</strong> page, the <strong>Timeline</strong> panel now provides options to perform job-related actions for nodes related to a job. You can select the clock icon to view the job details or select the kebab menu for additional job operations, such as <strong>Job Reschedule</strong> or <strong>Job Cancel</strong>, depending on the job status.</p>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-error-job-actions.png" alt="Image of job options for error node in timeline of Management Console">
</div>
<div class="title">Figure 288. Reschedule the job for a node in error state</div>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-management-console-node-active-job-actions.png" alt="Image of job options for active node in timeline of Management Console">
</div>
<div class="title">Figure 289. View job details for an active node</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about the {PRODUCT} Management Console, see {URL_PROCESS_SERVICES}#con-management-console_kogito-developing-process-services[<em>{PROCESS_SERVICES}</em>].</p>
</div>
<div class="paragraph">
<p>==== New {PRODUCT} Task Console</p>
</div>
<div class="paragraph">
<p>{PRODUCT} now provides a Task Console for viewing and interacting with user tasks in {PRODUCT} process services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="kogito/bpmn/kogito-task-console.png" alt="Image of Kogito Task Console">
</div>
<div class="title">Figure 290. {PRODUCT} Task Console</div>
</div>
<div class="paragraph">
<p>You can use the {PRODUCT} Task Console to view, filter, and sort assigned tasks, to view details for a selected task, or to move a selected task to the next phase of the task lifecycle.</p>
</div>
<div class="paragraph">
<p>For more information about the {PRODUCT} Task Console, see {URL_PROCESS_SERVICES}#con-task-console_kogito-developing-process-services[<em>{PROCESS_SERVICES}</em>].</p>
</div>
<div class="paragraph">
<p>==== Support for BPMN Compensation constructs</p>
</div>
<div class="paragraph">
<p>{PRODUCT} now supports BPMN Compensation constructs in process services. Compensation constructs provide BPMN processes with a more flexible and advanced flow control. When a process reaches a compensation intermediate node or compensation end node with an activity reference defined, the process executes a compensation boundary with a task attached to that activity reference. If no activity reference has been defined, all of the compensation boundary nodes are executed instead.</p>
</div>
<div class="paragraph">
<p>Compensation start nodes in subprocesses are currently not supported.</p>
</div>
<div class="paragraph">
<p>For more information about BPMN support in {PRODUCT}, see {URL_PROCESS_SERVICES}#ref-bpmn-support_kogito-developing-process-services[<em>{PROCESS_SERVICES}</em>].</p>
</div>
<div class="paragraph">
<p>=== {PRODUCT} Operator and CLI</p>
</div>
<div class="paragraph">
<p>==== Improved/new bla bla</p>
</div>
<div class="paragraph">
<p>Description</p>
</div>
<div class="paragraph">
<p>=== {PRODUCT} supporting services</p>
</div>
<div class="paragraph">
<p>==== New operator in Data Index Service GraphQL API</p>
</div>
<div class="paragraph">
<p>The {PRODUCT} Data Index Service GraphQL API now supports a <code>not</code> operator. This operator enables you to negate any single filter available for a specific GraphQL type. For example, a <code>UserTaskInstances</code> type contains an attribute named <code>excludedUsers</code> that is an array of Strings. In this example, to create a query where a specific user is not in this list, surround the usual filter for this attribute with a <code>not</code> operator, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example GraphQL query using <code>not</code> operator</div>
<div class="content">
<pre class="highlight"><code>UserTaskInstances( where: {  not: { excludedUsers: { contains : $actualOwner } } }</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about querying application data with the Data Index Service, see {URL_CONFIGURING_KOGITO}#proc-data-index-service-using_kogito-configuring[Using the {PRODUCT} Data Index Service to query application data].</p>
</div>
<div class="paragraph">
<p>=== {PRODUCT} tooling</p>
</div>
<div class="paragraph">
<p>==== Improved/new bla bla</p>
</div>
<div class="paragraph">
<p>Description</p>
</div>
<div id="ref-kogito-rn-fixed-issues_kogito-developing-decision-services" class="paragraph">
<p>== Fixed issues in {PRODUCT} {PRODUCT_VERSION}</p>
</div>
<div class="paragraph _abstract">
<p>The following list describes some of the fixed issues in {PRODUCT} {PRODUCT_VERSION}. For more information about each fixed issue, select the Atlassian Jira link provided.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start here</p>
</li>
</ul>
</div>
<div id="ref-kogito-rn-known-issues_kogito-developing-decision-services" class="paragraph">
<p>== Known issues in {PRODUCT} {PRODUCT_VERSION}</p>
</div>
<div class="paragraph _abstract">
<p>The following list describes some of the known issues in {PRODUCT} {PRODUCT_VERSION}. For more information about each known issue, select the Atlassian Jira link provided.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In some cases on Windows, users cannot extract the downloaded {PRODUCT} Business Modeler Hub or Business Modeler desktop application ZIP files using the standard Windows unzip functionality. Users must extract the files using a file extractor, such as 7-Zip. [<a href="https://issues.redhat.com/browse/KOGITO-1897">KOGITO-1897</a>]</p>
</li>
<li>
<p>In some cases on Windows, when users extract the downloaded {PRODUCT} Business Modeler Hub or Business Modeler desktop application ZIP files to a directory location with a long path, the application can fail to open or load indefinitely. Users must extract the files to a directory location with a shorter path. [<a href="https://issues.redhat.com/browse/KOGITO-1933">KOGITO-1933</a>]</p>
</li>
<li>
<p>In some cases, when Infinispan is running in an OpenShift instance deployed on Amazon Web Services and a configured Data Index Service instance is restarted, the {PRODUCT} Data Index Service stops running and the PROTO files are removed. [<a href="https://issues.redhat.com/browse/KOGITO-1497">KOGITO-1497</a>]</p>
</li>
<li>
<p>In the DMN boxed literal expression editor, when a user presses the <strong>Tab</strong> key within a FEEL expression, the FEEL auto-complete feature adds white space between characters instead of navigating out of the expression editor. [<a href="https://issues.redhat.com/browse/KOGITO-1581">KOGITO-1581</a>]</p>
</li>
<li>
<p>In some cases, the names of task nodes in a BPMN process diagram cannot be edited. [<a href="https://issues.redhat.com/browse/KOGITO-1267">KOGITO-1267</a>]</p>
</li>
<li>
<p>In a {PRODUCT} service where a DMN decision model is invoked in a BPMN process model, when a user interacts with the service through REST API requests, a <code>HashMap cannot be cast to <em>OBJECT</em></code> error is returned in the error log. [<a href="https://issues.redhat.com/browse/KOGITO-1332">KOGITO-1332</a>]</p>
</li>
<li>
<p>A {PRODUCT} project that uses the Jobs Service as a timer service fails to execute timer nodes when the project is built in native mode. [<a href="https://issues.redhat.com/browse/KOGITO-1179">KOGITO-1179</a>]</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-11-25 09:01:10 +0100
</div>
</div>
</body>
</html>