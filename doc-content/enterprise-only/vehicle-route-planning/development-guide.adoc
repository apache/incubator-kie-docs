[[development-guide]]
= OptaWeb Vehicle Routing development guide

GLUE


[[backend]]


GLUE:



//[[run-spring-boot-maven-plugin]]






=== Setting OptaWeb Vehicle Routing back end module configuration properties

There are several ways that you can set OptaWeb Vehicle Routing back end module configuration properties. The methods in this section are useful if you are running OptaWeb Vehicle Routing locally.

.Prerequisites
* The OptaWeb Vehicle Routing reference implementation has been downloaded and extracted. For information, see xref:download-ref-imp-proc_{context}[].

.Procedure
* Set configuration properties in the `application.properties` file:
. Change directory to the `{PRODUCT_INIT}-{PRODUCT_VERSION_LONG}-optaweb-vehicle-routing/src/main/resources` directory.
. Open the `application.properties` file in a text editor.
. Edit or add properties and then save the file.

* Use a command line argument when running the packaged application. In the following example, `<PROPERTY>` is the name of a property and `<VALUE>` is the value of that property:
+
[source]
----
java -jar optaweb-vehicle-routing-backend.jar --app.<PROPERTY>=<VALUE>
----
* Use an environment variable when running the application with `spring-boot:run`:
+
[source]
----
app_<PROPERTY>=<VALUE> ./mvnw spring-boot:run
----
NOTE: This method requires
https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-relaxed-binding[relaxed binding]
which only works if the property is defined using `@ConfigurationProperties`.


It is not possible to set properties by specifying `-D` when running the application using the Spring Boot Maven plugin (`./mvnw spring-boot:run -D<PROPERTY`).
Any system properties to be set by the plugin to the forked Java process in which the application runs must
be specified in the `pom.xml` file using the `systemPropertiesVariables` attribute. For information about this attribute, see
https://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/html/#run-example-system-properties[_Using System Properties_] on the Spring web site.

You can learn more about configuring a Spring Boot application on the
https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config[Spring Boot Externalized Configuration] page.

[TIP]
Use `src/main/resources/application-local.properties` to store your personal configuration without affecting the Git working tree.

//See the complete list of <<appendix-backend-config#backend-configuration-properties>>.

See also the complete list of
https://docs.spring.io/spring-boot/docs/current/reference/html/appendix-application-properties.html[common application properties]
available in Spring Boot.


[[frontend]]
= Working with the OptaWeb Vehicle Routing front end module

////
- PatternFly, Leaflet
- Npm, React, Redux, TypeScript, ESLint, Cypress, `ncu`
- Chrome, plugins
- Docker
////

The front end project was bootstrapped with https://create-react-app.dev/[Create React App].
Create React App provides a number of scripts and dependencies that help with development and with building the application for production.

.Prerequisites
* The OptaWeb Vehicle Routing reference implementation has been downloaded and extracted. For information, see xref:download-ref-imp-proc_{context}[].

.Procedure
. On Fedora, enter the following command to set up the development environment:
+
[source,shell]
----
sudo dnf install npm
----
+
See https://docs.npmjs.com/downloading-and-installing-node-js-and-npm[Downloading and installing Node.js and npm] for more information about installing npm.

. Change directory to the `{PRODUCT_INIT}-{PRODUCT_VERSION_LONG}-optaweb-vehicle-routing/sources/optaweb-vehicle-routing-backend` directory.
+
[source,shell]
----
cd optaweb-vehicle-routing-frontend
----
+
. Install `npm` dependencies:
+
[source,shell]
----
npm install
----
+
Unlike Maven, the `npm` package manager installs dependencies in `node_modules` under the project directory and does that only when you execute `npm install`.
Whenever the dependencies listed in `package.json` change, for example when you pull changes to the master branch, you must execute `npm install` before you run the development server.

. Enter the following command to run the development server:
+
[source,shell]
----
npm start
----

. If necessary, open `http://localhost:3000/` in a web browser.
+
By default, the `npm start` command attempts to open this URL in your default browser.

[TIP]
.Prevent `npm start` from launching your default browser
====
If you do not want the `npm start` command to open a new browser tab each time you run it, export the  `BROWSER=none` environment variable.

You can use `.env.local` file to make this preference permanent.
To do that, enter the following command:

[source,shell]
----
echo BROWSER=none >> .env.local
----
====
+
The browser refreshes the page whenever you make changes in the front end source code.
The development server process running in the terminal picks up the changes as well and prints compilation and lint errors to the console.

. Enter the following command to run tests.
+
[source]
----
`npm test`
----


. Optional: Change the value of the `REACT_APP_BACKEND_URL` environment variable to specify the location of the back end project when you execute  `npm start` or `npm run build`, for example:
+
[source]
----
REACT_APP_BACKEND_URL=http://10.0.0.123:8081
----
+
NOTE: Environment variables are hard coded inside the JavaScript bundle during the `npm` build process, so you must specify the back end location before you build and deploy the front end.

To learn more about the React environment variables, see https://create-react-app.dev/docs/adding-custom-environment-variables/[_Adding Custom Environment Variables_].

. To build the front end, enter one of the following commands:
+
[source]
----
./mvnw install
----
+
[source]
----
mvn install
----
