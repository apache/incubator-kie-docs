[[_defining_business_rules]]
= Defining Business Rules

The following chapter instructs you how to create business rules in {PRODUCT} using:

* The Guided Rule wizard
* The Guided Decision Table wizard

[float]
== Prerequisites

* Finished data object in {PRODUCT}. For further information, see <<_defining_a_data_model>>.

== Creating Guided Rules

To create a guided rule:

 . Log into Business Central. Click *Menu* -> *Projects*, then *process-app-start*.
<<<<<<< HEAD
 . Click *Create New Asset* -> *Guided Rule*, then enter:
=======
 . Click *Create new asset* -> *Guided Rule*, then enter:
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f

 * *Name*: `Validate Down Payment`
 * *Package*: `org.jboss.example`
+
Click *Ok*. The Guided Rule Editor opens.

<<<<<<< HEAD
. Click image:6176.png[] next to the *WHEN* label to open the *Add a condition to the rule...* window.
. Select *Property...* and click *Ok*.
. Click the *There is a Property* label, enter `prop` in the *Variable name* field, then click *Set*.
. Click image:6176.png[] next to the *WHEN* label to open the *Add a condition to the rule...* window.
. Select *Application...*, then click *Ok*.
. Click the *There is an Application* label and select *Any of (Or)* from the *Multiple field constraint* pull-down menu.
. Click the *There is an Application with: any of the following:* label, then select *downpayment* from the *Add a restriction on a field* pull-down menu.
.. Click *--- please choose ---*, then select *equal to*.
.. Click image:6191.png[], then click *Literal value*.
.. Enter `0`.
. Click the *There is an Application with: any of the following:* label, then select *downpayment* from the *Add a restriction on a field* pull-down menu.
.. Click *--- please choose ---*, then select *greater than or equal to*.
.. Click image:6191.png[], then click *Expression editor*.
.. From the *Choose...* menu, select *prop*.
.. From the *Choose...* menu, select *saleprice*.
. Click image:6176.png[] next to the *THEN* label. Select *Insert fact ValidationErrorDO*, then click *Ok*.
. Click the *Insert ValidationErrorDO* label, and select *error* from the *Add field* pull-down menu.
.. Click image:6191.png[], then click *Literal value*.
.. In the *error* field, enter: `Down payment cannot be 0, greater than, or equal to the property sale price.`.
. Click image:6176.png[] next to the *THEN* label and select *Add free form DRL*, then click *Ok*.
. Enter the following rule into the new _Add free form DRL..._ text box:
=======
. Click image:6176.png[] next to the *WHEN* label to open the *Add a condition to the rule* window. Then, select *Property* and click *Ok*.
. Click the *There is a Property* label.
. Enter `prop` in the *Variable name* field and click *Set*.
. Click image:6176.png[], select *Application*, then click *Ok*.
. Click the *There is an Application* label, then from the *Add a restriction on a field* select *downpayment*.
.. Click *--- please choose ---*, then select *equal to*.
.. Click image:6191.png[], then click *Literal value*.
.. Enter `0`.
. Click the *There is an Application* label, then from the *Add a restriction on a field* select *downpayment*.
.. Click *--- please choose ---*, then select *greater than or equal to*.
.. Click image:6191.png[], then click *Expression editor*.
.. From the *Choose...* menu, select *prop*.
.. From the *Choose...* menu, select *salesprice*.
. Click image:6176.png[] next to the *THEN* label. select *Insert fact ValidationErrorDO*, and click *Ok*.
. Click the *Insert ValidationErrorDO* label and select *error* from the *Add field* pull-down menu.
.. Click image:6191.png[], then click *Literal value*.
.. In the *error* field, enter: `Down payment cannot be 0, greater than, or equal to the property sale price.`.
. Click image:6176.png[] next to the *THEN* label. Select *Add free form DRL* and click *Ok*.
. Enter the following in the _Add free form DRL.._ text box:
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
+
[source,java]
----
System.out.println("Executed Rule: " + drools.getRule().getName() );
----
<<<<<<< HEAD
. Click *(show options...)*, then click image:6176.png[] next to the *Attributes* label.
. Select *ruleflow-group* from the *Attribute* pull-down menu.
. Enter *validation* in the *ruleflow-group* field.
. Click *Save*, then click *Save* to confirm, to save your changes.
=======
. Click image:6176.png[] next to the *(options)* label to open the *Add an option to the rule* window.
. Select *ruleflow-group* from the *Attribute* drop-down menu and enter *validation* in the *ruleflow-group* field.
. Click *Save*, then click *Save* to confirm your changes.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f

== Creating Guided Decision Tables

To create a guided decision table:

. Log into Business Central. Click *Menu* -> *Projects*, then *process-app-start*.
<<<<<<< HEAD
. Click *Create new asset* -> *Guided Decision Table*, then enter:
=======
. Click *Create New Asset* -> *Guided Decision Table*, then enter:
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
+
* *Name*: `Mortgage Decision Table`
* *Package*: `org.jboss.example`
* Check *Use Wizard*
+
Click *Ok*. The *Guided Decision Table Wizard* window opens.

<<<<<<< HEAD
. Click *Next*, then *Next*. All the objects from the same package are imported by default.
. In the *Define Facts\Patterns on which constraints can be defined* part, place *Applicant* and *Property* facts to the *Chosen patterns* window. Then, click *Next*.
. In the *Define constraints on the Facts\Patterns fields* part:
.. From *Available patterns*, select *Applicant*. From *Available fields*, select *annualincome*, and place it into *Conditions*.
=======
. Select *Add Fact Patterns*.
. Move the *Applicant* and *Property* patterns to the *Chosen patterns* section.
. Click *Add Constraints*, select *Applicant > annualincome:Whole number (interger)*, and move *annualincome..* to the *Conditions* section.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
.. From *Conditions*, select *annualincome*, then enter:
+
* *Column header (description)*: `Annual Income (Greater Than or Equal To)`
* *Operator*: `greater than`
<<<<<<< HEAD
.. From *Available fields*, select *annualincome* and, place it into *Conditions*.
.. From *Conditions*, select *annualincome*, then enter:
=======
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
+
.. Move *annualincome..* to the *Conditions* section again.
.. From *Conditions*, select *annualincome*, then enter:
+
* *Column header (description)*: `Annual Income (Less Than or Equal To)`
* *Operator*: `less than or equal to`
<<<<<<< HEAD
.. From *Available patterns*, select *Property*. From *Available fields*, select *saleprice*, and place it into *Conditions*.
=======
+
.. From *Available patterns*, select *Property*,  then from *Available fields*, select *saleprice:Whole number (interger)* and then move it to the *Conditions* section.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
.. From *Conditions*, select *saleprice*, then enter:
+
* *Column header (description)*: `Sale Price (Less Than)`
* *Operator*: `less than`
<<<<<<< HEAD
.. From *Available fields*, select *age*, and place it into *Conditions*.
=======
.. From *Available fields*, select *age:Whole number (interger)*, and move it in to the *Conditions* section.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
.. From *Conditions*, select *age*, then enter:
+
* *Column header (description)*: `Property Age (Less Than)`
* *Operator*: `less than`
<<<<<<< HEAD
.. From *Available fields*, select *locale*, and place it into *Conditions*.
=======
.. From *Available fields*, select *locale:Text*, and move it to the *Conditions* section.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
.. From *Conditions*, select *locale*, then enter:
+
* *Column header (description)*: `Location`
* *Operator*: `equal to`
* *(optional) value list*: `Urban,Rural`
<<<<<<< HEAD
. Click *Next*, then click *Next*.
. In the *Define actions to insert new Facts\Patterns* part:
.. From *Available patterns*, select *Application* and place it into *Chosen patterns*.
.. From *Chosen patterns*, select *Application*. Then, from *Available fields*, select *mortgageamount* and place it into *Chosen fields*.
=======
. Click *Next*.

. Click *Add Actions to insert Facts*, select *Application* and move it to the *Chosen patterns* section.
.. From *Available fields*, select *mortgageamount:Whole number (integer)*, and move it to the *Chosen fields* section.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
.. From *Chosen fields*, select *mortgageamount*, then enter:
+
* *Column header (description)*: `Mortgage Amount`
. Click *Finish*.
. Click *Save*.
. Click *Insert > Append row* and click *Save*.
. Click *Add Column*.
. From the *Add a new column* window, click *Include advanced options*, then select *Add a new Attribute column*, then click *Next*.
. Click *Decision table* -> *New column*, select *include advanced options*, select *Add a new Attribute column*, then click *Next*.
. Select *Ruleflow-group*, then click *Finish*.
. Click *Insert* -> *Append row*. Repeat this step one time.
. Fill out the table as shown below:

image:guided-dt.png[]

<<<<<<< HEAD
Click the *process-app-start* label to return to the *Assets* view of the project.
=======
. Click *Validate* then *Save*.
>>>>>>> 896f2a28404455ddfb5e34c541fdbe87a74a9f3f
