[id='assembly-openshift-authoring-managed']
= Deploying a {PRODUCT} authoring or managed server environment on {OPENSHIFT}
ifdef::context[:parent-context: {context}]
// Context attribute is assembly specific and enables module reuse between assemblies.
:context: openshift-authoring-managed

// Purpose statement for the assembly
As a system engineer, you can deploy a {PRODUCT} authoring or managed environment on {OPENSHIFT} to provide a platform for developing or running
ifdef::DM[]
services
endif::DM[]
ifdef::PAM[]
services, process applications,
endif::PAM[]
and other business assets.

.Prerequisites

* {OPENSHIFT} version 3.11 is deployed.
* At least four gigabytes of memory are available in the OpenShift cluster/namespace.
* For a high-availability deployment, the following resources are available on the OpenShift cluster:
** For the {CENTRAL} replicated pod, 8 gigabytes of memory and 2 CPU cores are required for each replica. Two replicas are created by default.
** For the {KIE_SERVER} replicated pod, 1 gigabyte of memory and 1 CPU core are required for each replica. Two replicas are created by default.
** The Red Hat AMQ replicated pod uses the default resource limits configured on your cluster.
** For the Red Hat Data Grid replicated pod, 2 gigabytes of memory and 1 CPU core are required for each replica. Two replicas are created by default.

[NOTE]
====
For instructions about checking the capacity of your cluster, see https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html/cluster_administration/admin-guide-cluster-capacity[Analyzing cluster capacity] in the {OPENSHIFT} 3.11 product documentation.
====

* The OpenShift project for the deployment is created.
* You are logged in to the project using the `oc` command. For more information about the `oc` command-line tool, see the OpenShift https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html-single/cli_reference/[CLI Reference]. If you want to use the OpenShift Web console to deploy templates, you must also be logged on using the Web console.
* Dynamic persistent volume (PV) provisioning is enabled. Alternatively, if dynamic PV provisioning is not enabled, a sufficient persistent volume must be available. By default, {CENTRAL} requires one 1Gi PV. You can change the PV size for {CENTRAL} persistent storage in the template parameters.
* If you intend to deploy a high-availability authoring environment, which includes high-availability {CENTRAL}, your OpenShift environment supports persistent volumes with `ReadWriteMany` mode. If your environment does not support this mode, you can use NFS to provision the volumes. However, for best performance and reliability, use GlusterFS to provision persistent volumes for a high-availability authoring environment. For information about access mode support in OpenShift public and dedicated clouds, see https://access.redhat.com/documentation/en-us/openshift_container_platform/3.11/html-single/architecture/#pv-access-modes[Access Modes].

[NOTE]
====
Since {PRODUCT} version 7.5, images and templates for {OPENSHIFT} 3.x are deprecated. These images and templates do not get new features, but remain supported until the end of full support for {OPENSHIFT} version 3.x. For more information about the full support lifecycle phase for {OPENSHIFT} version 3.x, see https://access.redhat.com/support/policy/updates/openshift_noncurrent[Red Hat OpenShift Container Platform Life Cycle Policy (non-current versions)].
====

[NOTE]
====
Do not use {PRODUCT} templates with {OPENSHIFT} 4.x. To deploy {PRODUCT} on {OPENSHIFT} 4.x, see the instructions in {URL_DEPLOYING_ON_OPENSHIFT}#assembly-openshift-operator[_{DEPLOYING_OPENSHIFT_OPERATOR}_].
====



include::{enterprise-dir}/openshift/ba-openshift-overview-con.adoc[leveloffset=+1]
include::{enterprise-dir}/openshift/architecture-authoring-con.adoc[leveloffset=+1]
include::{enterprise-dir}/openshift/dm-openshift-prepare-con.adoc[leveloffset=+1]
include::{enterprise-dir}/openshift/imagestreams-file-install-proc.adoc[leveloffset=+2]
// include::{enterprise-dir}/openshift/imagestreams-file-install-amq-proc.adoc[leveloffset=+2]
:secrettarget: kie
include::{enterprise-dir}/openshift/secrets-secrettarget-create-proc.adoc[leveloffset=+2]
:secrettarget: central
include::{enterprise-dir}/openshift/secrets-secrettarget-create-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/secret-adminuser-create-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/offline-repo-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/glusterfs-reconfig-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/readwritemany-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/environment-authoring-con.adoc[leveloffset=+1]
include::{enterprise-dir}/openshift/authoring-deploy-assy.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/githooks-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/truststore-template-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/rolemapping-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/startupstrategy-enable-proc.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/additional-server-managed-deploy-assy.adoc[leveloffset=+2]
include::{enterprise-dir}/installation/roles-users-con.adoc[leveloffset=+1]

include::{enterprise-dir}/openshift/template-overview-con.adoc[leveloffset=+1]
include::{enterprise-dir}/openshift/rhdm78-authoring-ref.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/rhdm78-authoring-ha-ref.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/rhdm78-kieserver-ref.adoc[leveloffset=+2]
include::{enterprise-dir}/openshift/openshift-usage-ref.adoc[leveloffset=+2]

ifdef::parent-context[:context: {parent-context}]
ifndef::parent-context[:!context:]
